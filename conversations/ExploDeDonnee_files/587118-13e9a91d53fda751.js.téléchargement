(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[587118],{301644:(e,n,i)=>{"use strict";i.d(n,{H:()=>r,d:()=>o});var a=i(194175);const t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"downloadAmsItem"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"urlOrObjectId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"type"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"BlobType"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"applyRetry"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"networkCorrelationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"downloadAmsItem"},arguments:[{kind:"Argument",name:{kind:"Name",value:"urlOrObjectId"},value:{kind:"Variable",name:{kind:"Name",value:"urlOrObjectId"}}},{kind:"Argument",name:{kind:"Name",value:"type"},value:{kind:"Variable",name:{kind:"Name",value:"type"}}},{kind:"Argument",name:{kind:"Name",value:"applyRetry"},value:{kind:"Variable",name:{kind:"Name",value:"applyRetry"}}},{kind:"Argument",name:{kind:"Name",value:"networkCorrelationId"},value:{kind:"Variable",name:{kind:"Name",value:"networkCorrelationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"blob"}},{kind:"Field",name:{kind:"Name",value:"fullSizeHeight"}},{kind:"Field",name:{kind:"Name",value:"fullSizeWidth"}},{kind:"Field",name:{kind:"Name",value:"size"}}]}}]}}]},r=async(e,n,i,r,l)=>{try{const{data:a}=await e.query({query:t,variables:{urlOrObjectId:n,type:i,applyRetry:r,networkCorrelationId:l},fetchPolicy:"network-only"});return{result:a?.downloadAmsItem??void 0,loading:!1,error:void 0}}catch(e){if(e instanceof a.c){const n=e.graphQLErrors.find((e=>o(e.extensions)))?.extensions;return{result:void 0,loading:!1,error:{...n,message:e.message,name:e.name}}}return{result:void 0,loading:!1,error:e}}},o=e=>"string"==typeof e?.cv},314020:(e,n,i)=>{"use strict";i.d(n,{cc:()=>k,PZ:()=>N,G4:()=>p});var a=i(818319);const t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"chatWithUser"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chatWithUser"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isDisabled"}},{kind:"Field",name:{kind:"Name",value:"memberIds"}}]}}]}}]},r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"sendMessage"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"message"}},type:{kind:"NamedType",name:{kind:"Name",value:"SendMessageInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"action"}},type:{kind:"NamedType",name:{kind:"Name",value:"SendMessageAction"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sendMessage"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}},{kind:"Argument",name:{kind:"Name",value:"message"},value:{kind:"Variable",name:{kind:"Name",value:"message"}}},{kind:"Argument",name:{kind:"Name",value:"action"},value:{kind:"Variable",name:{kind:"Name",value:"action"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},o={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"fireCallingIntent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callingIntent"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"CallingIntentInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fireCallingIntent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callingIntent"},value:{kind:"Variable",name:{kind:"Name",value:"callingIntent"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};var l=i(526462),s=i(683184),d=i(686219),c=i(323356),m=i(629494),u=i(811957);const p=(e,n,i)=>{const{enableCentralizedCommandingForEV:t}=(0,m.NC)(s.J.Host,["enableCentralizedCommandingForEV"]),{enablePlatformNavigationForBots:r}=(0,m.NC)(s.J.Extensibility,["enablePlatformNavigationForBots"]);return a.useMemo((()=>({sendMessage:g(n,i),startChat:N(e,n,!!r,i),startCall:f(e,n,i,!!t)})),[e,n,i,t,r])},k=async(e,n)=>{const{data:i}=await e.query({query:t,variables:{userId:n},fetchPolicy:"network-only"});return i?.chatWithUser},g=(e,n)=>async(i,a,t)=>{try{const n=await k(e,i);if(!n)throw new Error(`Could not fetch the user conversation using the mri ${i}`);const o={convId:n.id,message:{content:a,clientMessageId:(0,l.K)()},action:"Create"};await e.mutate({mutation:r,variables:o}),t.stop()}catch{const e=`Error while sending quick message with mri ${i}`;n.error(e),t?.fail({message:e})}},N=(e,n,i,a)=>async(t,r)=>{try{if(!t)throw new Error("No mri provided");const a=await k(n,t);if(a&&a.id){(0,u.bl)(t)&&i?e.platform.platformTabById(JSON.stringify({appId:t,threadId:a.id,tabEntityId:"conversations"}),{stateTransition:d.su.new,visibilityState:d.fe.show,correlation:{source:c.D.AppProfileCard}}):e.chat.chatById(a.id,{entityCommand:{stateTransition:d.su.new,visibilityState:d.fe.show,correlation:{source:c.D.AppProfileCard}}})}else e.chat.chatWithUsers({userIds:[t],entityCommand:{stateTransition:d.su.new,visibilityState:d.fe.show,correlation:{source:c.D.AppProfileCard}}});r?.stop()}catch{const e=`Error while we execute start chat with mri ${t}`;a?.error(e),r?.fail({message:e})}},f=(e,n,i,a)=>async(t,r,l)=>{try{if(!t)throw new Error(`Could not get the user mri ${t} from the persona identifier `);const i=(async(e,n,i=!1)=>{const a={callingIntent:{type:"OneToOneCall",joinOptions:{outgoingVideo:i,outgoingAudio:!0,oneToOne:{sharingSourceId:void 0}},coordinates:{oneToOne:{mri:n}}}},{data:t}=await e.mutate({mutation:o,variables:a});return t?.fireCallingIntent?.id})(n,t,r),s=k(n,t),[m,u]=await Promise.all([i,s]);if(!m)throw new Error(`Could not fetch the user calling IntentId using the mri ${t}`);const p=u?.id;a||e.call.callById(m,{stateTransition:d.su.new,visibilityState:d.fe.show,correlation:{source:c.D.AppProfileCard}},p),l.stop()}catch{const e=`Error while StartCall using the mri ${t}`;i.error(e),l.fail({message:e})}}},750949:(e,n,i)=>{"use strict";i.d(n,{V:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"appDefinition"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scope"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppsFilterOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appDefinition"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"scope"},value:{kind:"Variable",name:{kind:"Name",value:"scope"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appDefinition"}}]}}]}},...i(793563).E.definitions]}},121375:(e,n,i)=>{"use strict";i.d(n,{r:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"appDefinitions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"scope"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppsFilterOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appDefinitions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"scope"},value:{kind:"Variable",name:{kind:"Name",value:"scope"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appDefinition"}}]}}]}},...i(793563).E.definitions]}},928869:(e,n,i)=>{"use strict";i.d(n,{pr:()=>o,kf:()=>l,qy:()=>s,xv:()=>d,Xr:()=>c,V8:()=>m,Cv:()=>u,i7:()=>p,gV:()=>k,oG:()=>g,ju:()=>h,DP:()=>v,QR:()=>T,ch:()=>M,NQ:()=>y,kj:()=>S,xc:()=>b,yr:()=>D});var a,t=i(337178),r=i(803238);!function(e){e.Bot="Bot",e.Connector="Connector",e.Messaging="Messaging",e.StaticTabs="StaticTabs",e.GalleryTab="GalleryTab"}(a||(a={}));const o=e=>!!e&&A(e,["Installed","InstalledAndFavorited","InstalledAndPermanent","AdminPreInstalled"]),l=e=>I(e,["Installed","InstalledAndFavorited","InstalledAndPermanent","AdminPreInstalled"]),s=e=>"InstalledApp"===e?.__typename&&!(0,r.isUndefined)(e?.definition),d=e=>!!e&&A(e,["InstalledAndPermanent"]),c=e=>!!e&&A(e,["Featured"]),m=e=>!!e&&A(e,["PreConsented"]),u=e=>I(e,["PreConsented"]),p=e=>A(e,["RequireConsent"]),k=e=>A(e,["NotInstalled"]),g=e=>e&&(N(e.definition,a.Bot,"Personal")||N(e.definition,a.StaticTabs,"Personal"))||!1,N=(e,n,i)=>{if(!e)return!1;switch(n){case a.Bot:return e.bots&&(0,r.first)(e.bots)&&(0,r.includes)(e.bots[0].scopes,i)||!1;case a.StaticTabs:return e.staticTabs&&(0,r.first)(e.staticTabs)&&(0,r.includes)(e.staticTabs[0].scopes,i)||!1;default:return!1}},f=(e,n)=>e.installedScope&&e.installedScope.includes(n),h=e=>o(e)&&f(e,"Personal"),v=(e,n=!1)=>{const i=c(e)||o(e)&&(f(e,"GroupChat")||f(e,"Team"));return n?i||m(e):i},T=e=>o(e)&&(f(e,"GroupChat")||f(e,"Team")),M=e=>{const n=e.data&&e.data.installApp;return!!n&&"InstalledApp"===n.__typename},y=e=>{const n=e.data&&e.data.installCustomApp;return!!n&&"InstalledApp"===n.__typename},S=e=>{const n=e.data&&e.data.upgradeApp;return!!n&&"InstalledApp"===n.__typename},A=(e,n)=>(0,r.includes)(n,e.installationState),I=(e,n)=>(0,r.includes)(n,e),b=e=>{let n="",i="";if(e&&e.length>0){const a=e.indexOf(t.Jk.statusKey),r=e.indexOf(t.Jk.errorCodeKey);n=a>-1?`Http status code: ${C(e.substr(a),t.Jk.statusKey)}`:`Http status code: ${t.BY}`,i=r>-1?`Error code: ${C(e.substr(r),t.Jk.errorCodeKey)}`:`Error code: ${t.WK.NoSpecificErrorMessageFound}`}return`${n}, ${i}`},C=(e,n)=>{const i=e.length>0?e.split(","):[];if(i.length>0){const e=i[0].replace(/[\\"'{}\s]/g,"").split(":");if(e.length>1&&(n===t.Jk.statusKey&&e[1]in t.WE||n===t.Jk.errorCodeKey&&e[1]in t.WK))return e[1]}return n===t.Jk.statusKey?t.BY:t.WK.NoSpecificErrorMessageFound},D=()=>`${`Http status code: ${t.BY}`}, ${`Error code: ${t.WK.NoSpecificErrorMessageFound}`}`},337178:(e,n,i)=>{"use strict";var a,t;i.d(n,{WK:()=>a,WE:()=>t,BY:()=>r,Jk:()=>o,HU:()=>l}),function(e){e.NoSpecificErrorMessageFound="NoSpecificErrorMessageFound",e.Unknown="Unknown",e.Unauthorized="Unauthorized",e.AccessDenied="AccessDenied",e.BadRequest="BadRequest",e.NotFound="NotFound",e.AppScopeIsNotAllowed="AppScopeIsNotAllowed",e.AppIsNotInstalledInTheChat="AppIsNotInstalledInTheChat",e.AppIsNotInstalledInTheTeam="AppIsNotInstalledInTheTeam",e.AppIsNotActivelyInstalled="AppIsNotActivelyInstalled",e.AppIsBlockedByAppPermissionPolicy="AppIsBlockedByAppPermissionPolicy",e.UnknownFailureToParseTeamsAppManifest="UnknownFailureToParseTeamsAppManifest",e.UnableToParseTeamsAppManifest="UnableToParseTeamsAppManifest",e.AppSideloadingForbidden="AppSideloadingForbidden",e.CreateGroupChatAppDefinitionFailed="CreateGroupChatAppDefinitionFailed",e.AppDefinitionAlreadyExists="AppDefinitionAlreadyExists",e.AppDefinitionDoesntExist="AppDefinitionDoesntExist",e.UpdateGroupChatAppDefinitionFailed="UpdateGroupChatAppDefinitionFailed",e.GetAppDefinitionFailed="GetAppDefinitionFailed",e.GetGlobalAppDefinitionsFailed="GetGlobalAppDefinitionsFailed",e.AppDefinitionUpdateNotPermitted="AppDefinitionUpdateNotPermitted",e.AppEntitlementAlreadyExists="AppEntitlementAlreadyExists",e.CreateGroupChatAppEntitlementFailed="CreateGroupChatAppEntitlementFailed",e.CreateTeamAppEntitlementFailed="CreateTeamAppEntitlementFailed",e.GroupChatEntitlementDoesntExist="GroupChatEntitlementDoesntExist",e.TeamAppEntitlementsDontExist="TeamAppEntitlementsDontExist",e.UserAppEntitlementsDontExist="UserAppEntitlementsDontExist",e.TenantAppEntitlementsDontExist="TenantAppEntitlementsDontExist",e.UpgradeTeamAppEntitlementFailed="UpgradeTeamAppEntitlementFailed",e.UpgradeUserAppEntitlementFailed="UpgradeUserAppEntitlementFailed",e.UpgradeGroupChatAppEntitlementFailed="UpgradeGroupChatAppEntitlementFailed",e.GetUserEntitlementsFailed="GetUserEntitlementsFailed",e.GetDefaultUserAppEntitlementsFailed="GetDefaultUserAppEntitlementsFailed",e.SetUserAppEntitlementFailed="SetUserAppEntitlementFailed",e.PermanentAppEntitlementUpdateNotAllowed="PermanentAppEntitlementUpdateNotAllowed",e.GetUserAggregatedAppsFailed="GetUserAggregatedAppsFailed",e.TemplatedAppNotAllowedByTenantSettings="TemplatedAppNotAllowedByTenantSettings",e.TemplatedAppNotAllowedByUserPermissionPolicy="TemplatedAppNotAllowedByUserPermissionPolicy",e.TemplatedInstanceAppNotAllowed="TemplatedInstanceAppNotAllowed",e.GetTeamThreadFailed="GetTeamThreadFailed",e.GetTeamThreadsFailed="GetTeamThreadsFailed",e.GetChatThreadFailed="GetChatThreadFailed",e.GetTenantSettingsFailed="GetTenantSettingsFailed",e.NoPermissionToInstallApp="NoPermissionToInstallApp",e.NoPermissionToUpgradeApp="NoPermissionToUpgradeApp",e.NoPermissionToUploadCustomApp="NoPermissionToUploadCustomApp",e.FailedToCheckPermissionToManageApp="FailedToCheckPermissionToManageApp",e.AppIsTenantAdminBlocked="AppIsTenantAdminBlocked",e.AppUploadNotAllowedByTenant="AppUploadNotAllowedByTenant",e.AppUpdateNotAllowedByTenant="AppUpdateNotAllowedByTenant",e.UserNotAuthorizedToPerformAppOperationOnGroupChat="UserNotAuthorizedToPerformAppOperationOnGroupChat",e.AddAppBotToChatRosterFailed="AddAppBotToChatRosterFailed",e.AddAppBotToTeamRosterFailed="AddAppBotToTeamRosterFailed",e.AddBotToRosterFailedMaxLimitReached="AddBotToRosterFailedMaxLimitReached",e.UserNotFoundInSkypeTeam="UserNotFoundInSkypeTeam",e.BotIdFormatIsIncorrect="BotIdFormatIsIncorrect",e.GuestNotAllowedToInstallApps="GuestNotAllowedToInstallApps",e.GuestNotAllowedToUpdateApps="GuestNotAllowedToUpdateApps",e.GuestNotAllowedToUpgradeApps="GuestNotAllowedToUpgradeApps",e.OperationNotAllowedOnInstalledAndDeprecatedApp="OperationNotAllowedOnInstalledAndDeprecatedApp",e.AnonymousUsersInteractionNotSupported="AnonymousUsersInteractionNotSupported",e.GetUserAppSetupPoliciesAsync="GetUserAppSetupPoliciesAsync",e.InvalidHostedAppOperationForbidden="InvalidHostedAppOperationForbidden",e.OperationNotAllowedOnArchivedTeam="OperationNotAllowedOnArchivedTeam",e.ClientNetworkOffline="ClientNetworkOffline"}(a||(a={})),function(e){e[e.OK=200]="OK",e[e.CREATED=201]="CREATED",e[e.ACCEPTED=202]="ACCEPTED",e[e.NO_CONTENT=204]="NO_CONTENT",e[e.NOT_MODIFIED=304]="NOT_MODIFIED",e[e.BAD_REQUEST=400]="BAD_REQUEST",e[e.UNAUTHORIZED=401]="UNAUTHORIZED",e[e.PAYMENT_REQUIRED=402]="PAYMENT_REQUIRED",e[e.FORBIDDEN=403]="FORBIDDEN",e[e.NOT_FOUND=404]="NOT_FOUND",e[e.NOT_ALLOWED=405]="NOT_ALLOWED",e[e.NOT_ACCEPTABLE=406]="NOT_ACCEPTABLE",e[e.CONFLICT=409]="CONFLICT",e[e.GONE=410]="GONE",e[e.LENGTH_REQUIRED=411]="LENGTH_REQUIRED",e[e.PRECONDITION_FAILED=412]="PRECONDITION_FAILED",e[e.REQUEST_ENTITY_TOO_LARGE=413]="REQUEST_ENTITY_TOO_LARGE",e[e.UNSUPPORTED_MEDIA_TYPE=415]="UNSUPPORTED_MEDIA_TYPE",e[e.REQUEST_RANGE_NOT_SATISFIABLE=416]="REQUEST_RANGE_NOT_SATISFIABLE",e[e.EXPECTATION_FAILED=417]="EXPECTATION_FAILED",e[e.UNPROCESSABLE_ENTITY=422]="UNPROCESSABLE_ENTITY",e[e.THROTTLED=429]="THROTTLED",e[e.SERVER_ERROR=500]="SERVER_ERROR",e[e.NOT_IMPLEMENTED=501]="NOT_IMPLEMENTED",e[e.BAD_GATEWAY=502]="BAD_GATEWAY",e[e.SERVICE_UNAVAILABLE=503]="SERVICE_UNAVAILABLE",e[e.GATEWAY_TIMEOUT=504]="GATEWAY_TIMEOUT",e[e.INSUFFICIENT_STORAGE=507]="INSUFFICIENT_STORAGE",e[e.BANDWIDTH_LIMIT_EXCEEDED=509]="BANDWIDTH_LIMIT_EXCEEDED"}(t||(t={}));const r="NoHttpStatusCode",o={statusKey:"status",errorCodeKey:"errorCode"};var l;!function(e){e[e.BotInputMenu=1]="BotInputMenu",e[e.BotMentions=2]="BotMentions",e[e.MessageExtension=3]="MessageExtension",e[e.MessageAction=4]="MessageAction",e[e.LinkUnfurling=5]="LinkUnfurling",e[e.Webhooks=6]="Webhooks",e[e.BotCards=7]="BotCards",e[e.ChatPane=8]="ChatPane",e[e.MeetingAppNotifications=9]="MeetingAppNotifications",e[e.AppDetails=10]="AppDetails",e[e.TcPickerNavigation=11]="TcPickerNavigation",e[e.Scenes=12]="Scenes",e[e.CallEscalation=13]="CallEscalation",e[e.VivaFeedback=14]="VivaFeedback",e[e.InContextStore=15]="InContextStore",e[e.MeetingAppsFlyout=16]="MeetingAppsFlyout",e[e.AppsFlyout=17]="AppsFlyout",e[e.FreDialog=18]="FreDialog",e[e.Compose=19]="Compose",e[e.Connectors=20]="Connectors",e[e.PreviewCardFooter=21]="PreviewCardFooter",e[e.ACV2CardJITInstall=22]="ACV2CardJITInstall",e[e.MessageExtensionCardFooter=23]="MessageExtensionCardFooter",e[e.TaskModule=24]="TaskModule",e[e.MessageExtensionFlyoutCommand=25]="MessageExtensionFlyoutCommand",e[e.MessageExtensionFlyoutCommandPostInstall=26]="MessageExtensionFlyoutCommandPostInstall",e[e.GetFetchCommandApps=27]="GetFetchCommandApps",e[e.PinnedMessageExtensions=28]="PinnedMessageExtensions"}(l||(l={}))},462512:(e,n,i)=>{"use strict";i.d(n,{aN:()=>H,LS:()=>J,WW:()=>_,P2:()=>R,VC:()=>U,yx:()=>C,Vn:()=>D,HQ:()=>F,dK:()=>j,Qw:()=>x,sV:()=>b,xJ:()=>B,co:()=>L,jA:()=>W,Bi:()=>w,nM:()=>Q,eI:()=>y,Er:()=>V,Y2:()=>A});var a=i(803238),t=i(380275),r=i(543491),o=i(702135),l=i(689626),s=i(928869),d=i(121375),c=i(750949);const m={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"appImpressions"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"impressionProperty"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appImpressions"},arguments:[{kind:"Argument",name:{kind:"Name",value:"impressionProperty"},value:{kind:"Variable",name:{kind:"Name",value:"impressionProperty"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"count"}}]}}]}}]};var u=i(341887);const p={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"installApp"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installScope"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installParameters"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallParametersInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installApp"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installScope"},value:{kind:"Variable",name:{kind:"Name",value:"installScope"}}},{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"installParameters"},value:{kind:"Variable",name:{kind:"Name",value:"installParameters"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...u.W.definitions]},k={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"upgradeApp"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installScope"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"upgradeApp"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installScope"},value:{kind:"Variable",name:{kind:"Name",value:"installScope"}}},{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...u.W.definitions]},g={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"deleteApp"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedScope"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"deleteParameters"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppDeleteParametersInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"deleteApp"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedScope"},value:{kind:"Variable",name:{kind:"Name",value:"installedScope"}}},{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"deleteParameters"},value:{kind:"Variable",name:{kind:"Name",value:"deleteParameters"}}}]}]}}]};var N=i(607275),f=i(315783),h=i(668587),v=i(337178),T=i(714129),M=i(383914);const y=(e,n,i,a,t,r,o,l,d,c,m,u)=>{const k={installScope:t,appId:a,conversationId:l,installParameters:c||u?{isCopilotPlugin:c,hasAppEnableConsent:u}:void 0},g=n.newScenario(i);return g.appendEventData({"Thread.Id":l,"App.Id":a}),d&&g.appendEventData(d),H(g,l),e.mutate({mutation:p,variables:k,update:S(e,k,r,o),context:{callerInfo:m}}).then((e=>{if(!(0,s.ch)(e)||!e.data?.installApp?.definition)throw new Error("unexpected response, install app failed");return g.stop(),e.data.installApp})).catch((e=>{const n=e&&e.message?(0,s.xc)(e.message):(0,s.yr)();throw n.includes(v.WK.ClientNetworkOffline)?g.cancel({errors:n}):g.fail({errors:n}),e}))},S=(e,{installScope:n,conversationId:i},a,t)=>(r,o)=>{try{const r=(0,s.ch)(o)&&o.data;r&&r.installApp?(0,N.WB)({client:e,installedScope:n,conversationId:i,logger:a,enableAppsQueryOptimization:t},r.installApp):a.error("mutation update, install app failed")}catch(e){a.error("Failed to add app to client cache")}},A=(e,n,i,a,t,r,o,l,d)=>{const c={installScope:t,appId:a,conversationId:l},m=n.newScenario(i);return e.mutate({mutation:k,variables:c,update:I(e,c,r,o)}).then((e=>{if(!(0,s.kj)(e)||!e.data?.upgradeApp?.definition)throw new Error("unexpected response, upgrade app failed");return d?m.stop(d):m.stop(),e.data.upgradeApp})).catch((e=>{const n=e&&e.message?(0,s.xc)(e.message):(0,s.yr)();throw d?m.fail({...d,errors:n}):m.fail({errors:n}),e}))},I=(e,{installScope:n,conversationId:i},a,t)=>(r,o)=>{try{const r=(0,s.kj)(o)&&o.data;r&&r.upgradeApp?(0,N.WB)({client:e,installedScope:n,conversationId:i,logger:a,enableAppsQueryOptimization:t},r.upgradeApp):a.error("mutation update, upgrade app failed")}catch(e){a.error("Failed to add app to client cache")}},b=async(e,n,i,a)=>{const t=["Personal"],o=a?.conversation,l={installedScopes:o?[...t,o.scope]:t,conversationId:o&&o.id,options:{capabilityFilter:a?.capabilityFilter}},s=n.newScenario(r.RG.ExtInstalledApps);try{const n=await(0,T.r7)(e,l,"no-cache");s.mark(r.ck.ExtAppsFetched);const a=n?.filter((e=>e&&e.definition&&e.id===i));return s.mark(r.ck.ExtAppsProcessed),s.stop(),a}catch(e){return s.fail({errors:`failed to get installed app id: ${i}`}),[]}},C=async(e,n,i,a,t)=>{let r;i&&(r=a||"GroupChat");const{data:s,error:d}=await e.query({query:c.V,variables:{appId:n,scope:r,conversationId:i},context:{callerInfo:`${t}-getAppDefinition`}});if(!s||!s.appDefinition||d){const e="Get AppDefinition failed";throw(0,o.Tr)("AppsHelper",l.jK.NotPresent,"getAppDefinition",void 0,d?.message??e)}return s.appDefinition},D=async(e,n,i,a,t)=>{const{data:r,error:o}=await e.query({query:d.r,variables:n,context:{callerInfo:i}});if(!r||!r.appDefinitions){const e="Get AppDefinitions failed";if(t){t(`Fail to get App definitions, error message: ${o?.message}`)}throw new Error(e)}return a&&a(),r.appDefinitions},F=async(e,n,i,a)=>{const t=await D(e,{options:{capabilityFilter:["Messaging"]},conversationId:i,scope:a},"getAppDefinitionsByContext");return U(t,n)},U=(e,n)=>e.filter((e=>E(e,n))),E=(e,n)=>{if(!n)return!0;const i=e.messageExtensions??[];if(!(0,a.isEmpty)(i))for(const e of i)if((0,a.some)(e.commands,(e=>(0,h.RL)(e,n))))return!0;return!1},w=async e=>{const{client:n,logger:i,scenarioFactory:a,enableInstalledAppsV2:t,enableAppsQueryOptimization:r,entryPoint:o,isOneOnOneBotChat:l,scope:s,convId:d,botId:c}=e;let m={};d&&(m={conversation:l?void 0:{scope:s||"GroupChat",id:d},capabilityFilter:["Bot"],shouldFetchPersonalApps:l,botId:c,entryPoint:o});const u=t?await Q(n,i,a,r,m,void 0):await O(n,i,a,m);if(t&&c){const e=u?.filter((e=>e.definition?.bots?.[0]?.id===c));return e}return u},L=async(e,n,i,a,t,r,o,l)=>a?await Q(e,n,i,t,r,o,void 0,void 0,l):await O(e,n,i,r,o),x=async(e,n,i,a)=>{const t=i.newScenario(r.RG.ExtGetSimpleAppModel);try{const n=await(0,T.oW)(e,a??"cache-only");return t.stop(),n}catch(e){const i="getAppInstalledByCurrentUser failed";return t.fail({errors:i}),n.warn(`${i} ${e}`),[]}},O=async(e,n,i,a,t)=>{const o=i.newScenario(r.RG.ExtInstalledApps);try{const n=[];a?.shouldFetchPersonalApps&&n.push("Personal"),a?.conversation&&n.push(a.conversation.scope);const i=await(0,T.r7)(e,{installedScopes:n,conversationId:a?.conversation?.id,options:{capabilityFilter:a?.capabilityFilter,botId:a?.botId}},a?.fetchPolicy);o.mark(r.ck.ExtAppsFetched);const l=V(i,t);return o.mark(r.ck.ExtAppsProcessed),o.stop(),l}catch(e){const i=`getInstalledApps failed: ${a?.botId??""}`;return o.fail({errors:i}),n.warn(`${i} ${e}`),[]}},j=async(e,n,i,a,t)=>{const s={query:m,fetchPolicy:t??"network-only",variables:{impressionProperty:a}},d=i.newScenario(r.RG.ExtGetAppImpression),c="Get AppImpressions failed";try{const{data:n}=await e.query(s);if(!n||!n.appImpressions)throw(0,o.Tr)("AppsHelper",l.jK.NotPresent,"getAppImpressions",void 0,c);return d.stop(),n.appImpressions}catch(e){return d.fail({errors:c}),n.warnToTelemetry?.(`${c} ${e}`,"platform_appsframework_appscore_apps_helper"),[]}},V=(e,n,i)=>(0,t.compose)(a.compact,(0,t.map)((e=>z(e,n))),(0,t.filter)((e=>(0,s.qy)(e)&&G(e,i))))(e),z=(e,n)=>{if(!n)return e;let i=!1,t=[];if(e.definition.messageExtensions&&(t=e.definition.messageExtensions.map((e=>{let t=e;const r=e.commands??[];return(0,a.isEmpty)(e.commands)||(t={...e,commands:r.filter((e=>!!(0,h.RL)(e,n)&&(i=!0,!0)))}),t}))),!i)return null;const r=t.length?{...e.definition,messageExtensions:t}:e.definition;return{...e,definition:r}},P=(e,{appId:n,installedScope:i,conversationId:a},t,r)=>(o,{data:l})=>{try{l&&l.deleteApp?(0,N.nF)({client:e,installedScope:i,conversationId:a,logger:t,enableAppsQueryOptimization:r},n):t.error("mutation update, delete app failed")}catch(e){t.error("Failed to remove app from client cache")}},R=async(e,n,i,a,t,r)=>{const o=n.newScenario(i);o.appendEventData({"Thread.Id":t.conversationId??void 0}),H(o,t.conversationId);try{const n=await e.mutate({mutation:g,variables:t,update:P(e,t,a,r)});if(!n?.data?.deleteApp)throw new Error("unexpected response, delete app failed");return o.stop(),n}catch(e){throw o.fail({errors:`failed to delete app ${t.appId}`}),e}},B=async(e,n,i,a,t,o,l)=>{const s=l||{},d=i.newScenario(r.RG.ExtInstalledAppsV2);try{const i=[];if(l?.enableInstalledAppQueryOptimization){if(d.appendEventData({dataSource:"installedApp query",correlationId:o}),s.shouldFetchPersonalApps){const n=e.query({query:M.Z,variables:{installedScope:"Personal",appId:a},context:{callerInfo:`${o}-getInstalledAppsByIdV2`}}).then((e=>e.data?.installedApp));i.push(n)}if(s.conversation&&s.conversation.id){const n=e.query({query:M.Z,variables:{installedScope:s.conversation.scope,appId:a,conversationId:s.conversation.id},context:{callerInfo:`${o}-getInstalledAppsByIdV2`}}).then((e=>e.data?.installedApp));i.push(n)}const n=(await Promise.all(i)).filter((e=>!!e));return d.mark(r.ck.ExtAppsProcessed),d.stop({appCount:n.length}),n}{d.appendEventData({dataSource:"installedAppsV2 query",correlationId:o});const i=(await Z(e,d,n,t,`${o}-getInstalledAppsByIdV2`,s)).filter((e=>e&&e.definition&&e.id===a));return d.mark(r.ck.ExtAppsProcessed),d.stop(),i}}catch(e){return d.fail({errors:`failed to get installed app id: ${a}`}),[]}},Q=async(e,n,i,a,t,o,l,s,d)=>{const c=i.newScenario(r.RG.ExtInstalledAppsV2),m={"Thread.Id":t?.conversation?.id};t?.entryPoint&&(m["App.EntryPoint"]=v.HU[t.entryPoint]);try{const i=await Z(e,c,n,a,t?.entryPoint?v.HU[t.entryPoint]:"getInstalledAppsV2",t,d),s=V(i,o,t);return c.mark(r.ck.ExtAppsProcessed),c.stop(m),l&&l(),s}catch(e){const i=`getInstalledAppsV2 failed convId: ${t?.conversation?.id??""} botId: ${t?.botId??""}`;return c.fail({...m,errors:i}),s&&s(i),n.warn(`${i}`),[]}},W=async(e,n,i,a,t)=>{const r=i.newScenario(a);try{const i=await(0,T.wA)(e,n,"network-only"),a=V(i);return r.stop(),a}catch{const e=`failed to get hosted installed apps for ${n}`;return r.fail({errors:e}),t.error(e),[]}},Z=async(e,n,i,a,t,o,l)=>{let s;const{fetchPolicyForScope:d,fetchOptions:c}=await(0,f.EQ)(e,i,o);let m=null,u=null;if(o?.shouldFetchPersonalApps){s={scope:"Personal",conversationId:o?.conversation?.id};m=(l?T.o5:T.Px)(e,{installedContext:s},t,(0,f.i6)(d.Personal)).then((e=>(n.mark(r.ck.ExtAppsFetchedPersonalScope),i.log(`installedApps: ${e.length} scope: ${s.scope}`),e)))}o?.conversation&&o?.conversation.id&&(u=Y(e,n,i,a,o.conversation,d,t,l));const p=[...m?[m]:[],...u?[u]:[]],[k,g]=await Promise.all(p);return(0,f.N$)(e,i,c),k.concat(g)},Y=(e,n,i,a,t,o,l,s)=>{let d;const c=t.scope,m="Team"===t.scope,u={scope:c,conversationId:t.id},p=(0,f.i6)(o[c]);return a&&!m?(d=(0,T.KD)(e,{conversationId:t.id},p),n.mark(r.ck.ExtAppsQueryInstalledAppsWithPreCheck)):(d=s?(0,T.o5)(e,{installedContext:u},l,p):(0,T.Px)(e,{installedContext:u},l,p),n.mark(r.ck.ExtAppsQueryInstalledAppsV2)),d=d.then((e=>{i.log(`installedApps: ${e.length} scope: ${u.scope} conversationId: ${u.conversationId} enableInstalledAppsMsgActionsQueryOptimization: ${s}`);const a="Team"===c?r.ck.ExtAppsFetchedTeamScope:r.ck.ExtAppsFetchedGroupScope;return n.mark(a),e})),d},G=(e,n)=>{if((0,a.isEmpty)(n?.capabilityFilter))return!0;const i=e.definition;return(0,a.some)(n?.capabilityFilter,(e=>{switch(e){case"Messaging":return!(0,a.isEmpty)(i.messageExtensions);case"Tab":return!(0,a.isEmpty)(i.galleryTabs)||n?.enableStaticTabsPhase1&&!(0,a.isEmpty)(i.staticTabs);case"Bot":return!(0,a.isEmpty)(i.bots);case"Connector":return!(0,a.isEmpty)(i.connectors)}}))},_=(e,n)=>{let i=J(e,n.bots)||J(e,n.connectors)||J(e,n.galleryTabs)||J(e,n.staticTabs);if("Team"===e)return i;if(i||(i=J(e,n.messageExtensions)),"Personal"!==e)return i;const a=(n.meetingExtensionDefinition?.scenes?.length??0)>0,t=(n.meetingExtensionDefinition?.filters?.length??0)>0;return i||a||t},J=(e,n)=>(0,a.some)(n,(n=>(0,a.includes)(n.scopes,e))),H=(e,n)=>{(e=>!!e&&(e.toLowerCase().includes("replychainid")||e.toLowerCase().includes("messageid")))(n)&&e.appendEventData({"Thread.Type":"Channel"})}},809878:(e,n,i)=>{"use strict";i.d(n,{l:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"appsInstalledByCurrentUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appsInstalledByCurrentUser"}}]}}]}},571575:(e,n,i)=>{"use strict";i.d(n,{e:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"appsUsage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appsUsage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appsUsageFields"}}]}}]}},...i(802596).o.definitions]}},315783:(e,n,i)=>{"use strict";i.d(n,{EQ:()=>o,i6:()=>c,N$:()=>s,Ns:()=>d});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"platformAppsBatchFetchPolicy"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PlatformAppsFetchPolicyOptions"}}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"platformAppsBatchFetchPolicy"},arguments:[{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"},arguments:[{kind:"Argument",name:{kind:"Name",value:"always"},value:{kind:"BooleanValue",value:!0}}]}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"scope"}},{kind:"Field",name:{kind:"Name",value:"convId"}},{kind:"Field",name:{kind:"Name",value:"forceNetworkFetch"}}]}}]}}]},t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DataClientPlatformUpdateAllAppsFetchPoliciesMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"fetchSource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PlatformAppsFetchSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateAllPlatformAppsFetchPolicies"},arguments:[{kind:"Argument",name:{kind:"Name",value:"fetchSource"},value:{kind:"Variable",name:{kind:"Name",value:"fetchSource"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]};var r=i(17182);const o=async(e,n,i)=>{const a={};let t=[];try{i?.shouldFetchPersonalApps&&(t=[{scope:"Personal"}]),i?.conversation&&i?.conversation.id&&(t=[...t,{scope:i.conversation.scope,convId:i.conversation.id}]);const a=await l(e,t);return n.log("getFetchPolicy for installedApps",a),{fetchPolicyForScope:a,fetchOptions:t}}catch(e){return n.error("getFetchPolicy for installedApps failed"),{fetchPolicyForScope:a,fetchOptions:t}}},l=async(e,n)=>{const{data:i}=await e.query({query:a,variables:{options:n}}),t={},r=i?.platformAppsBatchFetchPolicy?.reduce(((e,n)=>({...e,[n.scope]:n.forceNetworkFetch})),t);return r??t},s=(e,n,i,a)=>{const t=a??"Cache",o=i.map((e=>({...e,fetchSource:t})));return e.mutate({mutation:r.U,variables:{input:o}}).catch((e=>(n.error("failed to set fetch policy to ",t),Promise.resolve(void 0))))},d=(e,n,i)=>{e.mutate({mutation:t,variables:{fetchSource:i}}).catch((e=>{n.error("failed to update all fetch policies to ",i)}))},c=e=>e?"network-only":"cache-first"},383914:(e,n,i)=>{"use strict";i.d(n,{Z:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedApp"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedScope"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedApp"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedScope"},value:{kind:"Variable",name:{kind:"Name",value:"installedScope"}}},{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}},{kind:"Field",name:{kind:"Name",value:"statusInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"}}]}}]}}]}},...i(341887).W.definitions]}},751599:(e,n,i)=>{"use strict";i.d(n,{C:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedAppsV2"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedContext"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallContext"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedAppsV2"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedContext"},value:{kind:"Variable",name:{kind:"Name",value:"installedContext"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}},{kind:"Field",name:{kind:"Name",value:"statusInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"}}]}}]}}]}},...i(341887).W.definitions]}},714129:(e,n,i)=>{"use strict";i.d(n,{oW:()=>g,yC:()=>k,KD:()=>u,r7:()=>f,wA:()=>N,Px:()=>p,o5:()=>h});var a=i(751599),t=i(341887);const r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedAppsForContainerApp"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"containerAppId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedAppsForContainerApp"},arguments:[{kind:"Argument",name:{kind:"Name",value:"containerAppId"},value:{kind:"Variable",name:{kind:"Name",value:"containerAppId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...t.W.definitions]},o={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedChatAppsWithPreCheck"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedChatAppsWithPreCheck"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...t.W.definitions]},l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedApps"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedScopes"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"AppsFilterOptionsInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedApps"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedScopes"},value:{kind:"Variable",name:{kind:"Name",value:"installedScopes"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"installedAppFields"}}]}}]}},...t.W.definitions]};var s=i(571575),d=i(809878);const c={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonAppDefinitionMsgActionFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AppDefinition"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"largeImageUrl"}},{kind:"Field",name:{kind:"Name",value:"validDomains"}},{kind:"Field",name:{kind:"Name",value:"accentColor"}},{kind:"Field",name:{kind:"Name",value:"isFullScreenApp"}},{kind:"Field",name:{kind:"Name",value:"isFullTrustApp"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"externalId"}},{kind:"Field",name:{kind:"Name",value:"isMicrosoftOwned"}},{kind:"Field",name:{kind:"Name",value:"webApplicationInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"resource"}}]}},{kind:"Field",name:{kind:"Name",value:"messageExtensions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"botId"}},{kind:"Field",name:{kind:"Name",value:"canUpdateConfiguration"}},{kind:"Field",name:{kind:"Name",value:"fetchCommands"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"commands"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"initialRun"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"parameters"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"isRequired"}}]}},{kind:"Field",name:{kind:"Name",value:"appKey"}},{kind:"Field",name:{kind:"Name",value:"fetchTask"}},{kind:"Field",name:{kind:"Name",value:"taskInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"height"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"width"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"authorization"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authType"}},{kind:"Field",name:{kind:"Name",value:"microsoftEntraConfiguration"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"supportsSingleSignOn"}}]}}]}}]}}]}}]},m={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAppsPlatformQueriesInstalledAppsV2MessageActionsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedContext"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallContext"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedAppsV2"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedContext"},value:{kind:"Variable",name:{kind:"Name",value:"installedContext"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonInstalledAppMsgActionFragment"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonInstalledAppMsgActionFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"InstalledApp"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"installedScope"}},{kind:"Field",name:{kind:"Name",value:"installationState"}},{kind:"Field",name:{kind:"Name",value:"messageExtensionStates"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"messageExtensionState"}}]}},{kind:"Field",name:{kind:"Name",value:"definition"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonAppDefinitionMsgActionFragment"}}]}}]}},...i(299227).l.definitions,...c.definitions]}.definitions]},u=async(e,n,i)=>{const{data:a}=await e.query({query:o,variables:n,fetchPolicy:i});return a&&a.installedChatAppsWithPreCheck?a.installedChatAppsWithPreCheck:[]},p=async(e,n,i,t)=>{const{data:r}=await e.query({query:a.C,variables:n,fetchPolicy:t,context:{callerInfo:i}});return r&&r.installedAppsV2?r.installedAppsV2:[]},k=async(e,n)=>{const{data:i}=await e.query({query:s.e,fetchPolicy:n});return i?.appsUsage?i.appsUsage:{__typename:"AppsUsage",appIds:[],appActions:[],appScenes:[],appsMru:[]}},g=async(e,n)=>{const i=await e.query({query:d.l,fetchPolicy:n}),{data:a}=i;return a?.appsInstalledByCurrentUser?a.appsInstalledByCurrentUser:[]},N=async(e,n,i)=>{const{data:a}=await e.query({query:r,variables:{containerAppId:n},fetchPolicy:i});return a?.installedAppsForContainerApp?a.installedAppsForContainerApp:[]},f=async(e,n,i)=>{const{data:a}=await e.query({query:l,variables:n,fetchPolicy:i});return a&&a.installedApps?a.installedApps:[]},h=async(e,n,i,a)=>{const{data:t}=await e.query({query:m,variables:n,fetchPolicy:a,context:{callerInfo:i}});return t?.installedAppsV2?t.installedAppsV2:[]}},607275:(e,n,i)=>{"use strict";i.d(n,{WB:()=>k,sw:()=>m,nF:()=>p});var a=i(803238);const t={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedAppsIdList"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedContext"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallContext"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedAppsV2"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedContext"},value:{kind:"Variable",name:{kind:"Name",value:"installedContext"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"installedScope"}},{kind:"Field",name:{kind:"Name",value:"installedVersion"}}]}}]}}]};var r=i(315783);const o={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"installedChatAppsIdsList"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"InstalledAppsOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedChatAppsWithPreCheck"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"installedScope"}},{kind:"Field",name:{kind:"Name",value:"installedVersion"}}]}}]}}]};var l=i(383914);const s=(e,n,i)=>"Personal"===e?{installedScope:e,appId:n}:{installedScope:e,appId:n,conversationId:i},d=(e,n)=>({installedContext:"Personal"===e?{scope:e}:{scope:e,conversationId:n}}),c=e=>({conversationId:e}),m=(e,n,i,a,t)=>{const r=i.newLogger("UpdateAppsCache","components-apps-platform-queries");try{if(!n.installedAppsUpdateEventV2)return;const{installedAppsUpdateEventV2:{installedScope:i,app:o,appId:l,eventType:s,conversationId:d}}=n,c={client:e,installedScope:i,conversationId:d,logger:r,enableAppsQueryOptimization:a};if(t&&"Personal"===i)return void u(i,d,e,r,t);switch(s){case"Added":k(c,o);break;case"Removed":p(c,l);break;case"Synced":u(i,d,e,r,t)}}catch(e){r.error("update apps cache failed")}},u=(e,n,i,a,t)=>{if(n&&("GroupChat"===e||"Team"===e)||!n&&"Personal"===e){if(t&&"Personal"===e)return void(0,r.Ns)(i,a,"Network");let o=[];o=[{scope:e,convId:n}],(0,r.N$)(i,a,o,"Network")}},p=(e,n)=>{const{logger:i,client:t,installedScope:r,conversationId:o}=e;if((0,a.isNull)(n)||"Personal"!==r&&!o)return void i.warn("removeAppFromCache - invalid input",n,r,o);const d=s(r,n,o);try{t.writeQuery({query:l.Z,variables:d,data:{installedApp:null}})}catch(e){throw i.error("removeAppFromCache - failed to update installedApp query",n,r,o),e}const c=N(e);if((0,a.isNull)(c))return void i.warn("removeAppFromCache - no apps in cache",n);const m=(0,a.filter)(c,(e=>null===e||e.id!==n));m.length!==c.length?(i.log("Removing from apps cache "),f(e,m)):i.warn("app to delete already removed from cache")},k=(e,n)=>{const{logger:i,client:t,installedScope:r,conversationId:o}=e;if((0,a.isNull)(n)||"Personal"!==r&&!o)return void i.warn("addAppToCache - invalid input",n,r,o);const{id:d,installedVersion:c,conversationId:m,__typename:u}=n,p=s(r,d,o);try{t.writeQuery({query:l.Z,variables:p,data:{installedApp:n}})}catch(e){throw i.error("addAppToCache - failed to update installedApp query",n,r,o),e}const k=N(e);if((0,a.isNull)(k))return void i.warn("addAppToCache - no apps in cache",n);const g=n.id,h=(0,a.find)(k,(e=>e?.id===g));(0,a.isNil)(h)?(i.log("Adding to apps cache"),f(e,[...k,{id:d,conversationId:m,installedVersion:c,installedScope:r,__typename:u}])):i.warn("app to add already in cache",h)},g=(e,n)=>"GroupChat"===e&&n,N=({client:e,installedScope:n,conversationId:i,logger:a,enableAppsQueryOptimization:r})=>{try{if(g(n,r)){if(i){const n=e.readQuery({query:o,variables:c(i)});return n&&n.installedChatAppsWithPreCheck?n.installedChatAppsWithPreCheck:(a.warn("readQuery for group scope returned no results"),null)}return a.error("invalid convid for cache read"),null}{const r=e.readQuery({query:t,variables:d(n,i)});return r&&r.installedAppsV2?r.installedAppsV2:(a.warn("readQuery returned no results"),null)}}catch(e){throw e}},f=({client:e,installedScope:n,conversationId:i,enableAppsQueryOptimization:a,logger:r},l)=>{try{g(n,a)?i?e.writeQuery({query:o,variables:c(i),data:{installedChatAppsWithPreCheck:l}}):r.error("invalid convid for cache update"):e.writeQuery({query:t,variables:d(n,i),data:{installedAppsV2:l}})}catch(e){throw e}}},905442:(e,n,i)=>{"use strict";var a;i.d(n,{D:()=>a}),function(e){e.None="none",e.ApiSecretServiceAuth="apiSecretServiceAuth",e.MicrosoftEntra="microsoftEntra"}(a||(a={}))},668587:(e,n,i)=>{"use strict";i.d(n,{Li:()=>m,mO:()=>p,lF:()=>k,Vn:()=>g,kH:()=>N,ZT:()=>f,hF:()=>h,F_:()=>v,RL:()=>y,hZ:()=>A,O0:()=>I,Un:()=>D,S:()=>F});var a=i(803238),t=i(380275),r=i(905442),o=i(309501),l=i(469483),s=i(340307);const d="Required",c=["Compose","Commandbox"],m=(e,n,i)=>{if(!n.id)return null;const a=v(n),r=T(n),o=a?u(a):null,[l,s]=(0,t.compose)((0,t.partition)(S),(0,t.map)((n=>b(e,n))),(0,t.filter)((e=>y(e,i))),M)(a);return{appInfo:r,validDomains:n.validDomains||[],type:a?.type,botId:a&&a.botId||"",actionCommands:l,queryCommands:s,authorization:o||void 0,galleryTabs:n.galleryTabs||[]}},u=e=>{if("ApiBased"!==e.type)return null;const{authorization:n}=e;return n&&"microsoftEntra"===n.authType&&n.microsoftEntraConfiguration?{authType:r.D.MicrosoftEntra,microsoftEntraConfiguration:{supportsSingleSignOn:!!n.microsoftEntraConfiguration.supportsSingleSignOn}}:{authType:r.D.None}},p=e=>!(0,a.isEmpty)(e.appInfo.tenantId),k=e=>{const n=(0,t.first)(e.messageExtensions),i=n&&n.botId||"";return`${o.at.BotPrefix}${i}`},g=e=>e&&(0,a.isEmpty)(e.queryCommands)&&(0,a.isArray)(e.actionCommands)&&e.actionCommands.length>=1,N=e=>e&&(0,a.isEmpty)(e.queryCommands)&&(0,a.isArray)(e.actionCommands)&&1===e.actionCommands.length,f=e=>e&&(0,a.isEmpty)(e.queryCommands)&&(0,a.isArray)(e.actionCommands)&&e.actionCommands.length>1,h=e=>e&&(0,a.isArray)(e.queryCommands)&&e.queryCommands.length>1,v=e=>e&&(0,t.first)(e.messageExtensions),T=e=>({accentColor:e.accentColor||"",appId:e.id,appName:e.name||"",appIcon:e.largeImageUrl||"",isFullScreenApp:e.isFullScreenApp||!1,isFullTrustApp:e.isFullTrustApp||!1,tenantId:e.tenantId||"",externalId:e.externalId||"",resource:e.webApplicationInfo?.resource||"",isMicrosoftOwned:e.isMicrosoftOwned||!1}),M=e=>e&&e.commands||[],y=(e,n)=>(0,a.isEmpty)(e.context)?(0,a.includes)(c,n):(0,a.includes)(e.context,n),S=e=>e&&(0,a.isString)(e.type)&&e.type.toLowerCase()==="Action".toLowerCase(),A=e=>{const n=v(e);if(n)return"ApiBased"===n.type?"ApiBased":"BotBased"},I=(e,n)=>(e=>"ApiBased"===e.type)(n)?e?`${o.at.TeamsAppPrefix}${n.appInfo.appId}`:"":`${o.at.BotPrefix}${n.botId}`,b=(e,n)=>({id:n.id,type:n.type||"Query",context:n.context,fetchTask:!!n.fetchTask,description:n.description,initialRun:!!n.initialRun,parameters:n.parameters,title:n.title||"",appKey:n.appKey,taskInfo:D(e,n.taskInfo,n.parameters)}),C=(e,n)=>{const i={};return e&&(i.title=e.title||"",i.height=w(e.height),i.width=w(e.width)||n),i},D=(e,n,i)=>{const a=U(i);if(a){const i=e.stringTranslate("extensibility","inputExtension_task_module_button_title");return a.addSubmitAction("submitButton",i,{id:"submitButton"}),{...C(n,l.Jc.Large),card:a.getCard()}}if(n)return n.url?{...C(n),url:n.url}:{...C(n)}},F=e=>U(e)?.getRawJson()??null,U=e=>{if(!e||(0,a.isEmpty)(e))return null;const n=new s.h;return e.forEach((e=>E(n,e))),n},E=(e,n)=>{if(!n)return;const i=n.title||"",a=n.name||"",t=n.description||"",r=n.value??void 0,o=n.isRequired??!1;switch(n.inputType||"Text"){case"Text":e.addTextInput(a,t,r,200,!1,{label:i,isRequired:o,errorMessage:d});break;case"Textarea":e.addTextInput(a,t,r,1e3,!0,{label:i,isRequired:o,errorMessage:d});break;case"Number":e.addNumberInput(a,t,r,{label:i,isRequired:o,errorMessage:d});break;case"Date":e.addDateInput(a,t,r,{label:i,isRequired:o,errorMessage:d});break;case"Time":e.addTimeInput(a,t,r,{label:i,isRequired:o,errorMessage:d});break;case"Toggle":e.addToggle(a,i,r,{isRequired:o,errorMessage:d});break;case"Choiceset":const l=(n.choices??[]).map((e=>({title:e.title??"",value:e.value??""})));e.addChoiceSet(a,i,!1,!0,l,r,{label:i,isRequired:o,errorMessage:d})}},w=e=>{if(!(0,a.isNil)(e))return L(e)?(0,a.isNil)(e.customValue)?void 0:e.customValue:x(e)?O(e):void 0},L=e=>"DimensionInFloat"===e.__typename,x=e=>"DimensionInString"===e.__typename,O=e=>{if((0,a.isNil)(e.predefinedValue))return;switch(e.predefinedValue.toLowerCase()){case"small":return l.Jc.Small;case"medium":return l.Jc.Medium;case"large":return l.Jc.Large;default:return}}},564087:(e,n,i)=>{"use strict";var a,t,r;i.d(n,{tS:()=>a,$D:()=>t,xB:()=>r}),function(e){e[e.User=0]="User",e[e.Group=1]="Group",e[e.Team=2]="Team",e[e.MsaUser=3]="MsaUser",e[e.MsaGroup=4]="MsaGroup",e[e.Bot=5]="Bot",e[e.Unknown=6]="Unknown",e[e.TFLOffNetwork=7]="TFLOffNetwork",e[e.TFLSMSUnverified=8]="TFLSMSUnverified",e[e.Initials=9]="Initials",e[e.MergedGroup=10]="MergedGroup",e[e.Connector=11]="Connector",e[e.OutgoingWebhook=12]="OutgoingWebhook",e[e.VoiceApp=13]="VoiceApp",e[e.App=14]="App",e[e.Mail=15]="Mail",e[e.Pstn=16]="Pstn",e[e.SharedChannelInviteeTeam=17]="SharedChannelInviteeTeam",e[e.Communities=18]="Communities",e[e.Simple=19]="Simple",e[e.SubCommunity=20]="SubCommunity"}(a||(a={})),function(e){e.Large="HR196x196",e.Medium="HR96x96",e.Small="HR64x64",e.XMedium="HR120x120",e.XSmall="HR32x32"}(t||(t={})),function(e){e.Icon="icon",e.Url="url",e.Name="name",e.Label="label"}(r||(r={}))},467192:(e,n,i)=>{"use strict";i.d(n,{HA:()=>u,oG:()=>N,B4:()=>h,sB:()=>T,WJ:()=>M,AZ:()=>y,Gt:()=>S,NO:()=>A,sq:()=>I,LA:()=>C,vn:()=>D});var a=i(564087),t=i(683184),r=i(811957),o=i(309501),l=i(327557),s=i(439697),d=i(602129),c=i(443089),m=i(628918);const u=(e,n,i,t,o,l,d,c,m,u)=>{let k=a.tS.Unknown;const N=F(m,e,u);return c&&i?k=a.tS.SharedChannelInviteeTeam:!t&&i?k=a.tS.Team:l?k=a.tS.App:d?k=a.tS.Mail:o?k=a.tS.MergedGroup:N||e&&(0,r.y)(e)||(0,r.Cq)(e)?k=a.tS.Initials:v(e)?k=a.tS.Connector:e&&(0,r.YQ)(e)?k=a.tS.OutgoingWebhook:h(e)?k=a.tS.VoiceApp:f(e)?k=a.tS.Bot:s.eo.isTFLOffNetworkUser(e)?k=a.tS.TFLOffNetwork:s.eo.isTFLSmsUnVerifiedMri(e)?k=a.tS.TFLSMSUnverified:e&&(0,r.EG)(e)?k=a.tS.Pstn:t?k=p(k,e,n,i):t||(k=g(k,e,m)),k},p=(e,n,i,t)=>(n?e=a.tS.MsaUser:i?e=a.tS.MsaGroup:t&&(e=a.tS.Communities),e),k=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,g=(e,n,i)=>{const t=((0,r.lp)(n)||n&&k.test(n.toLowerCase()))&&!Array.isArray(i),o=!(0,r.lp)(n)&&Array.isArray(i);return t||o?e=n?a.tS.User:a.tS.Group:e},N=e=>{const n=e?.type?.toUpperCase(),i=e?.id;return n===d.t.botType||f(i)},f=e=>!!e&&e.startsWith(o.at.BotPrefix),h=e=>!!e&&(0,r.B4)(e,o.f0),v=e=>!!e&&e.startsWith(o.kR),T=(e,n)=>!!e&&(e===n.audienceBotId||e===n.largeGridBotId),M=(e,n,i)=>{if(n)return i?l.Rq:l.WW;switch(e){case a.tS.Mail:return l.SX;case a.tS.App:case a.tS.Connector:case a.tS.Bot:case a.tS.OutgoingWebhook:return l.zD;case a.tS.User:case a.tS.MsaUser:case a.tS.Initials:case a.tS.Unknown:return l.zw;case a.tS.Group:case a.tS.MsaGroup:case a.tS.MergedGroup:case a.tS.Team:case a.tS.Communities:case a.tS.SubCommunity:return l.dA;case a.tS.TFLOffNetwork:case a.tS.TFLSMSUnverified:return l.uj;case a.tS.VoiceApp:return l.dH;case a.tS.Pstn:return l.Az;default:return l.zw}},y=e=>-1!==e?.indexOf("profilePictureV2ForSharedChannel"),S=(e,n,i)=>!(!e||e&&(0,c.zP)(n))&&(void 0===i||i),A=(e,n)=>e?m.cU:n?m.YP:m.W9,I=(e,n,i)=>e&&n?.id===e.id&&i===e.id&&"avatar"===e.updateType?e.updatedTime:void 0,b=new Map([["smallest",20],["smaller",24],["small",28],["medium",32],["medium-large",36],["large",48],["larger",64],["largest",96]]),C=e=>e&&b.get(e)||32,D=(e,n,i)=>{if(i&&e)try{const i=new URL(e);if("https:"!==i.protocol)return e;const t=i.searchParams.get("size"),r=n||a.$D.Small;return null!==t&&t!==r?e.replace(`size=${t}`,`size=${r}`):e}catch(n){return e}return e},F=(e,n,i)=>{const a=i?.get(t.J.People).enableInitialsImageForPstn,r=i?.get(t.J.Messaging).enablePaidSmsChat,o=!!e?.isInitialsImage,l=!!a&&!!r&&!!n&&s.eo.isValidNameForInitialsAvatarForPstnUser(n,e?.displayName);return o||l}},327557:(e,n,i)=>{"use strict";i.d(n,{zw:()=>a,dA:()=>t,P7:()=>r,Az:()=>o,dH:()=>l,SX:()=>s,WW:()=>d,Rq:()=>c,uj:()=>m,zD:()=>u,ap:()=>p,Uw:()=>k,Md:()=>g});const a="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iLTYgLTYgMzIgMzIiPjxyZWN0IGZpbGw9IiM5NDk0OTQiIHg9Ii02IiB5PSItNiIgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSI+PC9yZWN0PjxwYXRoIGZpbGw9IiNmZmYiIGQ9Ik0xMCAyQzcuNzkwODYgMiA2IDMuNzkwODYgNiA2QzYgOC4yMDkxNCA3Ljc5MDg2IDEwIDEwIDEwQzEyLjIwOTEgMTAgMTQgOC4yMDkxNCAxNCA2QzE0IDMuNzkwODYgMTIuMjA5MSAyIDEwIDJaTTcgNkM3IDQuMzQzMTUgOC4zNDMxNSAzIDEwIDNDMTEuNjU2OSAzIDEzIDQuMzQzMTUgMTMgNkMxMyA3LjY1Njg1IDExLjY1NjkgOSAxMCA5QzguMzQzMTUgOSA3IDcuNjU2ODUgNyA2Wk01LjAwODczIDExQzMuOTAzMTUgMTEgMyAxMS44ODY5IDMgMTNDMyAxNC42OTEyIDMuODMyODEgMTUuOTY2MyA1LjEzNDk5IDE2Ljc5NjZDNi40MTY5NyAxNy42MTQgOC4xNDUyNiAxOCAxMCAxOEMxMS44NTQ3IDE4IDEzLjU4MyAxNy42MTQgMTQuODY1IDE2Ljc5NjZDMTYuMTY3MiAxNS45NjYzIDE3IDE0LjY5MTIgMTcgMTNDMTcgMTEuODk1NiAxNi4xMDQ1IDExIDE1IDExTDUuMDA4NzMgMTFaTTQgMTNDNCAxMi40NDY3IDQuNDQ3ODYgMTIgNS4wMDg3MyAxMkwxNSAxMkMxNS41NTIyIDEyIDE2IDEyLjQ0NzggMTYgMTNDMTYgMTQuMzA4OCAxNS4zNzc3IDE1LjI4MzcgMTQuMzI3NCAxNS45NTM0QzEzLjI1NjggMTYuNjM2IDExLjczNTEgMTcgMTAgMTdDOC4yNjQ4OSAxNyA2Ljc0MzE4IDE2LjYzNiA1LjY3MjYyIDE1Ljk1MzRDNC42MjIyNiAxNS4yODM3IDQgMTQuMzA4OCA0IDEzWiIvPjwvc3ZnPg==",t="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iLTYgLTYgMzIgMzIiPjxyZWN0IGZpbGw9IiM5NDk0OTQiIHg9Ii02IiB5PSItNiIgaGVpZ2h0PSIxMDAlIiB3aWR0aD0iMTAwJSIvPjxwYXRoIGZpbGw9IiNmZmYiIGQ9Ik0xMi40NzQ3IDguMDE0MzFDMTIuOTg3NiA4LjAxNDMxIDEzLjQxMDIgOC40MDAzNSAxMy40NjggOC44OTc2OUwxMy40NzQ3IDkuMDE0MzFWMTMuMzgxN0MxMy40NzQ3IDE1LjMwNiAxMS45MTQ4IDE2Ljg2NiA5Ljk5MDQ0IDE2Ljg2NkM4LjEzMDI3IDE2Ljg2NiA2LjYxMDU2IDE1LjQwODMgNi41MTEzMSAxMy41NzI4TDYuNTA2MTYgMTMuMzgxN1Y5LjAxNDMxQzYuNTA2MTYgOC41MDE0OCA2Ljg5MjIgOC4wNzg4IDcuMzg5NTQgOC4wMjEwNEw3LjUwNjE2IDguMDE0MzFIMTIuNDc0N1pNMTIuNDc0NyA5LjAxNDMxSDcuNTA2MTZWMTMuMzgxN0M3LjUwNjE2IDE0Ljc1MzcgOC42MTg0MSAxNS44NjYgOS45OTA0NCAxNS44NjZDMTEuMzA3NiAxNS44NjYgMTIuMzg1MyAxNC44NDA5IDEyLjQ2OTQgMTMuNTQ1TDEyLjQ3NDcgMTMuMzgxN1Y5LjAxNDMxWk01Ljc3NDA3IDguMDEzNzJDNS42MzIwOCA4LjI1ODk3IDUuNTQwNjkgOC41MzcxOCA1LjUxNDE3IDguODM0MDZMNS41MDYxNiA5LjAxNDMxSDMuMDE2ODVWMTIuNzUzNEMzLjAxNjg1IDEzLjc3ODYgMy44NDc5MyAxNC42MDk3IDQuODczMTIgMTQuNjA5N0M1LjE0NDMzIDE0LjYwOTcgNS40MDE5NiAxNC41NTE1IDUuNjM0MjEgMTQuNDQ3QzUuNzEzNDcgMTQuNzc1NiA1LjgzMDA1IDE1LjA5MDcgNS45Nzg1IDE1LjM4NzFDNS42Mzg4NyAxNS41MzA3IDUuMjY1MjIgMTUuNjA5NyA0Ljg3MzEyIDE1LjYwOTdDMy4zNTE5OCAxNS42MDk3IDIuMTA4NTcgMTQuNDIwNiAyLjAyMTY5IDEyLjkyMTJMMi4wMTY4NSAxMi43NTM0VjkuMDE0MzFDMi4wMTY4NSA4LjUwMTQ4IDIuNDAyODkgOC4wNzg4IDIuOTAwMjIgOC4wMjEwNEwzLjAxNjg1IDguMDE0MzFMNS43NzQwNyA4LjAxMzcyWk0xNC4yMDY4IDguMDEzNzJMMTYuOTkxMiA4LjAxNDMxQzE3LjUwNCA4LjAxNDMxIDE3LjkyNjcgOC40MDAzNSAxNy45ODQ0IDguODk3NjlMMTcuOTkxMiA5LjAxNDMxVjEyLjc1NDJDMTcuOTkxMiAxNC4zMzEyIDE2LjcxMjcgMTUuNjA5NyAxNS4xMzU3IDE1LjYwOTdDMTQuNzM0OCAxNS42MDk3IDE0LjM1MzIgMTUuNTI3MSAxNC4wMDY5IDE1LjM3NzlDMTQuMTU1MSAxNS4wODAzIDE0LjI3MDkgMTQuNzY0OCAxNC4zNTAzIDE0LjQzNTFDMTQuNTg4NyAxNC41NDczIDE0Ljg1NDkgMTQuNjA5NyAxNS4xMzU3IDE0LjYwOTdDMTYuMTExNiAxNC42MDk3IDE2LjkxMTYgMTMuODU2MiAxNi45ODU2IDEyLjg5OTJMMTYuOTkxMiAxMi43NTQyVjkuMDE0MzFIMTQuNDc0N0wxNC40NjkyIDguODY1MDVDMTQuNDQ2NSA4LjU1NjU0IDE0LjM1MzcgOC4yNjc0OSAxNC4yMDY4IDguMDEzNzJaTTkuOTg4NTcgMi45ODkyNkMxMS4yMTg3IDIuOTg5MjYgMTIuMjE1OSAzLjk4NjQ4IDEyLjIxNTkgNS4yMTY2MkMxMi4yMTU5IDYuNDQ2NzYgMTEuMjE4NyA3LjQ0Mzk4IDkuOTg4NTcgNy40NDM5OEM4Ljc1ODQzIDcuNDQzOTggNy43NjEyMSA2LjQ0Njc2IDcuNzYxMjEgNS4yMTY2MkM3Ljc2MTIxIDMuOTg2NDggOC43NTg0MyAyLjk4OTI2IDkuOTg4NTcgMi45ODkyNlpNMTQuOTc1NyAzLjYxNzM5QzE2LjAzMjQgMy42MTczOSAxNi44ODkgNC40NzQgMTYuODg5IDUuNTMwNjlDMTYuODg5IDYuNTg3MzcgMTYuMDMyNCA3LjQ0Mzk4IDE0Ljk3NTcgNy40NDM5OEMxMy45MTkxIDcuNDQzOTggMTMuMDYyNCA2LjU4NzM3IDEzLjA2MjQgNS41MzA2OUMxMy4wNjI0IDQuNDc0IDEzLjkxOTEgMy42MTczOSAxNC45NzU3IDMuNjE3MzlaTTUuMDE3MTcgMy42MTczOUM2LjA3Mzg2IDMuNjE3MzkgNi45MzA0NyA0LjQ3NCA2LjkzMDQ3IDUuNTMwNjlDNi45MzA0NyA2LjU4NzM3IDYuMDczODYgNy40NDM5OCA1LjAxNzE3IDcuNDQzOThDMy45NjA0OSA3LjQ0Mzk4IDMuMTAzODggNi41ODczNyAzLjEwMzg4IDUuNTMwNjlDMy4xMDM4OCA0LjQ3NCAzLjk2MDQ5IDMuNjE3MzkgNS4wMTcxNyAzLjYxNzM5Wk05Ljk4ODU3IDMuOTg5MjZDOS4zMTA3MiAzLjk4OTI2IDguNzYxMjEgNC41Mzg3NyA4Ljc2MTIxIDUuMjE2NjJDOC43NjEyMSA1Ljg5NDQ3IDkuMzEwNzIgNi40NDM5OCA5Ljk4ODU3IDYuNDQzOThDMTAuNjY2NCA2LjQ0Mzk4IDExLjIxNTkgNS44OTQ0NyAxMS4yMTU5IDUuMjE2NjJDMTEuMjE1OSA0LjUzODc3IDEwLjY2NjQgMy45ODkyNiA5Ljk4ODU3IDMuOTg5MjZaTTE0Ljk3NTcgNC42MTczOUMxNC40NzEzIDQuNjE3MzkgMTQuMDYyNCA1LjAyNjI5IDE0LjA2MjQgNS41MzA2OUMxNC4wNjI0IDYuMDM1MDkgMTQuNDcxMyA2LjQ0Mzk4IDE0Ljk3NTcgNi40NDM5OEMxNS40ODAxIDYuNDQzOTggMTUuODg5IDYuMDM1MDkgMTUuODg5IDUuNTMwNjlDMTUuODg5IDUuMDI2MjkgMTUuNDgwMSA0LjYxNzM5IDE0Ljk3NTcgNC42MTczOVpNNS4wMTcxNyA0LjYxNzM5QzQuNTEyNzcgNC42MTczOSA0LjEwMzg4IDUuMDI2MjkgNC4xMDM4OCA1LjUzMDY5QzQuMTAzODggNi4wMzUwOSA0LjUxMjc3IDYuNDQzOTggNS4wMTcxNyA2LjQ0Mzk4QzUuNTIxNTcgNi40NDM5OCA1LjkzMDQ3IDYuMDM1MDkgNS45MzA0NyA1LjUzMDY5QzUuOTMwNDcgNS4wMjYyOSA1LjUyMTU3IDQuNjE3MzkgNS4wMTcxNyA0LjYxNzM5WiIvPjwvc3ZnPg==",r="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgZmlsbD0ibm9uZSI+PHBhdGggZmlsbD0iI0U4RUJGQSIgZD0iTTAgMzJWMGgzMnYzMkgwWiIvPjxwYXRoIGZpbGw9IiM0RjUyQjIiIGQ9Ik0xNS41IDEyLjUwMmEuNS41IDAgMSAxIDEgMHYxLjAwMmEuNS41IDAgMCAxLTEgMHYtMS4wMDJabTMuMzUuOTQxYS41LjUgMCAwIDAtLjcwNyAwbC0uNzA4LjcwOWEuNS41IDAgMCAwIC43MDcuNzA3bC43MDktLjcwOWEuNS41IDAgMCAwIDAtLjcwN1ptLTQuOTk4IDBhLjUuNSAwIDAgMC0uNzA3LjcwN2wuNzA4LjcwOWEuNS41IDAgMSAwIC43MDctLjcwN2wtLjcwOC0uNzA5Wk0xNiA4YzMuMzE0IDAgNiAyLjU5NyA2IDUuOCAwIDEuNjc3LS43NDUgMy4yMTYtMi4yMDQgNC41OTRhLjU5OS41OTkgMCAwIDAtLjE0NS4yMTNsLS4wMjYuMDgxLS45MzYgMy45MTdjLS4xODQuNzcxLS44NjUgMS4zMy0xLjY3IDEuMzlsLS4xNDQuMDA1aC0xLjc1Yy0uODE5IDAtMS41MzUtLjUxNi0xLjc3Ni0xLjI2MmwtLjAzOC0uMTMzLS45MzUtMy45MTZhLjU5Ni41OTYgMCAwIDAtLjE3LS4yOTVjLTEuMzktMS4zMTItMi4xMzMtMi43Ny0yLjItNC4zNTVMMTAgMTMuOGwuMDAzLS4xOTFDMTAuMTA4IDEwLjQ5NCAxMi43NTMgOCAxNiA4Wm0tMi4wNDUgMTMgLjMxOSAxLjMzNC4wMjYuMDk2Yy4wOTcuMy4zNzYuNTIyLjcxMi41NjNsLjExNC4wMDdoMS43MTJsLjEwNi0uMDAzYS44NTYuODU2IDAgMCAwIC43NDEtLjUyNWwuMDMyLS4xLjMyOC0xLjM3MmgtNC4wOVpNMTYgOWMtMi42MzIgMC00Ljc4OCAxLjk1My00Ljk4NSA0LjQxNGwtLjAxMi4yMTItLjAwMy4xNTMuMDA0LjIxN2MuMDU2IDEuMzA0LjY3NCAyLjUyNSAxLjg4OCAzLjY3MS4xODguMTc4LjMzLjM5OC40MTQuNjRsLjA0My4xNS4zNjcgMS41NDNIMTUuNXYtNC41MDNhLjUuNSAwIDEgMSAxIDBWMjBoMS43ODVsLjM4Ny0xLjYxNS4wNTEtLjE1Yy4wODYtLjIxNS4yMTgtLjQwOS4zODYtLjU2OEMyMC4zODIgMTYuNDY1IDIxIDE1LjE4IDIxIDEzLjhjMC0yLjY0My0yLjIzMS00LjgtNS00LjhaIi8+PC9zdmc+",o="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iLTYgLTYgMzIgMzIiPjxyZWN0IGZpbGw9Im1lZGl1bXR1cnF1b2lzZSIgeD0iLTYiIHk9Ii02IiB3aWR0aD0iMzIiIGhlaWdodD0iMzIiPjwvcmVjdD48cGF0aCBmaWxsPSIjZmZmIiBkPSJNMTAgMkM3Ljc5MDg2IDIgNiAzLjc5MDg2IDYgNkM2IDguMjA5MTQgNy43OTA4NiAxMCAxMCAxMEMxMi4yMDkxIDEwIDE0IDguMjA5MTQgMTQgNkMxNCAzLjc5MDg2IDEyLjIwOTEgMiAxMCAyWk03IDZDNyA0LjM0MzE1IDguMzQzMTUgMyAxMCAzQzExLjY1NjkgMyAxMyA0LjM0MzE1IDEzIDZDMTMgNy42NTY4NSAxMS42NTY5IDkgMTAgOUM4LjM0MzE1IDkgNyA3LjY1Njg1IDcgNlpNNS4wMDg3MyAxMUMzLjkwMzE1IDExIDMgMTEuODg2OSAzIDEzQzMgMTQuNjkxMiAzLjgzMjgxIDE1Ljk2NjMgNS4xMzQ5OSAxNi43OTY2QzYuNDE2OTcgMTcuNjE0IDguMTQ1MjYgMTggMTAgMThDMTEuODU0NyAxOCAxMy41ODMgMTcuNjE0IDE0Ljg2NSAxNi43OTY2QzE2LjE2NzIgMTUuOTY2MyAxNyAxNC42OTEyIDE3IDEzQzE3IDExLjg5NTYgMTYuMTA0NSAxMSAxNSAxMUw1LjAwODczIDExWk00IDEzQzQgMTIuNDQ2NyA0LjQ0Nzg2IDEyIDUuMDA4NzMgMTJMMTUgMTJDMTUuNTUyMiAxMiAxNiAxMi40NDc4IDE2IDEzQzE2IDE0LjMwODggMTUuMzc3NyAxNS4yODM3IDE0LjMyNzQgMTUuOTUzNEMxMy4yNTY4IDE2LjYzNiAxMS43MzUxIDE3IDEwIDE3QzguMjY0ODkgMTcgNi43NDMxOCAxNi42MzYgNS42NzI2MiAxNS45NTM0QzQuNjIyMjYgMTUuMjgzNyA0IDE0LjMwODggNCAxM1oiLz48L3N2Zz4=",l="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiBmaWxsPSIjMjkzODRGIi8+CjxwYXRoIGQ9Ik0xMS45OTAyIDMuMjVDMTIuNTgyNyAzLjI1IDEzLjE0OTEgMy4zMjgxMiAxMy42ODk1IDMuNDg0MzhDMTQuMjI5OCAzLjYzNDExIDE0LjczMTEgMy44NDU3IDE1LjE5MzQgNC4xMTkxNEMxNS42NTU2IDQuMzkyNTggMTYuMDcyMyA0LjcyNDYxIDE2LjQ0MzQgNS4xMTUyM0MxNi44MjEgNS41MDU4NiAxNy4xNDMyIDUuOTM1NTUgMTcuNDEwMiA2LjQwNDNDMTcuNjc3MSA2Ljg3MzA1IDE3Ljg4MjIgNy4zODA4NiAxOC4wMjU0IDcuOTI3NzNDMTguMTY4NiA4LjQ2ODEgMTguMjQwMiA5LjAzMTI1IDE4LjI0MDIgOS42MTcxOUMxOC40MjkgOS42ODIyOSAxOC41OTgzIDkuNzczNDQgMTguNzQ4IDkuODkwNjJDMTguOTA0MyAxMC4wMDc4IDE5LjAzNDUgMTAuMTQ0NSAxOS4xMzg3IDEwLjMwMDhDMTkuMjQ5MyAxMC40NTA1IDE5LjMzNCAxMC42MTk4IDE5LjM5MjYgMTAuODA4NkMxOS40NTc3IDEwLjk5MDkgMTkuNDkwMiAxMS4xNzk3IDE5LjQ5MDIgMTEuMzc1VjEzLjg3NUMxOS40OTAyIDE0LjEyODkgMTkuNDQxNCAxNC4zNjk4IDE5LjM0MzggMTQuNTk3N0MxOS4yNDYxIDE0LjgyNTUgMTkuMTA5NCAxNS4wMjczIDE4LjkzMzYgMTUuMjAzMUMxOC43NjQzIDE1LjM3MjQgMTguNTY1OCAxNS41MDU5IDE4LjMzNzkgMTUuNjAzNUMxOC4xMSAxNS43MDEyIDE3Ljg2OTEgMTUuNzUgMTcuNjE1MiAxNS43NUgxNi4zNjUyQzE2LjE5NiAxNS43NSAxNi4wNDk1IDE1LjY4ODIgMTUuOTI1OCAxNS41NjQ1QzE1LjgwMjEgMTUuNDQwOCAxNS43NDAyIDE1LjI5NDMgMTUuNzQwMiAxNS4xMjVWMTAuMTI1QzE1Ljc0MDIgOS45NDkyMiAxNS43ODI2IDkuODE5MDEgMTUuODY3MiA5LjczNDM4QzE1Ljk1MTggOS42NDMyMyAxNi4wNTYgOS41ODEzOCAxNi4xNzk3IDkuNTQ4ODNDMTYuMzAzNCA5LjUwOTc3IDE2LjQzNjggOS40OTM0OSAxNi41ODAxIDkuNUMxNi43Mjk4IDkuNSAxNi44NjY1IDkuNSAxNi45OTAyIDkuNUMxNi45OTAyIDguODA5OSAxNi44NTY4IDguMTYyMTEgMTYuNTg5OCA3LjU1NjY0QzE2LjMyOTQgNi45NTExNyAxNS45NzE0IDYuNDIzODMgMTUuNTE1NiA1Ljk3NDYxQzE1LjA2NjQgNS41MTg4OCAxNC41MzkxIDUuMTYwODEgMTMuOTMzNiA0LjkwMDM5QzEzLjMyODEgNC42MzM0NiAxMi42ODAzIDQuNSAxMS45OTAyIDQuNUMxMS4zMDAxIDQuNSAxMC42NTIzIDQuNjMzNDYgMTAuMDQ2OSA0LjkwMDM5QzkuNDQxNDEgNS4xNjA4MSA4LjkxMDgxIDUuNTE4ODggOC40NTUwOCA1Ljk3NDYxQzguMDA1ODYgNi40MjM4MyA3LjY0Nzc5IDYuOTUxMTcgNy4zODA4NiA3LjU1NjY0QzcuMTIwNDQgOC4xNjIxMSA2Ljk5MDIzIDguODA5OSA2Ljk5MDIzIDkuNUg3LjI3MzQ0QzcuMzg0MTEgOS41IDcuNDk4MDUgOS41MDY1MSA3LjYxNTIzIDkuNTE5NTNDNy43MzI0MiA5LjUyNjA0IDcuODM2NTkgOS41NTIwOCA3LjkyNzczIDkuNTk3NjZDOC4wMTg4OCA5LjYzNjcyIDguMDkzNzUgOS42OTg1NyA4LjE1MjM0IDkuNzgzMkM4LjIxMDk0IDkuODY3ODQgOC4yNDAyMyA5Ljk4MTc3IDguMjQwMjMgMTAuMTI1VjE1LjEyNUM4LjI0MDIzIDE1LjMwMDggOC4xOTc5MiAxNS40MzQyIDguMTEzMjggMTUuNTI1NEM4LjAyODY1IDE1LjYxIDcuOTI0NDggMTUuNjcxOSA3LjgwMDc4IDE1LjcxMDlDNy42NzcwOCAxNS43NDM1IDcuNTQwMzYgMTUuNzU5OCA3LjM5MDYyIDE1Ljc1OThDNy4yNDc0IDE1Ljc1MzMgNy4xMTM5MyAxNS43NSA2Ljk5MDIzIDE1Ljc1VjE3Ljk3NjZDNi45OTAyMyAxOC4xMzI4IDcuMDM5MDYgMTguMjYzIDcuMTM2NzIgMTguMzY3MkM3LjI0MDg5IDE4LjQ2NDggNy4zNzEwOSAxOC41NDYyIDcuNTI3MzQgMTguNjExM0M3LjY5MDEgMTguNjc2NCA3Ljg2OTE0IDE4LjcyNTMgOC4wNjQ0NSAxOC43NTc4QzguMjU5NzcgMTguNzkwNCA4LjQ1NTA4IDE4LjgxNjQgOC42NTAzOSAxOC44MzU5QzguODQ1NyAxOC44NDkgOS4wMjc5OSAxOC44NTg3IDkuMTk3MjcgMTguODY1MkM5LjM2NjU0IDE4Ljg2NTIgOS41MDMyNiAxOC44NjUyIDkuNjA3NDIgMTguODY1MkM5LjY3OTA0IDE4LjY4MjkgOS43NzM0NCAxOC41MTY5IDkuODkwNjIgMTguMzY3MkMxMC4wMDc4IDE4LjIxNzQgMTAuMTQxMyAxOC4wODcyIDEwLjI5MSAxNy45NzY2QzEwLjQ0NzMgMTcuODY1OSAxMC42MTY1IDE3Ljc4MTIgMTAuNzk4OCAxNy43MjI3QzEwLjk4MTEgMTcuNjU3NiAxMS4xNjk5IDE3LjYyNSAxMS4zNjUyIDE3LjYyNUgxMS45OTAyQzEyLjI0NDEgMTcuNjI1IDEyLjQ4NSAxNy42NzM4IDEyLjcxMjkgMTcuNzcxNUMxMi45NDA4IDE3Ljg2OTEgMTMuMTM5MyAxOC4wMDU5IDEzLjMwODYgMTguMTgxNkMxMy40ODQ0IDE4LjM1MDkgMTMuNjIxMSAxOC41NDk1IDEzLjcxODggMTguNzc3M0MxMy44MTY0IDE5LjAwNTIgMTMuODY1MiAxOS4yNDYxIDEzLjg2NTIgMTkuNUMxMy44NjUyIDE5Ljc1MzkgMTMuODE2NCAxOS45OTQ4IDEzLjcxODggMjAuMjIyN0MxMy42MjExIDIwLjQ1MDUgMTMuNDg0NCAyMC42NTIzIDEzLjMwODYgMjAuODI4MUMxMy4xMzkzIDIwLjk5NzQgMTIuOTQwOCAyMS4xMzA5IDEyLjcxMjkgMjEuMjI4NUMxMi40ODUgMjEuMzI2MiAxMi4yNDQxIDIxLjM3NSAxMS45OTAyIDIxLjM3NUgxMS4zNjUyQzEwLjk2MTYgMjEuMzc1IDEwLjYwMDMgMjEuMjYxMSAxMC4yODEyIDIxLjAzMzJDOS45NjIyNCAyMC43OTg4IDkuNzM0MzggMjAuNDkyOCA5LjU5NzY2IDIwLjExNTJDOS4zNTAyNiAyMC4xMDg3IDkuMDgwMDggMjAuMDk5IDguNzg3MTEgMjAuMDg1OUM4LjUwMDY1IDIwLjA3MjkgOC4yMTQxOSAyMC4wNDY5IDcuOTI3NzMgMjAuMDA3OEM3LjY0MTI4IDE5Ljk2MjIgNy4zNjQ1OCAxOS44OTcxIDcuMDk3NjYgMTkuODEyNUM2LjgzNzI0IDE5LjcyMTQgNi42MDYxMiAxOS41OTc3IDYuNDA0MyAxOS40NDE0QzYuMjAyNDcgMTkuMjc4NiA2LjAzOTcxIDE5LjA4MDEgNS45MTYwMiAxOC44NDU3QzUuNzk4ODMgMTguNjA0OCA1Ljc0MDIzIDE4LjMxNTEgNS43NDAyMyAxNy45NzY2VjE1LjYzMjhDNS41NTc5NCAxNS41Njc3IDUuMzg4NjcgMTUuNDc2NiA1LjIzMjQyIDE1LjM1OTRDNS4wNzYxNyAxNS4yNDIyIDQuOTQyNzEgMTUuMTA4NyA0LjgzMjAzIDE0Ljk1OUM0LjcyNzg2IDE0LjgwMjcgNC42NDMyMyAxNC42MzM1IDQuNTc4MTIgMTQuNDUxMkM0LjUxOTUzIDE0LjI2MjQgNC40OTAyMyAxNC4wNzAzIDQuNDkwMjMgMTMuODc1VjExLjM3NUM0LjQ5MDIzIDExLjE3OTcgNC41MTk1MyAxMC45OTA5IDQuNTc4MTIgMTAuODA4NkM0LjY0MzIzIDEwLjYxOTggNC43Mjc4NiAxMC40NTA1IDQuODMyMDMgMTAuMzAwOEM0Ljk0MjcxIDEwLjE0NDUgNS4wNzYxNyAxMC4wMDc4IDUuMjMyNDIgOS44OTA2MkM1LjM4ODY3IDkuNzczNDQgNS41NTc5NCA5LjY4MjI5IDUuNzQwMjMgOS42MTcxOUM1Ljc0MDIzIDkuMDMxMjUgNS44MTE4NSA4LjQ2ODEgNS45NTUwOCA3LjkyNzczQzYuMDk4MzEgNy4zODA4NiA2LjMwMzM5IDYuODczMDUgNi41NzAzMSA2LjQwNDNDNi44MzcyNCA1LjkzNTU1IDcuMTU2MjUgNS41MDU4NiA3LjUyNzM0IDUuMTE1MjNDNy45MDQ5NSA0LjcyNDYxIDguMzI0ODcgNC4zOTI1OCA4Ljc4NzExIDQuMTE5MTRDOS4yNDkzNSAzLjg0NTcgOS43NTA2NSAzLjYzNDExIDEwLjI5MSAzLjQ4NDM4QzEwLjgzMTQgMy4zMjgxMiAxMS4zOTc4IDMuMjUgMTEuOTkwMiAzLjI1Wk0xMS4zNjUyIDE4Ljg3NUMxMS4xOTYgMTguODc1IDExLjA0OTUgMTguOTM2OCAxMC45MjU4IDE5LjA2MDVDMTAuODAyMSAxOS4xODQyIDEwLjc0MDIgMTkuMzMwNyAxMC43NDAyIDE5LjVDMTAuNzQwMiAxOS42NjkzIDEwLjgwMjEgMTkuODE1OCAxMC45MjU4IDE5LjkzOTVDMTEuMDQ5NSAyMC4wNjMyIDExLjE5NiAyMC4xMjUgMTEuMzY1MiAyMC4xMjVIMTEuOTkwMkMxMi4xNTk1IDIwLjEyNSAxMi4zMDYgMjAuMDYzMiAxMi40Mjk3IDE5LjkzOTVDMTIuNTUzNCAxOS44MTU4IDEyLjYxNTIgMTkuNjY5MyAxMi42MTUyIDE5LjVDMTIuNjE1MiAxOS4zMzA3IDEyLjU1MzQgMTkuMTg0MiAxMi40Mjk3IDE5LjA2MDVDMTIuMzA2IDE4LjkzNjggMTIuMTU5NSAxOC44NzUgMTEuOTkwMiAxOC44NzVIMTEuMzY1MlpNNi4zNjUyMyAxMC43NUM2LjE5NTk2IDEwLjc1IDYuMDQ5NDggMTAuODExOCA1LjkyNTc4IDEwLjkzNTVDNS44MDIwOCAxMS4wNTkyIDUuNzQwMjMgMTEuMjA1NyA1Ljc0MDIzIDExLjM3NVYxMy44NzVDNS43NDAyMyAxNC4wNDQzIDUuODAyMDggMTQuMTkwOCA1LjkyNTc4IDE0LjMxNDVDNi4wNDk0OCAxNC40MzgyIDYuMTk1OTYgMTQuNSA2LjM2NTIzIDE0LjVINi45OTAyM1YxMC43NUg2LjM2NTIzWk0xNi45OTAyIDEwLjc1VjE0LjVIMTcuNjE1MkMxNy43ODQ1IDE0LjUgMTcuOTMxIDE0LjQzODIgMTguMDU0NyAxNC4zMTQ1QzE4LjE3ODQgMTQuMTkwOCAxOC4yNDAyIDE0LjA0NDMgMTguMjQwMiAxMy44NzVWMTEuMzc1QzE4LjI0MDIgMTEuMjA1NyAxOC4xNzg0IDExLjA1OTIgMTguMDU0NyAxMC45MzU1QzE3LjkzMSAxMC44MTE4IDE3Ljc4NDUgMTAuNzUgMTcuNjE1MiAxMC43NUgxNi45OTAyWiIgZmlsbD0id2hpdGUiLz4KPC9zdmc+Cg==",s="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAACxKAAAsSgF3enRNAAAEuElEQVR42u2cwUsjVxzHv9tVKZs9uJTEg5cY0JaNI97W4DFpb41eWjbrYVkQ/4bSRSjI9r50T9arG+iyVNNrAr1I0ps467JViLmkkJHSHHakNND2sEzIrskaWzVvZj6fk5igM/M+83vv++a9ufbF3R//EYSWD7gECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAg2bIpIPJpOPKpONKTIwG8mJXj5oqlmoqlmrGHNM1E14WHYkMa/XhfGAbvpsIa4925LotugBJoWp8SUpMjGr14TxjAK/sh6nxOyXIpOMIkLozHtoBGAJI2szvy7aPQ9f4tn2s9e93GQR6WFZUK8uzGotFAt3wDcfV0/xLlSt1UkA3FrKTWsxOKRIZDlzjb+b3VSzVjBj9GyuAFwuXckkj+sgLK/cbu2o4rnHHNnABLCvacwxgWVEt5ZK+TQlnlfv3nftVcT05ffebQR7Ak8ef6datD/Xq19/Vav391meOc6JiqaY/mn/qk48/0sjIdV+V+/WNXVWPml0r3IP7M3pwf0bPnr8a6HEaMRWcSceVmhvXVuFA24XDU58XSzWVK3UtZqe0kJ30dbk3bYxjzLOAzn5/fWP3VGl03VZ7ELWyPCvLivqu3JuYcoZMu4PGYhGtfj3f805qOK7Wvt1Ram5c93K3B35BXbfVs3J552OisMYK0HnHfPf4057RqVypq1ypD7Sklit1Pc2/7FruI5FhZdJxLeWSRndZQzKcpVxSi9mptgjvsl04VKXymxayk1cWG6tHzffOYHoN74e5DOMF8O6mleVZpe6Ma+ung1MXvuG4Wt/YVfmX+qXGxrPKvWVFtfj5lLHl3rcCdF5gy4qqWKppM79/qluw7WN9Zf98Kd1Cr//57gDWbwzJh5wVG7cLhyqWahcSG237WJv5/a553sRYFwoBzhMby5U33cJ5y7JfY11oBOg3NlaPmueKjf3Eunu520rNBWMdw5ACQj+xcc92lEnHe5bs7cKhtgoHPft5P8S60ArQT2x03VY7NnbexcVSTduFw57Tt5l0XAvZyUCuVRj408Af8ouX9rdt+7hrbOws515/343ExOh/Gj+chy9zW1SAQcXGXg0ftPUIoRWg39gYpFiHAH3ERm+eoBNTHi4hwBXExpXlWS3lkqpW30zuJBKjobnjQy9AZ0Xw05z9ZcHuYAQABAAEGBQmrpUP07kPXIAw7gs06dyN2Bxq0lapq8J7XB16AVy3pbVHO6HqChqOa8wbQozZG+g9bg3yNKy31sCkDaJGbg713hqSmhv3vQyu21K5Um+/IMo0jBSgk8TEaHuqdmY6ptjYDWPn6xuOK6dxor0Xjly3pWq12XMtIQJcgBiRm8O6GRlRLHaj/fuZ6dhb3/s/wngN2sneC6f9s+Oc6LX7l9zXLeMbOnACQEBSACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAPwL3XwvzOsJdhMAAAAASUVORK5CYII=",d="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHN0eWxlPSJlbmFibGUtYmFja2dyb3VuZDpuZXcgMCAwIDMwNiAzMDY7IiB2aWV3Qm94PSIwIDAgMzA2IDMwNiIgeD0iMHB4IiB5PSIwcHgiIHhtbG5zOnhtbD0iaHR0cDovL3d3dy53My5vcmcvWE1MLzE5OTgvbmFtZXNwYWNlIiB4bWw6c3BhY2U9InByZXNlcnZlIj4KICA8c3R5bGUgdHlwZT0idGV4dC9jc3MiPgogICAgLnN0MHtmaWxsLXJ1bGU6ZXZlbm9kZDtjbGlwLXJ1bGU6ZXZlbm9kZDtmaWxsOnJnYigyMTksIDQxLCA1Myk7fQogICAgLnN0MXtlbmFibGUtYmFja2dyb3VuZDpuZXc7fQogICAgLnN0MntmaWxsOnJnYigyNTUsIDI1NSwgMjU1KTt9CiAgPC9zdHlsZT4KICA8Zz4KICA8Zz4KICAgIDxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik0gMTUzIDAgTCAxNTMgMCBjIDg0LjUgMCAxNTMgNjguNSAxNTMgMTUzIGwgMCAwIGMgMCA4NC41IC02OC41IDE1MyAtMTUzIDE1MyBsIDAgMCBDIDY4LjUgMzA2IDAgMjM3LjUgMCAxNTMgbCAwIDAgQyAwIDY4LjUgNjguNSAwIDE1MyAwIFoiLz4KICAgIDxnIGNsYXNzPSJzdDEiPgogICAgPHBhdGggY2xhc3M9InN0MiIgZD0iTSAxNTQuOCA4My42IGMgMi42IDAgNS4xIDAuNyA3LjUgMi4xIGMgMi4zIDEuNCA0LjEgMy4zIDUuNCA1LjYgbCA1MS45IDk2LjQgYyAxLjIgMi4yIDEuOCA0LjUgMS44IDYuOSBjIDAgMiAtMC40IDMuOSAtMS4yIDUuNiBjIC0wLjggMS44IC0xLjggMy4zIC0zLjIgNC42IGMgLTEuMyAxLjMgLTIuOSAyLjQgLTQuNiAzLjIgYyAtMS44IDAuOCAtMy43IDEuMiAtNS42IDEuMiBIIDEwMi44IGMgLTIgMCAtMy44IC0wLjQgLTUuNiAtMS4yIGMgLTEuOCAtMC44IC0zLjMgLTEuOSAtNC42IC0zLjIgYyAtMS4zIC0xLjMgLTIuNCAtMi45IC0zLjIgLTQuNiBjIC0wLjggLTEuOCAtMS4yIC0zLjYgLTEuMiAtNS42IGMgMCAtMi40IDAuNiAtNC43IDEuOCAtNi45IGwgNTEuOSAtOTYuNCBjIDEuMyAtMi4zIDMuMSAtNC4yIDUuNCAtNS42IEMgMTQ5LjcgODQuMyAxNTIuMiA4My42IDE1NC44IDgzLjYgWiBNIDE1NC44IDkzLjMgYyAtMSAwIC0xLjkgMC4zIC0yLjYgMC44IGMgLTAuNyAwLjYgLTEuNCAxLjIgLTEuOSAyLjEgYyAtMC42IDAuOCAtMSAxLjcgLTEuNCAyLjYgYyAtMC40IDAuOSAtMC44IDEuOCAtMS4yIDIuNSBjIC0wLjggMS41IC0yIDMuOSAtMy44IDcuMiBjIC0xLjggMy40IC0zLjkgNy4zIC02LjQgMTEuNyBjIC0yLjUgNC41IC01LjIgOS4zIC04LjEgMTQuNiBjIC0yLjkgNS4zIC01LjggMTAuNiAtOC43IDE1LjkgcyAtNS43IDEwLjUgLTguNCAxNS41IGMgLTIuNyA1IC01LjEgOS41IC03LjIgMTMuNiBjIC0yLjEgNCAtMy44IDcuMyAtNSA5LjkgYyAtMS4yIDIuNiAtMS45IDQuMiAtMS45IDQuOCBjIDAgMS4zIDAuNSAyLjUgMS40IDMuNCBjIDEgMSAyLjEgMS40IDMuNCAxLjQgaCAxMDMuOSBjIDEuMyAwIDIuNSAtMC41IDMuNCAtMS40IGMgMSAtMSAxLjQgLTIuMSAxLjQgLTMuNCBjIC0xLjUgLTMuNyAtMy4xIC03LjIgLTUgLTEwLjYgYyAtMS45IC0zLjQgLTMuNyAtNi45IC01LjUgLTEwLjQgYyAtMi40IC00LjUgLTQuNyAtOSAtNyAtMTMuNCBjIC0yLjMgLTQuNSAtNC43IC05IC03IC0xMy40IGMgLTIuNCAtNC42IC00LjkgLTkuMiAtNy4zIC0xMy43IGMgLTIuNCAtNC41IC00LjkgLTkuMSAtNy4zIC0xMy43IGMgLTEuOCAtMy4yIC0zLjUgLTYuNSAtNS4zIC05LjcgYyAtMS44IC0zLjIgLTMuNiAtNi40IC01LjQgLTkuNiBjIC0wLjQgLTAuNyAtMC44IC0xLjQgLTEuMiAtMi4xIGMgLTAuNCAtMC43IC0wLjkgLTEuMyAtMS40IC0xLjkgYyAtMC42IC0wLjcgLTEuMiAtMS4zIC0xLjggLTEuOCBDIDE1Ni42IDkzLjYgMTU1LjggOTMuMyAxNTQuOCA5My4zIFogTSAxNTQuOCAxNzcuNiBjIDEgMCAxLjkgMC4yIDIuNyAwLjYgYyAwLjkgMC40IDEuNiAxIDIuMyAxLjYgcyAxLjIgMS41IDEuNiAyLjMgYyAwLjQgMC45IDAuNiAxLjggMC42IDIuNyBjIDAgMSAtMC4yIDEuOSAtMC42IDIuNyBjIC0wLjQgMC45IC0xIDEuNiAtMS42IDIuMyBzIC0xLjUgMS4yIC0yLjMgMS42IGMgLTAuOSAwLjQgLTEuOCAwLjYgLTIuNyAwLjYgYyAtMSAwIC0xLjkgLTAuMiAtMi43IC0wLjYgYyAtMC45IC0wLjQgLTEuNiAtMSAtMi4zIC0xLjYgcyAtMS4yIC0xLjUgLTEuNiAtMi4zIGMgLTAuNCAtMC45IC0wLjYgLTEuOCAtMC42IC0yLjcgYyAwIC0xIDAuMiAtMS45IDAuNiAtMi43IGMgMC40IC0wLjkgMSAtMS42IDEuNiAtMi4zIHMgMS41IC0xLjIgMi4zIC0xLjYgQyAxNTIuOSAxNzcuOCAxNTMuOCAxNzcuNiAxNTQuOCAxNzcuNiBaIE0gMTU5LjcgMTcwLjIgaCAtOS44IHYgLTQ4LjggaCA5LjggViAxNzAuMiBaIi8+CiAgICA8L2c+CiAgPC9nPgogIDwvZz4KPC9zdmc+",c="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTQ0IiBoZWlnaHQ9IjE0NCIgdmlld0JveD0iMCAwIDE0NCAxNDQiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgo8Y2lyY2xlIGN4PSI3MiIgY3k9IjcyIiByPSI3MiIgZmlsbD0idXJsKCNwYXR0ZXJuMCkiLz4KPGNpcmNsZSBjeD0iNzIiIGN5PSI3MiIgcj0iNzIiIGZpbGw9IiNEMTM0MzgiLz4KPHBhdGggZD0iTTQ1LjEyMTQgODdDMzkuMTIyIDg3IDM1IDgzLjI5ODcgMzUgNzguMzc3M0g0MC42NzI5QzQwLjcxMzcgODAuMzcwMyA0Mi42NzI3IDgyLjAzNzkgNDUuMjg0NyA4Mi4wMzc5QzQ3LjgxNSA4Mi4wMzc5IDQ5LjQ4ODMgODAuNjU1IDQ5LjQ4ODMgNzguNjYyQzQ5LjQ4ODMgNzcuMTE2NCA0OC4zNDU2IDc2LjAxODIgNDUuOTM3NyA3NS4yODYxTDQyLjUwOTQgNzQuMzFDMzYuMzQ2OCA3Mi42ODMgMzUuMjQ0OSA2OC45ODE4IDM1LjI0NDkgNjYuNDZDMzUuMjQ0OSA2MS40NTcyIDM5LjU3MSA1OCA0NC45NTgyIDU4QzUwLjI2MzggNTggNTQuMzQ1IDYxLjIxMzIgNTQuMzQ1IDY2LjU0MTRINDguNjcyMUM0OC42NzIxIDY0LjU0ODQgNDcuMjg0NSA2My4wMDI4IDQ0LjgzNTcgNjMuMDAyOEM0Mi42MzE5IDYzLjAwMjggNDAuOTU4NiA2NC40NjcgNDAuOTU4NiA2Ni4zMzhDNDAuOTU4NiA2Ny4wMjk1IDQxLjE2MjYgNjguNDUzIDQ0LjEwMTEgNjkuMzA3Mkw0Ny4yNDM3IDcwLjIwMkM1MS40ODgxIDcxLjQ2MjggNTUuMjAyMSA3My42MTg1IDU1LjIwMjEgNzguMzc3M0M1NS4yMDIxIDgzLjk0OTUgNTAuNDI3IDg3IDQ1LjEyMTQgODdaIiBmaWxsPSJ3aGl0ZSIvPgo8cGF0aCBkPSJNNzIuOTE1OCA4N0M2NC45MTY2IDg3IDU4LjYzMTYgODAuNDUxNiA1OC42MzE2IDcyLjUyMDNDNTguNjMxNiA2NC41NDg0IDY0LjkxNjYgNTggNzIuOTE1OCA1OEM4MC44NzQyIDU4IDg3LjI0MDkgNjQuNTQ4NCA4Ny4yNDA5IDcyLjUyMDNDODcuMjQwOSA4MC40NTE2IDgwLjg3NDIgODcgNzIuOTE1OCA4N1pNNzIuOTE1OCA4MS42NzE4Qzc3LjkzNTcgODEuNjcxOCA4MS41MjcyIDc3LjU2MzggODEuNTI3MiA3Mi41MjAzQzgxLjUyNzIgNjcuNDc2OSA3Ny45MzU3IDYzLjMyODIgNzIuOTE1OCA2My4zMjgyQzY3Ljg1NTEgNjMuMzI4MiA2NC4zMDQ0IDY3LjQ3NjkgNjQuMzA0NCA3Mi41MjAzQzY0LjMwNDQgNzcuNTYzOCA2Ny44NTUxIDgxLjY3MTggNzIuOTE1OCA4MS42NzE4WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggZD0iTTEwMC45MTkgODdDOTQuOTIgODcgOTAuNzk4IDgzLjI5ODcgOTAuNzk4IDc4LjM3NzNIOTYuNDcwOUM5Ni41MTE3IDgwLjM3MDMgOTguNDcwNyA4Mi4wMzc5IDEwMS4wODMgODIuMDM3OUMxMDMuNjEzIDgyLjAzNzkgMTA1LjI4NiA4MC42NTUgMTA1LjI4NiA3OC42NjJDMTA1LjI4NiA3Ny4xMTY0IDEwNC4xNDQgNzYuMDE4MiAxMDEuNzM2IDc1LjI4NjFMOTguMzA3NCA3NC4zMUM5Mi4xNDQ4IDcyLjY4MyA5MS4wNDI4IDY4Ljk4MTggOTEuMDQyOCA2Ni40NkM5MS4wNDI4IDYxLjQ1NzIgOTUuMzY4OSA1OCAxMDAuNzU2IDU4QzEwNi4wNjIgNTggMTEwLjE0MyA2MS4yMTMyIDExMC4xNDMgNjYuNTQxNEgxMDQuNDdDMTA0LjQ3IDY0LjU0ODQgMTAzLjA4MiA2My4wMDI4IDEwMC42MzQgNjMuMDAyOEM5OC40Mjk4IDYzLjAwMjggOTYuNzU2NSA2NC40NjcgOTYuNzU2NSA2Ni4zMzhDOTYuNzU2NSA2Ny4wMjk1IDk2Ljk2MDYgNjguNDUzIDk5Ljg5OTEgNjkuMzA3MkwxMDMuMDQyIDcwLjIwMkMxMDcuMjg2IDcxLjQ2MjggMTExIDczLjYxODUgMTExIDc4LjM3NzNDMTExIDgzLjk0OTUgMTA2LjIyNSA4NyAxMDAuOTE5IDg3WiIgZmlsbD0id2hpdGUiLz4KPGRlZnM+CjxwYXR0ZXJuIGlkPSJwYXR0ZXJuMCIgcGF0dGVybkNvbnRlbnRVbml0cz0ib2JqZWN0Qm91bmRpbmdCb3giIHdpZHRoPSIxIiBoZWlnaHQ9IjEiPgo8dXNlIHhsaW5rOmhyZWY9IiNpbWFnZTBfODA2N18yMjc5NzkiIHRyYW5zZm9ybT0ic2NhbGUoMC4wMDI1KSIvPgo8L3BhdHRlcm4+CjxpbWFnZSBpZD0iaW1hZ2UwXzgwNjdfMjI3OTc5IiB3aWR0aD0iNDAwIiBoZWlnaHQ9IjQwMCIgeGxpbms6aHJlZj0iZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFaQUFBQUdRQ0FZQUFBQ0F2emJNQUFBQldHbERRMUJKUTBNZ1VISnZabWxzWlFBQUtKRnRrRUZMQWxFVWhjK1laYVJSUkxzYUdGcEV4Q1JsQnUzQ0RDeHlNVTBHRmtHTm8ya3dUcS9uUkFqOWlQYlJyaDhSMHFKZEJPNkNJbWlieXphQkJDWFRmVTZsVmc4dTUrTnczdVZ5QUYrdndaamxCMUMwSGE0bkZwWDA1cFlTcUNFSUdRUHdZY3d3U3l5bWFVbUs0RnM3WC8wZWt0QzdLYkZyNTdsblpsSk5MTnltNWF0YTlXWGtiNzdqOVdWekpaUDBneVpzTXU0QWtrcXNIVHRNOEFueE1LZWppRThGNXoyK0VKengrTEtaU2VseDRpcnhvRmt3c3NSUHhHcW16YyszY2RFNk1yOXVFTmVIY3ZiR091a1F6U2lTU0VEQk1wYWdrMGF4U3YzOG40ODI4M0VjZ0tFTWpuM2tVWUJEdjJMa01GaklFYS9BaG9rd1ZPSUlwbWtpb3VmZi9iVzg4Z013djBhdzNmSlNqMEJGQTRKbkxXOWlIT2pmQlc3bW1NR05uMWFsdXIrME54dnhPTVNCN2pmWGZaV0JRQVZvY05kOVAzZmRCblhZUlR1dkR6OEIwTzloQ0xDY1g0UUFBQUE0WlZoSlprMU5BQ29BQUFBSUFBR0hhUUFFQUFBQUFRQUFBQm9BQUFBQUFBS2dBZ0FFQUFBQUFRQUFBWkNnQXdBRUFBQUFBUUFBQVpBQUFBQUFPUGxOOWdBQVB4MUpSRUZVZUFIdG5WdVFGY2VaNTdPcVc3dGN0SFNmdG9VdE5ERTYzWUIyck81WkkyNStHR1Exc3VCQkY0UTlJZkNUUUx6SURpbFdXRHUyTi9aQmdOL0dudFVsd2hySjh5QkEreUpRaEhXeDVJaXhKdFF0SVQ4c1lJSFgzZkpZWExxSk1DZ0VOdFhJeldWWG5GUDdmVVZYYy9yMHVWUmxaVlZsWmY0ekFrNmRPcFczWCtZNS8vN3l5NHNqRUVEQUlBSmpudGROMWVtK0trVFpwMzljTlg1MVhMZmJkWnl1OEgzdzZ2dGxmZzJETS9WOCtMN1pLNlUzSG41R2NTYUU0MHhNdlovZzkxWGZ2K0JYcTN3OVRzOU91UFNQWDIrZzk3MmxVdmhzbUFSZVFhQ3dCS2lQSTRCQWNRaVFRSlQvbnhETHFPTjJzekIwZEhUY3lxOCtpUUhmbzVyd1A5M0RVUllkRnBoS3BYS0tYL2xmNXpXQkdkZTk4Q2dmQ0lRRXFOOGlnSUJlQk5pSytKeEVnVXExVExqdU1zZHhiaVdCWU5IZ2V6WUVGcGh4cXZNcHNtU0cyWUloY1RrSzY4V0dwaTlXSFNFZ3hXb3Y0MG9iV2hTZHJudHIxWEVHTFJPS3VPMFpDRXUxVXZrdGljb3dSQ1V1UGp5dm1nQUVSRFZScE5lVUFGc1c1SnRZNXJydVZ5RVdUVEhGK29DK3dPTys0eHgxZlgrNFdxMytGcUlTQ3g4ZVRrZ0FBcElRSUtJM0o4Q0NRZjZLUVhKZ0QxSkh1NHVlWE5iOGFYeWlrTUJSOGd1OXg4TmYvNEVzRlF4OUtTU0xwR1lRZ0lETXdJRTNTUWhBTUpMUVN6VXVCQ1ZWdlBZbURnR3h0KzJWMVB5WTV3Mkt6czY3aE84UEJ2K1VwSXBFVWlYZ09NTTA1UFY2cFZwOTc3WlM2V2lxZVNGeG93bEFRSXh1WHZXVkMvMFl2dXR1cE02emhYSW93clJaOVNBTVNaSGFjSnhtZkEzVGRPSTMvbk9wOUxvaDFVSTFNaUlBQWNrSWRKR3pZZEdnYWJVYm5ZNk9MV1Jsc0I4RG9sSGtCbTFWZHNkNW5YNFVYdThnUVlIdnBCVW9mTVlFSUNEb0J3MEoxSW5HWU1PSGNOTnNBbVNaMEEvRUhvaUoyYzJjcEhZUWtDVDBESXNiRGsrSmpvNGRzRFFNYTl5azFTSExoTmFmN01Vd1YxS1Fac1dIZ0pqVm5sSzFZVWM0ZkJwUzZLeUxSRDhZZ2MvRUp6RlpXaW9OV3djQUZaNUJBQUl5QTRjOWJ3SnJvN1B6Q1ZHdGJxUmFzMThEQVFSaUVhRFY4R08waUhFWERYRzlSLzZTOFZpUjhiQVJCQ0FnUmpSajlFb0UwMjZ2RFZFTlJvK0ZKMEdnTlFIYXIyd1BySkxXakV6OEZBSmlZcXZXMVltdGphcnJicWtLc1pVK2dyVlJ4d2R2MVJHQVZhS09aUkZTZ29BVW9aVWt5MGpDVWY3Y2RiZFRJMk85aGlSRFJKTW1NRUZXQ1U4SDNvWGhMV21HMmtlRWdHamZSUEVMaUdHcStNd1FJejBDR041S2oyM2VLVU5BOG00QmhmbERPQlRDUkZKcEVEaENZdkxja2dVTDlxYVJPTkxNbmdBRUpIdm15blA4MlBPMjBoYnBPMmdIMXJMeXhKRWdDQ2dtRVBwSklDU0t3ZWFRSEFRa0IraXFzb1J3cUNLSmRQSWdBQ0hKZzdyYVBDRWdhbmxta2hxRUl4UE15Q1FqQWhDU2pFQ25rQTBFSkFXb2FTVUo0VWlMTE5MVmdRQ0VSSWRXaUZjR0NFZzhYcms4SFRqSFhmY1p5aHhyT0hKcEFXU2FKUUVJU1phMGsrVUZBVW5HTDlYWW1GV1ZLbDRrcmorQkkzUXM3elljZXFWdlEwRkFOR3diWGdCWTZlaDR4dmQ5M3FjS0FRU3NKc0RyU0xBZ1VjOHVBQUhScUYxcU5qamNUc1hxMXFob0tBb0k1RTNBRjY2N2EvTHExZWZ1S0pVbThpNE04cjlHQUFLaVNVOWdCN2x6emM4QjRkQ2tUVkFNL1FqQVA2SlhtMEJBY200UEVvNWxkRlRzTTNTQTAyRE9SVUgySUZBa0FrYzZxOVZ2WVordGZKc01BcElULzZuaHFoMTBIZ2NQVnlHQUFBaklFSENjWnlZcmxSOWhXRXNHWHZJNEVKRGtER09ud0xPcmFMaHFON1llaVkwT0VVQmdGZ0VNYTgxQ2t0a05DRWhtcU9uNE5wcGRkYldqWXplR3F6S0VqcXlzSVlEWld0azNOWWszUWhZRVRreE9QbkhWZFk5QVBMS2dqVHhzSkVEVDNyZlN3V252SHYvc016Ny9CaUVEQXJCQVVvWU1xeU5sd0VnZUJCb1FvTFBhWDd1aFVua1NUdllHY0JUZWdnV2lFR1o5VXJBNjZvbmdQUWhrUThEeC9XL0NHa21mTlN5UUZCZ0hNNnc2T2w3RGNGVUtjSkVrQ01Ra0FOOUlUR0F4SG9lQXhJQVY1ZEdwalE5Zm8yZXhJREFLTUR3REFoa1F3RXl0ZENCRFFCUnh4Ym9PUlNDUkRBaWtTWURXalN4ZHNPREpOTE93S1cwSWlJTFdaa2Q1eFhXSHNLNURBVXdrQVFJcEUyQnJ4SzFXNzRhRFBUbG9PTkVUTWd3ZDVSQ1BoQ0FSSFFReUlsQVZvcGVtMUgvNDc1NkhYU0FTTW9jRklna1FRMWFTNEJBTkJIUWlnSzFRRXJVR0JFUUNINGFzSktBaENnaG9TZ0JEV3ZJTmd5R3NtT3lPVDA1dTRSWGxHTEtLQ1E2UGc0Q21CTUloTGF4Z2o5OUFFSkFZekk3OTVTODcvRXBsRDBYQkZOMFkzUEFvQ0JTQVFJbTJRdG5OMy9FQ2xGV2JJbUlJSzBKVEJQNE9MQXlNUUFxUGdFRHhDV0FibE9odENBRnB3d3IramphQThERUlHRWdBZnBGb2pZb2hyQmFjZUZVNS9CMHRBT0VqRURDVVFPZ1grWVBuYlRTMGlrcXFCUUZwZ3BIWGR3aGFIRWdmdzkvUmhCRnVnNERoQkVxdTYvNGNmcEhtclF3QmFjQ0dPMHkxVW5tMndVZTRCUUlnWUJjQmg0NmQzZ0VSYWR6bzhJSFVjR0ZuK2VjZEhjL1FWdEJiYTI3akVnUkFBQVNFY0p6ZGRQNzZremgvL1hwbmdJQk1zV0JuT2ZrN2VCZmRaZGZ4NEFvRVFBQUVaaEE0MGxtdGZndjdhRjFqQWdFaERwaHBOZU1MZ2pjZ0FBSXRDR0NHMW5VNDFnc0l4T042WjhBVkNJQkFOQUlRa1d1Y3JIYWlmK3g1eXpCTk45b1hCaytCQUFoY0o4RFRmUG5JWFA0TnVYN1h2aXRyTFJCdWVBZlRkTzNyOGFneENLZ2w0UGwwdHNodHBkSlJ0Y2tXSXpVckxSRGVFSkhFNHdnMVVYY3htZ21sQkFFUTBKUkFpWDVMUHJSMUkwYnJMQkFXajZrTkVUWHRqeWdXQ0lCQUFRblFGbHJPSTBzV0xOaGJ3TEpMRjlrcUFZRjRTUGNUUkFRQkVHaFB3RG9Sc1VaQUlCN3RleitlQUFFUVNFekFLaEd4UWtBZ0hvbS9GRWdBQkVBZ09nRnJSTVI0QVlGNFJPLzFlQklFUUVBWkFTdEV4R2dCZ1hnbyt6SWdJUkFBZ2ZnRWpCY1JZd1ZrYXAwSFQ5VkZBQUVRQUlHOENQaTBUbVM1cWV0RWpGd0hVck5JTUs5T2czeEJBQVJBZ0FrNHRFN0UyQlhyeGxrZzJOc0szMW9RQUFFTkNYaTBpKzl5MDNieE5jb0NnWGhvK0xWQmtVQUFCSmhBaWZmTzR0OG9rM0FZWTRGQVBFenFscWdMQ0poSmdQNWlIM05wN3l4VExCRWpMQkFTajI0K0RNb1hvbXhtdDBPdFFBQUVUQ0RBdS9qU2I5WFBqOUJ2bGduMU1VSkErQmhhYWd5cnQxVTJvVE9pRGlCZ0NZRTdidXpvZU5xRXVoWmVRUGl3ZTV4aGJrSlhSQjFBd0NJQ3ZyK1ZmN3VLWHVOQyswQ0NCcWhXZHhhOUVWQitFQUFCS3duNGxXcjF5YjhwbFo0dGF1MExLeUIvOEx5Tkx2azlpZ29lNVFZQkVBQUJJdUFMY3FvdkxaV0dpMGlqa0FMQ002NzRLRm9DYm9RanFvZ2RCMlVHQVJCUVJxQ3dhMFFLNXdNSnArdFMwMEU4bFBWZkpBUUNJSkFqZ1dDTlNCRm5aaFZPUUNvMDR3clRkWFBzNnNnYUJFQkFPUUdlM2tzenMzNnVQT0dVRXl5VWdMRFQzUGY5alNrelFmSWdBQUlna0QwQjN4OHMyc3lzd3ZoQWFJUEVyYlFwMmU3c1d4VTVnZ0FJZ0VCbUJBcTFCWHdoQkFSTzg4dzZMeklDQVJESW4wQmhuT3JhRDJIeE5pVVYxeDJpTm9YVFBQK09qUktBQUFpa1Q2QXdUblh0QmVScVorY09PTTNUNzdISUFRUkFRQjhDVTA3MXAvUXBVZU9TYUMwZ0p5WW5uNkJGTnRzYkZ4MTNRUUFFUU1CZ0FyNi8vZDg5VCt2ZlAyMTlJUEI3R1B6RlFOVkFBQVNpRXREYUg2S3RCUUsvUjlUK2hlZEFBQVFNSnFDMVAwUkxBYUc1MEZnc2FQQTNBbFVEQVJDSVRrQm5mNGgyUTFoWTd4RzlZK0ZKRUFBQmF3aG91ZW1pVmdJUzduT0ZXVmZXZkNsUVVSQUFnZWdFdk1scXRlK09VbWtpZXBSMG45UnFDT3R6MTkwSjhVaTN3WkU2Q0lCQVlRbVVkTnN2U3hzQkNZYXVoTmhTMktaRndVRUFCRUFnYlFLMFg1Wk9VM3UxR01MQzBGWGF2UTdwZ3dBSUdFUkFtNm05V2xnZzJLTGRvSzZOcW9BQUNLUk5vSFMxbytPbHRET0prbjd1QXNKRFY5aWlQVXBUNFJrUUFBRVFtQ0tneVZCV3JrTllHTHJDMXdFRVFBQUVwQW5rUHBTVnF3V0NXVmZTSFFjUlFRQUVRS0QwZVVmSDAzbGl5TTBDd1lMQlBKc2RlWU1BQ0JoQ0lOY0ZocmtJQ0ExZDhSa2ZSN0RtdzVBdWpHcUFBQWprUm9DR2tjWStxMWFYNTdIQU1KY2hMSnp4a1Z0ZlE4WWdBQUtHRWNoenI2ek1MUkIybkY5MTNUSEQyaERWQVFFUUFJRThDZmcrV1NHM2xVcEhzeXhFNWhZSWljZHJXVllRZVlFQUNJQ0FCUVFjSndlSGVxWUN3bzV6YXNobEZqUW1xZ2dDSUFBQzJSS2d0U0hIUC9zczArMmdNaHZDd3BxUGJQc1NjZ01CRUxDU1FLWTc5blptaFpnYzUxdm9mUE55VnZraEh4Qm9SdURpNWN0aTlNUkpjZmI4ZVhITzg4UlorbmZ1dkNmNGZ2RHZ5cFVaVWVmUG1TUG16NTByYnVvcEJmZDdGeTBTTjVWS29uekxJc0hYL0JrQ0NHaENvRFJQQ0Q1SGZXY1c1Y25FQW9IalBJdW1SQjdOQ0xCQUhQemRpQmo3NUJQeDBmRVRnV0EwZTFibS9zSXBNVm5kM3kvNkYvZUpoVDA5TXNrZ0RnaW9JcERaQ3ZWTUJPVGpDeGYyVUVhWmpzMnBhZ21rVTB3Q1kyZk9pSU1qbytJUS9lUHJMQU5iSlN3azk5MjVCbUtTSlhqa05VM0FkNXpYYmx1dzRGdlROMUs2U0YxQXlIRyt6S0ZGZ3ltVkg4bUN3RFFCSG40YU9uUllIQndkRFlhb3BqL0k4WUxGaElWazlVQS9ocnB5YkFjTHM4NWtoWHJxQW5Mc3dnVVdEOHk4c3JBSFoxVmxGbzYzRG53ZzNuNy9nTGhZNTcvSXFnenQ4dUZocnY3Rmk4V205ZmZBS21rSEM1K3JJZUE0UTBzWExMaGJUV0tOVTBsVlFMRGZWV1BvdUt1R1FCR0VvMUZOMTY1Y0NTRnBCQWIzVkJOSTNRcEpWVUNPWDdndzVndFJWazBGNmRsTm9LakNVZHRxYkpFTXJsb3BOcTlmVjNzYjF5Q2dtc0NScFYxZHkxVW5HcWFYbW9EQStnZ1I0MVVsZ1pFVEo4VHpyK3hYUHBOS1pSbmpwTVZDOHNpREQ1Q1BaQ0JPTkR3TEFsRUprRC9kZVdUSmdnVjdvMGFJODF4cUFnTHJJMDR6NE5sMkJOanEyUGVyZDhUYjVPc3dNZkN3RmdzSjFwU1kyTHI1MW9tMkd4bGIzTlhWbDBZcFVoRVFXQjlwTkpXOWFZNmRQaTErdk9kbFk2eU9aaTNKMXNpdTd6NEtKM3N6UUxndlN5QTFLeVFWQVlIMUlkdk9pRmRQNEswREI4VHVOMzVSZjl2bzk1dklMd0xmaU5GTm5IbmwwckpDS0YyMWdhMFBPTTdWTXJVMXRaZmVlTk02OGVDMjNrOURkYnVwN2dnZ29Jb0FuUmxTVG1PalJlVVdDS3dQVlUxdWJ6cVQ1Ty80OFo2OTJpd0d6S3NsK21nUjRrNGEwb0pmSks4V01DdmZOS3dRcFJZSXJBK3pPbHdldGZtVU5qamMrY0xQckJjUFpuK1N0bUQ1aDZlZkRUWjl6S010a0tkWkJOS3dRcFJhSUxBK3pPcHdXZGNtRkEvZS9EQ3J3STVyM2xWM1lhbUhkdGp0bnY1clA5d1E4ZUxsUzdSRDc1WEFnWCtKWHNmT25BNnVlZmZlckFLYzYxbVJOajhmMVZhSU1nSEJ6Q3Z6TzErYU5jeEtQT2JOblNQdVhybUt0aFhwcFg5TFNERG1TRldMUldYMHhISGFzUEVqTVhMeVJMQWR2RlJDRVNOOWlZVHVKMDl1bnhhNGlOSHdHQWpVRTFDNk9sMlpnR0RQcS9wMnd2dW9CQ1l2WFJZN1gveFphcnZtaHFLeGV1RDJZRCtxcU9XSzh4eWZMOEliT2FZcEp2Q0p4R2tSUE51VWdNSTlzcFFJeURIUEd4U3VPOVMwd1BnQUJGb1ErT2tyKzhUUTRkKzBlRUx1SXo0QTZ2NDFhOFRhVmF1a0xRMlpuRmxJOXIzelRpcFd5ZHBWSzhUam16ZkxGQXR4UUNBa29Nd0tVU0lnT084amJCZTh4aVhBVTFaNWhibkt3QmJIdGcwYlNEaFdxa3cyZGxwcENRbldpY1J1Q2tTb0o2RElDa2tzSURodHNMNWw4RDRxZ2Y5Tmh6M3hkRjJWNFg0NmUyUFQrdldaV2h5dHlzOWJzUEQySzZwRmtsZXNEOUQyOEFnZ0lFbkE3NnhXKzNwTHBYSEorRUcweE5ONFAzZmRuVWtLZ0xoMkVtQ24rUjZGaStWNHVPcWZ2cmVkOXBQYW9JMTRjTXZ5R2c2MkdQNzVmL3ozNlRQVlZiVDRUM2hyRjJLSUFBS1NCSnpQaFhoQ011NTB0RVFXeUpUMXdRZEdkVStuaUFzUWFFT0FkaW9RTzE1NFVkbGFEOTJzam1iVloydUVoK3o0OENzVmdZL04vZEYzdjZNaUthUmhKd0Z2a3F5UU8wcWxDZG5xSjdKQVNNRUdLV09JaHl4OVMrTzlUZnRiOGF3bEZXRWJXUnk2V1IzTjZzWFdDSmRWMVQ1WHpGQ1ZHRFVyTSs0YlRhQjdyaEJiazlRd2tZQzRycnNqU2VhSWF4OEJIcnJhLzYvSm5lYnNLUC9oMWkzQmVlTkZvOGhEV2ovWStyRGdPaVFOcjVKRmc2R3NwQlN0amU5MHVPN0RTV292TFNBOGRSZWJKaVpCYjJkYy9zRkxlbTQ1Ly9EKzZEdmZvVU9ZK2dzTDhXdDBnTlF1R241S0tpSzhiOWp1TiszYXJiaXdqYTVud1pjRnl6QWt5eVl0SUw3cmJwWE1FOUVzSmNCN095VmQ3OEZPT3hhUFh0cCtwT2lCRndheWlDUU5CMmsyRzUvVWlBQUNFZ1FjMGRIeGxFUzhJSXFVZ0xEem5MN0lXMlF6UlR6N0NQaGtydkpSdEVuRFk5L2VaSVI0aEJ4WVJCN2Z2Q2w4Sy8zS3pua0VFSkFpNFB1RFJ6eFB5cGN0SlNCVHpuT3BzaUtTblFTR0R4OFc0MlNCSkFuc08rQ2pYMDBMdk9BeHFXT2RIZXF3UWt6ckdablZ4NWtueEhhWjNLUUVCTTV6R2RUMnhpSGpnNGF1RGljQ3NMcS9QL0dQYktJQ3BCejVJUkpIbnBhYkpNQUtTVUxQN3JqMG03NUJoa0JzQVlIelhBYXozWEg0citNazAzWjVrU0JQZnpVNXNHL25CMXVTemN5Q0ZXSnlEMG05YmxMTzlOZ0NBdWQ1NmcxcFhBYkRodzRscXRQbWRldkVRaElSMDhPTjgrWWw5b2ZBQ2pHOWw2UldQNGRHQ2g2TW0zcHNBYUVJZDhYTkJNL2JTNERYZlNTWmVjVStqN3czUmN5eTlWYlQ5TjRrUTFrZmtiWEhLOTRSUUNBdUFjZDF0OFIxcHNjU2tPT2V0NUZVcWh5M1lIamVYZ0w4Z3lZYmVGaUhIZWMyQmE3ell3bG1aYkcvQ2F2VGJlb3hTdXZhZmFNUXkrS2tHRXRBYUw3d2xqaUo0MW03Q2ZEVTNTUS9ab05rZmRnd2RGWGZTNzdVMDVOb3dzQW8xb1RVSThYN2FBUmlyd21KTENDMDlxUGI5LzJOMGNxQnAwQkEwTm5oNTZXbjd0cG9mZFQybVh2WC9KMzBLblcyK3JJOFY3NjIzTGd1T0FIZlh4Wm5HQ3V5Z05EYUQ0aEh3ZnRHMXNVL05Eb3FuYVd0MWtjSWpCM3FYK3NmQ04vR2V1VmhMRjZkamdBQ0VnUzY1OGY0clk4c0lBNkdyeVRhd3Q0b1BId2wreVBtT0k2NDcrdHI3SVUzVmZNa2t3Y09qb3hZenc4QXBBZzQ5RnNmZVlQRlNBTEN3MWVDbHJ0TEZRZVJyQ1J3OGZJbDZiVWY1VVUzaTE3YTRzUDJjRHN0TEpTZGtZWFpXTGIzbmdUMWo3RzFTU1FCd2ZCVmdzYXdOT3I0bVUra2E4N0RWd2hDc0I5STl0aGFIc1lhUzdoMUROckFYZ0pSaDdFaUNZamIwUkY3Z1ltOTZGRnpKakJ5VW03NkxnOWY4YllsQ05jSTNMVnloVFNLSkNJdW5Ta2lta0FnOGpCV0pBSEI3Q3NUK2tTMmRUaDFXbTdqeFBLaUwxczVkYmRaNnl3c2xRVC9rd2xKdG8rUnlROXhEQ0lRY1RaV1d3SGh4WU1HWVVGVk1pREFEblRaYWFTOU45K1NRUW1Ma3dWYlpLc2tEODRhUDMyNk9CVkZTWFVqRUdsUllWc0JxYm91QkVTM3B0VytQTDcwK285VkE3ZHJYN3VzQ3lnN29lQ2M1MkZiazZ3Ynk1ejhJdTJOMVZaQTZJRzd6R0dDbW1SQllFeHkrSXFkeGpmUktteUVtUVI0TnBac1NIcDhzR3kraUZkOEFydzNWcnRhdEJRUW1yNjdqRVlqeXUwU3dlY2dVRXZnMHBVcnRXK2pYOU53amV4ZjI5RXpLZDZUc2o0USt1NEtER01WcjcwMUtuRjN1L1BTV3dySVZTRUdOYW9NaWxJUUFyTCtqL0xOWHk1SURiTXZwcXlJWEx3c0tlYlpWeEU1NmtmQXFiYlJnSllDUXBzbll2cXVmbzJxZllsNDdGMG16Sjg3VnlhYStYSElNdU5EdFdTQ3JKakw1SVU0NWhHZ0pSeGZiMVdycGdLQzFlZXRzT0d6TkFqTW0wc25NeVBNSWdEZjBDd2t1SkVWZ1RhcjBwc0tTS1dONlpKVitaRlA4UWpJSG1nMGIrNmM0bFZXOHhKZnd1RlNtcmVRL3NXN3NhT2o2VVNxcGdMU2J1eEwvMnFqaEhrUndNeWZ2TWpQem5kU2RrTEQ3S1J3eDA0Q2psK3BERGFyZWxNQm9TbGNUVlduV1dLNER3SWdBQUlnWUJpQkZsclFVRURJLzFFbUJNc013NERxWkVSZy9od01SV1dFdW0wMk42SXQyakxDQTYwSmtBK3U2U0ZURFFXRS9COFFqOVpNOFdrTEFwaE4xUUtPNUVlWExsMldpamtQTTl1a3VDSFNUQUxOL0NBTkJRVCtqNW53OEM0YkF1Zk9uODhtbzRMbHdnc0NMMTZSRTVDQ1ZSWEYxWk5BVXo5SVF3R0IvMFBQVml4S3FXUVh2WjA3TDdkK3BDaGNwTXRKQ2lLN0lGQzJMYVRMaW9obUVtamlCNWtsSU1INkR3eGhtZGtKTXFyVmZNbnB1T2NtSmpJcVlkR3lrZCtjVW5ZQll0RUlvYnpwRW1qbUI1a2xJTFI5Q2Z3ZjZiYUY4YW5mS25zY0xlMERqNVhUczd0SGtzMHA0WSthelJOMzVBamMyRUFiWmdrSUpRMEJrZU9MV0ZNRVpHZGg4VmovNlBFVDRGaEg0SnduNlJ2QzVwUjFKUEUyQ1lGR2s2dG1DWWpUWXRWaGtzd1IxeDRDL0ZldjdOajdPTTd4bnRWUkRvMStOT3RlbEJ0OHVpTUNDQ2dpUUgrT3pEN2FZNWFBQ0RyS1VGR0dTTVpTQW55S1hsbHlHT3ZneUtpbDFCcFhtNDZURnJKSDB5NHNmYUZ4b3JnTEFoSUVPbDMzcS9YUlpnZ0lMeUNrWVlSeS9VTjREd0p4Q2ZRdjZZc2JKWGllZC9LRkgrUTZ1ck0wdFZtV3g2MkxicjZlRUs1QUlDRUJXdDVSUHVKNTNiWEp6QkFRY3FDWGF6L0VOUWpJRXVoZEpIZTJPZnRCaGc0ZGxzM1d1SGdIUitVdHN2NEVKeGthQnhJVlVrS2dma0hoREFIQkFrSWxqSkVJRWJnMXdlRlFveWZnU09kT3hNTlh3NGMvbE9wUFBJeUkweDJsMENGU0N3S1ZTcVczOXVNWkF0TFIwVEZyakt2MllWeURRRlFDOCtmTkU3Si9BZk9ZL3doRVJQRDBYZGxKQmYxOXZRSlRlS1AyVmp3WGtjQXNSL29NQWFHL2VNb1JFOEpqSU5DU0FNM1lFS3NIK2xzKzArckQ0VU8vYWZXeDhaL3hVTjdiSDN3Z1hjOVZBd1BTY1JFUkJKb1JxSGVrVHdzSVZxQTNRNGI3c2dSVzljc0x5Q0VhKzVjOW1FcTJ2RHJGTy92blA5UHdsWnlJOHZEVjZnVHNkZUtBc3VoRm9ONlJQaTBnV0lHdVYwT1pVSnFGUFQzU3cxaVRkSkxlV3dmay93SXZNaisyUHZhLzgyL1NWU2pUN0t1RmttZW9TMmVLaU5ZUW1GOHoyV3BhUUdqSVljYjBMR3Rvb0tLcEVlQmhySUhGaTZYVGYvVlg3d2lleG1wYlNHSjlNS3Y3MXF5eERSbnFteTJCNmJXQzB3S0NHVmpadG9BdHVkMjc1dStrcThwL2lmOTAzMzdwK0VXTXlET3ZrbGdmUEh6Vm4wQzBpOGdNWmM2VUFQOWRPRDNaYWxwQTNJNk9Xek10QmpLemdrQ1MyVmdNaUdkazJiUTZuZGZBeVBvK21OZmFsU3N4Zk1VZ0VGSWpRSC9ZbGNQRXB3VUVNN0JDSkhoVlNZRC9YTm04Zm4yaUpKOG5LOFFHaC9xbjVEaC9OWUh2ZzYyUHUxWXVUOFFha1VHZ0hZSGFtVmpUQWtLUnBzZTEyaVdBejBFZ0RvSGJhVVcwN0pvUXpvY2Q2dis0WjIrY0xBdjNMQTlkN1huekxlbHRTN2pDekRpSno2bHcwRkRnWEFqd1RLd3c0MEJBZms5N1lJVTM4QW9DcWdtb3NFSjRLR3NmT2RWTkRJSGZnK3FXWk5zU1pqeTRZb1dKZUZBbkRRbUVtaEVJU0dlTm9taFlWaFRKQUFKSnJSQkdzSjkrWkljT203ZFAxbHNIRGlSeW5ET2IzbHR1RVd0WHJlUkxCQkJJblVEbjFLNGxnWURVT2tWU3p4a1pXRWxBaFJYQzRKNS9aYi8wOWg0NmdqLzV4ejhHUTFkSnlzYStqOGMyUDVRa0NjUUZnVmdFL0VxbHhCRWdJTEd3NGVFa0JIaU1Qc24ySnB3M1QrMTk2b1dmR1NFaUxCNDdYL3lYSkVpRHVEenpTdmI4bGNTWkl3RWJDVGloMFJFSUNCRW8yMGdCZGM2ZXdOWU5HOFM4dVhNU1pjd3pzbGhFaWpxOWwwWHczVU9IQXZHNGVPVktJaFlMdjlBakhscDNUNkkwRUJrRTRoSndIZWV2T1U0Z0lGZ0RFaGNmbnBjbDhDWGFZbVB6dW1UVGVqbHZGaEdlbVZVMHh6bzd6Tjk2LzMzeC9MNVhSVkx4NEdIQkIyalZPYll0a2UyTmlKZUFRSm5qWHJOQWZCL2JtQ1FnaWFqeENOejM5VFdKcHZYVzVzYU85ZDF2dkNrbUwxMnV2YTNsOWVTbFMrSWxLaXRQMTFVUitwY3NGdmZlaVcxTFZMQkVHdkVJa0FWUzVoamhFQmJXZ0RBTmhFd0k4Ri9PajIzZW5IZ29LeXdzYjdyNC9XZWVGWjlxdW04V0QxbXh2K1A3enp3bmZ2bkJyOE5pSjNybG9hdkhObTFLbEFZaWc0QXNBVm9MRWhnZERtL2pmdFYxUGRtRUVBOEVaQW53Mm82blhuaFJObnJEZUp2V3J3czJFN3h4M3R5R24yZDlrNjBPSG1aVEpSeGNmcDUxOVlNdER5ZWVrSkExQytSbkZBRi9zbHJ0WVFGWlJnSnl4S2lxb1RLRkljQkRVS3I5R0F0TEpjRkNNcmh5UmZCam13Y005blh3dmxaNzN2eEZZbDlIYmZuWmV1TzY4VDhFRU1pUmdIKzFXdTF6am5uZW9IRGRvUndMZ3F3dEovRFRWL2JSQWtHNXc1TmFvY3REU05qaVlPRmdpK09zcDk2d3Y1c1dDejYyR1VOWHJkb2RuMlZDd0JmVjZ0M09jYy9iNkx2dWE1bGtpVXhBb0FFQjN1dHFSNHByTzFoSWVJdnp3VlVyUkg5Zm4zS3JoSzBOUHNQOTBNaG9zSk51MHRsVkRSQUZ0M3IvNmhheDY5Rkg2YXp6Wk5PZ202V1AreUFRZzREdlY2dmJuSTg5YjZ2anVydGpSTVNqSUtDY0FJdklQNUFqL054NTlYKzExeFkyRkJOZTBIZ3JuOXhINGtLS0luaG9LR3Bnd2VCcHhPekRHU1hoNE8zWDB4S05zRXpzTkdmeHdKVGRrQWhlY3lad1RVRCs0SGs3WGRmZGtYTmhrRDBJMEN3cVQreDQ4Y1hVUmFRV05RdklUYlEycFhmUklwb1ZOamNRRkg0TkZqdVNVUHpKbXdnZVo0SDdFdzFKOGJEVStPa3pxUXhQMVphcjlocmlVVXNEMTdvUXFGYXJ1OWdDZVpZc2tDZDBLUlRLWVRlQlBFUkVaK0k4YlBXRGh4K0c1YUZ6STFsYU5ockNldGFsT2VwWVJHaHBCOUN4MnJ4Uy9aKyt0eDE3TzFIakROQkNRUXhiNmRoTFVTWW1RTlBKdTJnWGs0NHU0QUFCblFqY1NFTkkvL1BKN2VKK1MxZFo4enFQQjJpMS9xN3Z3R0d1VTc5RVdXWVNvSDdxZE1JQ21Ra0Y3L1FoOE1pREcyakcwZHpnSEJEcXAxWUVGbzl0R3g3QUZpVld0SGF4SzBtVFNXNTFqbjMyMlpEdy9jRmlWd1dsTjVtQUxYNFJkcGF6djZQM2xrVW1OeWZxWmdvQjN4OXlqbDI0Y0lUcWc3MndUR2xVUSt2QjAyWjUxVHJ2ZTJWYVlLdmovalYvSng1YXZ4NXJQRXhyWElQclF4c3Bqam5ITDF3WW8rR0Jzc0gxUk5VTUluQndaRVM4Uk51RHBMMWVKQ3RrYkhVOHZ1bWhZS0ZqVm5raUh4QlFRUUFDb29JaTBzaUZBRnNqNzlMNTZFVVZrdm0wMlNPZjVYSHZuWGZDNnNpbEJ5SFRwQVFnSUVrSkluNnVCTTdTd2tNV2ttRVNrcUk0MlNFY3VYWVpaSzZRUUNBZzVBTXB5bmRQWWRXUmxFa0VRaUVaT1hsQ1c0c0V3bUZTajBOZHBnajQ3RVNIZ0tBL0dFSGc0dVVyZEU3NlNPQm9QM1htVE81V0NUdkgrL3Q2eGFyK2ZyRjIxU29NVlJuUnkxQ0pHZ0lRa0JvWXVEU0lBRnNsYjlPTUxkNGxOMHN4WWRFbzB5YU5xMGswZU1QR011MnhoUUFDaGhLQWdCamFzS2hXRFFFV0U5NDE5K0RvcUJnankrUlA5SjZEQ3RPYkJZTTNaTHg5Y1o4bzMwekM4YmNEMTNiNHJja2ZseUJnS0FFSWlLRU5pMnExSU1CRFhlTWtKR09uVDR0enROdnVXZTk4c0QwN3oraTZlT1d5dUhUbC84Nkl6VHZ6M3ZnZjU0aDVOSE1xMkwyMzFDTnVLblVIR3h6MkwxNkNvYWtadFBER0lnSVFFSXNhRzFVRkFSQUFBWlVFZkpxSmhRQUNJQUFDSUFBQzhRbEFRT0l6UXd3UUFBRVFBQUVpQUFGQk53QUJFQUFCRUpBaUFBR1J3b1pJSUFBQ0lBQUNyaVBFT0RDQUFBaUFBQWlBUUJ3Q1pIMk13d0tKUXd6UGdnQUlnQUFJVEJPQWdFeWp3QVVJZ0FBSWdFQWNBaENRT0xUd0xBaUFBQWlBUUVDZ0lzU0U2enZPT0hpQUFBaUFBQWlBUUJ3Q2p1OVB3QUtKUXd6UGdnQUlnQUFJVEJOd3E1WEtxZWwzdUFBQkVBQUJFQUNCQ0FTcXZuOEJGa2dFVUhnRUJFQUFCRUJnSmdIWGNieE9XZ2N5TWZNMjNvSEFiQUlxdGo2Zm5TcnU2RWFBZmc4UVFDQVNBWjhza0U3NllaaEFwNG5FeTRxSHFGUFE5dWFlK09qRXllQ1Zyem1jTzMvZWl2cmJYc241YytlS2VmU1B0NjN2cGNPd2J1b3BCZWVjOExrbkNDQlFTNEMxZ3kyUThkcWJ1TGFQQUl2R3lNbVQ0dkRJcUJnNmRKak94TGhpSHdUVXVDa0JGcFAreFl2RjRLb1ZkRVJ2bjRDWU5FVmwwd2MrYWNjcDUyUFAyK3E0N202YmFvNjZYaU13ZWVtU2VQdURYNHUzM3o4QTBVQ25pRVNBeFdUVCtuWEJDWXhmNnVtSkZBY1BHVW5BcDc4a3Z1a2M4N3hCNGJwRFJsWVJsV3BJZ0F3T0VvNERZdisvdmdQaGFFZ0lOOXNSQ0lWa2NPVUtXQ1R0WUpuNXVTK3ExYnVkMzN0ZXVkTjF4OHlzSTJwVlQrQWtIZVA2ei90ZURjNEdyLzhNNzBFZ0xnRVdrcDNmZlZUQUdvbExydkRQKzM2MXV0d1o4N3p1cTY1N3pWTmErRHFoQXEwSXZIVUFWa2NyUHZoTW5zQWpEMjRROTkrNVJqNEJ4Q3dhQVgreVd1MEpwbFljdTNDQkJhUzdhRFZBZWFNVDJQK3JkOFErK29jQUFta1JZTi9JWnZxSFlBVUJmMmxYbDl2SlZTVVZtYUJoY1FpSW9lMyswMWYyaWFIRHZ6RzBkcWlXTGdUNGo1UkxseThMdGtZUXpDWkFlbkdVYXhpc1JNZUdpdVkyTm4rcElSN210cTl1Tlh2cndBZXdkSFZybEJUS3d4c3BjcktCZ0dBL3JCUUlhNUFraHEwMGFBUUxpOEQ5am9VRXdXZ0M0MXk3Y0MrczRBM2ZRRENEd0tlMGNodytEelBhc29pMTJQM0dtMkxreElraUZoMWxqa0NBTmxJOHhZOEZBa0kra1BFSWNmQklnUWpzZk9GbkJTb3RpbW9pZ2VkZjJTOHVrazhFd1RnQ3dTcDBybFVnSVBSZk1KNWxYRFV0clJBUElZUjdXRm1LQU5YV2dBRDNRUXhsYWRBUUtSUWhORG9DQWZsOHlxT2VRajVJTW1NQ1p6RjBsVEZ4Wk5lS3dDL0pGd0lycEJXaFluNTJkV3JVS3BqRys1VlNhWnpXZ2hTekppajFEQUpzZmFnSzlGZUdLTit5U054S3U3SWkyRUdBcCtHZVBlK0pVMmZPQ0pxcW1UaE1VbnBzaFdCOVNHS1VXaVhBbXNFRkNnU0VMOWdrb1E1VDVtdUVZaEpnNjBQRmxOMzVjK2ZRcXVJN3hYMzBqNjhSN0NQQUlqSjgrTEI0bC82ZG8rc2tnYTBRWHFYT1c4VWpGSjlBdUFhRWF6SXRJTFFqMmxIaCsrWGlWOC9lR296U0dSNUp3MXJhSE8rUkJ4K0VjQ1FGV2ZENEMra2NFRjVaUHJoeXBXQ3Jkb2lFUkRhd0ZjSi8yR0NyRTFtQ2VzV2pQYkJPaFNVS2ZDRDhCbXRCUWlURmZVM3lKZWRhOHcvRzQ5L2VEUEVvYmhkUVhuSVdrc2UvdlNueEVOVEJrUkhsWlVPQytSRGcwYW93NTJrQm9SdkIwdlR3QTd3V2l3QVBYeVd4UUxDUFViSGFPK3ZTY3Y5SVlrSHdDWmR3cG1mZGFxbms1enNkSGNOaHl0TUNjZ01FSkdSU3lOZHhjbnJLQmo2MkZFNU9XWHIyeE51NllZTW9TMDZvWUlmOFFUcnhFc0VBQXBYSzlJeXJhUUdoYW8wYlVEVnJxekNTd1AreGVSMTJVTFcyNDhTb09CK0x2aTNCUm9sSi9zaUpVVXc4bWpLQnlScGpZMXBBZWt1bGlkcXhyWlRMZ09RVkU1RDljckwxc1hiVlNzV2xRWEttRXJpOXIxZndJVkl5NGF5SDljb3kzSFNLd3pPdzdpQ3RDTXMwTFNEQkRaNkpoVkJJQWhjdlg1RXE5OWY2KzZYaUlaS2RCQnd5UTFZTnlQV1pVM1FhSmtLeENkVE93T0thekJBUXYxSjVyOWpWczdmMFo3M3pVcFh2WDl3bkZRK1I3Q1V3SU5sbkxsNlIreVBIWHRKYTFueUdrVEZEUURDRXBXV0RSU3JVSlVrTFpCNFdkMFhpaTRldUUvaGlxZWY2bXhoWEVKQVlzUFI4MUNmQm1HRmt6QkNRRGlHRzlTdzNTcFVXZ1lVOWNqOEdhWlVINmVwUEFMc1Q2TjlHYVpXdzFvSE9lY3dRRURqUzA4S09kRUVBQkVDZzJBVElnVDVlNjBEbjJzd1FrS0I2Y0tRWHU1VlJlaEFBQVJCSWdRQTUwSDlibit3c0FZRWp2UjRSM29NQUNNd2d3S3NDRVd3ajRGT3pEOWRYZXBhQTBBTXp2T3oxRWZBZUJFREFiZ0xZa3NUTzlpY2ZlWHNMaExibmhZQlkxRDk0RHkwRUVJaEQ0QkttNDhiQlpjeXo5UTUwcnRnc0M0UWQ2WFFmSWxLd1pwZGRIY3dIQ0NHQVFCd0NGeTlmaXZQNDlMTUx1N3VucjNGUkxBTDFLOUREMHM4U0VQNkFuQ1V6NXZxR0QrUFZQQUxZWHNLOE5rMjdSbWNuK0cvTStHRWVEaWVMRDAyWEdFMDBvYUdBME0xaFhjcU5ja1FqSUx0TDZsaUNYWHlqbFF4UG1VWkE5b1JDbkVoWTJKN0FXN2dQTlNwOVF3SEJnc0pHcVBTK04yK2UzSEdoNDlpZlNPK0cxYXgwUHMzRmtUMTNSdmFQSE0wUVdGbWN5VXJsL1VZVmJ5Z2c4SU0wUXFYM3ZkNUZOMHNWY1B6TUp6am9SNHFjblpGNEJwYjh6cy9ZOWFDSXZhYVovNFByMGxCQStBUDRRWmhDY1VMdm9sdWtDNHVEZnFUUldSY3hTVjhwUy82Ull4MWszU3JjeFAvQnhXd3FJUFRCc0c3MVFIbWFFMGp5NVV4NmxucnpVdUVUa3dqd1NySkRveDlKVlltM2dlK1ZQTTFRS2tORVVrV2dxZitETTJncUlQQ0RxT0tmVFRyc29KUWRZOFl3VmpadFZQUmN6cDcvc3pnNEtuY3NiWG5SbHdXYzZNWHNBYzM4SDF5YnBnSVMrRUVjWjdpWVZiYXoxTEpuZS9DNDlsc0hQckFUR21vZG1ZQ3M4NXd6R09oYkhEa2ZQS2dSQWQ4ZnJ0OUFzYlowVFFXRUg2cmlnS2xhVnRwZmYyMWdRTHFNYjVPQVlJc0thWHpHUitUWlY2Kys4MjlTOWFSemhzUkt5Vk1NcFRKRUpGVUUvSXJ2djlFcXNaWUNRaDhPdDRxTXovUWl3SDRRMmNWYXNFTDBha3ZkU2pOOCtEZmlyT2RKRldzK1RURWZXQXdMUkFwZXpwRklBMW91S204cElFdExwV0Vxdjl5eTA1d3JibVAyUE1hOGR1Vks2YXJEQ3BGR1ozVEVULy84WjdIL1YrOUkxM0Yxdjd4bExKMHBJaVltUUhNbXhtOHJsVnB1YTlWU1FMZ0VOSjEzYitLU0lJSE1DQ1FaeG1JckpNa1BSV2FWUkVhWkVtRC9tS3oxd2NOWGQ2MWNubWw1a1prYUFnNzVQOXFsMUZaQXFBTzgzaTRSZks0UEFYYWt5ODdHNGxyd2o4WElpUlA2VkFnbHlaVUFXeCsvL09EWDBtVzQ2UXM5R0w2U3BwZHJSRis0YnR2Zi9yWUNNclc5TzRheGNtM0xlSm12WGJVaVhvUzZwNTkvWlQ4YzZuVk1iSHc3ZWVtUzJQbml2eVNxK3FaNzdra1VINUh6STdCMHdZSTMyK1hlVmtDbXB2TzJIQWRybHdrK3o1WUErMEZrbmVsY1VoNnV3RkJXdG0ybVcyNDg2Mm9mK1Qxa2g2NjRQZ3ZKK2xpN1N0NG5weHNUbThwVHJWWmJ6cjRLV2JRVkVINlFqcm1GSHlRa1ZvQlhkcVkvY09lZGlVcktRMWxZRzVJSVlXRWprL00wK0FNaXlkQVZWeDdXUjNHN1FJZnJ2aGFsOUpFRTVBYjRRYUt3MU9xWisrNWNrOGdLNGNyc2Z1Tk44VHY0UTdScTF5d0tNM0w4dU5ndnVlWWpMQitzajVCRU1WLy9VcTIySGI3aW1rVVNFS3hLTDE0bllDdGs4N3IxaVF2K2t6MHZTKysrbWpoekpKQTVnWk4vL0tQZ05rOGFZSDBrSlpoai9EYXJ6MnRMRmtsQU9BS0dzV3F4RmVQNi9xK3ZFYkxibTRRMTVLbTkvN2g3ci9nVVo2ZUhTSXg5NVJsWFA5bjd2OFRGaEdlZXcvb29kQmZ4YWVQTFBWRnJFRmxBcG9heE1Cc3JLbGxObnR1OFBya1Z3bzdVblMvOERDS2lTWnVtVVF5MlBIakdWUktuT1plTGQ5M2Q5ZWlqYVJRUmFXWkVJT3J3RlJjbnNvQmdObFpHcmFjNEc3WkE3aWQvU05MQVB5emZmK1k1REdjbEJhbGgvTitSejBPRmVIRFZOcTI3Unl6c0tXbFlTeFFwQ2dHZWZkVnE4OFQ2TkNJTFNCQ3hVdGxWbndEZTYwOWcwL3AxaVJZWGhqWGs0YXovOXZTem1KMFZBakhnOVJmdnZ4K0lSOUpoSzBiQlExZmMxeEFLUzhCM096cDJ4eWw5TEFIQm9zSTRhUFY1bGgzcVA5eTZKZkdzckxCR1BEdUwxd2p3ZEUrRVloTGdkUjR2VVR2dWVmTXRKUlhnRFJNeGRLVUVaVzZKOE41WFVSWVAxaFl3bG9Ed01CYjJ4cXJGVjV4ckhsWlFNU3NyckRFdk5Oenh3b3Z3aTRSQUN2VEt6dklkTC81TThPYVpLZ0w3UGI2OWJoMkdybFRBekRHTktIdGYxUmN2bG9Cd1pPeU5WWSt3T085NVZwWUtmMGhZWXo1Z2lKM3JRNGNPaDdmd3FqRUJQcEtXL1Izc3kwcHlPRlI5RmRudmNhOENQMXQ5dW5pZktRRmYrUDdMY1hNa1BZZ2ZqbDI0Y0lSaUxZc2ZFekYwSVBBVVdRNHFmMEM0VHJ4OXlrUHI3eEZmNnVuUm9Zb29ReDBCM3RlS2h4MlRyaTZ2UzFZTUxGa3NkbjBIczY3cXVSVHRQZjF0TVhaYlYxZGYzSExIdGtBNGc2ajdwTVF0REo3UGhnRDdRMjVTUEZObTZQQmhXQ1BaTkYrc1hOalhFVm9kcXNXRG5lWS8yTElsVm5ud3NKWUVmQktDblRJbGs3SkF4anl2KzZycnloMVBKbE5LeEZGTzRPeDVUenoxNG92aUhMMnFEckJHVkJPVlM0OTlIYy92ZjFXNXRjbWxZZkZncHptbTdNcTFqV2F4L0t2VmF0OVhTcVh4dU9XU0VoRE81TmhubnczUm1ObGczQXp4dkQ0RTBoUVJyaVg3VzNoc0hNTmEyYlk1RDFmeFJwaXlaNWkzS3kzRW94MmhnbjN1Kzd1WGRuZHZreW0xdklCNDNpQWRPRElra3luaTZFTWdiUkZaV0NxSlFkclNlM0RsQ2doSnlzMGVDc2N2U1R4VXJPdG9WRnlJUnlNcWhiN25rMC9pN3FuankyTlhSRnBBT0NjNDAyUHoxakpDMmlMQ2xZYVFwTmYwV1FoSDBJWVl0a3F2RVhOS1dkWjVIaFkzbVlCNDNuYXlRcDRKRThOcmNRbXdpUHg0ejE0eGR1Wk1xcFdZUDJlT1dEMHdnQmxiQ1NtemMvd3NiWEE1ZFBnM0lrMkxJeXhtNzEvZEV2Zzg1cytkRTk3Q2EvRUorQ1FBVzVkMGRiMHNXNVZFQWpMbFRCK2p6THRsQzRCNGVoSGdWZVpaSFNTMWVxQS9tUDY3cXYvMllCTSt2VWpvV1JvV0RqNnpudjBicXFkaU42b3gvMER3cVlKYk4yd1FFSTlHaEFwOXp5UG4rWElaNTNsWTYwUUN3b2w4N0huUE9xNzdSSmdnWG90UGdGZVo4NXFCckFJUGIvVXZYaHhZSlF0TFBTUW1XZVZjakh4QzBXREJ5TUxhQ0tud0NuTmVKSWo5clVJaWhyMG1jSjZISkJKL1ZYL3ZlZVZPMTJVckJNRWdBZ2RIUnNSTGIvNGlsV20rclREMUxsb1VPTnhYa1hYQ3dzSS9ZamFHWUlpS2RrRG1JYXFQeU9MSXd0cW81Y3g3Vy8xd3k4T0JzTmZleDdVeEJLU243dFlTVVBMdHhKVGVXcVRtWEdmbEYybEdqQVdFaDdsWVRQcjcrdml3Q2Q1S3g4aEF6a3c2dGUzYThOU2hrVkZ4YVBTanhHZHp5SUJpdnYyMHV2eXhUWnV3eGtNR1lGSGlLTEErdUtwS3ZvL0hNS1czS04xR3FwdzhwTVgvZ2g4NXFSU1NSMkxuZS9tV1JXSjFmMy93V25SQnFSV004ZE5ueEtHUFBoTDhtdGIwMnlndHdOYmV0ZzBQWUYrcktMQ0svVXlpcWJ1MVZWY2lJSndnckpCYXJPWmRmMHF6dEhha3RISmRobFlvS0R6a3hmNFQzcHFsZlBQTldsb3BaRmhRb0ZsVE5DVEZRMUduYUtZYnozYkxXekJxdWZNc3E4Y2Vla2owa2tnam1FMkF1dU1SMnZkcXVZcGFxaE1RV0NFcTJrUDdOSFN3UnBwQkNrV0Z6ejhwazdEd1A1NDV4TUxDOTRLUXdqQllhRTF3K256b0ZndkZxVE9maUVtNkh2L2tFM0dLTEF1ZWNwdW5kWEd0OHJQL1oxL0hBMnZXMEFRR0hBUTFtNDZSZHhKUDNhMmxva3hBT05HUEwxd1lvd1RMdFJuZzJqd0M3QnRoSWVFTkZJc1UyS2ZDbGdxTHlUejZ4Kzg1aEs5OHpmZm4xYTUxSVBQaFQ5NEVmeFFFRm90ekpCRGhLOTg4UitMQWU0cXhlT2dvRWtIQjYvN2o0YXJiKzNyRjQ1czN3OWRSeDhia3Q5UnZwWGJkYmNaRXJZQjQzbGFhMHJ1N1dXYTRieFlCUGdkazN6dnZaRDVUeXl5SzJkZUd0eU41Zk5ORG1HR1ZQZnE4YzFScWZYQmxsQW9JSndncmhDbllGU0FreFdodkhxN2lrd054K0ZNeDJrdDFLVlZiSDF3KzlRSUNLMFIxdXhjbVBRaUpuazBWK2pudXZmTk9yQ2JYczRteUtKVnk2NE1MclZ4QU9GRllJVXpCM2dBaDBhUHRJUng2dElNT3BVakQrdUI2cFNNZ3NFSjA2RE81bHlFVWtqK1JnNWs2TUVJR0JOZzUzcis0VHd5dVdCRnNXb245cXpLQXJuOFdxVmdmWE8xVUJJUVRoaFhDRkJDWUFLOTlZREVacGxsYkVKSjAra1FvSEx4M0ZhK0xRUUNCa0VCYTFnZW5uNTZBd0FvSjJ3K3ZVd1I0K3U4bzdldkVNN2RnbFNUdkZvRm8wRlRjQVJJTStEZVM4elEwaGRTc0QrYVZtb0J3NG5UZzFJZjBjZ2RmSTRCQUxRRmVpZjMyK3grSWtaTW5JQ2ExWU5wYzh4ZDJIczJtdW52RlN0b2o3SFpZRzIxNDJmNXhtdFlIczAxWFFMQTYzZmIrRzZuKzRSQVh4S1F4THJZMGdvMGxhUjh3aUVaalJyamJrRUNxMWdmbm1LcUFjQWJZSTRzcElFUWx3SmJKNlBFVDR1RG9xUGpvNUZpd1E2MXRmcFBReXVpbExWaFdrV2lzL3R1QkdhdmxvN0xFYzVZVDhQMFBsM1ozcjBpVFF2b0NBaXNremZZelBtMjJUdmdFUHZhZG1Db290WUxCRG5DZVJWVmVkQXZXYkJqZnUxT3RvSkx6UHRxVk1IVUI0UUljLyt5em45TUJPZDlzVnhoOERnTHRDTENnakowK0xjWnBzMEsyVms3UlpvVjhqa1pSckpUZ0MwZERVdVZGTjEvYjhKR3NERDUvZzNjVlJnQUJaUVFVbmZmUnJqeVpDTWpVcVlWSHFEQTRPNzFkaStEejJBUllTSGhEd3pFU2xYRzY1dGxlNTd6ejR0TGxLOU5wWlNrd29Vandwb3pzdStCZGdXK2kxK0NhdGt1SFdFdzNDeTdTSVpDSjljRkZ6MFJBT0tNL2VONU8xM1YzOERVQ0NHUkI0Q0lKeU5rcEllSHQxSG1iZFJhVnlTdVhBOEhoTXZCMFlnNHNNT2NtcnUrNkc5eXMrMjloOTlUZlAyUkJmTEhVSFh4NXZ0alRJMjZjYzIwSFh4WUlYcmgzRTkzanM5MnhpSzhPSU41bVFZQVBpOXExdEZUYWxVVm1tUW5JbU9kMVgzWGRrMVNwYTN0b1oxRTc1QUVDSUFBQ0ZoR2dQNFRHTGxhcnkrOG9sVnIvTmFTSWlhc29uYmJKOUZLRi9HcjF5YllQNGdFUUFBRVFBQUVaQWo3OW9PL01Tank0Z0psWklDRU5tdGI3TGprOTE0YnY4UW9DSUFBQ0lLQ0FRQWJUZHV0TG1aa0ZFbWJzVnlxd1FrSVllQVVCRUFBQk5RVDhxNzcvOTJxU2lwNUs1Z0p5VzZsMGxKdzh6MFl2SXA0RUFSQUFBUkJvUWNBbjk4QnpYeW1WeGxzOGs4cEhtUXNJMTZKVGlGM3M3RW1sUmtnVUJFQUFCQ3dpUUwrbDR4ZnBOeldQS3VjaUlPeFFkNnJWYlhsVUdIbUNBQWlBZ0VFRU1uZWMxN0xMUlVDNEFEUlBlVmc0emxCdFlYQU5BaUFBQWlBUW1RQnR3ZUR2V2RMVjlYTGtHSW9mekUxQXVCNVhLeFcyUXE2dDVGSmNNU1FIQWlBQUFpWVQ0S0VyY3B6L0tNODY1aW9nZ2RPbldzMFZRSjd3a1RjSWdBQUlTQklJaHE3eWNKelhsamZ6ZFNDMW1ZZlhXQnNTa3NBckNJQUFDTFFsRUF4ZDBWYnRQSUtUYThqVkFnbHJqcUdza0FSZVFRQUVRS0ExQVIyR3JzSVNhaUVnR01vS213T3ZJQUFDSU5DU2dCWkRWMkVKdFJqQ0NndURvYXlRQkY1QkFBUkFZQllCYllhdXdwSnBZWUdFaGVtc1ZMNUYxNWlWRlFMQkt3aUFBQWhNRWRCcDZDcHNGSzBFaEJjWTBqWW5MQ0lJSUFBQ0lBQUMxd2xvTlhRVkZrc3JBZUZDQlFzTXNWZFcyRDU0QlFFUUFJRmdyNnM4Rnd3MmF3S3RmQ0JoSWZud3FjOWQ5ME1xWEc5NEQ2OGdBQUlnWUNNQkdybzZlVnRYMTJJZDY2NmRCY0tRZUNpclVxM2VUWmZ3aCtqWWExQW1FQUNCckFoNDlGdjRqYXd5aTV1UGxnTENsY0RVM3JoTmllZEJBQVFNSThCRFY3dnlYbTNlaXFtMkFzS0ZKbi9Jc3pnN3BGWHo0VE1RQUFGRENRUitEem8vNlRtZDY2ZTFnREE0bkIyaWMvZEIyVUFBQk5JZ1FINlBzYnpPK0loVEgrMEZCUDZRT00ySlowRUFCQXdnRVBnOTd1QmxEWm9IN1FXRStmRVlJSTBGNGl4MXpUc1RpZ2NDSUpDWWdFK3pUN2ZyN1Blb3JXRWhCSVFMVEdPQmU4Z2ZzcXUyOExnR0FSQUFBWU1JK1B3YnArTjZqMmFNU2V5S0ZiQmZWckhhQzZVRkFSQ0lSc0R4L2RlV2RIY1hhaWVPd2xnZ1lSUHdmbG5zWUFyZjR4VUVRQUFFaWs2QWY5TSs5LzNDRGRNWHpnTGhqdko3enl0MzBrcDF1aXdWdmVPZy9DQUFBdFlUOEs1V3E4dUw0dmVvYmEzQ1dTQmMrQUQwdFUwWFNiZ1JRQUFFUUtDd0JIeGFhZjVJRWNXRGlSZFNRTGpnVTVzdUZzN2s0N0lqZ0FBSWdBQVJDSnptZjFNcXZWRlVHb1VWRUFZK3RWSWRNN09LMnZ0UWJoQ3dsMEFnSHZRYlZ1amZyMEw2UU9yNzNNY1hMdXltaW15dHY0LzNJQUFDSUtBaEFkNm1aQzh0VFhoRXc3TEZLbEtoTFpDd3BqZFVxOStqNnlQaGU3eUNBQWlBZ01ZRWp0STJKZnliVmZoZ2hBWENyY0F6c3pwYzkxMnFVRy9oV3dVVkFBRVFNSklBVDlmbG95cUs2alN2YnhSakJJUXJCaEdwYjE2OEJ3RVEwSVdBYWVMQlhJMFNFSzRRMW9nd0JRUVFBQUdkQ0pnb0hzelhDQjlJYlVkaDA1QWNWSGZUUFp4bVdBc0cxeUFBQW5rUk9FOTdYSDNMbEdHcldvakdXU0JoNVQ3MnZHWE90ZFhxeHRZeHJDdGVRUUFFdENYQU02NlcwNHlybzlxV01FSEJqTE5BUWhiY1lOUncyK2c5VnF1SFVQQUtBaUNRSlFIZm9WWG1wb29IZ3pUK3IzT3lSTGFTSmZLU0RYWE44cHVCdkVBQUJGb1NDTVJqU2FtMHQrVlRCZi9RZUFIaDlvR0lGTHlYb3ZnZ1VDd0NWb2dITjRrVkFzSVZoWWd3QlFRUUFJR1VDVmdqSHN6UkdnSGh5a0pFbUFJQ0NJQkFTZ1NzRWc5bWFKV0FjSVVoSWt3QkFRUkFRREVCNjhTRCtWa25JRnhwaUFoVFFBQUJFRkJFd0VyeFlIWldDZ2hYbkVTRTE0bThTNWM0MVpDQklJQUFDTWdRT0UvTEJiNWg4bFRkVmxDTVhRZlNxdEw4MmRRNmtidDVpNEYyeitKekVBQUJFR2hBd0dyeFlCN1dXaUJoWjhBR2pDRUp2SUlBQ0VRbFlPcmVWbEhySHo1bnZZQXdDSWhJMkIzd0NnSWcwSTRBeE9NNklXdUhzSzRqRUlJM09lTTkrdWtlRHFXcUJZTnJFQUNCV2dLa0hlS0lTZWQ1MUZaTzVob0NNa1dOUmFTVFJJUjZ5QjRaa0lnREFpQmdOSUhnR05wSmd3NkRVdEZhR01KcVFQR1k1KzBVcnJ1andVZTRCUUlnWUI4Qm43WmozN1cwVk5wbFg5VmIxeGdDMG9UUGxJZzhSUitEVVJOR3VBMENGaEJneStON05HdnpPUXZxR3J1SytIRnNnZXk0NTIzMHIrM2tpN1VpTFRqaEl4QXdsQUFmQlBYM1pIa01HMXEveE5XQ2dMUkJpQmxhYlFEaFl4QXdrQUQ1UWsrU3Mvd2JKcDRpcUxLNTRFUnZRek9jb2VVNHptdHRIc1hISUFBQ3hTZmdDOThmdWxpdHJvQjR0RzlNV0NEdEdVMC9BYi9JTkFwY2dJQ0pCT0FzajltcUVKQ1l3S1kyWW55YW9zRXZFcE1kSGdjQmpRbDRkUHpzOTB3L1FWQTFmd2lJQkZINFJTU2dJUW9JNkVuQUozL0hHUHdkY28wREg0Z0VOeDRidmFGYVhVNHpOSjZsNk5UL0VFQUFCQXBJZ0tmb1BnZC9oM3pMd1FLUlp4ZkVKTC9JZGxwMHlPdEZNS1NWa0NXaWcwQ0dCRHdTajExWTM1R01PQVFrR2I4Z05vYTBGRUJFRWlDUURRRU1XU25rakNFc0JUQjVTT3UycnE0K0RHa3BnSWtrUUNBOUFoaXlVc3dXRm9oaW9EeExpNGUwQ0d5djRxU1JIQWlBZ0R3QnJDcVhaOWMwSml5UXBtamtQcUF4MVQyODNUT05yKzZoRk9CZ2w4T0lXQ0NnaWtDd01KQjIwVjJNTFVsVUliMmVEaXlRNnl5VVg4RWFVWTRVQ1lKQUhBSndsTWVoSmZFc0JFUUNXcHdvN0dDL3dYR2U5aDFuSThVRDd6anc4Q3dJeUJGZ3EyUDRxdTl2dzNZa2NnQ2p4c0lQV2xSU0NaK0ROWklRSUtLRFFEUUNzRHFpY1ZMeUZBUkVDY1pvaVFUVGZZWFk0Ymp1Rm9vQjl0R3c0U2tRaUVMQWQzei85Yzk5LzBsWUhWRndxWGtHUDJKcU9NWktCZFpJTEZ4NEdBUmFFZUIxSGVPMGo5VTJPTWxiWVVybk04ekNTb2RyeTFSNXBoYTJRbW1KQ0IrQ1FCUUM0YnFPNVJDUEtMalVQd01MUkQzVFdDbnlzRmFuNi82Y0lpMmpmMmlQV1BUd3NLVUVBaWU1VDhOVjlNZllVVXNaYUZGdC9HQnAwUXhDWUZoTGs0WkFNWFFtd091cUp1aEhhL3VTcnE2WGRTNm9MV1dEZ0dqVTBvRTFJa1N3a3AyS2hiYlJxRzFRbE53SmVMUlYwSE9UUWp4M1I2azBrWHRwVUlDQUFINmtOT3dJbUsybFlhT2dTSGtSd095cXZNaEh5QmNDRWdGU1hvL0FQNUlYZWVTckFZSEF6MEVMQW44RUI3a0dyZEdrQ0JDUUptQjB1bDNqSHlsVHVkQm1PalVPeXFLYUFQczVqdEp3MVpNUUR0Vm8xYWVISHlQMVRGTkxFVUtTR2xva25EK0JZRDBIclN2WUNRZDUvbzBSdFFRUWtLaWtOSG9PUXFKUlk2QW9TUWxBT0pJU3pERStCQ1JIK0VtemhwQWtKWWo0T1JLQWNPUUlYMVhXRUJCVkpITk1CMEtTSTN4a0haY0FoQ011TVkyZmg0Qm8zRGh4aThaQzRqak9meFdPZzFYdGNlSGgrYlFKWUZaVjJvUnpTQjhDa2dQMHRMTTg1bm1ETkpWbEMzYjlUWnMwMG85QUFNSVJBVkpSSDRHQUZMWGxJcFM3WmtIaWcvUjROLzFEZTBmZ2hrY1NFd2kySEtGam5mZFdhT1U0dGxkUHpGUGJCUENEb20zVHFDdllsSkFNQ3RkOWlocThUQ21qM2RYaFJVclhDYkMxY1pTR1VmZjhwVnA5R1Z1T1hBZGo2aFYrU0V4dDJTYjFxaHZlNHFmUUI1cXd3dTNJQkRCTUZSbVZXUS9peDhPczlveGNHMWdsa1ZIaHdjWUVBbXVETEk0M3NNRmhZMEEyM0lXQTJOREtiZW9ZV2lVMHhIVVhkWWd5UFk1KzBZYVpwUjlQK3phb2c3eUJyVVlzN1FVMTFjWVBSUTBNWEFweDNQTTIwalRnaDMzSDJUakZBMzNFN280UmlBYjdObmhqUTdJMmpzSzNZWGVIcUswOWZoeHFhZUI2bXNBUnordWVMOFJHY29nK1RJSXlPUFVCK3NzMElhTXZwa1dqNnZ0N0w1RzFBZEV3dXIybEs0Y2ZCR2wwOWtRTXhjUjFuQTJ3VEl4dGQ0aUdzVTJiWHNVZ0lPbXhOVFpsSHVhcUN2RmdqYytFNjRxK1ZMd1duK0hUd1BCVThSb3c3eExqUzU5M0N4UThmOW8rWlZrSE9kOXBxT05CREhWcDM1Z3NHSUo4R2NQMDd6MjZlZytPOElBSS9wTWtBQUdSQklkb3N3bndVTmQvRW1LUXJKTzd5SGR5MTlTZVhQd2crdGxzWEZuY0NRWGpxRStDUVkwd1RGYkdlL0JuWklIZWpqend4YmFqblhPcFpRdEI0ZktnNzZsdGxXdGl3V25TakNrSWhscTRTSzB4QVh5SkczUEIzUlFJc0tEY0tNUXkxM1cvU2o5d2QxVnAxMkRxZ09XcHJOQVhvek9mRmd2aU9FNm4rQjBsYTIrWTlwNzZQL0JqUkllSUo1TVR3SmMyT1VPa2tJQkFLQ28wN0RYWTRUai9oWDRaeXpWRFg1eXk3WDIwbVZpY3duQlVnbzZIcUVvSTJQN2xWQUlSaWFnbEVJb0tkYzV1OXFmUTlPRmJHd2dMWjJwSy81MFdDYTVVYUZYUXhJUlQ5TUZScXVSdkx3b3hEdDhGMDBIUWlZQXBYMENkbUtJc0tSSVk4N3p5VmJKU1dGRDRING5MWDFOMlpmclhYV2U1MUpZaXIzNCtReGltQ2pSQkFqRkJCUnFuOStNc0VuUjlpb2FoSmpwSUxIcExKYjZQQUFLRklKRFhGNnNRY0ZESTRoRmc2NFZXMEplcFkzZnpQN0pndWxsbzZMcUxab1oxOFQxNnoyZWpjS2k5SnYxeHlueXpYV0FMb2ZZWlNqTjhIN3pTNXhjb0R4YUpVL3djZjk1Si95Ym9IcXdJSm9KZ0NvSC9EM1krcjcrNVEwQ3RBQUFBQUVsRlRrU3VRbUNDIi8+CjwvZGVmcz4KPC9zdmc+",m="data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSItNiAtNiAzMiAzMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSIxMCIgY3k9IjEwIiByPSIxNiIgZmlsbD0iI0UxREZERCIvPjxwYXRoIGZpbGw9IiM2MDVlNWMiIGQ9Ik0xMCAyQzcuNzkwODYgMiA2IDMuNzkwODYgNiA2QzYgOC4yMDkxNCA3Ljc5MDg2IDEwIDEwIDEwQzEyLjIwOTEgMTAgMTQgOC4yMDkxNCAxNCA2QzE0IDMuNzkwODYgMTIuMjA5MSAyIDEwIDJaTTcgNkM3IDQuMzQzMTUgOC4zNDMxNSAzIDEwIDNDMTEuNjU2OSAzIDEzIDQuMzQzMTUgMTMgNkMxMyA3LjY1Njg1IDExLjY1NjkgOSAxMCA5QzguMzQzMTUgOSA3IDcuNjU2ODUgNyA2Wk01LjAwODczIDExQzMuOTAzMTUgMTEgMyAxMS44ODY5IDMgMTNDMyAxNC42OTEyIDMuODMyODEgMTUuOTY2MyA1LjEzNDk5IDE2Ljc5NjZDNi40MTY5NyAxNy42MTQgOC4xNDUyNiAxOCAxMCAxOEMxMS44NTQ3IDE4IDEzLjU4MyAxNy42MTQgMTQuODY1IDE2Ljc5NjZDMTYuMTY3MiAxNS45NjYzIDE3IDE0LjY5MTIgMTcgMTNDMTcgMTEuODk1NiAxNi4xMDQ1IDExIDE1IDExTDUuMDA4NzMgMTFaTTQgMTNDNCAxMi40NDY3IDQuNDQ3ODYgMTIgNS4wMDg3MyAxMkwxNSAxMkMxNS41NTIyIDEyIDE2IDEyLjQ0NzggMTYgMTNDMTYgMTQuMzA4OCAxNS4zNzc3IDE1LjI4MzcgMTQuMzI3NCAxNS45NTM0QzEzLjI1NjggMTYuNjM2IDExLjczNTEgMTcgMTAgMTdDOC4yNjQ4OSAxNyA2Ljc0MzE4IDE2LjYzNiA1LjY3MjYyIDE1Ljk1MzRDNC42MjIyNiAxNS4yODM3IDQgMTQuMzA4OCA0IDEzWiIvPjwvc3ZnPg==",u="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAYAAAB5fY51AAAABGdBTUEAALGPC/xhBQAAIGhJREFUeAHtnQl4VuWZhj8IJCxhDZAERGQT12rVuuCCgChWQVu7zkwvO52pV2eKgKJtHTdwA3cExNmns9aZ6bRVtC6I+9YZF1wAQXErJiEJW9gCBJj3OeFUCX/Iv5z35Lzne97raiNZzv9+9/N8z/+d85+lw+iFq/c6FgmQAAkYINDRQI9skQRIgAQCAgwsGoEESMAMAQaWGanYKAmQAAOLHiABEjBDgIFlRio2SgIkwMCiB0iABMwQYGCZkYqNkgAJMLDoARIgATMEGFhmpGKjJEACDCx6gARIwAwBBpYZqdgoCZAAA4seIAESMEOAgWVGKjZKAiTAwKIHSIAEzBBgYJmRio2SAAkwsOgBEiABMwQYWGakYqMkQAIMLHqABEjADAEGlhmp2CgJkAADix4gARIwQ4CBZUYqNkoCJMDAogdIgATMEGBgmZGKjZIACTCw6AESIAEzBBhYZqRioyRAAgwseoAESMAMAQaWGanYKAmQAAOLHiABEjBDgIFlRio2SgIkwMCiB0iABMwQYGCZkYqNkgAJMLDoARIgATMEGFhmpGKjJEACDCx6gARIwAwBBpYZqdgoCZAAA4seIAESMEOAgWVGKjZKAiTAwKIHSIAEzBBgYJmRio2SAAkwsOgBEiABMwQYWGakYqMkQAIMLHqABEjADAEGlhmp2CgJkAADix4gARIwQ4CBZUYqNkoCJMDAogdIgATMEGBgmZGKjZIACTCw6AESIAEzBBhYZqRioyRAAgwseoAESMAMAQaWGanYKAmQAAOLHiABEjBDgIFlRio2SgIkwMCiB0iABMwQYGCZkYqNkgAJMLDoARIgATMEGFhmpGKjJEACDCx6gARIwAwBBpYZqdgoCZAAA4seIAESMEOAgWVGKjZKAiTAwKIHSIAEzBBgYJmRio2SAAkwsOgBEiABMwQYWGakYqMkQAIMLHqABEjADAEGlhmp2CgJkAADix4gARIwQ4CBZUYqNkoCJMDAogdIgATMEGBgmZGKjZIACTCw6AESIAEzBBhYZqRioyRAAgwseoAESMAMAQaWGanabrS4qIO7acIAN6KsuO1fTvFvYPyzhAN4sNJFgIGVEj0xOW8/v9yNH1Hq5k2u9Da0EFYY/znCATwYWikx+L5hMLBSoCcm5RyZnCcP7haMpleXIi9DKwwrjB8FHuDC0ApwpOL/GFjGZewsCs6eWO5O2RdW4XB8C62WYRVyABfwASeWfQKU0bCGzWFV4U49tHll1XIovoRWa2EV8gCf2RMrGFohEMNfGVhGxeskyt0mk/C0IZnDKhxW2kOrrbAKOYATeIEbyy4BymdQuyCszit3o9sIq3BoaQ2tbMMq5ABetwk3hlZIxN5XBpYxzTDZbpVJd/ph3XPqPG2hlWtYhbDADfwYWiERW18ZWIb0KhK1bjm33J2RY1iFQ0xLaOUbViEH8ANH8GTZIkDJjOgVhtWZQ3NbWbUcnvXQKjSsQh7gyNAKadj5ysAyoBXC6uYJ5e6sAsMqHKrV0IoqrEIO4AmuXGmFRJL/lYGVcI1wdcmscwa4McMKW1m1HKa10Io6rEIe4Aq+vIonJJLsrwysBOsThJVcEzd2eKlKl2FoDendWWX7UW0U/eFyG/SrUeCLaw8ZWhp0o90mAytanpFtDZNnpmJYhY1+tH6nW7ulKfxnIr+iP/SpWQgt8GZoaVIufNsMrMIZRr6FjhJWN8huyjillVXY8NKq7W7GozWusWlv+K1EfkV/6BP9ahZ4gzv4s5JJgIGVMF0wWW4cPyC424Bma29XN7qrDIRVyAChhX7Rt2bhLg/gz9DSpJz/thlY+bOL/C8xSa4fJ2E1UueYVdjwOzWNsmKpdtsTvrIK+w2/ol/0jf41C/yhA0NLk3J+22Zg5cct8r/CXsh14/q7cw/XD6srH6l223YlezewNcDoG/1rhxZ0gB7cO2xNifb5PgOrfbjv96phWJ13eI/9vh/1P96VlYnlsAp5hKGF8WgW9GBoaRLOfdsMrNyZRfoXCKtr5Z184ijdsFq2ttFdYXhl1RI6Qgvjwbg0C7pAH660NClnv20GVvasIv9NTIJrxvZ35yuH1fIgrGrM7ga2Br45tGocxqdZ0Ac6MbQ0KWe3bQZWdpxUfguT4IIjdFdWK2ob3fRHatzWnXtUxtDeG8W4ML4VtTtUW4FO0IvVvgQYWO3E/2dn91MPq/fqdrjpi9IbVqF0QWgtqnYYr2YhtKAbq/0IMLDagf1Px/Rzk47sqfrKK4OwqnZbUrqyagkP45wuoYVxaxZ0g36s9iHAwIqZ+0/E7JOP0g2rVTJpp8nk3bwjnbuBrUmG8WLcGL9mQT/oyIqfAAMrRuZXn9XPXaQdVvU73FQPwyqUEaGF8a8SDpoFHaEnK14CDKyYeM84s5+7+GjdldX7MkmnPezfyqqlhMFKSziAh2ZBT+jKio8AAysG1leeUea+foxuWH2wTlZWMkkbPNsNbE0+cAAPcNEs6Ap9WfEQYGApc75CzHzJsb1UX2X1up0MqwyEw9ACH82CvtCZpU+AgaXIePrpZe4bymH1YRBWVW5To18H2LOVDVymPlzlwEmzoDP0ZukSYGAp8Z0m5v3ml3RXVh/KTe0ul8m4kWF1UBXB5/JFElrKNwGE3lNHM7QOKkaBP2RgFQgw059fPrqv+5ZyWOEOnAyrTPQzf2/jdgktCXftO5d++7heDvqzdAgwsCLmOuW0vu47x/WOeKv7b+7jDQiraodJyMqeQHNoVTvw0yzoDx+woifAwIqQ6Y/FpN89XjesPkFYPVTtNmzfHWHn/mwK3MAPHDULPoAfWNESYGBFxPMvTu3r/iiGsJoik209w6og1cAPK1Tt0IIf4AtWdAQYWBGw/NEpfd2ffFl3ZfXpxubdQIZVBILJJtZtaw4tcNUs+AL+YEVDgIFVIMfLTu7jvneCblj9fuOuYDcGk4wVHYEgtGTFCr6aBX/AJ6zCCTCwCmD4QzHhpSfqGnHNpl1uiny6Vc+wKkCp1v8UXMEXnDULPoFfWIURYGDlye/Pv9LHfT+OsHpIwmorV1Z5ypTVn4HvFOGsHVrwC3zDyp8AAysPdj84qY/7U/mfZn3WgN3AKlfHsNLE/IdtgzN4g7tmwTfwDys/AgysHLn94KTe7s+U3yWrZNJM+U2Vq2VY5ahOYb8O3uAO/poF/8BHrNwJMLByYPb9ExFWup/4VCOs5EAwwyoHYSL81SC0hD900Cz4CH5i5UaAgZUlr0vlk54fnqwbVjWbd7kfy2RZu6Upy674axoEwB86QA/Ngp/gK1b2BBhYWbD6npxLc5nyuTQMqyyEiPFX4got+Ar+YmVHgIHVBqfgxD/ls5VrNjcFu4H4ykoOgbh0+ZH4S/vE4+RQLawTBtZB+P3x8b3UL63AOznuIlDNsDqIEu33I+gCfbR303EJD/zGOjgBBlYrfL4rtwn5y9N0721Ui7CSj9KrGriyakWGRHwb+kAn6KVZ8Bt8x2qdAAMrA5vviGmmKN+IrU7Mj5MVP2NYZVAged+CTtALumkWfAf/sTITYGC14PJtufHe5dphtRWfQjGsWqBP/D+D0JLdwzrRT7PgP/iQdSABBtYXmHzz2J5uqvJ9uWF2rqy+AN3Yf67ZtG+lpRxa8CH8yNqfAANrH49viDmmn6H7jLl6MTluHgfTs+wSgH7QEXpqFvwIX7I+J8DAEhaXyLPlrlAOq3XbxORy07jfK98V4HNp+V+aBKAj9ISumgVfwp+sZgLeB1bwIEzlp/euF1PjcptPle+7RFPHSwB6BneAVQ6tK8WfX1N+ani85PJ/Na8DCybQfmovwyp/c1r4y7hCa8aZZQwtMYS3gXXRUT0cTNChQwe1ebFh3214P+HKSo1xEjYMfbF7CL21Cj6FX+Fbn8vLwJosol99Vj/dsAoedFAlj5TSvYDWZ/MmaezQGWfEaz7NCKEF38K/vpZ3gTXpyB7uJ8phtXFfWH3EsPJqXkFvhBb01yqEFvwLH/tYXgXWhUf0cD8do7uyag6rannCMFdWPk4o6I7dQ+3Qgo/hZ9/Km8D66qhS97OzdcNqU+NuN1XM+qE8Rp7lLwHoP21RtYMftAorLfgZvvapvAgsiHrN2P6qx6waxJzTJKxWM6x8mj+tjvWDdRJa4gf4QqsQWvC1T6GV+sCaeHhzWHUUcbUKppwq76jvi0lZJBASgB/gC83Qgq8RWvC5D5XqwDpPRLx2XH+nGlY7ZGWFsKpnWPkwYXIdI3wBfzSIT7QK/obP4fe0V2oD69yRpe465bDaLCacLmZcxbBK+zwpaHzwB3wCv2gVQgt+h+/TXKkMrAkxhtXKOq6s0jxBohobfBJXaMH/aa2iwRdMm5mmwY0f0d3dMH6AK+qod8xqy449Yr4a957BsCoSLIN7d3bDy4qD/3Uv7uia9ux1jU17E2uD3l07uqF9i90R/Utcv+5FrrMMAhokt+PMKOvlTPjX1jS68cNLXXEnHX9ipXXmYd3cp3JxdhpPrekweuFqa7pndoN8d/zw7u7Gc2IIq0eq3YraHa32kcQfHFNeElyLNlrM3LOk6IAWV9btcE+v3up+9e4mt21X+1uiW+cO7uvH9HLjRNNRElQtC8eEXv54m/v1sgb37lpbWhw5oMTNvbDSlZbo7eDsljehWU/VuiWiaZoqNYE1Vow9U8Kqk+LKautOrKyq3XJDYdWna5G7Ss6MPntY96x8i0tLHnh1vXv0vc1Z/b7GL10gJ0TioQzoPZt69sOt7q7n61Uvi8mmj1x+5yiE1qRKhxWuVmHlPFNC65kUhVYqdgkxGWdN0A+rK2VltcxQWI2U3b75Fw10x5R3yXpOdO3c0Z05tLvr263I/e7TbbHudmF3dYaE62XygFH0kW0d1qfYjR9R6t74bLtbr3hZTLb9ZPN7dVt3uzertssKUnYPMXCFwu7hWaIlrnNMyzWt5gNrzNBu7qZzy9VXVggrS7seg3p2cg98baAr69Ypr6mA3RascF7+ZFtef5/PH2ElmO99n0plpYLdR6y2NsvxLQtVG1NojZE39I/khOY03DUk+7exBDrg9CESVhN0w2rbrj1uxqO2wgqLk9vPr3A9u2S3S9WatBfL/cImx3SRLV4Hr1dIYbwYdw6Ls0JeLpK/xZsg/AWfaRUOk2CeYL5YL7OBNbRPZzcTu4FKy2kIG4TVIzXunRpbB3UvObZX8KlaFObEU4k1j7OgR2wfrxNF4dNEjN9SwV8zxGeqoSXzBPMF88ZymQ0sXI7QTfGtdLu84131aI17u6bRlL44HnLpCb0j67mXrFq0n97yLXnQAl4nqsL4tY4LRdVjy+3AZ/AbfKdVmC+YN5bLZGCdemhXd3QOB5JzFQimmSHmeavaVlhhnCcO6lrwrmBLXjhvSLNw4DnKwq4hOFgr+E07tDBvMH+slsnAGpvlR/T5iNIoYXX1b22GFcY7ekj0ZhwmnzaWl+Z38L4tDbBdbD/q0uAQdY+ZtrdUQgv+gw+1SnP+aPUcbtdkYB1XGf2kBJAwrN6ssreyCgUd1FPnGMVA+dRRo7S2q8VBg0HLbcJ/mqGlNX9ajkPj3yYDC5dnRF07mmRl9ViNe8NwWIFJmQKbYLtyXpZGlSltF+eRWS74EH6EL6MujfkTdY+tbc9kYGlcOIKT7EqKTOLYT9sdStcEWtvuzt0aLtkPtfo/4Ef4MuqyTMbkDK3bEv3TdnFB7W0Ty91phg9Iwtj1cjKiRuHCXY1S264SBw0GmbYJH84WP8KXUZfG/Im6x9a2ZzKwcGBSo/BR+G0TK0x/irKqPvpzxrBa+Vjp1s/YrsZqaKUCBw3PZdomPsWDDzXCCq+nNX8yjSXq75kMLNxVQKsQWrPFLCcP1jmwr9V3uN3nP4r+UprX12x325V2NbFdbD/qekGBQ9Q9ZtreKeI7+E/zPLIlH2zJ9NImvmcysF4Tgy+VC0e1CmaZI8vxkw+xF1p4YsvytdGuQB9e0aCFOthu1NtfJuO3+OQi+A27gZphhXnz+mfR+kPVHC02bjKwMIbZz9ap3nK2pFNHN+f8cvcVg6F1/yvrW8ic/z/fkTOwNVZtX+wI28frRFULIxx/VD21tR34DH6D77QKt2jGvLFcenSUqazZ1OSue7JW5fhH2DrMc7uY6CRjoYVjFL98Z1M4jLy/4v5fc2IyOF4Hr1doYdzWjtHAX/CZZljhOCHmC+aN5TIbWICOXcNrHq9RD607xEwnDMr+nlJJMMS8l9YF97PKt5ddYvAbF9fGdh8l3K8Jr4fXzbdw/y6M21LBV/CXdlhhnmC+WC/z98PCO8Yqub3vWLkeTes+7rg9xzi5HOhd2W2p3mzjHQrT/qnVW4Ib8eFe6LkU7jqKa9pelxvixVlr5D7kb8jxldPlNs653MAPPT60vMHNWlLrCsi7OIcavNYJA7u4O79a4booXsSPN4C/krB69dN4tdSCaT6wACYILXmUEq6RUgstORCPG8ThWEuNldCS1HpJbsCH+7WPkOv12rrlMG6p+9Dyze562XVor5u9rZVz7B5buSUIrJH9its8cRI3ppv9TJ178K1Nbm/+izOt+dXqdr8sYXVXHGH1xFr3SkrCCjBTc093DAY3KLv1PJ2T7bB9lNU7OeBW98fLJMEtc3E/8X7dO0kodHDr5YTQqoYmeQfeJgfXtzrcujcp1V8uM0K/px7azeGaQ1xus10ekFG/tSm4rz76XSqXsEjOmqrjKru4uy+oyHkVmcsgsbK6VsIKb1hpqlQFFoQ5Q3YnbsUtk2VFpFVWQ0uLB7ebPYE4wqoJYfXkWveiPFUobWX6oHsmMSDSdSIWRNMqHF+5S94hv1Rh60C8Fg9uNzsC8At8k+vxuey23vxb8D38n8awwghTF1gY1AsSWtcv1g0t3L3x7gsr3LEVuR3QRn8s/wjAJ/CL5l1yEVbwPfyf1kplYEEsnIx4ozyTDQeStSoIrQsq5TFaDC0txmnYLvxxt/hENazE5/C79km+7a1HagMLYPHIJ5zboxlaeIDCPfIU36MZWu3t5US+PnwBf2g+yAP+hs/h97RXqgML4kFEPP1WO7TuFVPi0zcWCYQE4Af4Qjus4G8fwgpcUx9YGCQe1X2TiLpbcfcQpoQ58QBSFgnAB9phBT/D12l6FH1bzvEisABhiYRWcCa0YmiVlnR0cyW0cj2zvC2R+HNbBKA/fAA/aBXCCn6Gr30qPaIJpLjkg63u5qfrVFdaQWhNqpDQiv5JMAlEypZaEIDuc0V/7bCCj+Fn38qrwIK4i9/f4m4RsfcoXsfRo6RITFvpRjG0vJpP0Bu6Q3+tgm/hX/jYx/IusCDykzGG1uFyPRwr/QSgc1xhBf/6Wl4GFsR+YtUWd6vySqunvNPeJ++4uIiXlV4C0Bc6Q2+twsoKfoVvfS5vAwuiPy7i40p/zd1DPDZ9npgZd0tgpY8AdIW+0Fmr4E/4FH71vbwOLIj/W7mVCcywV/GYVhBakyvd8L4MrTRNOOg5T3TVDCv4Ev6ET1menIfVltAww5xn61VDqxdWWmLuYQyttuQw8XPoCD2hq1YhrOBLhtXnhL1fYYUoHnlvs7v9Od3Q6t21yM0Xkw/t2zl8WX41SAD6Iaygp1YhrOBH+JL1OQEG1ucs3KIVm90dz8cRWgPd0D4MrS+gN/Of0G3+5IFt3r21kAEhrOBD+JG1PwEG1v483MNyi+A7lUMLtyqG6Q9jaLWgn+x/Qq84wgr+gw9ZBxJgYB3IJLiv+d0v6D59pY/c7he7h0N6c6WVQYLEfQs6QS/oplVYWcF3uK8+KzMBBlZmLu7XyxrEPPWt/DSab/ft1sktuKjSHcrQigao0lagD3SCXpp1z4vrAt9pvob1bTOwDqLgr95tcPcwtA5CKP0/ii2sxGfwG+vgBBhYB+fj/kdMdO+LuiutMnnnxu7G4F7cPWxDjlh/DD2gC/TRLPgLPmO1TYCB1TYjeex7g7vvJd3QwmO35stuxyG9dCdHFsPlrwgB6AA9oItmwVfwFys7Agys7Di5/3q7Qf0x6P1lciyQTw8HyTP4WO1HAPyhA/TQrHkvrQt8pfkaads2AysHRf/z7U1u/su6nx72L+3k7r+IoZWDLJH+KsIK/KGDZsFH8BMrNwIMrNx4BY9EXxBDaC1gaOWoTOG/HqysYggr+OfBtxhW+SjGwMqD2i/EbAtf0V1pDZB3+PkyefCIdpY+AXAGb3DXLPgG/mHlR4CBlR839+9LN7kHXl2f519n92flCC05llLZQ3cSZddNen8LfMEZvDULfoFvWPkTYGDlz87925sb3d/8Tje0KmQy4aRFfGVFTyAuvvAJ/MIqjAADqzB+7l/e2Oj+Vj205ExrOR9IewVQIApzfw6e4FrRQ/f8N/gDPmEVToCBVThD989ixr/7X92VVmXPzvLpFUMrArmCTSCswBNcNQu+gD9Y0RBgYEXD0f389Y3uH/5PP7Swezigu94FuBHhSPRmwA8ctcMKfoAvWNERYGBFx9L942sIrQ0RbvHATQ2UFcGCi3FSI0PrQDptfwfcwA8cNQs+gB9Y0RJgYEXLU0y6wf2T/E+zBiG0cL4QQysnzEFYCTfw0yzoDx+woifAwIqeqft7eXf9+eu6hj1ELsxFaPVjaGWlIDiBF7hpFnSH/iwdAgwsHa5yEH6DfDKka9wgtOT8oX6KN5VTwhPrZsEH1wZqhxX0hu4sPQIMLD22co7WBvevyp8QDcadMOUAchlDK6OS4AI+4KRZ0Bl6s3QJMLB0+bq/juGEwUN7Fwf3beqr+BQXZUwqmwcP3M8KfDQLJ4RCZ5Y+AQaWPuPgEp7/WKr7idGQPsXBR/UMrWZBwQGnLoCLZkFX7Uu0NPu3tm0GVkyK3f/KeveLGEILuz94Ko/PFTyVKIawgp7QlRUfAQZWfKzdAjH3g2/prrQOkxUFdoN6d/VTWowb4wcHzYKO0JMVLwE/XR0v4/1ebf7L6+Uuk7pX7A+Vx6jj7gO9u/glL8aLcWP8mgX9oCMrfgJ+OTp+vhlf8T65Ne5/K4fWMM9CKwwrjFuzoBv0Y7UPAQZW+3B3c8X0v3xHd6U1rKzYzZMVR6+Ur7QwPowT49Us6AXdWO1HgIHVfuzl8WHr5Fl0uqE1PAitStezJJ1SY1zz5JgVxqlZ0Al6sdqXQDpd3L5Mc3p1PJpc+wGaI8pKgkmdttAKwwrj0yzoA51Y7U+AgdX+GshkqHe/Wab7bLqR/UrcfbIS6ZGSlRbGgfFgXJoFXaAPKxkEGFjJ0MHd+Xy9e2i5bmgdLpN73iT7oYWwwjgwHs2CHtCFlRwCDKzkaOHueK7ePawdWv1lpWU4tIKVFcJKxqFZ0AF6sJJFgIGVLD3c7TJJFq3QXWmNksl+74WVrrTYlvzoF32jf80Cf+jASh4BW45NHj+VjuY8W+8efW+zyrbDjR45oMTNnVThuhsJLfSJftG3ZoE7+LOSSYCBlUxd3Oxn6mIIrS5u7oUVrrioQ0IpNLeF/tDnkQO6qPaJsAJ3VnIJMLASqs1e6QuT57GVuiutpdWNbuduvFpyC/29WdWo2iA4g3eySagiMLFxBlaCZcLkufXpOve4Umjh1ihW7jawEE9NVnoQKfiCM8MqwZNhX2sMrIRrhEl0i0ymJ1ZFu9KyFFahRBqhBa7gy7AKKSf7KwMr2foE3YWh9eSqLZF0azGswoFHGVrgybAKydr4ysCyoZPbI6l189O17qn3Cwsty2EVShVFaIEjeIIryw4BBpYdrYLJNWuJhNYH+YVWGsIqlKuQ0AI/cGRYhTTtfGVg2dEq6BST7Kanat3Tq3MLrTSFVShZPqEFbuDHsAop2vrKwLKlV9AtzkKYubjWPZNlaKUxrELZcgkt8AK3hJ/FEQ6NXzMQYGBlgGLhW5h0N8rke/bDrQdtN81hFQ48m9ACJ/BiWIXUbH5lYNnULegak++GxWvdc62Elg9hFcp3sNACH3BiWIW07H5lYNnVLuh89x7nrpfJ+PxH+6+0cJKllZNCo5IgU2iBC/iAE8s+AQaWfQ2DyXjdk2vdC/tCC2GFyetjfTG0wANcGFbpcUKH0QtXy44FKw0EOsnbz4SRpXL9YW6fIKZh7C3HcP6oUrdYzrVq4sqqJRrT/2ZgmZaPzZOAXwS4S+iX3hwtCZgmwMAyLR+bJwG/CDCw/NKboyUB0wQYWKblY/Mk4BcBBpZfenO0JGCaAAPLtHxsngT8IsDA8ktvjpYETBNgYJmWj82TgF8EGFh+6c3RkoBpAgws0/KxeRLwiwADyy+9OVoSME2AgWVaPjZPAn4RYGD5pTdHSwKmCTCwTMvH5knALwIMLL/05mhJwDQBBpZp+dg8CfhFgIHll94cLQmYJsDAMi0fmycBvwgwsPzSm6MlAdMEGFim5WPzJOAXAQaWX3pztCRgmgADy7R8bJ4E/CLAwPJLb46WBEwTYGCZlo/Nk4BfBBhYfunN0ZKAaQIMLNPysXkS8IsAA8svvTlaEjBNgIFlWj42TwJ+EWBg+aU3R0sCpgkwsEzLx+ZJwC8CDCy/9OZoScA0AQaWafnYPAn4RYCB5ZfeHC0JmCbAwDItH5snAb8IMLD80pujJQHTBBhYpuVj8yTgFwEGll96c7QkYJoAA8u0fGyeBPwiwMDyS2+OlgRME2BgmZaPzZOAXwQYWH7pzdGSgGkCDCzT8rF5EvCLAAPLL705WhIwTYCBZVo+Nk8CfhFgYPmlN0dLAqYJMLBMy8fmScAvAgwsv/TmaEnANAEGlmn52DwJ+EWAgeWX3hwtCZgmwMAyLR+bJwG/CDCw/NKboyUB0wQYWKblY/Mk4BcBBpZfenO0JGCaAAPLtHxsngT8IsDA8ktvjpYETBNgYJmWj82TgF8EGFh+6c3RkoBpAgws0/KxeRLwiwADyy+9OVoSME2AgWVaPjZPAn4RYGD5pTdHSwKmCTCwTMvH5knALwIMLL/05mhJwDQBBpZp+dg8CfhFgIHll94cLQmYJsDAMi0fmycBvwgwsPzSm6MlAdMEGFim5WPzJOAXAQaWX3pztCRgmgADy7R8bJ4E/CLAwPJLb46WBEwTYGCZlo/Nk4BfBP4fdKKKT3sfOPsAAAAASUVORK5CYII=",p="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmlld0JveD0iMCAwIDQ1IDQ1Ij4KPHBhdGggZmlsbD0iI2E3MjAzNyIgc3Ryb2tlPSIjZmZmIiBkPSJNMjIuNSw0NC41YzEyLjE1LDAsMjItOS44NSwyMi0yMlMzNC42NSwuNSwyMi41LC41LC41LDEwLjM1LC41LDIyLjVzOS44NSwyMiwyMiwyMloiLz4KPHBhdGggY2xhc3M9ImNscy0zIiBkPSJNMjAuOTMsMzAuNDJsMy41Ni0xLjUxYy4xMywuODgtLjM0LDEuNzctMS4yLDIuMTQtLjg2LC4zNi0xLjgzLC4wOC0yLjM3LS42MlptNS40My0xNy44M2MyLjA5LDEuMTQsMy42NSwyLjYsNC42OCw0LjM5LDEuMDMsMS43OCwxLjUxLDMuODcsMS40Niw2LjI1LDAsLjQxLS4zNSwuNzQtLjc3LC43My0uNDEsMC0uNzQtLjM1LS43My0uNzcsLjA1LTIuMTEtLjM3LTMuOTMtMS4yNi01LjQ2LS44OS0xLjU0LTIuMjUtMi44MS00LjEtMy44Mi0uMzYtLjItLjUtLjY1LS4zLTEuMDIsLjItLjM2LC42NS0uNSwxLjAyLS4zWm0tOS4xNSw0LjQyYzIuODYtMS4yNyw2LjItLjA3LDcuNiwyLjc1bC4xLC4yMSwxLjI5LDIuODksMS43LDEuNDdjLjA5LC4wOCwuMTcsLjE3LC4yNywuMzJsLjA2LC4xMWMuMjgsLjYzLDAsMS4zNy0uNjQsMS42NWwtMTAuMzMsNC41N2MtLjE2LC4wNy0uMzMsLjExLS41MSwuMTEtLjY5LDAtMS4yNS0uNTYtMS4yNS0xLjI1di0yLjM0cy0xLjI0LTIuNzktMS4yNC0yLjc5Yy0xLjMxLTIuOTUsMC02LjM5LDIuOTUtNy43Wm0tMS41OCw3LjA5bDEuMzcsMy4wOHYyLjI4czkuNjItNC4yNiw5LjYyLTQuMjZsLTEuNjUtMS40My0xLjQyLTMuMTgtLjA4LS4xOGMtMS4wMy0yLjA4LTMuNTEtMi45Ny01LjY0LTIuMDMtMi4xOSwuOTctMy4xNywzLjUyLTIuMTksNS43MlptMTAuNS03LjkxYy45NywuNTMsMS43NCwxLjI5LDIuMzIsMi4yOSwuNTcsLjk5LC44NSwyLjA1LC44MiwzLjE1LS4wMSwuNDEtLjM1LC43NC0uNzcsLjczLS40MS0uMDEtLjc0LS4zNS0uNzMtLjc3LC4wMi0uODItLjE5LTEuNi0uNjItMi4zNi0uNDQtLjc2LTEuMDEtMS4zMy0xLjc0LTEuNzItLjM2LS4yLS41LS42NS0uMy0xLjAyLC4yLS4zNiwuNjUtLjUsMS4wMi0uM1oiLz4KPHBhdGggZmlsbD0iI2ZmZiIgZD0iTTIwLjkzLDMwLjQybDMuNTYtMS41MWMuMTMsLjg4LS4zNCwxLjc3LTEuMiwyLjE0LS44NiwuMzYtMS44MywuMDgtMi4zNy0uNjJabTUuNDMtMTcuODNjMi4wOSwxLjE0LDMuNjUsMi42LDQuNjgsNC4zOSwxLjAzLDEuNzgsMS41MSwzLjg3LDEuNDYsNi4yNSwwLC40MS0uMzUsLjc0LS43NywuNzMtLjQxLDAtLjc0LS4zNS0uNzMtLjc3LC4wNS0yLjExLS4zNy0zLjkzLTEuMjYtNS40Ni0uODktMS41NC0yLjI1LTIuODEtNC4xLTMuODItLjM2LS4yLS41LS42NS0uMy0xLjAyLC4yLS4zNiwuNjUtLjUsMS4wMi0uM1ptLTkuMTUsNC40MmMyLjg2LTEuMjcsNi4yLS4wNyw3LjYsMi43NWwuMSwuMjEsMS4yOSwyLjg5LDEuNywxLjQ3Yy4wOSwuMDgsLjE3LC4xNywuMjcsLjMybC4wNiwuMTFjLjI4LC42MywwLDEuMzctLjY0LDEuNjVsLTEwLjMzLDQuNTdjLS4xNiwuMDctLjMzLC4xMS0uNTEsLjExLS42OSwwLTEuMjUtLjU2LTEuMjUtMS4yNXYtMi4zNHMtMS4yNC0yLjc5LTEuMjQtMi43OWMtMS4zMS0yLjk1LDAtNi4zOSwyLjk1LTcuN1ptOC45MS0uODJjLjk3LC41MywxLjc0LDEuMjksMi4zMiwyLjI5LC41NywuOTksLjg1LDIuMDUsLjgyLDMuMTUtLjAxLC40MS0uMzUsLjc0LS43NywuNzMtLjQxLS4wMS0uNzQtLjM1LS43My0uNzcsLjAyLS44Mi0uMTktMS42LS42Mi0yLjM2LS40NC0uNzYtMS4wMS0xLjMzLTEuNzQtMS43Mi0uMzYtLjItLjUtLjY1LS4zLTEuMDIsLjItLjM2LC42NS0uNSwxLjAyLS4zWiIvPgo8L3N2Zz4=",k="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMCAyMCI+DQogIDxyZWN0IHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0iI2ZhZWNlYiIvPg0KICA8cGF0aCBmaWxsPSIjYmMyZjMyIiBkPSJNMi44NTM1NSAyLjE0NjQ2QzIuNjU4MjkgMS45NTEyIDIuMzQxNzEgMS45NTEyIDIuMTQ2NDUgMi4xNDY0NkMxLjk1MTE4IDIuMzQxNzIgMS45NTExOCAyLjY1ODMxIDIuMTQ2NDUgMi44NTM1N0wyLjkwOTM0IDMuNjE2NDZDMi4zNTI3MiA0LjA4NzA1IDIgNC43ODU3OSAyIDUuNTY1ODJWMTIuMjc2NEMyIDEzLjY5MzUgMy4xNjQwNiAxNC44NDIzIDQuNiAxNC44NDIzSDUuMTk5MzdMNS4yIDE3LjAxMzNDNS4yIDE3LjIyNjIgNS4yNjk4OSAxNy40MzM1IDUuMzk5MjEgMTcuNjA0MkM1LjczIDE4LjA0MDYgNi4zNTY2OCAxOC4xMjk4IDYuNzk4OTUgMTcuODAzNEwxMC44MSAxNC44NDIzSDE0LjEzNTFMMTcuMTQ2NCAxNy44NTM2QzE3LjM0MTcgMTguMDQ4OCAxNy42NTgzIDE4LjA0ODggMTcuODUzNiAxNy44NTM2QzE4LjA0ODggMTcuNjU4MyAxOC4wNDg4IDE3LjM0MTcgMTcuODUzNiAxNy4xNDY1TDE1LjU0NTQgMTQuODM4M0MxNS41NDU0IDE0LjgzODMgMTUuNTQ1NCAxNC44MzgzIDE1LjU0NTQgMTQuODM4M0wzLjgyMzUgMy4xMTYzOEMzLjgyMzUgMy4xMTYzOCAzLjgyMzUxIDMuMTE2MzggMy44MjM1IDMuMTE2MzhMMi44NTM1NSAyLjE0NjQ2Wk0xMy4xMzUxIDEzLjg0MjNIMTAuNDgwOUw2LjIwNTAyIDE2Ljk5ODhMNi4yMDM0NiAxNi45OTk3TDYuMiAxN0w2LjE5OTA4IDEzLjg0MjNINC42QzMuNzAzODMgMTMuODQyMyAzIDEzLjEyODggMyAxMi4yNzY0VjUuNTY1ODJDMyA1LjA2NzE0IDMuMjQwOTMgNC42MTU5OSAzLjYyMDM0IDQuMzI3NDZMMTMuMTM1MSAxMy44NDIzWiIvPg0KICA8cGF0aCBmaWxsPSIjYmMyZjMyIiBkPSJNMTcgMTIuMjc2NEMxNyAxMi45NjU4IDE2LjUzOTYgMTMuNTY0NCAxNS44ODk0IDEzLjc2OEwxNi42NDg4IDE0LjUyNzVDMTcuNDU0MSAxNC4wOTE1IDE4IDEzLjI0NjkgMTggMTIuMjc2NFY1LjU2NTgyQzE4IDQuMTQ4NzYgMTYuODM1OSAzIDE1LjQgM0g1LjEyMTM0TDYuMTIxMzQgNEgxNS40QzE2LjI5NjIgNCAxNyA0LjcxMzQ4IDE3IDUuNTY1ODJWMTIuMjc2NFoiLz4NCjwvc3ZnPg0K",g="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTIiIGhlaWdodD0iNTIiIHZpZXdCb3g9IjAgMCA1MiA1MiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxwYXRoIGQ9Ik0yNiA1MC45NkMzOS43ODUgNTAuOTYgNTAuOTYgMzkuNzg1IDUwLjk2IDI2QzUwLjk2IDEyLjIxNSAzOS43ODUgMS4wNCAyNiAxLjA0QzEyLjIxNSAxLjA0IDEuMDQgMTIuMjE1IDEuMDQgMjZDMS4wNCAzOS43ODUgMTIuMjE1IDUwLjk2IDI2IDUwLjk2WiIgZmlsbD0iI0ZERjZGMyIgc3Ryb2tlPSIjRjRCRkFCIiBzdHJva2Utd2lkdGg9IjEuOTIiLz4NCjxwYXRoIGQ9Ik0yMy40OTk0IDE1Ljk0NTdDMjQuNTY1NyAxNC4wMTgxIDI3LjMzNjcgMTQuMDE4MSAyOC40MDMgMTUuOTQ1NkwzOC4wNDg4IDMzLjM4MTdDMzkuMDgxOSAzNS4yNDkyIDM3LjczMTMgMzcuNTQgMzUuNTk3MSAzNy41NEgxNi4zMDZDMTQuMTcxOCAzNy41NCAxMi44MjExIDM1LjI0OTMgMTMuODU0MSAzMy4zODE4TDIzLjQ5OTQgMTUuOTQ1N1pNMjcuMTk1IDMyLjU2MDVDMjcuMTk1IDMxLjg3MzcgMjYuNjM4MiAzMS4zMTY5IDI1Ljk1MTQgMzEuMzE2OUMyNS4yNjQ2IDMxLjMxNjkgMjQuNzA3OCAzMS44NzM3IDI0LjcwNzggMzIuNTYwNUMyNC43MDc4IDMzLjI0NzMgMjUuMjY0NiAzMy44MDQxIDI1Ljk1MTQgMzMuODA0MUMyNi42MzgyIDMzLjgwNDEgMjcuMTk1IDMzLjI0NzMgMjcuMTk1IDMyLjU2MDVaTTI2Ljg3MjMgMjIuNzgwOEMyNi44MTAxIDIyLjMyNSAyNi40MTkgMjEuOTczOSAyNS45NDYyIDIxLjk3NDNDMjUuNDMwMyAyMS45NzQ3IDI1LjAxMjUgMjIuMzkzMiAyNS4wMTI5IDIyLjkwOUwyNS4wMTc0IDI4LjUxNDlMMjUuMDI2IDI4LjY0MTZDMjUuMDg4MyAyOS4wOTc0IDI1LjQ3OTMgMjkuNDQ4NSAyNS45NTIxIDI5LjQ0ODFDMjYuNDY4IDI5LjQ0NzcgMjYuODg1OCAyOS4wMjkyIDI2Ljg4NTQgMjguNTEzNEwyNi44ODA5IDIyLjkwNzVMMjYuODcyMyAyMi43ODA4WiIgZmlsbD0iI0RBM0IwMSIvPg0KPC9zdmc+"},628918:(e,n,i)=>{"use strict";i.d(n,{Ww:()=>c,YP:()=>m,W9:()=>k,cU:()=>g});var a=i(564087),t=i(882066),r=i(327557),o=i(803238),l=i(811957),s=i(449473),d=i(208689);const c=3,m={profilePictureType:a.tS.User,generateUrl(e,n,i,o,l=a.$D.Small,s,d,c,m,k,g,N,f){if(s)return r.WW;if((0,t.EG)(e.id)&&!g)return r.Az;let h="";const v=m&&!k&&e.id?e.id.split("|")[0]:e.id,T=v&&v.indexOf("#")>=0?encodeURIComponent(v):v,M=e.displayName?encodeURIComponent(e.displayName):"";return h=""===e.id||g?"beta/users/defaultProfilePictureV2?displayName={displayName}".replace("{displayName}",M):k?p(M,T,d,c,i,o):u(M,T,i,o),h=`${h}&size=${l}`,N&&f&&!g&&(h=`${h}&ETag=${f}`),`${n}${h}`},getPresenceUserId:e=>e.id},u=(e,n,i,a)=>{let t="";return t=i&&a&&!(0,o.isEmpty)(a)?"beta/users/{currentUserObjectId}/profilepicturev2/{id}?displayname={displayname}".replace("{currentUserObjectId}",a).replace("{id}",n).replace("{displayname}",e):"beta/users/{id}/profilepicturev2?displayname={displayname}".replace("{id}",n).replace("{displayname}",e),t},p=(e,n,i,a,t,r)=>{let l="";return l=t&&r&&!(0,o.isEmpty)(r)?"beta/users/{currentUserObjectId}/profilePictureV2ForSharedChannel/{id}?displayName={displayName}&conversationId={conversationId}&hostTenantId={hostTenantId}".replace("{currentUserObjectId}",r):"beta/users/{id}/profilePictureV2ForSharedChannel?displayName={displayName}&conversationId={conversationId}&hostTenantId={hostTenantId}",i&&a?l=l.replace("{id}",n).replace("{displayName}",e).replace("{conversationId}",i||"").replace("{hostTenantId}",a||""):(l=t&&r&&!(0,o.isEmpty)(r)?"beta/users/{currentUserObjectId}/profilePictureV2ForSharedChannel/{id}?displayName={displayName}".replace("{currentUserObjectId}",r):"beta/users/{id}/profilePictureV2ForSharedChannel?displayName={displayName}",l=l.replace("{id}",n).replace("{displayName}",e)),l},k={profilePictureType:a.tS.Group,generateUrl(e,n,i,d,m=a.$D.Small){let u="";const p=(e.length>c?e.slice(0,c):e).map((e=>({userId:e.id,displayName:e.displayName}))),k=(e=>{if(1===e.length){const n=e[0].id;if(n===s.HE)return{shouldUseProjectGroupImage:!0,shouldUseDefaultGroupImage:!1};if(n===s.xw)return{shouldUseProjectGroupImage:!1,shouldUseDefaultGroupImage:!0}}return{shouldUseProjectGroupImage:!1,shouldUseDefaultGroupImage:!1}})(e);let{shouldUseDefaultGroupImage:g}=k;const{shouldUseProjectGroupImage:N}=k;for(const e of p){if(g||N)break;((0,o.isEmpty)(e.displayName)||!(0,l.lp)(e.userId)||(0,l.y)(e.userId)||(0,t.EG)(e.userId))&&(g=!0)}if(g||(0,o.isEmpty)(p))return r.dA;if(N)return r.P7;u=encodeURIComponent(JSON.stringify(p));let f="";return f=i&&d&&!(0,o.isEmpty)(d)?"beta/users/{currentUserObjectId}/mergedProfilePicturev2?usersInfo={usersArray}&size={size}".replace("{currentUserObjectId}",d).replace("{usersArray}",u).replace("{size}",m):"beta/users/mergedProfilePicturev2?usersInfo={usersArray}&size={size}".replace("{usersArray}",u).replace("{size}",m),`${n}${f}`},getPresenceUserId(){}},g={profilePictureType:a.tS.Team,generateUrl(e,n,i,a){const{displayName:t,groupId:r,pictureETag:o}=e;return(0,d.RJ)(n,t,o||"",r,i,a)},getPresenceUserId(){}}},436599:(e,n,i)=>{"use strict";i.d(n,{r:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"msaGroupProfilePicture"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"msaGroupInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"MsaGroupProfilePictureInput"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaGroupProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"msaGroupInfo"},value:{kind:"Variable",name:{kind:"Name",value:"msaGroupInfo"}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}}}]}]}}]}},649883:(e,n,i)=>{"use strict";i.d(n,{E$:()=>F,Ou:()=>D,tw:()=>U});var a=i(818319),t=i(564087),r=i(681971);const o={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"user"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"imageUri"}},{kind:"Field",name:{kind:"Name",value:"selfAvatarLastupdatedTime"}}]}}]}}]},l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"connectorProfile"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"integrationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"connectorProfile"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}},{kind:"Argument",name:{kind:"Name",value:"integrationId"},value:{kind:"Variable",name:{kind:"Name",value:"integrationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"avatarUrl"}}]}}]}}]},s={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAvatarCommunityProfilePictureQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"threadId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"imageUri"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"community"},arguments:[{kind:"Argument",name:{kind:"Name",value:"threadId"},value:{kind:"Variable",name:{kind:"Name",value:"threadId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"profilePictureUrl"},arguments:[{kind:"Argument",name:{kind:"Name",value:"imageUri"},value:{kind:"Variable",name:{kind:"Name",value:"imageUri"}}}]}]}}]}}]},d={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"msaUserProfilePicture"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"displayName"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"imageUri"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"renderInitials"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaUserProfilePicture"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"displayName"},value:{kind:"Variable",name:{kind:"Name",value:"displayName"}}},{kind:"Argument",name:{kind:"Name",value:"imageUri"},value:{kind:"Variable",name:{kind:"Name",value:"imageUri"}}},{kind:"Argument",name:{kind:"Name",value:"profilePictureSize"},value:{kind:"Variable",name:{kind:"Name",value:"profilePictureSize"}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}}},{kind:"Argument",name:{kind:"Name",value:"renderInitials"},value:{kind:"Variable",name:{kind:"Name",value:"renderInitials"}}}]}]}}]};var c=i(436599);const m={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAvatarIsSharedChannelQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"channelByID"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isShared"}},{kind:"Field",name:{kind:"Name",value:"substrateGroupId"}}]}}]}}]},u={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAvatarGetUsersQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mriOrEmailArray"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isMailAddress"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getUsers"},arguments:[{kind:"Argument",name:{kind:"Name",value:"mriOrEmailArray"},value:{kind:"Variable",name:{kind:"Name",value:"mriOrEmailArray"}}},{kind:"Argument",name:{kind:"Name",value:"isMailAddress"},value:{kind:"Variable",name:{kind:"Name",value:"isMailAddress"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"mri"}},{kind:"Field",name:{kind:"Name",value:"avatarUrl"}}]}}]}}]},p={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAvatarChatAvatarUrlQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chat"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"avatarUrl"}}]}}]}}]},k={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAvatarChatTypeQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chat"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"picture"}},{kind:"Field",name:{kind:"Name",value:"chatType"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOne"}}]}}]}}]};var g=i(467192),N=i(803238);const f={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"isTenantVerifiedDomain"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"domain"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isTenantVerifiedDomain"},arguments:[{kind:"Argument",name:{kind:"Name",value:"domain"},value:{kind:"Variable",name:{kind:"Name",value:"domain"}}}]}]}}]};var h=i(133598),v=i.n(h),T=i(325506),M=i(462512),y=i(610597),S=i(543491),A=i(327557);const I={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAvatarUrlPreviewQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"url"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"urlPreview"},arguments:[{kind:"Argument",name:{kind:"Name",value:"url"},value:{kind:"Variable",name:{kind:"Name",value:"url"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}}]}}]}}]},b={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsAvatarDownloadAmsItemQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"urlOrObjectId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"type"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"BlobType"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"applyRetry"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"downloadAmsItem"},arguments:[{kind:"Argument",name:{kind:"Name",value:"urlOrObjectId"},value:{kind:"Variable",name:{kind:"Name",value:"urlOrObjectId"}}},{kind:"Argument",name:{kind:"Name",value:"type"},value:{kind:"Variable",name:{kind:"Name",value:"type"}}},{kind:"Argument",name:{kind:"Name",value:"applyRetry"},value:{kind:"Variable",name:{kind:"Name",value:"applyRetry"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"blob"}}]}}]}}]},C={throttleTimeInMS:36e5,maxThrottleCount:5,resetThrottleTime:72e5,throttleCount:0,lastThrottleTime:0},D=(e,n="avatar-container-hook")=>{const{userId:i,conversationId:t,teamId:o,entity:l,profilePictureSize:s,isEmergencyCallTarget:d,client:c,generator:m,baseImageUrl:u,isImageAuthCookieValid:p,logger:k,enableMSAProfilePicture:N,showMergedAvatarForGroup:f,isAnonymousAccount:h,isTeamsApp:v,isUnresolvedEmail:T,sharedChannelId:M,skipAvatarQuery:y}=e,{coreSettings:S}=(0,r.SE)(),A=(0,g.HA)(i,t,o,N,f||!1,v,T,M,l,S),I=(0,g.WJ)(A,d),[b,C]=a.useState(I),D=a.useRef(!1);return a.useEffect((()=>(D.current=!0,()=>{D.current=!1}))),a.useEffect((()=>{if(y)return;let i="";(async()=>{i=await F(e,A,n),D.current&&i&&C(i)})()}),[i,t,l,s,d,c,k,m,u,A,e,n,p,D,h,y]),b},F=async(e,n,i)=>{const{baseImageUrl:a,isEmergencyCallTarget:r,isImageAuthCookieValid:o,enableCachedAvatarCheck:l,isAnonymousAccount:s,logger:d,enableSampleAvatarFetch:c,enableAvatarUrlQuery:m,avatarUrl:u,profilePictureSize:p}=e,k=(0,g.WJ)(n,r);let f;if(u?f=(0,g.vn)(u,p,n===t.tS.User):m&&(f=await Y(e,n,i)),(0,N.isEmpty)(f)){if((0,N.isEmpty)(a)||!o){const t=(0,N.isEmpty)(a)&&!o?"baseImageUrlisImageAuthCookieValidFailed":o?"baseImageUrlFailed":"isImageAuthCookieValidFailed",r={callerInfo:i,profilePictureType:n,isSelfProfileAvatar:!!e.isSelfProfileAvatar,errorMessage:t};if(E(C,e.scenarioFactory,r,!!e.enableFBSTelemetryForAvatarStatus,d),(0,N.isEmpty)(a))return k}f=await w(e,n,i)}if(!f)return k;if(o||s||n===t.tS.Initials)return o&&((e,n,i)=>{e&&v()(n,{method:"GET",credentials:"include",headers:{"x-ms-client-caller":i}}).catch((()=>{}))})(!!c,f,i),f;if(l){if(await L(f))return f}return k},U=(e,n,i,t,r,o)=>{const l=(0,g.vn)(e,n,i),s=r&&!o&&!!l,d=s?((e,n,i)=>n?A.zw:i?A.dA:e)(l,i,t):l,[c,m]=a.useState(d),u=a.useRef(!1);return a.useEffect((()=>(u.current=!0,s&&d!==l?L(l).then((e=>{const n=e?l:d;u.current&&m(n)})):m(l),()=>{u.current=!1})),[s,d,l]),c},E=(e,n,i,a=!1,t)=>{e.throttleCount++;const r=Date.now();if(e.throttleCount<=e.maxThrottleCount&&r-e.lastThrottleTime>e.throttleTimeInMS||999999999999999===r){if(t.error(`AvatarContainer: caller:${i.callerInfo} numericType:${i.profilePictureType} isSelf:${i.isSelfProfileAvatar} errorMessage:${i.errorMessage}`),e.lastThrottleTime=r,a){const e=n&&n.newScenario(S.RG.AvatarStatus);e&&e.fail(i)}}else r-e.lastThrottleTime>e.resetThrottleTime&&(e.throttleCount=0)},w=async(e,n,i)=>{const{userId:a,conversationId:r,entity:o,client:l,logger:s,profilePictureSize:d,isSelfProfileAvatar:c,showUpdatedGroupAvatar:m,enableConnectorsProfileInChannels:u,onBehalfOfId:p,scenarioFactory:k}=e;let g;switch(n){case t.tS.Communities:g=await Z(o,l,s,m);break;case t.tS.Connector:const n=await Q(l,r,a,s,u);g=n?.data?.connectorProfile?.avatarUrl;break;case t.tS.OutgoingWebhook:g=await W(l,r,s,p,k);break;case t.tS.App:case t.tS.Bot:g=await G(l,a,s,i);break;case t.tS.MsaUser:case t.tS.MsaGroup:g=await V(a,r,d||t.$D.Small,o,l,s,c,m);break;case t.tS.User:case t.tS.Group:case t.tS.Team:case t.tS.SharedChannelInviteeTeam:g=await x(e,l,i);break;case t.tS.MergedGroup:g=await B(e);break;case t.tS.Initials:g=await R(e)}return g},L=async(e,n)=>{try{return await v()(e,{method:"GET",mode:"same-origin",cache:"only-if-cached",credentials:"include",headers:{"x-ms-client-caller":n||"image-cache-check"}}),!0}catch(e){return!1}},x=async(e,n,i)=>{const{entity:a,profilePictureSize:t,isEmergencyCallTarget:r,generator:l,baseImageUrl:s,logger:d,isSelfProfileAvatar:c,avatarEtag:u}=e;let p,k=u;const{conversationId:g}=e;if(!Array.isArray(a)){const e=a;p=e.upn,e&&!e.displayName&&d.warn(`Avatar without display name, callerInfo: ${i}`)}if(e.isSharedChannel&&g){const{data:a}=await n.query({query:m,variables:{convId:g},context:{callerInfo:"avatar-url-shared-channel"}});if(a?.channelByID?.substrateGroupId||a?.channelByID?.isShared)return O(p,e,n,i)}if(c&&!k){const e=a,t=await n.query({query:o,variables:{userId:e.id},context:{callerInfo:i}});t?.data?.user?.selfAvatarLastupdatedTime&&(k=t?.data?.user?.selfAvatarLastupdatedTime)}return l.generateUrl(a,s||"",!!e.isProfilePictureWithObjectIdEnabled,e.currentUserOid,t,r,void 0,void 0,void 0,void 0,void 0,c,k)},O=async(e,n,i,a)=>{const{entity:t,profilePictureSize:r,isEmergencyCallTarget:o,generator:l,baseImageUrl:s,logger:d}=n;if(e){const a=!await j(i,e);return l.generateUrl(t,s||"",!!n.isProfilePictureWithObjectIdEnabled,n.currentUserOid,r,o,n.conversationId,n.hostTenantId,!0,a,void 0)}return d.warn(`Avatar: upn not provided for sharedChannel, callerInfo: ${a}`),l.generateUrl(t,s||"",!!n.isProfilePictureWithObjectIdEnabled,n.currentUserOid,r,o,n.conversationId,n.hostTenantId,!0,!0,void 0)},j=async(e,n)=>{const i=n.substring(n.indexOf("@")+1);try{const{data:n}=await e.query({query:f,variables:{domain:i}});return n&&n.isTenantVerifiedDomain}catch{return!1}},V=async(e,n,i,a,t,r,o=!1,l=!1)=>{const s=(0,T.UL)(n);let d;if(e&&n&&Array.isArray(a)||s){const{data:e}=await t.query({query:k,variables:{convId:n},context:{callerInfo:"get-msa-avatar-url"}});if(s&&e?.chat?.picture)return e.chat.picture;d="Chat"===e?.chat?.chatType&&!e?.chat?.isOneOnOne}if(e&&!d){const n=await z(t,e,a.displayName,i,r,o);return n?.data?.msaUserProfilePicture}if(n){const e=[],i=a;Array.isArray(i)&&i.forEach((n=>{e.push({userId:n.id,displayName:n.displayName?n.displayName:""})}));const o=await P(t,n,e,r,l);return o?.data?.msaGroupProfilePicture}},z=async(e,n,i,a,t,r,o)=>{try{return await e.query({query:d,variables:{userId:n,displayName:i,callerInfo:"avatar-container",profilePictureSize:a,renderInitials:o},fetchPolicy:r?"network-only":"cache-first"})}catch(e){return void t.error(`msaUserProfilePictureQuery failed for msa user: ${e.message}`)}},P=async(e,n,i,a,t)=>{i.forEach((e=>{e&&(0,N.isEmpty)(e.displayName)&&n&&a.warn(`Avatar without display name for conversationId: ${n}`)}));try{const a={conversationId:n,pictureReadyUsers:i};return await e.query({query:c.r,variables:{msaGroupInfo:a,callerInfo:"avatar-container"},fetchPolicy:t?"network-only":"cache-first"})}catch{return void a.error(`msaGroupProfilePictureQuery failed for conversationId:  ${n}`)}},R=async e=>{const{entity:n,profilePictureSize:i,isEmergencyCallTarget:a,generator:t,baseImageUrl:r}=e;return t.generateUrl(n,r,!!e.isProfilePictureWithObjectIdEnabled,e.currentUserOid,i,a,void 0,void 0,!1,!1,!0)},B=async e=>{const{entity:n,profilePictureSize:i,isEmergencyCallTarget:a,generator:t,baseImageUrl:r}=e;return t.generateUrl(n,r,!!e.isProfilePictureWithObjectIdEnabled,e.currentUserOid,i,a,void 0,void 0,!1,!1,!0)},Q=async(e,n,i,a,t)=>{try{if(t&&n&&i){return await e.query({query:l,variables:{convId:n,integrationId:i}})}return}catch(e){return void a.error(`connectors query failed for conversationId: ${n}`)}},W=async(e,n,i,a,t)=>{if(t&&a&&n)try{const r=await(0,y.RD)(e,n);return(await(0,M.xJ)(e,i,t,a,!0,"outgoing-webhook-avatar-url",{conversation:{scope:"Team",id:r||""}}))[0].definition.largeImageUrl}catch(e){i.error(`installed apps query failed for conversationId: ${n}`)}},Z=async(e,n,i,a)=>{const t=e.teamThreadId||"",r=e.pictureETag;if(r)try{const e=await n.query({query:s,variables:{threadId:t,imageUri:r},fetchPolicy:a?"network-only":"cache-first"});return e?.data?.community?.profilePictureUrl}catch(e){return void i.errorToTelemetry?.(`community profile picture query failed for this : ${t}`,"community_profile_picture_query_failed")}else i.infoToTelemetry?.(`getCommunitiesAvatarUrl function returned undefined for this threadId : ${t}, and imageUri: ${r}`,"get_communities_avatar_url_returned_undefined",void 0,!0)},Y=async(e,n,i)=>{const{client:a,profilePictureSize:r}=e;if(n===t.tS.User&&e.userId){const{data:n}=await a.query({query:u,variables:{mriOrEmailArray:[e.userId]},context:{callerInfo:i}});return(0,g.vn)(n.getUsers?.[0].avatarUrl,r,!0)}if(n===t.tS.Group&&e.conversationId){const{data:n}=await a.query({query:p,variables:{convId:e.conversationId},context:{callerInfo:i}});return n.chat?.avatarUrl}},G=async(e,n,i,a)=>{const t=await(async(e,n,i,a)=>{try{return await e.query({query:o,variables:{userId:n},context:{callerInfo:a}})}catch(e){return void i.error(`userQuery failed: ${e.message}`)}})(e,n,i,a),r=t?.data?.user?.imageUri;if(r){const n=await e.query({query:I,variables:{url:r},context:{callerInfo:a}}),i=n.data.urlPreview?.thumbnail||n.data.urlPreview?.url;if(i){const{data:n}=await e.query({query:b,variables:{urlOrObjectId:i,type:"Url",applyRetry:!0},fetchPolicy:"cache-first"});return n?.downloadAmsItem?.blob}}}},894917:(e,n,i)=>{"use strict";i.d(n,{v:()=>f});var a=i(452558),t=i(15051),r=i(472632),o=i(982635),l=i(533185),s=i(256350),d=i(253170),c=i(374504),m=i(219622),u=i(445393),p=i(699201),k=i(170404),g=i(217494),N=i(255567);const f={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsChatQueriesChatQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chat"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"shortTitle"}},{kind:"Field",name:{kind:"Name",value:"groupTemplate"}},{kind:"Field",name:{kind:"Name",value:"themeId"}},{kind:"Field",name:{kind:"Name",value:"picture"}},{kind:"Field",name:{kind:"Name",value:"isBotBlocked"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOne"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOneBotChat"}},{kind:"Field",name:{kind:"Name",value:"isDisabled"}},{kind:"Field",name:{kind:"Name",value:"disabledReason"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"code"}},{kind:"Field",name:{kind:"Name",value:"newlyCreatedUserId"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingChatPolicy"}},{kind:"Field",name:{kind:"Name",value:"chatSubType"}},{kind:"Field",name:{kind:"Name",value:"chatType"}},{kind:"Field",name:{kind:"Name",value:"isSfB"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isMeeting"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isOneOnOne"}},{kind:"Field",name:{kind:"Name",value:"isMuted"}},{kind:"Field",name:{kind:"Name",value:"isFederated"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]},{kind:"Field",name:{kind:"Name",value:"isHidden"}},{kind:"Field",name:{kind:"Name",value:"isRead"}},{kind:"Field",name:{kind:"Name",value:"isRetentionHorizonSet"}},{kind:"Field",name:{kind:"Name",value:"isModerator"}},{kind:"Field",name:{kind:"Name",value:"replyPermission"}},{kind:"Field",name:{kind:"Name",value:"isAdmin"}},{kind:"Field",name:{kind:"Name",value:"isUserAnonymous"}},{kind:"Field",name:{kind:"Name",value:"substrateGroupId"}},{kind:"Field",name:{kind:"Name",value:"lastMessage"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"lastMessageFields"}}]}},{kind:"Field",name:{kind:"Name",value:"me"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userFields"}}]}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonFields"}}]}},{kind:"Field",name:{kind:"Name",value:"consumptionHorizonBookmark"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonBookmarkFields"}}]}},{kind:"Field",name:{kind:"Name",value:"userConsumptionHorizon"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"consumptionHorizonBookmarkFields"}}]}},{kind:"Field",name:{kind:"Name",value:"memberIds"}},{kind:"Field",name:{kind:"Name",value:"membersLimited"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userFields"}}]}},{kind:"Field",name:{kind:"Name",value:"memberDisplayNamesLimited"}},{kind:"Field",name:{kind:"Name",value:"hasFederatedUser"}},{kind:"Field",name:{kind:"Name",value:"hasTflConsumerUser"}},{kind:"Field",name:{kind:"Name",value:"cfet"}},{kind:"Field",name:{kind:"Name",value:"hasEnterpriseUser"}},{kind:"Field",name:{kind:"Name",value:"hasUnknownConsumerUser"}},{kind:"Field",name:{kind:"Name",value:"hasUnknownEnterpriseUser"}},{kind:"Field",name:{kind:"Name",value:"hasUnresolvedFederatedUser"}},{kind:"Field",name:{kind:"Name",value:"hasTflSmsUnverifiedUser"}},{kind:"Field",name:{kind:"Name",value:"hasTflSmsVerifiedUser"}},{kind:"Field",name:{kind:"Name",value:"nonTeamsFederatedUserLimitedNames"}},{kind:"Field",name:{kind:"Name",value:"nonTeamsFederatedUsersLength"}},{kind:"Field",name:{kind:"Name",value:"isPrivateChatPolicyDefinedScenario"}},{kind:"Field",name:{kind:"Name",value:"isChatDisabledForRecipients"}},{kind:"Field",name:{kind:"Name",value:"guardianChatInfo"}},{kind:"Field",name:{kind:"Name",value:"quarantineCounter"}},{kind:"Field",name:{kind:"Name",value:"tflOffNetworkUser"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userFields"}}]}},{kind:"Field",name:{kind:"Name",value:"tflOffNetworkUserLength"}},{kind:"Field",name:{kind:"Name",value:"hasBotMember"}},{kind:"Field",name:{kind:"Name",value:"isUserMember"}},{kind:"Field",name:{kind:"Name",value:"botMembers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"userAdminSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"adminDeleteEnabled"}},{kind:"Field",name:{kind:"Name",value:"deleteMessagesEnabled"}}]}},{kind:"Field",name:{kind:"Name",value:"creator"}},{kind:"Field",name:{kind:"Name",value:"meetingInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"meetingType"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"meetingData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"meetingCode"}},{kind:"Field",name:{kind:"Name",value:"passcode"}},{kind:"Field",name:{kind:"Name",value:"meetingUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"iCalUid"}},{kind:"Field",name:{kind:"Name",value:"resolvedSensitivityLabelId"}},{kind:"Field",name:{kind:"Name",value:"isCopyRestrictionEnforced"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"organizerId"}},{kind:"Field",name:{kind:"Name",value:"meetingJoinUrl"}},{kind:"Field",name:{kind:"Name",value:"scenario"}},{kind:"Field",name:{kind:"Name",value:"eventType"}},{kind:"Field",name:{kind:"Name",value:"isCancelled"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonRecordingMessageMiFragment"}},{kind:"Field",name:{kind:"Name",value:"messagingPolicy"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"textOnlyChat"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"chatDisabledContext"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isUIDisabled"}},{kind:"Field",name:{kind:"Name",value:"disabledReason"}},{kind:"Field",name:{kind:"Name",value:"extendedData"}},{kind:"Field",name:{kind:"Name",value:"lastUpdatedTime"}}]}},{kind:"Field",name:{kind:"Name",value:"interopConversationStatus"}},{kind:"Field",name:{kind:"Name",value:"extendedDirectoryRedemptionRequired"}},{kind:"Field",name:{kind:"Name",value:"hasExtendedDirectoryUsers"}},{kind:"Field",name:{kind:"Name",value:"chatScheduleSuggestionSuppressUntil"}},{kind:"Field",name:{kind:"Name",value:"chatHistoryHiddenTime"}},{kind:"Field",name:{kind:"Name",value:"clearHistoryTime"}},{kind:"Field",name:{kind:"Name",value:"userProperties"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userProperties"}}]}},{kind:"Field",name:{kind:"Name",value:"pinnedConversationItems"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"pinnedMessageItemFields"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"addedBy"}},{kind:"Field",name:{kind:"Name",value:"addedByTenantId"}},{kind:"Field",name:{kind:"Name",value:"identityMaskEnabled"}},{kind:"Field",name:{kind:"Name",value:"sensitivityLabel"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isCopyBlocked"}}]}},{kind:"Field",name:{kind:"Name",value:"createdAt"}},{kind:"Field",name:{kind:"Name",value:"lastJoinAt"}},{kind:"Field",name:{kind:"Name",value:"isCommentStream"}},{kind:"Field",name:{kind:"Name",value:"avatarUrl"}},{kind:"Field",name:{kind:"Name",value:"meetingChatType"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonUseExternalTagFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonChatMtoTelemetryFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonChatWithMtoUserBannerFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonChatRecapFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonUseMtoUserBannerFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonChatPaneLayoutFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonChatAddMembersFragment"}},{kind:"Field",name:{kind:"Name",value:"awarenessLiveState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"key"}},{kind:"Field",name:{kind:"Name",value:"value"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingChatType"}}]}}]}},...a.T.definitions,...t.f.definitions,...r.T.definitions,...o.v.definitions,...l.e.definitions,...s.I.definitions,...d.E.definitions,...c.g.definitions,...m.x.definitions,...u.l.definitions,...p.B.definitions,...k.X.definitions,...g.x.definitions,...N._.definitions]}},507078:(e,n,i)=>{"use strict";i.d(n,{wV:()=>t,ii:()=>r,x2:()=>o,xS:()=>l,UG:()=>s,T3:()=>d});var a=i(30416);const t=()=>(0,a.x)("amsV2Domain")||"",r=()=>(0,a.x)("baseImageUrl")||"",o=()=>(0,a.x)("isImageAuthCookieValid")||!1,l=()=>(0,a.x)("postCriticalPhaseReached")||!1,s=()=>(0,a.x)("completePhaseReached")||!1,d=()=>(0,a.x)("meControlAvatarSrc")||""},30416:(e,n,i)=>{"use strict";i.d(n,{I:()=>m,x:()=>u});var a=i(379263),t=i(555128),r=i(818319),o=i(879815);var l=i(347653),s=i(994575),d=i(649641);const c=(0,l.QS)(void 0),m=e=>{const n=(0,a.f8)();return p(n,e)},u=e=>{const{appsRegistryService:n}=(0,d.i)(),i=n.getAppByActor(t.$K),a=i?.manifest.id;return p(a,e)},p=(e,n)=>{const i=(0,s.w)("useAppViewStateInternal"),{appsRegistryService:a,windowId:t}=(0,d.i)();e||i.errorToTelemetry?.(`Expected appId '${e}' to exist in order to look up viewStateKey ${n}'`,"webclient_framework_foundation_core_services");const l=e&&a.getAppViewStateForWindow(t,e)||void 0;e&&!l&&i.errorToTelemetry?.(`Expected appViewState to exist for appId '${e}' and windowId '${t}'`,"webclient_framework_foundation_core_services");const m=l&&k(l,n);e&&!m&&i.errorToTelemetry?.(`Expected reactiveVar to exist for appId '${e}' and viewStateKey '${n}'`,"webclient_framework_foundation_core_services");return function(e){const[n,i]=r.useState((()=>e()));return r.useEffect((()=>{let a=!1;const t=e();n!==t&&i(t);const r=e.onNextChange((e=>{(0,o.unstable_scheduleCallback)(o.unstable_NormalPriority,(()=>{a||i(e)}))}));return()=>{a=!0,r()}}),[e,n]),n}(m||c)},k=(e,n)=>{const i=e.nonNavigationalReactiveValues,a=i?.[n]?.ref,t=e.navigationalReactiveValues,r=t?.[n]?.ref;return r||a}},257135:(e,n,i)=>{"use strict";i.d(n,{mf:()=>p,nv:()=>k,rH:()=>v,g3:()=>m,NH:()=>f,n$:()=>u});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"getUsersForConversation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mriArray"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isShortProfileRequested"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"peoplePickerFilters"}},type:{kind:"NamedType",name:{kind:"Name",value:"PeoplePickerFiltersInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isSharedChannel"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"hostTenantId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"getUsersForConversation"},arguments:[{kind:"Argument",name:{kind:"Name",value:"mriArray"},value:{kind:"Variable",name:{kind:"Name",value:"mriArray"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}},{kind:"Argument",name:{kind:"Name",value:"isShortProfileRequested"},value:{kind:"Variable",name:{kind:"Name",value:"isShortProfileRequested"}}},{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}}},{kind:"Argument",name:{kind:"Name",value:"peoplePickerFilters"},value:{kind:"Variable",name:{kind:"Name",value:"peoplePickerFilters"}}},{kind:"Argument",name:{kind:"Name",value:"isSharedChannel"},value:{kind:"Variable",name:{kind:"Name",value:"isSharedChannel"}}},{kind:"Argument",name:{kind:"Name",value:"hostTenantId"},value:{kind:"Variable",name:{kind:"Name",value:"hostTenantId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userProfileData"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"userProfileData"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"User"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"userPrincipalName"}},{kind:"Field",name:{kind:"Name",value:"companyName"}},{kind:"Field",name:{kind:"Name",value:"tenantName"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"userType"}},{kind:"Field",name:{kind:"Name",value:"isFederated"}},{kind:"Field",name:{kind:"Name",value:"xtapUser"}}]}}]}.definitions]};var t=i(379658),r=i(439697),o=i(602129),l=i(683184),s=i(882066);const d={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsPersonaUserTypeQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"userType"}},{kind:"Field",name:{kind:"Name",value:"profileType"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]},c="Topic",m=e=>{const{ariaLabel:n,behavior:i,disableAccessibilityDefaults:a,externalAppSessionCorrelationId:t,hostConversationId:r,hostTenantId:o,isSharedChannel:l,tabIndex:s,userId:d,handleOnCardOpen:m,handleOnCardClose:u,personaType:p,topicId:k,contextId:g,highlightedText:N,shouldDeferCardOpenToParentWindow:f,displayName:v}=e,T=p===c?{contextId:g,highlightedText:N,hideEntityAndContextQuestion:!0}:void 0;return{cardParameters:{disableAccessibilityDefaults:!!a,personaInfo:{identifiers:{PersonaType:p||"NotResolved",HostAppPersonaId:h({userId:d,isSharedChannel:!!l,hostTenantId:o,hostConversationId:r}),TeamsMri:p!==c?d:void 0,TopicId:k},topicMetadata:T,displayName:v},behavior:{onCardOpen:m,onCardClose:u,disableHover:!1,cardPlacementMode:"AnchorSide",shouldDeferCardOpenToParentWindow:!!f,...i},externalAppSessionCorrelationId:t,ariaLabel:n,clientScenario:"MicrosoftTeams_MultiWindow",cardOpenTime:Date.now()},tabIndex:s}},u=(e,n,i)=>{e.LPC.openCard(n,{...m(i).cardParameters})},p=(e,n)=>{e.LPC.dismissCard((()=>{}),n)},k=async(e,n,i,t,o,s,d,c,m)=>{const{enableTflSms:u}=d.get(l.J.Messaging),{showPersonCardForSMSUser:p,showPersonCardForXTapUser:k}=d.get(l.J.People),{disablePstnPersonaCard:h,disablePersonaCard:v}=d.get(l.J.Calling),{enableFlyoutInlineChat:T,enableSimplifiedFeaturesInFlyoutChat:M}=d.get(l.J.Flyout);if(v||T&&M)return!1;if(e&&r.eo.isTFLSmsMri(e))return!!u&&!!p;if(e&&r.eo.isTFLOffNetworkUser(e))return!1;if(n&&"attendee"===i&&r.eo.isAnonymousTfwUser(e))return!1;if(g(e,d))return!1;if(N(!!h,e))return!1;if(t&&!k){const n=f(e,o||"",s,m,t);if(!n)return m.warn("xTap profile Query variables are not defined for a shared channel"),!1;const{data:i}=await c.query({query:a,variables:n,context:{callerInfo:"lpc-persona-container"}});if(!i||!i.getUsersForConversation)return m.warn("xTap profile Query returned null data"),!1;const l=i.getUsersForConversation,d=!!(l.length>0&&l[0]&&r.eo.isFederatedUser(l[0])&&l[0].xtapUser);return!d||!!k&&d}return!0},g=(e,n)=>{const i=n.get(l.J.Metadata).environment===t.s.life,a=n.get(l.J.PhonelinkSms).enablePhonelinkSms||!1,r=n.get(l.J.HostCapabilities).phoneLinkingBlocked||!1,o=a&&!r;return e&&(0,s.EG)(e)&&i&&o},N=(e,n)=>e&&(0,s.EG)(n);function f(e,n,i,a,t){if(!n&&t)return void a.warn("Host conversation Id is not defined for a shared channel");return{mriArray:[e],conversationId:t?n:"",isShortProfileRequested:!1,peoplePickerFilters:void 0,isSharedChannel:t,hostTenantId:i}}const h=({userId:e,isSharedChannel:n,hostTenantId:i,hostConversationId:a})=>JSON.stringify({userId:e,isSharedChannel:n,hostTenantId:i,hostConversationId:a});const v=async(e,n,i)=>{const{data:a}=await i.query({query:d,variables:{userId:e},context:{callerInfo:"lpc-persona-container:on-hover"}}),{user:t}=a,{userType:l,profileType:s,type:c}=t||{},m=r.eo.isMTOUser({profileType:s})?o.vf.MTOUser:r.eo.isB2BMember({profileType:s,userType:l})?o.vf.B2BMember:r.eo.isAcsUserMri(e)?o.vf.ACSUser:r.eo.isAnonymousTfwUser(e)?o.vf.anonymousUser:l||c,u=n.createDatabag?.();let p;return l&&(p=r.eo.getTfwExtendedDirectoryMembership({mri:e,userType:l})),u&&(u.isEDUser=!!p,u.EDUserState=p,u.userTypeSelected=m),u}},879565:(e,n,i)=>{"use strict";i.d(n,{Y:()=>N});var a=i(681971),t=i(683184),r=i(686219),o=i(323356),l=i(90934),s=i(462512),d=i(237867),c=i(803238),m=i(818319),u=i(629494),p=i(366296),k=i(316877),g=i(679868);const N=()=>{const e=(0,d.x)(),{entityCommanding:n}=(0,a.SE)(),{enableAppDetailsToChatNavigation:i}=(0,u.NC)(t.J.Extensibility,["enableAppDetailsToChatNavigation"]),c=(0,g.V)();return m.useCallback((async(a,t)=>{const d=await(0,s.yx)(e,a),m=d.bots?.[0]?.id,u=h(m),{isM365BotPostInstallNavEnabled:g,navigateToM365BotChat:N}=c(a,u);if(f(d))t?g()?await N(!1):n.platform.launchPersonalPlatformApp(a,!1):n.platform.launchPersonalApp({appId:a,botMri:u,isNewlyInstalled:!1});else if(v("Personal",d.messageExtensions)){const t=n.platform.launchAppDetailsTutorial({appName:d.name??"",isFirstInstallation:!1,hasCommandBoxCapability:T(d,"Commandbox"),hasComposeCapability:T(d,"Compose")}).subscribe({next:t=>{t.containerState&&t.containerState===r.oq.Confirmed&&(i?n.chat.default({correlation:{source:o.D.PlatformAppDetailsDialog},stateTransition:r.su.flush,visibilityState:r.fe.show}).then((()=>{e.mutate({mutation:p.K,variables:{input:{appId:a,id:(0,k.v4)(),capability:l.dB.MessagingExtension}}})})):n.platform.appDetailsPostInstall({name:"navigateToLastChatState",appCapability:l.dB.MessagingExtension,appId:a,externalId:d.externalId??""}).then((()=>{e.mutate({mutation:p.K,variables:{input:{appId:a,id:(0,k.v4)(),capability:l.dB.MessagingExtension}}})})))},complete:()=>{t.unsubscribe()}})}else;}),[e,c,n.platform,i,n.chat])},f=e=>{const n=(e.meetingExtensionDefinition?.scenes?.length??0)>0,i=(e.meetingExtensionDefinition?.filters?.length??0)>0;return v("Personal",e.staticTabs)||v("Personal",e.bots)||n||i},h=e=>{if(e){const n=e?.startsWith("28:");return n?e:`28:${e}`}},v=(e,n)=>(0,c.some)(n,(n=>(0,c.includes)(n.scopes,e))),T=(e,n)=>e.messageExtensions?.some((e=>e.commands?.some((e=>e.context?e.context.some((e=>e===n)):"Commandbox"===n||"Compose"))))??!1},679868:(e,n,i)=>{"use strict";i.d(n,{V:()=>g});var a=i(818319),t=i(681971),r=i(994575),o=i(686219),l=i(323356),s=i(629494),d=i(683184),c=i(237867),m=i(224611);const u={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsPlatformSharedHooksGetConversationForBotIdQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"installedScope"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"AppInstallScope"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedApp"},arguments:[{kind:"Argument",name:{kind:"Name",value:"installedScope"},value:{kind:"Variable",name:{kind:"Name",value:"installedScope"}}},{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"conversationForBot"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]}}]},p={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsPlatformSharedHooksGetPinnedChatIdsQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"pinnedChats"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"edges"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Conversation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ChatListChannelConversation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]}}]}}]}}]},k={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"ComponentsPlatformSharedHooksSetChatPinnedMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"convId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pinned"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"setChatPinned"},arguments:[{kind:"Argument",name:{kind:"Name",value:"convId"},value:{kind:"Variable",name:{kind:"Name",value:"convId"}}},{kind:"Argument",name:{kind:"Name",value:"pinned"},value:{kind:"Variable",name:{kind:"Name",value:"pinned"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConversationPinnedUpdate"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"convId"}},{kind:"Field",name:{kind:"Name",value:"pinned"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"SetChatPinnedMaxLimitReachedError"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"maxPinnedChats"}}]}}]}}]}}]},g=()=>{const e=(0,c.x)(),{entityCommanding:n}=(0,t.SE)(),{enableM365BotPostInstallNavigation:i,m365ChatBotIds:g}=(0,s.NC)(d.J.Messaging,["enableM365BotPostInstallNavigation","m365ChatBotIds"]),[N]=(0,m.D)(k),f=(0,r.w)("useLaunchBizChatNavigation");return a.useCallback(((a,t="")=>({isM365BotPostInstallNavEnabled:()=>{const e=[...g||[]];return i&&e.includes(t)},navigateToM365BotChat:async i=>{try{const{data:t}=await e.query({query:u,variables:{appId:a,installedScope:"Personal"},fetchPolicy:"no-cache"});if(t.installedApp?.conversationForBot?.id){let r=!1;const s=t.installedApp.conversationForBot.id;try{const{data:n}=await e.query({query:p});r=!!n?.pinnedChats.edges.some((e=>e.node.id===s))}catch{f.errorToTelemetry?.("failed to get pinned chat ids for bot post install navigation.","platform_userlifecycle_details_dialog_event",{appId:a,conversationId:s})}if(i&&!r)try{await N({variables:{convId:t.installedApp.conversationForBot.id,pinned:!0}})}catch{f.errorToTelemetry?.("failed to set chat pinned for bot post install navigation.","platform_userlifecycle_details_dialog_event",{appId:a,conversationId:s})}await n.chat.chatById(t.installedApp.conversationForBot.id,{entityCommand:{stateTransition:o.su.forceFlush,visibilityState:o.fe.show,correlation:{source:l.D.PlatformAppDetailsDialog}}})}}catch(e){throw f.errorToTelemetry?.(`failed to grab the conversation id from the installed app. appId: ${a}`,"platform_userlifecycle_details_dialog_event",{appId:a}),e}}})),[e,i,n.chat,f,g,N])}},941147:(e,n,i)=>{"use strict";i.d(n,{K8:()=>a,Tt:()=>t,_z:()=>r,pU:()=>o,if:()=>l});const a="com.microsoft.teamspace.tab.web",t="com.microsoft.teamspace.tab.file.staticviewer.pdf",r="com.microsoft.teams.callable-channel",o="44263ed4-f1ac-4e96-93aa-d24dd50459ea",l="b85718a3-6d15-4f59-8fad-b6809c6fc6a9"},348214:(e,n,i)=>{"use strict";i.d(n,{u:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsPlatformTabUtilsChannelByIdQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"channelByID"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"channelType"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"defaultOneNoteSectionId"}},{kind:"Field",name:{kind:"Name",value:"defaultFileSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filesRelativePath"}}]}},{kind:"Field",name:{kind:"Name",value:"hostTeamGroupId"}},{kind:"Field",name:{kind:"Name",value:"hostTeamId"}},{kind:"Field",name:{kind:"Name",value:"hostTenantId"}},{kind:"Field",name:{kind:"Name",value:"owningTeam"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"teamSiteInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"groupId"}},{kind:"Field",name:{kind:"Name",value:"sharepointSiteUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"isArchived"}},{kind:"Field",name:{kind:"Name",value:"memberRole"}},{kind:"Field",name:{kind:"Name",value:"teamType"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}}]}},{kind:"Field",name:{kind:"Name",value:"memberRole"}},{kind:"Field",name:{kind:"Name",value:"sharepointSiteUrl"}},{kind:"Field",name:{kind:"Name",value:"isGeneral"}}]}}]}}]}},775667:(e,n,i)=>{"use strict";i.d(n,{li:()=>d,g4:()=>c,E9:()=>m,dJ:()=>u,iP:()=>k,ot:()=>N,dE:()=>f,Cn:()=>T,UH:()=>M});var a,t=i(907203),r=i(503720),o=i(609446),l=i(745780),s=i(981917);!function(e){e.Member="member",e.Guest="guest",e.External="external",e.Anonymous="anonymous",e.Unknown="unknown"}(a||(a={}));const d=(e,n,i)=>n===s.k2.None&&e===o.rf.Conference&&!i,c=(e,n,i)=>n===s.k2.None&&e===o.rf.P2P&&i,m=(e,n)=>{if(u(e))return a.Anonymous;if(p(e))return a.Guest;if(e&&n){if(k(e.profile?.tenantId,n))return a.External;if(g(e.profile?.tenantId,n))return a.Member}return a.Unknown},u=e=>e?.role===t.w4.Anonymous,p=e=>e?.role===t.w4.Guest,k=(e,n,i)=>(i?.log(`isExternalUser: tenantId-${n}, currentTenantId-${e}`),!(!n||!e||e===n)),g=(e,n)=>!!n&&!!e&&e===n,N=(e,n,i,a,t)=>{const r=e?.baseInfo?.id,o=n?.appDefinition;if(t?.log(`(isValidTabForInMeetingExperience) Tab: ${r}, App: ${o?.name} ${o?.id}, isAnonymousUser: ${i}, enableMeetingSurfaces: ${a}`),!a||((e,n,i)=>{const a=n.appDefinition?.galleryTabs?.[0];let t=!1;if("StaticExtensionTab"===e.__typename){const a=n.appDefinition?.staticTabs?.find((n=>n.entityId===e?.entityId));t=a?.context?.some((e=>e===l.BU.MeetingSidePanel)),i?.log(`(isMeetingOptimizeApp) Static tab ${e?.baseInfo?.id} isMeetingOptimized: ${t}`)}else t=a?.context?.some((e=>e===l.jD.MeetingSidePanel))||a?.meetingSurfaces?.some((e=>e===l.Aj.SidePanel)),i?.log(`(isMeetingOptimizeApp) Gallery Tab ${e?.baseInfo?.id} isMeetingOptimized: ${t}. `);return!!t})(e,n,t)){const e=!i||(e=>e?.appDefinition?.meetingExtensionDefinition?.isAnonymousAccessAllowed)(n);return t?.log(`(isValidTabForInMeetingExperience) is access to tab '${r}', valid: ${e}`),e}return!1},f=(e,n,i,a,l,s,c,m,u,p)=>{if(!s)return!1;const k=e?.type===t.Ch.MsaLife;if(p&&k)return!0;if(T(e,s))return!1;const g=d(i,c,a);if(v(a,g,l))return!1;const N=n===r.Eh.Organizer||n===r.Eh.Presenter,f=m&&i===o.rf.P2P;return N||f||u&&h(n,g)},h=(e,n)=>e===r.Eh.Attendee&&n,v=(e,n,i)=>i&&(e||n),T=(e,n)=>{if(u(e))return!0;if(p(e))return!0;return!!k(e?.profile.tenantId,n)},M=(e,n)=>`${e};replyChainId=${n}`},610597:(e,n,i)=>{"use strict";i.d(n,{g7:()=>T,$s:()=>M,hR:()=>y,$c:()=>S,RD:()=>A,kT:()=>I,u$:()=>C,uo:()=>F,kq:()=>U,zy:()=>E,xO:()=>w,LY:()=>L,KG:()=>x,eA:()=>j,OL:()=>V,s0:()=>z,Rd:()=>P,k6:()=>R,TQ:()=>B,gc:()=>Q,jZ:()=>W,SR:()=>Z,uJ:()=>Y,kU:()=>G,pQ:()=>_,rh:()=>J,BT:()=>H,Kf:()=>q,vr:()=>X,oP:()=>K,_K:()=>$,J2:()=>ee,dN:()=>ne,ti:()=>ie,Fd:()=>ae,r6:()=>te,kB:()=>re,CX:()=>oe,Td:()=>le,Br:()=>de,ui:()=>ce,JF:()=>me,Iv:()=>ue,nq:()=>pe,rt:()=>ke,ig:()=>ge,eF:()=>Ne,OJ:()=>fe,w4:()=>he,cq:()=>ve,$b:()=>Te,oh:()=>ye});var a=i(750949),t=i(447567),r=i(288718),o=i(12978),l=i(960981),s=i(876323),d=i(543491),c=i(485510),m=i(745780),u=i(233304),p=i(981917),k=i(609446),g=i(348214),N=i(775667),f=i(482616),h=i(702135),v=i(941147);const T=async(e,n,i,a,t)=>{const{data:r,error:o}=await e.query({query:l.b,variables:i?.isChannelMeeting&&i?.messageId?{id:n,queryType:"QueryByMessage",storageOptions:{messageStorage:{messageId:i.messageId},platformTabsQueryType:"QueryByMessage"},options:a}:{id:n,queryType:"QueryByThread",options:a},fetchPolicy:"network-only"});return o&&t?.error(`(getTabsData) Error fetching tabs: ${o.message}`),r},M=async(e,n,i,t,r,o)=>{const l=j(t),s=l?await S(e,n):void 0,{data:d,error:c}=await e.query({query:a.V,variables:{scope:l?"Team":"GroupChat",conversationId:l?s:n,appId:i}});return c&&(o?.fail({errors:`Error getting app data for app ${i}: ${c.message}`,"App.Id":i,reason:"AppDefinitionError"}),r?.error(`(getAppData) Error getting app data for app ${i}: ${c.message}`)),d&&d.appDefinition||(o?.fail({errors:`App definition not found for app ${i}`,"App.Id":i,reason:"AppDefinitionMissing"}),r?.error(`(getAppData) App definition not found for app ${i}`)),d},y=async(e,n,i,t)=>{const{data:r}=await e.query({query:a.V,variables:{scope:t,conversationId:n,appId:i}});return r},S=async(e,n)=>A(e,n),A=async(e,n)=>{if(!n)return;const{conversationId:i}=F(n);if(!i)return;const a=await e.query({query:g.u,variables:{conversationId:i}}),t=a.data?.channelByID.owningTeam?.id;return t||void 0},I=(e,n,i)=>{if(b(n)){if(!i)return{botMri:e,appId:n.id};{const a=n.definition?.staticTabs?.some((e=>e.entityId===i));if(a)return{botMri:e,appId:n.id,tabEntityId:i}}}},b=e=>!!(e.definition?.galleryTabs?.some((e=>e?.context?.some((e=>e===m.jD.MeetingSidePanel))))||e.definition?.galleryTabs?.some((e=>e?.meetingSurfaces?.some((e=>e===m.Aj.SidePanel))))||e.definition?.staticTabs?.some((e=>e?.context?.some((e=>e===m.BU.MeetingSidePanel))))),C=async(e,n,i,a)=>{const{data:t,error:r}=await e.query({query:s.y,variables:{tabId:n,threadId:i}});return r&&a?.error(`(getPlatformTab) Error fetching tab: ${r.message}`),t},D=";messageid=",F=e=>{const n=e?.split(";replyChainId=")??[];let i=n[0];const a=n[1];if(i?.includes("channelId")){i=JSON.parse(i).channelId}return i?.includes(D)&&(i=i.split(D)[0]),{conversationId:i,replyChainId:a}},U=e=>{const{replyChainId:n}=F(e);return j(n)?"Team":"GroupChat"},E=async(e,n,i,a,t,r,o,l,s,c)=>{const m=[],u=[];if(!e)return m;for(const l of e)if(s&&"StaticExtensionTab"===l.__typename||"ExtensionTab"===l.__typename){const e={tabId:l.baseInfo.id,displayName:decodeURIComponent(l.baseInfo.displayName||""),entityId:l.entityId,tabType:l.__typename,tabPinnedState:l.pinnedState||"UserPinned"},s=await M(n,i,l.baseInfo.appId,r,o,c);if((0,N.ot)(l,s,a,!!t,o)){const n={appId:l.baseInfo.appId,appName:s.appDefinition?.name||"",iconUrl:s.appDefinition?.smallImageUrl||""};e.displayName||(e.displayName=decodeURIComponent(n.appName));const i={tabInfo:e,appInfo:n};m.push(i)}else u.push(l.baseInfo.appId)}return u?.length>0&&(c?.mark(d.ck.PlatformTabFetchUbarDroppedTabsDueToMeetingContext),o?.log(`convertToTabButtons(${l}) dropped apps: ${u.join(",")}`)),m},w=async(e,n,i,a,t,r,o,l,s,c)=>{c?.mark(d.ck.PlatformTabFetchStart);const m=await T(e,n,t,l,r);r?.log(`getPlatformTabs(${o}): fetched ${m.platformTabs?.length} tabs`),c?.mark(d.ck.PlatformTabFetchDataComplete);return await E(m.platformTabs,e,n,i,a,t?.messageId,r,o,s,c)},L=(e,n)=>{const i=[],a=[];for(const n of e.platformTabsEvent)if("StaticExtensionTab"===n?.__typename||"ExtensionTab"===n?.__typename){const e=n.baseInfo.appId??"",t=n.baseInfo.id??"";i.push(e),a.push(t)}n.log(`tabsEvent appData: ${i.join(",")}`),n.log(`tabsEvent tabData: ${a.join(",")}`)},x=(e,n,i,a,t,r,o,l,s,d)=>{const c=e&&["Scheduled","Recurring"].includes(e)&&(!r||d),m=l&&O(e,n,i),u=o&&(0,N.li)(n,i,a),p=s&&(0,N.g4)(n,i,a);return t?.log(`isSupportedMeeting: meetingType-${e}, isChannelMeeting- ${r}, isSupportedInPrivateOrChannelMeeting-${c}, \n    callType -${n}, isSupportedInCalendarMeetNow: ${m}, isSupportedInGroupCall: ${u},\n    isSupportedInOneOnOneCall: ${p}: chatSubType - ${i}, isOneOnOne - ${a}`),!!(c||m||u||p)},O=(e,n,i)=>e&&"MeetNow"===e&&n===k.rf.Conference&&i===p.k2.Meeting,j=e=>!!e&&"0"!==e;function V(e){return j(e)?{platformTabsQueryType:"QueryByMessage",messageStorage:{messageId:e}}:void 0}function z(e){return e?{appInstallScope:"Team"}:{appInstallScope:"GroupChat"}}const P=e=>j(e)?"QueryByMessage":"QueryByThread",R=e=>{switch(e){case t.m.Channel:case t.m.ChannelMeeting:case t.m.ChannelMeetingSchedulingForm:case t.m.SelectAppEntity:return"Team";default:return"GroupChat"}},B=e=>e?{appInstallScope:"Team",platformTabsEntryPoint:"ChannelMeeting"}:{appInstallScope:"GroupChat",platformTabsEntryPoint:"PrivateMeeting"},Q=e=>{switch(e){case u.mQ.privateMeetingSchedulingForm:return{appInstallScope:"GroupChat",platformTabsEntryPoint:"PrivateMeetingSchedulingForm"};case u.mQ.chatTab:return{appInstallScope:"GroupChat",platformTabsEntryPoint:"GroupChat"};case u.mQ.channelMeetingSchedulingForm:return{appInstallScope:"Team",platformTabsEntryPoint:"ChannelMeetingSchedulingForm"};case u.mQ.channelTab:return{appInstallScope:"Team",platformTabsEntryPoint:"Channel"};default:return}},W=e=>{const n=new Error(e.message);return n.name=e.name,n},Z=e=>{switch(e){case"GroupChat":return r.Mv.group;case"Personal":return r.Mv.personal;case"Team":return r.Mv.team;default:return}},Y=e=>G({chatId:e?.chatId,teamId:e?.teamId,channelId:e?.channelId}),G=e=>{const{chatId:n,teamId:i,channelId:a}=e||{};return n?"GroupChat":i||a?"Team":"Personal"},_=e=>X(e)||ee(e)?e.baseInfo.id:"",J=e=>X(e)||ee(e)?e.baseInfo.appId:"",H=e=>ee(e)&&e.entityId||"",q=e=>(X(e)||ee(e))&&e.websiteUrl?e.websiteUrl:null,X=e=>"WebsiteTab"===e?.__typename,K=e=>"FileViewTab"===e?.__typename,$=e=>e===v.Tt,ee=e=>"ExtensionTab"===e?.__typename||ne(e),ne=e=>"StaticExtensionTab"===e?.__typename,ie=e=>"StaticExtensionTab"===e,ae=e=>"PlaceholderTab"===e?.__typename,te=e=>!!ne(e)&&e.baseInfo?.context?.includes(m.BU.TeamLevelApp),re=(e,n)=>e?.linkedEntity?.type===o.py.extensions&&!n,oe=(e,n,i,a,t)=>({threadId:e,tab:{id:n,displayName:"",tabType:"StaticExtensionTab",appInstallScope:i,externalId:t},storageOptions:V(a)}),le=(e,n,i)=>{if(e)return se(e.id,e.isMeeting,e.isOneOnOne,e.isOneOnOneBotChat,n,i)},se=(e,n,i,a,t,r)=>{if(e)return n?c.Th.Meeting:i?a?c.Th.Botchat:c.Th.OneOnOneChat:t||"channelTab"===r?c.Th.Channel:c.Th.GroupChat},de=[v._z,v.pU,v.if,v.Tt,v.K8],ce=(e,n,i,a,t,r)=>{if(de.includes(n))return;const o=(0,h._S)(n),l=(0,f.Z)(),s=n=>{const s=e.findScenario(n);s&&(s.cancel({errors:"NewScenarioStarting"}),e.clearScenario(s));const d=e.newScenario(n,{clientId:`${n};${l}`});e.hoistScenarioToCore&&e.hoistScenarioToCore(d),d.appendEventData({"App.Id":o,"App.EntryPoint":i,"PlatformApp.IsMultiWindow":!!t,"PlatformApp.FromOpenFileInTeams":!!r}),a?.log(`phase 1 scenario marker started for entryPoint ${i}`)};s(d.RG.PlatformTabFrameLoading),s(d.RG.PlatformTabLaunch)},me=(e,n,i)=>{(a=>{e.findScenario(a)?.cancel();const t=(0,f.Z)();e.newScenario(a,{clientId:t}).appendEventData({"App.EntryPoint":n}),i?.log(`fetch platform tabs - scenario marker started for entryPoint ${n}`)})(d.RG.PlatformTabFetchData)},ue=(e,n)=>{switch(e){case t.m.Meeting:case t.m.ChannelMeeting:return m.BU.MeetingSidePanel;case t.m.PrivateMeetingSchedulingForm:case t.m.ChannelMeetingSchedulingForm:return m.BU.MeetingDetailsTab;case t.m.Channel:return m.BU.ChannelTab;case t.m.Chat:return n&&Me(n)?m.BU.MeetingChatTab:m.BU.PrivateChatTab;case t.m.MeetingChat:return m.BU.MeetingChatTab;default:return m.BU.Unknown}},pe=e=>{switch(e){case t.m.Chat:return u.mQ.chatTab;case t.m.Channel:return u.mQ.channelTab;case t.m.PrivateMeetingSchedulingForm:return u.mQ.privateMeetingSchedulingForm;case t.m.ChannelMeetingSchedulingForm:return u.mQ.channelMeetingSchedulingForm;default:return u.mQ.platformAppView}},ke=(e,n)=>"Desktop"===e&&!1===n,ge=e=>{switch(e){case r.Mv.group:return"GroupChat";case r.Mv.personal:return"Personal";case r.Mv.team:return"Team";default:return}},Ne=(e,n,i)=>({threadId:e.threadId,messageId:e.messageId||i?.messageId,appId:n.appId||e.appId,tabId:e.tabId||n.tabId,tabEntityId:n.tabEntityId||e.tabEntityId}),fe=(e,n)=>n.find((n=>"StaticExtensionTab"===n.__typename&&n?.baseInfo?.appId===e)),he=(e,n,i)=>Boolean(e&&e.length>0&&e.filter((e=>-1!==e.context?.indexOf(n)&&-1!==e.scopes?.indexOf(i))).length>0),ve=(e,n,i)=>{let a;if(n)try{a=e.id&&JSON.parse(e.id)}catch(n){i.error(`entity id ${e.id} json parsing failed`)}else{const n=e.id&&decodeURIComponent(e.id);a=n&&JSON.parse(n)}return a},Te=(e,n,i)=>i?.entryPoint===u.mQ.botChat||!(e&&n||i?.chatId),Me=e=>!!e&&e.includes("meeting"),ye=(e,n)=>(n&&e===u.$c.content)??!1},620046:(e,n,i)=>{"use strict";i.d(n,{e:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"baseInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BaseTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"externalAppId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"dateAdded"}},{kind:"Field",name:{kind:"Name",value:"order"}},{kind:"Field",name:{kind:"Name",value:"replyChainId"}},{kind:"Field",name:{kind:"Name",value:"teamInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"groupId"}},{kind:"Field",name:{kind:"Name",value:"teamSiteDomain"}},{kind:"Field",name:{kind:"Name",value:"teamSitePath"}},{kind:"Field",name:{kind:"Name",value:"teamSiteUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"channelInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"channelRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"channelType"}}]}},{kind:"Field",name:{kind:"Name",value:"tabPermission"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"canUpdateConfig"}},{kind:"Field",name:{kind:"Name",value:"canHaveTabConversation"}},{kind:"Field",name:{kind:"Name",value:"definedDevicePermissions"}}]}}]}}]}},111084:(e,n,i)=>{"use strict";i.d(n,{W:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesCalendarTabFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CalendarTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}}]}},...i(620046).e.definitions]}},412558:(e,n,i)=>{"use strict";i.d(n,{y:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesPlaceholderTabFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PlaceholderTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}}]}},...i(620046).e.definitions]}},653767:(e,n,i)=>{"use strict";i.d(n,{C:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"legacyDocumentLibraryTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LegacyDocumentLibraryTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"siteUrl"}},{kind:"Field",name:{kind:"Name",value:"libraryId"}},{kind:"Field",name:{kind:"Name",value:"libraryServerRelativeUrl"}},{kind:"Field",name:{kind:"Name",value:"selectedSiteImageUrl"}},{kind:"Field",name:{kind:"Name",value:"selectedDocumentLibraryTitle"}},{kind:"Field",name:{kind:"Name",value:"selectedSiteTitle"}}]}},...i(620046).e.definitions]}},744762:(e,n,i)=>{"use strict";i.d(n,{e:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"extensionTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ExtensionTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"removeUrl"}},{kind:"Field",name:{kind:"Name",value:"contentUrl"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}},{kind:"Field",name:{kind:"Name",value:"isPlaceholderTab"}}]}},...i(620046).e.definitions]}},984422:(e,n,i)=>{"use strict";i.d(n,{N:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"fileViewTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"FileViewTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"fileType"}},{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"serviceName"}},{kind:"Field",name:{kind:"Name",value:"providerMetadata"}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"shareUrl"}}]}},...i(620046).e.definitions]}},390565:(e,n,i)=>{"use strict";i.d(n,{K:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"legacyWikiTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LegacyWikiTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"wikiTabId"}},{kind:"Field",name:{kind:"Name",value:"wikiDefaultTab"}},{kind:"Field",name:{kind:"Name",value:"hasContent"}},{kind:"Field",name:{kind:"Name",value:"scenarioName"}},{kind:"Field",name:{kind:"Name",value:"isMyWiki"}},{kind:"Field",name:{kind:"Name",value:"isPrivateMeetingWiki"}},{kind:"Field",name:{kind:"Name",value:"meetingNotes"}},{kind:"Field",name:{kind:"Name",value:"hasMigratedToOneNote"}}]}},...i(620046).e.definitions]}},615164:(e,n,i)=>{"use strict";i.d(n,{H:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"oneNoteTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"OneNoteTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"oneNoteId"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"sectionUrl"}},{kind:"Field",name:{kind:"Name",value:"notebookId"}},{kind:"Field",name:{kind:"Name",value:"notebookLocation"}},{kind:"Field",name:{kind:"Name",value:"service"}},{kind:"Field",name:{kind:"Name",value:"subtype"}}]}},...i(620046).e.definitions]}},981818:(e,n,i)=>{"use strict";i.d(n,{S:()=>h});var a=i(496921),t=i(620046);const r={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"extensionTabInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ExtensionTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}}]}},...t.e.definitions]};var o=i(557132);const l={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"basicTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BasicTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}},{kind:"Field",name:{kind:"Name",value:"displayNameLocalizationKey"}}]}}]}},...t.e.definitions]};var s=i(732743),d=i(984422),c=i(151428),m=i(615164),u=i(390565),p=i(653767),k=i(412558),g=i(111084);const N={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesDocumentLibraryTabFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DocumentLibraryTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}}]}},...t.e.definitions]},f={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesWikiTabFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WikiTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}}]}},...t.e.definitions]},h={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"platformTabInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PlatformTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"FragmentSpread",name:{kind:"Name",value:"staticExtensionTabInfo"}},{kind:"FragmentSpread",name:{kind:"Name",value:"extensionTabInfo"}},{kind:"FragmentSpread",name:{kind:"Name",value:"websiteTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"basicTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"staticExtensionTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"fileViewTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"powerBiTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"oneNoteTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"legacyWikiTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"legacyDocumentLibraryTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesPlaceholderTabFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesCalendarTabFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesDocumentLibraryTabFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesWikiTabFragment"}}]}},...a.p.definitions,...r.definitions,...o.Y.definitions,...l.definitions,...s.Q.definitions,...d.N.definitions,...c.y.definitions,...m.H.definitions,...u.K.definitions,...p.C.definitions,...k.y.definitions,...g.W.definitions,...N.definitions,...f.definitions]}},151428:(e,n,i)=>{"use strict";i.d(n,{y:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"powerBiTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"PowerBiTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"originatingTeam"}},{kind:"Field",name:{kind:"Name",value:"originatingTeamId"}},{kind:"Field",name:{kind:"Name",value:"reports"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}}]}},...i(620046).e.definitions]}},732743:(e,n,i)=>{"use strict";i.d(n,{Q:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"staticExtensionTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"StaticExtensionTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"contentUrl"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}},{kind:"Field",name:{kind:"Name",value:"pinnedState"}}]}},...i(620046).e.definitions]}},496921:(e,n,i)=>{"use strict";i.d(n,{p:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"staticExtensionTabInfo"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"StaticExtensionTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}},{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"scopes"}}]}},{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"pinnedState"}}]}},...i(620046).e.definitions]}},557132:(e,n,i)=>{"use strict";i.d(n,{Y:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"websiteTab"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"WebsiteTab"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"baseInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"baseInfo"}}]}},{kind:"Field",name:{kind:"Name",value:"url"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}}]}},...i(620046).e.definitions]}},876323:(e,n,i)=>{"use strict";i.d(n,{y:()=>k});var a=i(732743),t=i(744762),r=i(557132),o=i(496921),l=i(984422),s=i(151428),d=i(615164),c=i(390565),m=i(653767),u=i(412558),p=i(111084);const k={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"Tab"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"tabId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"threadId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"storageOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"PlatformTabsStorage"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"TabOptionInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"platformTab"},arguments:[{kind:"Argument",name:{kind:"Name",value:"tabId"},value:{kind:"Variable",name:{kind:"Name",value:"tabId"}}},{kind:"Argument",name:{kind:"Name",value:"threadId"},value:{kind:"Variable",name:{kind:"Name",value:"threadId"}}},{kind:"Argument",name:{kind:"Name",value:"storageOptions"},value:{kind:"Variable",name:{kind:"Name",value:"storageOptions"}}},{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"FragmentSpread",name:{kind:"Name",value:"staticExtensionTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"extensionTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"websiteTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"staticExtensionTabInfo"}},{kind:"FragmentSpread",name:{kind:"Name",value:"fileViewTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"powerBiTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"oneNoteTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"legacyWikiTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"legacyDocumentLibraryTab"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesPlaceholderTabFragment"}},{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsPlatformTabsQueriesCalendarTabFragment"}}]}}]}},...a.Q.definitions,...t.e.definitions,...r.Y.definitions,...o.p.definitions,...l.N.definitions,...s.y.definitions,...d.H.definitions,...c.K.definitions,...m.C.definitions,...u.y.definitions,...p.W.definitions]}},960981:(e,n,i)=>{"use strict";i.d(n,{b:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"PlatformTabsInfo"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"queryType"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PlatformTabsQueryType"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"storageOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"PlatformTabsStorage"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"options"}},type:{kind:"NamedType",name:{kind:"Name",value:"TabOptionInput"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"platformTabs"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}},{kind:"Argument",name:{kind:"Name",value:"platformTabsQueryType"},value:{kind:"Variable",name:{kind:"Name",value:"queryType"}}},{kind:"Argument",name:{kind:"Name",value:"storageOptions"},value:{kind:"Variable",name:{kind:"Name",value:"storageOptions"}}},{kind:"Argument",name:{kind:"Name",value:"options"},value:{kind:"Variable",name:{kind:"Name",value:"options"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"platformTabInfo"}}]}}]}},...i(981818).S.definitions]}},867840:(e,n,i)=>{"use strict";i.d(n,{z:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"ComponentsPresenceSubscription"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"source"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PresenceSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"presenceUpdateEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"source"},value:{kind:"Variable",name:{kind:"Name",value:"source"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userPresenceData"}},{kind:"Field",name:{kind:"Name",value:"isBlocked"}},{kind:"Field",name:{kind:"Name",value:"isDisabled"}}]}}]}},...i(550214).O.definitions]}},588641:(e,n,i)=>{"use strict";var a,t;i.d(n,{Rd:()=>a,Ai:()=>t,rG:()=>r}),function(e){e[e.IS_GREATER_THAN_0=1]="IS_GREATER_THAN_0",e[e.IS_AT_LEAST_240=240]="IS_AT_LEAST_240",e[e.IS_AT_LEAST_290=290]="IS_AT_LEAST_290",e[e.IS_AT_LEAST_320=320]="IS_AT_LEAST_320",e[e.IS_AT_LEAST_360=360]="IS_AT_LEAST_360",e[e.IS_AT_LEAST_375=375]="IS_AT_LEAST_375",e[e.IS_AT_LEAST_414=414]="IS_AT_LEAST_414",e[e.IS_AT_LEAST_480=480]="IS_AT_LEAST_480",e[e.IS_AT_LEAST_640=640]="IS_AT_LEAST_640",e[e.IS_AT_LEAST_720=720]="IS_AT_LEAST_720",e[e.IS_AT_LEAST_768=768]="IS_AT_LEAST_768",e[e.IS_AT_LEAST_834=834]="IS_AT_LEAST_834",e[e.IS_AT_LEAST_947=947]="IS_AT_LEAST_947",e[e.IS_AT_LEAST_1000=1e3]="IS_AT_LEAST_1000",e[e.IS_AT_LEAST_1024=1024]="IS_AT_LEAST_1024",e[e.IS_AT_LEAST_1280=1280]="IS_AT_LEAST_1280",e[e.IS_AT_LEAST_1350=1350]="IS_AT_LEAST_1350",e[e.IS_AT_LEAST_1440=1440]="IS_AT_LEAST_1440",e[e.IS_AT_LEAST_1500=1500]="IS_AT_LEAST_1500",e[e.IS_AT_LEAST_1680=1680]="IS_AT_LEAST_1680",e[e.IS_AT_LEAST_1920=1920]="IS_AT_LEAST_1920",e[e.IS_AT_LEAST_2048=2048]="IS_AT_LEAST_2048",e[e.IS_AT_LEAST_2560=2560]="IS_AT_LEAST_2560",e[e.IS_AT_LEAST_3840=3840]="IS_AT_LEAST_3840"}(a||(a={})),function(e){e[e.IS_GREATER_THAN_0=1]="IS_GREATER_THAN_0",e[e.IS_AT_LEAST_320=320]="IS_AT_LEAST_320",e[e.IS_AT_LEAST_480=480]="IS_AT_LEAST_480",e[e.IS_AT_LEAST_568=568]="IS_AT_LEAST_568",e[e.IS_AT_LEAST_667=667]="IS_AT_LEAST_667",e[e.IS_AT_LEAST_768=768]="IS_AT_LEAST_768",e[e.IS_AT_LEAST_1024=1024]="IS_AT_LEAST_1024",e[e.IS_AT_LEAST_1280=1280]="IS_AT_LEAST_1280",e[e.IS_AT_LEAST_1366=1366]="IS_AT_LEAST_1366",e[e.IS_AT_LEAST_1440=1440]="IS_AT_LEAST_1440",e[e.IS_AT_LEAST_1500=1500]="IS_AT_LEAST_1500",e[e.IS_AT_LEAST_1680=1680]="IS_AT_LEAST_1680",e[e.IS_AT_LEAST_1920=1920]="IS_AT_LEAST_1920",e[e.IS_AT_LEAST_2160=2160]="IS_AT_LEAST_2160",e[e.IS_AT_LEAST_4320=4320]="IS_AT_LEAST_4320"}(t||(t={}));const r=(e,n={})=>{const{isMinWidthBreakpointAtLeast360:i,isMinWidthBreakpointAtLeast480:a,isMinWidthBreakpointAtLeast720:t,isMinWidthBreakpointAtLeast768:r}=e,{offsetForMinWidthBreakpointIsGreaterThan0:o,offsetForMinWidthBreakpointAtLeast360:l,offsetForMinWidthBreakpointAtLeast480:s,offsetForMinWidthBreakpointAtLeast720:d,offsetForMinWidthBreakpointAtLeast768:c}=n,m=(({isMinWidthBreakpointAtLeast240:e,isMinWidthBreakpointAtLeast290:n,isMinWidthBreakpointAtLeast320:i,isMinWidthBreakpointAtLeast360:a,isMinWidthBreakpointAtLeast375:t,isMinWidthBreakpointAtLeast414:r,isMinWidthBreakpointAtLeast480:o,isMinWidthBreakpointAtLeast640:l,isMinWidthBreakpointAtLeast720:s,isMinWidthBreakpointAtLeast768:d,isMinWidthBreakpointAtLeast834:c,isMinWidthBreakpointAtLeast947:m,isMinWidthBreakpointAtLeast1000:u,isMinWidthBreakpointAtLeast1024:p,isMinWidthBreakpointAtLeast1280:k,isMinWidthBreakpointAtLeast1350:g,isMinWidthBreakpointAtLeast1440:N,isMinWidthBreakpointAtLeast1500:f,isMinWidthBreakpointAtLeast1680:h,isMinWidthBreakpointAtLeast1920:v,isMinWidthBreakpointAtLeast2048:T,isMinWidthBreakpointAtLeast2560:M,isMinWidthBreakpointAtLeast3840:y})=>y?3840:M?2560:T?2048:v?1920:h?1680:f?1500:N?1440:g?1350:k?1280:p?1024:u?1e3:m?947:c?834:d?768:s?720:l?640:o?480:r?414:t?375:a?360:i?320:n?290:e?240:239)(e);let u=o??0;r&&"number"==typeof c?u=c:t&&"number"==typeof d?u=d:a&&"number"==typeof s?u=s:i&&"number"==typeof l&&(u=l);const p=(m-u)/10+"rem";return{"--width":p,width:[p,"var(--width)"]}}},100113:(e,n,i)=>{"use strict";i.d(n,{RB:()=>o,KR:()=>l,iA:()=>s,jH:()=>d,nf:()=>c,q0:()=>m});var a=i(588641),t=i(803238);const r=({dimension:e,MinDimensionBreakpoint:n})=>{let i=n.IS_GREATER_THAN_0;for(const a in n)if(!isNaN(Number(n[a]))){const r=Number(n[a]);if(!((0,t.round)(e)>=r))break;i=r}return i},o=({height:e,width:n,host:i})=>{const{self:{innerHeight:t,innerWidth:o}}=i;return{minHeightBreakpoint:r({dimension:e,MinDimensionBreakpoint:a.Ai}),minWidthBreakpoint:r({dimension:n,MinDimensionBreakpoint:a.Rd}),minHeightViewportBreakpoint:r({dimension:t,MinDimensionBreakpoint:a.Ai}),minWidthViewportBreakpoint:r({dimension:o,MinDimensionBreakpoint:a.Rd})}},l=({minHeightBreakpoint:e,minWidthBreakpoint:n,minHeightViewportBreakpoint:i,minWidthViewportBreakpoint:t}={minHeightBreakpoint:a.Ai.IS_GREATER_THAN_0,minWidthBreakpoint:a.Rd.IS_GREATER_THAN_0,minHeightViewportBreakpoint:a.Ai.IS_GREATER_THAN_0,minWidthViewportBreakpoint:a.Rd.IS_GREATER_THAN_0})=>({...u({minHeightBreakpoint:e,minHeightViewportBreakpoint:i}),...g({minWidthBreakpoint:n,minWidthViewportBreakpoint:t})}),s=({minHeightBreakpoint:e}={minHeightBreakpoint:a.Ai.IS_GREATER_THAN_0})=>({...p({minHeightBreakpoint:e})}),d=({minHeightViewportBreakpoint:e}={minHeightViewportBreakpoint:a.Ai.IS_GREATER_THAN_0})=>({...k({minHeightViewportBreakpoint:e})}),c=({minWidthBreakpoint:e}={minWidthBreakpoint:a.Rd.IS_GREATER_THAN_0})=>({...N({minWidthBreakpoint:e})}),m=({minWidthViewportBreakpoint:e}={minWidthViewportBreakpoint:a.Rd.IS_GREATER_THAN_0})=>({...f({minWidthViewportBreakpoint:e})}),u=({minHeightBreakpoint:e,minHeightViewportBreakpoint:n})=>({...p({minHeightBreakpoint:e}),...k({minHeightViewportBreakpoint:n})}),p=({minHeightBreakpoint:e})=>({isMinHeightBreakpointAtLeast320:e>=a.Ai.IS_AT_LEAST_320,isMinHeightBreakpointAtLeast480:e>=a.Ai.IS_AT_LEAST_480,isMinHeightBreakpointAtLeast568:e>=a.Ai.IS_AT_LEAST_568,isMinHeightBreakpointAtLeast667:e>=a.Ai.IS_AT_LEAST_667,isMinHeightBreakpointAtLeast768:e>=a.Ai.IS_AT_LEAST_768,isMinHeightBreakpointAtLeast1024:e>=a.Ai.IS_AT_LEAST_1024,isMinHeightBreakpointAtLeast1280:e>=a.Ai.IS_AT_LEAST_1280,isMinHeightBreakpointAtLeast1366:e>=a.Ai.IS_AT_LEAST_1366,isMinHeightBreakpointAtLeast1440:e>=a.Ai.IS_AT_LEAST_1440,isMinHeightBreakpointAtLeast1500:e>=a.Ai.IS_AT_LEAST_1500,isMinHeightBreakpointAtLeast1680:e>=a.Ai.IS_AT_LEAST_1680,isMinHeightBreakpointAtLeast1920:e>=a.Ai.IS_AT_LEAST_1920,isMinHeightBreakpointAtLeast2160:e>=a.Ai.IS_AT_LEAST_2160,isMinHeightBreakpointAtLeast4320:e>=a.Ai.IS_AT_LEAST_4320}),k=({minHeightViewportBreakpoint:e})=>({isMinHeightViewportBreakpointAtLeast320:e>=a.Ai.IS_AT_LEAST_320,isMinHeightViewportBreakpointAtLeast480:e>=a.Ai.IS_AT_LEAST_480,isMinHeightViewportBreakpointAtLeast568:e>=a.Ai.IS_AT_LEAST_568,isMinHeightViewportBreakpointAtLeast667:e>=a.Ai.IS_AT_LEAST_667,isMinHeightViewportBreakpointAtLeast768:e>=a.Ai.IS_AT_LEAST_768,isMinHeightViewportBreakpointAtLeast1024:e>=a.Ai.IS_AT_LEAST_1024,isMinHeightViewportBreakpointAtLeast1280:e>=a.Ai.IS_AT_LEAST_1280,isMinHeightViewportBreakpointAtLeast1366:e>=a.Ai.IS_AT_LEAST_1366,isMinHeightViewportBreakpointAtLeast1440:e>=a.Ai.IS_AT_LEAST_1440,isMinHeightViewportBreakpointAtLeast1500:e>=a.Ai.IS_AT_LEAST_1500,isMinHeightViewportBreakpointAtLeast1680:e>=a.Ai.IS_AT_LEAST_1680,isMinHeightViewportBreakpointAtLeast1920:e>=a.Ai.IS_AT_LEAST_1920,isMinHeightViewportBreakpointAtLeast2160:e>=a.Ai.IS_AT_LEAST_2160,isMinHeightViewportBreakpointAtLeast4320:e>=a.Ai.IS_AT_LEAST_4320}),g=({minWidthBreakpoint:e,minWidthViewportBreakpoint:n})=>({...N({minWidthBreakpoint:e}),...f({minWidthViewportBreakpoint:n})}),N=({minWidthBreakpoint:e})=>({isMinWidthBreakpointAtLeast240:e>=a.Rd.IS_AT_LEAST_240,isMinWidthBreakpointAtLeast290:e>=a.Rd.IS_AT_LEAST_290,isMinWidthBreakpointAtLeast320:e>=a.Rd.IS_AT_LEAST_320,isMinWidthBreakpointAtLeast360:e>=a.Rd.IS_AT_LEAST_360,isMinWidthBreakpointAtLeast375:e>=a.Rd.IS_AT_LEAST_375,isMinWidthBreakpointAtLeast414:e>=a.Rd.IS_AT_LEAST_414,isMinWidthBreakpointAtLeast480:e>=a.Rd.IS_AT_LEAST_480,isMinWidthBreakpointAtLeast640:e>=a.Rd.IS_AT_LEAST_640,isMinWidthBreakpointAtLeast720:e>=a.Rd.IS_AT_LEAST_720,isMinWidthBreakpointAtLeast768:e>=a.Rd.IS_AT_LEAST_768,isMinWidthBreakpointAtLeast834:e>=a.Rd.IS_AT_LEAST_834,isMinWidthBreakpointAtLeast947:e>=a.Rd.IS_AT_LEAST_947,isMinWidthBreakpointAtLeast1000:e>=a.Rd.IS_AT_LEAST_1000,isMinWidthBreakpointAtLeast1024:e>=a.Rd.IS_AT_LEAST_1024,isMinWidthBreakpointAtLeast1280:e>=a.Rd.IS_AT_LEAST_1280,isMinWidthBreakpointAtLeast1350:e>=a.Rd.IS_AT_LEAST_1350,isMinWidthBreakpointAtLeast1440:e>=a.Rd.IS_AT_LEAST_1440,isMinWidthBreakpointAtLeast1500:e>=a.Rd.IS_AT_LEAST_1500,isMinWidthBreakpointAtLeast1680:e>=a.Rd.IS_AT_LEAST_1680,isMinWidthBreakpointAtLeast1920:e>=a.Rd.IS_AT_LEAST_1920,isMinWidthBreakpointAtLeast2048:e>=a.Rd.IS_AT_LEAST_2048,isMinWidthBreakpointAtLeast2560:e>=a.Rd.IS_AT_LEAST_2560,isMinWidthBreakpointAtLeast3840:e>=a.Rd.IS_AT_LEAST_3840}),f=({minWidthViewportBreakpoint:e})=>({isMinWidthViewportBreakpointAtLeast240:e>=a.Rd.IS_AT_LEAST_240,isMinWidthViewportBreakpointAtLeast290:e>=a.Rd.IS_AT_LEAST_290,isMinWidthViewportBreakpointAtLeast320:e>=a.Rd.IS_AT_LEAST_320,isMinWidthViewportBreakpointAtLeast360:e>=a.Rd.IS_AT_LEAST_360,isMinWidthViewportBreakpointAtLeast375:e>=a.Rd.IS_AT_LEAST_375,isMinWidthViewportBreakpointAtLeast414:e>=a.Rd.IS_AT_LEAST_414,isMinWidthViewportBreakpointAtLeast480:e>=a.Rd.IS_AT_LEAST_480,isMinWidthViewportBreakpointAtLeast640:e>=a.Rd.IS_AT_LEAST_640,isMinWidthViewportBreakpointAtLeast720:e>=a.Rd.IS_AT_LEAST_720,isMinWidthViewportBreakpointAtLeast768:e>=a.Rd.IS_AT_LEAST_768,isMinWidthViewportBreakpointAtLeast834:e>=a.Rd.IS_AT_LEAST_834,isMinWidthViewportBreakpointAtLeast947:e>=a.Rd.IS_AT_LEAST_947,isMinWidthViewportBreakpointAtLeast1000:e>=a.Rd.IS_AT_LEAST_1000,isMinWidthViewportBreakpointAtLeast1024:e>=a.Rd.IS_AT_LEAST_1024,isMinWidthViewportBreakpointAtLeast1280:e>=a.Rd.IS_AT_LEAST_1280,isMinWidthViewportBreakpointAtLeast1350:e>=a.Rd.IS_AT_LEAST_1350,isMinWidthViewportBreakpointAtLeast1440:e>=a.Rd.IS_AT_LEAST_1440,isMinWidthViewportBreakpointAtLeast1500:e>=a.Rd.IS_AT_LEAST_1500,isMinWidthViewportBreakpointAtLeast1680:e>=a.Rd.IS_AT_LEAST_1680,isMinWidthViewportBreakpointAtLeast1920:e>=a.Rd.IS_AT_LEAST_1920,isMinWidthViewportBreakpointAtLeast2048:e>=a.Rd.IS_AT_LEAST_2048,isMinWidthViewportBreakpointAtLeast2560:e>=a.Rd.IS_AT_LEAST_2560})},114926:(e,n,i)=>{"use strict";i.d(n,{K:()=>r});var a=i(803238),t=i(818319);const r=(e,n,i)=>{const r=(0,t.useCallback)((0,a.debounce)(e,n,i),[e,n,i]);return(0,t.useEffect)((()=>r.cancel),[r]),r}},461774:(e,n,i)=>{"use strict";i.d(n,{b:()=>l});var a=i(818319),t=i(301644),r=i(980860),o=i(681971);const l=(e,n,i=!1,l="Url",s="",d=!1,c=!0)=>{const m=a.useRef(!1),{host:u,amsImageCache:p,user:k}=(0,o.SE)(),g=a.useRef(),N=a.useRef(d&&k?.id&&p?.has(n,k.id)),[f,h]=a.useState((()=>{const e=N.current&&k?.id?p?.get(n,k.id):void 0;return{result:e,loading:!e,error:void 0}})),v=a.useCallback((e=>m.current&&h(e)),[]),T=a.useCallback((()=>{(async()=>{if(""!==n&&!(0,r.nz)(n,u.location.origin)){let a=await(0,t.H)(e,n,l,i,s);if(g.current&&"Url"===l&&URL.revokeObjectURL(g.current),k?.id&&d&&p?.has(n,k.id)){const e=a.result?.blob,i=p?.get(n,k.id),t=e&&i?.blob&&e!==i.blob;a.result&&c&&t&&URL.revokeObjectURL(e),a={result:i,loading:!1},N.current=!0}else a.result&&k?.id&&!a?.error&&d&&"Url"===l&&(N.current=p?.add(n,k.id,a.result));g.current=a?.result?.blob??void 0,v(a)}})()}),[p,i,l,e,u.location.origin,s,d,c,v,n,k?.id]);return a.useEffect((()=>{m.current=!0,N.current=d&&k?.id&&p?.has(n,k.id),N.current||T()}),[T,N,p,d,n,k]),a.useEffect((()=>()=>{m.current=!1,"Url"===l&&g.current&&!N.current&&URL.revokeObjectURL(g.current)}),[T,l,N]),[f,T]}},528550:(e,n,i)=>{"use strict";i.d(n,{Il:()=>c,bp:()=>m,fe:()=>u,i2:()=>p,iz:()=>k,Pi:()=>g});var a=i(250033),t=i(803238),r=i(818319),o=i(839779),l=i(841763),s=i(242111),d=i(445217);const c=r.createContext({}),m=(c.Consumer,()=>r.useContext(c)),u="Microsoft Teams",p=e=>`${e} | ${u}`;class k extends r.PureComponent{constructor(e){super(e),this.currentTitle="",this.currentName="",this.currentBadgeCount=0,this.applyBadgeCount=e=>{this.currentBadgeCount=e,this.applyTitleToDocument()},this.applyTitle=(e,n)=>{this.currentName=e,this.currentTitle=n,this.applyTitleToDocument()},this.applyTitleToDocument=()=>{if(this.props.document){let e=[this.currentName,this.currentTitle,this.props.mtmaPrefix,u].filter(Boolean).join(" | ");this.currentBadgeCount&&(e=`(${this.currentBadgeCount}) ${e}`),this.props.document.title=e}};const n=new o.X(e.defaultAppTitle||""),i=new o.X(""),a=new o.X(0);this.state={biLogger:e.biLogger,chatServiceSubscriptionFilter:{convId:null},setI18nProviderLocale:()=>{},titleObservable:n,nameObservable:i,badgeObservable:a},this.titleSubscription=n.pipe((0,l.h)((e=>!!e)),(0,s.x)(((e,n)=>this.currentTitle===n))).subscribe({next:()=>{const e=this.state.nameObservable.getValue(),n=this.state.titleObservable.getValue();this.applyTitle(e,n)}}),this.nameSubscription=i.pipe((0,l.h)((e=>!!e)),(0,s.x)(((e,n)=>this.currentName===n))).subscribe({next:()=>{const e=this.state.nameObservable.getValue();this.applyTitle(e,"")}}),this.badgeSubscription=a.pipe((0,s.x)(((e,n)=>this.currentBadgeCount===n))).subscribe({next:()=>{const e=this.state.badgeObservable.getValue();this.applyBadgeCount(e)}})}componentWillUnmount(){this.titleSubscription.unsubscribe(),this.state.titleObservable.complete(),this.nameSubscription.unsubscribe(),this.state.nameObservable.complete(),this.badgeSubscription.unsubscribe(),this.state.badgeObservable.complete()}componentDidMount(){this.props.document&&!this.props.document.title&&(this.props.document.title=u)}render(){return(0,a.t)(N,{children:this.props.children,value:this.state})}}const g=r.memo((({chatServiceSubscriptionFilter:e,children:n})=>{const i=r.useContext(c),t=r.useMemo((()=>({...i,chatServiceSubscriptionFilter:e})),[e,i]);return(0,a.t)(N,{children:n,value:t})})),N=r.memo((({children:e,value:n})=>(0,a.t)(c.Provider,{value:(0,d.Q)(n,t.isEqual),children:e})))},700310:(e,n,i)=>{"use strict";i.d(n,{W_:()=>Yn});var a=i(250033),t=i(818319),r=i(436328),o=i(208460),l=i(919244),s=i(462512),d=i(479509),c=i(797057),m=i(755494);const u=({children:e})=>(0,a.t)(t.Fragment,{children:t.Children.map(e,(e=>t.cloneElement(e,{styles:{clipPath:"polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%)"}})))});var p=i(768385),k=i(391745),g=i(977113),N=i(660393),f=i(272380),h=i(332534),v=i(629494),T=i(683184);const M={isActionButton:!0},y=({isBotSupportCalling:e,startChat:n,startAudioCall:i,startVideoCall:r,isVideoAvailableForConversation:o,videoNotAvailableForConversationReason:l,isAudioAvailableForConversation:s,audioNotAvailableForConversationReason:d})=>{const c=(0,h.Cq)(),m=t.useMemo((()=>S(c,l,o,!0)),[c,l,o]),u=t.useMemo((()=>S(c,d,s)),[c,d,s]),{enableBotsCallingSupport:y}=(0,v.NC)(T.J.Extensibility,["enableBotsCallingSupport"]),A=c.stringTranslate("extensibility","app_profile_card_toggleChat_on");return(0,a.t)(p.k,{hAlign:"start",fill:!0,gap:"gap.small",children:[(0,a.t)(k.z,{iconOnly:!0,text:!0,icon:(0,a.t)(g.k,{outline:!0,size:"medium"}),onClick:n,title:A,disabled:!1,variables:M}),y&&e?(0,a.t)(t.Fragment,{children:[(0,a.t)(k.z,{iconOnly:!0,text:!0,icon:(0,a.t)(N.N,{outline:!0,size:"medium"}),onClick:r,title:m,disabled:!o,variables:M}),(0,a.t)(k.z,{iconOnly:!0,text:!0,icon:(0,a.t)(f.o,{outline:!0,size:"medium"}),onClick:i,title:u,disabled:!s,variables:M})]}):null]})},S=(e,n,i,a)=>!i&&n?e.stringTranslate("calling",n):e.stringTranslate("messaging",a?"calling_video":"calling_call");var A=i(349409);const I={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"videoAvailableForConversationChanged"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"videoAvailableForConversationChangedEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"isAvailable"}},{kind:"Field",name:{kind:"Name",value:"notAvailableReason"}}]}}]}}]};var b=i(314020),C=i(681971),D=i(994575),F=i(485510),U=i(700802),E=i(543491),w=i(528550),L=i(288718);const x=(e,n,i,a,t,r,o)=>({actionGesture:e,actionOutcome:n,actionScenario:i,actionScenarioType:F.Yu.appMgmt,moduleName:a,panelRegion:F.Ai.popover,panelType:F.wh.AppProfileCardPopover,appName:t,extensibilityData:{id:r,capabilityId:o,scenarioCapability:L.Ky.bots}}),O=t.memo((({client:e,appProfile:n,botCallingCapabilities:i})=>{const{entityCommanding:r,scenarioFactory:o}=(0,C.SE)(),l=(0,D.w)(O.name),{startChat:s,startCall:d}=(0,b.G4)(r,e,l),c=(0,w.bp)(),{convId:m}=c.chatServiceSubscriptionFilter,{isBotAudioSupported:u,isBotVideoSupported:p,botAudioNotAvailableForConversationReason:k,botVideoNotAvailableForConversationReason:g}={...R(i)},{recordPanelAction:N}=(0,U.It)(),f=u||p,h=n.botIdOrAppId,v=t.useCallback((()=>{const e=o.newScenario(E.RG.AppProfileCardStartChat);N(x(F.uS.click,F.$K.select,F.Tk.appProfileCardChat,F.rA.appProfileCardStartChat,n.appName)),s(h,e)}),[h,n.appName,N,s,o]),T=t.useCallback((()=>{const e=o.newScenario(E.RG.AppProfileCardStartAudioCall);V(n,!1,N),d(h,!1,e)}),[h,n,d,o,N]),M=t.useCallback((()=>{const e=o.newScenario(E.RG.AppProfileCardStartVideoCall);V(n,!0,N),d(h,!0,e)}),[h,n,d,o,N]),{videoNotAvailableForConversationReason:S,isVideoAvailableForConversation:A}=z(e,m,p,g,l);return(0,a.t)(y,{startChat:v,startVideoCall:M,startAudioCall:T,isBotSupportCalling:!!f,videoNotAvailableForConversationReason:S,isVideoAvailableForConversation:A&&!!p,audioNotAvailableForConversationReason:k??null,isAudioAvailableForConversation:!!u})})),j=(0,A.C)(O),V=(e,n,i)=>{i(x(F.uS.click,F.$K.nav,F.Tk.appProfileCardCall,n?F.rA.appProfileCardVideoCall:F.rA.appProfileCardAudioCall,e.appName))},z=(e,n,i,a="bot_calling_video_not_supported",r)=>{const[o,l]=t.useState(null);t.useEffect((()=>{if(!i)return;const a=e.subscribe({query:I,variables:{conversationId:n}}).subscribe((({data:e,errors:n})=>{n&&r.error("Error on callQuery for video conversation subscription"),l(e)}));return()=>{a.unsubscribe()}}),[e,r,n,i]);const s=o?.videoAvailableForConversationChangedEvent;let d=!1,c="calling_video_disabled";return s&&(d=s.isAvailable,c=d?i?null:a:P(s.notAvailableReason,r)),{isVideoAvailableForConversation:d,videoNotAvailableForConversationReason:c}},P=(e,n)=>{switch(e){case"calling_video_disabled":case"calling_video_disabled_by_admin":case"calling_video_disabled_no_device":case"calling_video_disabled_vdi":case"bot_calling_video_not_supported":case"bot_calling_audio_not_supported":return e;default:return n.warn(`_queryVideoAvailableForConversation: wrong videoDisabledReason received: ${e}`),"calling_video_disabled"}},R=e=>{if(!e)return;const n=!!e?.supportsVideo,i=!!e?.supportsCalling;let a="bot_calling_audio_not_supported",t="bot_calling_video_not_supported";return a=i?null:a,t=n?null:t,{isBotVideoSupported:n,isBotAudioSupported:i,botAudioNotAvailableForConversationReason:a,botVideoNotAvailableForConversationReason:t}};var B=i(647170),Q=i(119579),W=i(322577),Z=i(264896),Y=i(696618);const G=(0,Y.s)({isAppProfileCardTextInput:{a9b677:"fly5x3f"}},{d:[".fly5x3f{width:100%;}"]}),_=({sendMessage:e,appName:n,className:i})=>{const r=(0,h.Cq)(),[o,l]=t.useState(""),s=""===o,d=t.useCallback((e=>{const n=e.target.value;l(n)}),[l]),c=t.useCallback((()=>{e(o),l("")}),[o,e,l]),m=r.stringTranslate("extensibility","app_profile_card_icons_send"),u=r.stringTranslate("extensibility","app_profile_card_quickMessage",{appName:n}),k=G();return(0,a.t)(p.k,{column:!0,gap:"gap.small",className:i,children:(0,a.t)(W.l,{onSubmit:c,children:(0,a.t)(p.k,{className:k.isAppProfileCardTextInput,gap:"gap.smaller",children:[(0,a.t)(B.I,{placeholder:u,onChange:d,value:o}),(0,a.t)(Q.z,{icon:(0,a.t)(Z.j,{}),appearance:"transparent",disabled:s,title:m})]})})})};var J=i(811957),H=i(309501);const q=({client:e,appProfile:n,...i})=>{const{entityCommanding:r,scenarioFactory:o}=(0,C.SE)(),l=(0,D.w)(q.name),{sendMessage:s}=(0,b.G4)(r,e,l),{recordPanelAction:d}=(0,U.It)(),{appName:c,botIdOrAppId:m,appId:u}=n,p=(0,J.bl)(m)?m.substring(H.at.BotPrefix.length):void 0,k=t.useCallback((e=>{const n=o.newScenario(E.RG.AppProfileCardSendQuickMessage);d(x(F.uS.click,F.$K.submit,F.Tk.quickIM,F.rA.appProfileCardQuickIM,c,u,p)),s(m,e,n)}),[m,c,u,p,d,s,o]);return(0,a.t)(_,{sendMessage:k,appName:c,...i})},X=(0,A.C)(q);var K=i(751329),$=i(980026),ee=i(217120),ne=i(825848),ie=i(895007),ae=i(298456),te=i(951375),re=i(197882),oe=i(930427);const le=({title:e})=>(0,a.t)(re.q,{state:"success",title:e,variables:{appProfileCardPresenceImage:oe.F.Online}});var se=i(332305),de=i(379263),ce=i(12978);const me=(0,Y.s)({isBotSettingsButton:{a9b677:"f14z66ap",Bqenvij:"f11ysow2",Bf4jedk:"fy77jfu",qb2dma:"f1locze1"},isAppProfileCardPresence:{Be2twd7:"fy9rknc",B6of3ja:"f10kaskc"},isAppProfileShortCardDescription:{Be2twd7:"fy9rknc"},isAppProfileCardTitle:{Be2twd7:"fod5ikn",Bhrd7zp:"flh3ekv"},isAppProfileCardDeveloper:{Be2twd7:"fy9rknc"},isSceneProfileCardDesc:{jrapky:"f1sq5vfh",Be2twd7:"fy9rknc",cr1yyl:"f1r4h3gm"},isContentClamped:{mc9l5x:"f1rvi9lw",B68tc82:"f1p9o1ba",Bmxbyg5:"f1sil6mw",B6of3ja:"f1hu3pq6",ygn44y:"f1cmbuwj",a9b677:"fly5x3f",Bh9c35c:"fd4kbmi",Fd1uvx:"fpfc2by"},isAppProfileCardDescription:{a9b677:"fqva8l3",Be2twd7:"fy9rknc",Bg96gwp:"f7yhwew"},listStyleBullet:{Bhrd7zp:"flh3ekv",Be2twd7:"f1fjxbv2"},isAppProfileCardPermission:{uwmqm3:["f1pui2vs","f1xqnc6q"]},isAppProfileCard:{a9b677:"ffyt4a4",Bqenvij:"f1l02sjl",z8tnut:"fjmaoex",z189sj:["f1nz66ws","fpsd8hx"],Byoj8tv:"f1tg7txk",uwmqm3:["fpsd8hx","f1nz66ws"]},isAppProfileCardImageContainer:{a9b677:"f190kgpo",Bqenvij:"fvi13kb",qhf8xq:"f10pi13n"},isAppProfileCardBasicPermission:{Be2twd7:"fy9rknc",jrapky:"f12kb92q",B6of3ja:"ficmxd5",Bg96gwp:"f7yhwew"},sceneAppProfileCard:{jrapky:"f1c0w631",B6of3ja:"fvrswf7"},isAppProfileCardDetail:{uwmqm3:["f1pui2vs","f1xqnc6q"]},isAppProfileCardActionButton:{z8tnut:"f1tdj2vy",Byoj8tv:"foxqkq2"},flexItemAlign:{qb2dma:"fjgzulp"},flexItemGrow:{Bh6795r:"fqerorx"},flexItemPush:{Frg6f3:["fcgxt0o","f1ujusj6"]},isAppProfileCardLink:{Be2twd7:"f14d40fx",w71qe1:"f13mvf36",I8pafv:"fpthbmc",dvvfom:"f1lqvz6u"},isAppProfileCardPermissionFlex:{uwmqm3:["f1pui2vs","f1xqnc6q"]},messageAppDivider:{B6of3ja:"f14f5g9s",jrapky:"f1kd9ml8"}},{d:[".f14z66ap{width:auto;}",".f11ysow2{height:auto;}",".fy77jfu{min-width:0;}",".f1locze1{align-self:end;}",".fy9rknc{font-size:var(--fontSizeBase200);}",".f10kaskc{margin-top:0.1rem;}",".fod5ikn{font-size:var(--fontSizeBase400);}",".flh3ekv{font-weight:var(--fontWeightBold);}",".f1sq5vfh{margin-bottom:1.6rem;}",".f1r4h3gm{num-of-lines:6;}",".f1rvi9lw{display:-webkit-box;}",".f1p9o1ba{overflow-x:hidden;}",".f1sil6mw{overflow-y:hidden;}",".f1hu3pq6{margin-top:0;}",".f1cmbuwj{text-overflow:ellipsis;}",".fly5x3f{width:100%;}",".fd4kbmi{-webkit-line-clamp:6;}",".fpfc2by{-webkit-box-orient:vertical;}",".fqva8l3{width:20rem;}",".f7yhwew{line-height:1.6rem;}",".f1fjxbv2{font-size:1.8rem;}",".f1pui2vs{padding-left:0.5rem;}",".f1xqnc6q{padding-right:0.5rem;}",".ffyt4a4{width:31rem;}",".f1l02sjl{height:100%;}",".fjmaoex{padding-top:1.9rem;}",".f1nz66ws{padding-right:2.4rem;}",".fpsd8hx{padding-left:2.4rem;}",".f1tg7txk{padding-bottom:1.9rem;}",".f190kgpo{width:7.2rem;}",".fvi13kb{height:6.4rem;}",".f10pi13n{position:relative;}",".f12kb92q{margin-bottom:1.0rem;}",".ficmxd5{margin-top:1.0rem;}",".f1c0w631{margin-bottom:1.2rem;}",".fvrswf7{margin-top:1.2rem;}",".f1tdj2vy{padding-top:1rem;}",".foxqkq2{padding-bottom:1rem;}",".fjgzulp{align-self:flex-start;}",".fqerorx{flex-grow:1;}",".fcgxt0o{margin-left:auto;}",".f1ujusj6{margin-right:auto;}",".f14d40fx{font-size:1.1rem;}",".f13mvf36{text-decoration-line:underline;}",".fpthbmc{text-decoration-style:solid;}",".f1lqvz6u{text-decoration-color:var(--colorBrandForegroundLink);}",".f14f5g9s{margin-top:.2rem;}",".f1kd9ml8{margin-bottom:.5rem;}"]});var ue=i(237867),pe=i(461774),ke=i(584613),ge=i(56056);const Ne=({botName:e,iconUrl:n,description:i,developerName:r,privacyUrl:o,termsOfUseUrl:l,botIdOrAppId:s,isShortProfileCard:d,sceneCount:c,showActionButtons:m,isSceneApp:u,sceneName:p,showRectAppImage:k,botCallingCapabilities:g,appId:N,supportsMeetingStreaming:f,botConfiguration:h,appDef:M})=>{const y=t.useMemo((()=>({botIdOrAppId:s,appName:e,appId:N})),[N,s,e]),{host:S}=(0,C.SE)(),A=(0,se.WG)(),{entity:I}=(0,de.sV)(),b=I.type===ce.py.channels?"Team":"GroupChat",D=(0,se.LZ)(M,b),F=I.type===ce.py.channels?(e=>e.id&&(e=>{try{JSON.parse(e)}catch(e){return!1}return!0})(e.id)?JSON.parse(e.id).channelId:e.id)(I):I.id,U=t.useCallback((()=>{A(F,b,M,se.ku.ReConfig)}),[M,F,A,b]),{enableFetchAPIForNonAdaptiveCardImages:E}=(0,v.NC)(T.J.Extensibility,["enableFetchAPIForNonAdaptiveCardImages"]),w=(0,ue.x)(),[{result:L}]=(0,pe.b)(w,E&&(0,ke.HM)(n,S.location.origin)||(0,ge.$O)(n)?n:"",!0,"Url"),x=L?.blob??n;return u?(0,a.t)(he,{botName:e,description:i,iconUrl:x,sceneCount:c,sceneName:p,showRectAppImage:k,privacyUrl:o,termsOfUseUrl:l}):(0,a.t)(fe,{appProfile:y,botName:e,description:i,iconUrl:x,isShortProfileCard:d,developerName:r,showRectAppImage:k,botCallingCapabilities:g,supportsMeetingStreaming:f,privacyUrl:o,termsOfUseUrl:l,showActionButtons:m,botConfiguration:D?h:null,launchBotConfig:U})},fe=({appProfile:e,botName:n,iconUrl:i,description:r,developerName:o,privacyUrl:l,termsOfUseUrl:s,isShortProfileCard:d,showActionButtons:c,showRectAppImage:m,botCallingCapabilities:u,supportsMeetingStreaming:k,botConfiguration:g,launchBotConfig:N})=>{const{enableBotConfiguration:f}=(0,v.NC)(T.J.Extensibility,["enableBotConfiguration"]),h=me();return(0,a.t)($.W,{className:h.isAppProfileCard,children:[(0,a.t)(p.k,{vAlign:"start",children:(0,a.t)(Te,{botName:n,description:r,iconUrl:i,isShortProfileCard:d,developerName:o,showRectAppImage:m})}),(0,a.t)(p.k,{column:!0,children:[f&&g?(0,a.t)(Q.z,{appearance:"transparent",className:h.isBotSettingsButton,onClick:N,icon:(0,a.t)(te.e,{outline:!0,size:"medium"})}):(0,a.t)(t.Fragment,{}),(0,a.t)(Ue,{isShortProfileCard:d,supportsMeetingStreaming:k}),d?null:(0,a.t)(Fe,{privacyUrl:l,termsOfUseUrl:s}),c?(0,a.t)(Se,{appProfile:e,botCallingCapabilities:u}):null]})]})},he=({botName:e,description:n,iconUrl:i,sceneCount:t,sceneName:r,showRectAppImage:o,privacyUrl:l,termsOfUseUrl:s})=>{const d=me();return(0,a.t)($.W,{className:d.isAppProfileCard,children:[(0,a.t)(p.k,{fill:!0,vAlign:"start",children:(0,a.t)(ve,{botName:e,description:n,iconUrl:i,sceneCount:t,sceneName:r,showRectAppImage:o})}),(0,a.t)(p.k,{column:!0,children:(0,a.t)(Fe,{privacyUrl:l,termsOfUseUrl:s})})]})},ve=({botName:e,description:n,iconUrl:i,sceneCount:r,sceneName:o,showRectAppImage:l})=>{const s=me();return(0,a.t)(t.Fragment,{children:[(0,a.t)(p.k,{fill:!0,column:!0,children:[(0,a.t)(Ae,{botName:o}),(0,a.t)(ee.q,{size:"small",children:e}),(0,a.t)(p.k,{gap:"gap.small",vAlign:"center",className:s.sceneAppProfileCard,children:[(0,a.t)(K.e,{size:"smaller",outline:!0}),(0,a.t)(be,{sceneCount:r})]}),(0,a.t)(Ce,{description:n})]}),(0,a.t)(Me,{iconUrl:i,showRectAppImage:l})]})},Te=({botName:e,description:n,developerName:i,iconUrl:r,isShortProfileCard:o,showRectAppImage:l})=>{const{presence:s}=we(),d=me();return(0,a.t)(t.Fragment,{children:[(0,a.t)(p.k,{fill:!0,column:!0,className:d.isAppProfileCardDetail,children:[(0,a.t)(Ae,{botName:e}),(0,a.t)(p.k,{column:!0,gap:"gap.small",children:[(0,a.t)(ee.q,{className:d.isAppProfileCardPresence,children:s}),(0,a.t)(De,{description:n}),o?(0,a.t)(Ae,{botName:e,isShortProfileCard:o}):(0,a.t)(Ie,{developerName:i})]})]}),(0,a.t)(Me,{iconUrl:r,showRectAppImage:l})]})},Me=({iconUrl:e,showRectAppImage:n})=>{const{appProfileImageBorderRadius:i}=Ee();return n?(0,a.t)(ye,{iconUrl:e,width:60,height:60,variables:i}):(0,a.t)(ye,{showStatus:!0,iconUrl:e,width:68,height:60,isHexagon:!0})},ye=({iconUrl:e,showStatus:n,width:i,height:t,isHexagon:r,variables:o})=>{const{presence:l}=we(),s=me(),c=(0,a.t)(d.J,{src:e,width:i,height:t,variables:o});return(0,a.t)($.W,{className:s.isAppProfileCardImageContainer,children:[r?(0,a.t)(u,{children:c}):c,n&&(0,a.t)(le,{title:l})]})},Se=({appProfile:e,botCallingCapabilities:n})=>{const i=me();return(0,a.t)(p.k,{column:!0,children:[(0,a.t)(p.k,{fill:!0,className:i.isAppProfileCardActionButton,children:(0,a.t)(j,{appProfile:e,botCallingCapabilities:n})}),(0,a.t)(ne.i,{className:i.messageAppDivider}),(0,a.t)(X,{appProfile:e,className:i.flexItemAlign})]})},Ae=({botName:e,isShortProfileCard:n})=>{const i=me();return(0,a.t)(ee.q,{className:n?i.isAppProfileShortCardDescription:i.isAppProfileCardTitle,children:e})},Ie=({developerName:e})=>{const n=(0,h.Cq)().translate("extensibility","app_profile_card_developer",{developerName:e}),i=me();return(0,a.t)(ee.q,{className:i.isAppProfileCardDeveloper,children:n})},be=({sceneCount:e})=>{const n=(0,h.Cq)().stringTranslate("extensibility","app_profile_card_scene_count_mf",{sceneCount:e});return(0,a.t)(ee.q,{size:"small",children:n})},Ce=({description:e})=>{const n=me();return(0,a.t)(ee.q,{className:(0,ie.z)(n.isContentClamped,n.isSceneProfileCardDesc),children:e})},De=({description:e})=>{const n=me();return(0,a.t)(ee.q,{className:(0,ie.z)(n.isContentClamped,n.isAppProfileCardDescription),children:e})},Fe=({privacyUrl:e,termsOfUseUrl:n})=>{const{termsOfUse:i,privacy:t}=we(),r=me();return(0,a.t)(p.k,{vAlign:"end",className:r.flexItemGrow,children:[(0,a.t)(ae.r,{target:"_blank",href:e,className:r.isAppProfileCardLink,children:t}),(0,a.t)(ae.r,{target:"_blank",href:n,className:(0,ie.z)(r.flexItemPush,r.isAppProfileCardLink),children:i})]})},Ue=({isShortProfileCard:e,supportsMeetingStreaming:n})=>{const i=(0,h.Cq)(),t=e?["app_profile_card_imsend","app_profile_card_imreceive"]:["extension_addAppDialogBasicPermission1","extension_addAppDialogBasicPermission2","extension_addAppDialogIdentityPermission1","extensibility_addAppDialogAppCardPermission1","extensibility_addAppDialogAppCardPermission2","extension_addAppDialogIdentityPermission2"];n&&!e&&t.push("extension_addAppDialog_Permission_Meeting_Streaming_Access");const r=[],o=me();for(let n=0;n<=t.length-1;n++)r.push((0,a.t)(p.k,{gap:"gap.smaller",children:[e?null:(0,a.t)(ee.q,{className:o.listStyleBullet,children:""}),(0,a.t)(ee.q,{children:i.translate("extensibility",t[n])})]},n));const{whatAppCanDo:l}=we();return(0,a.t)($.W,{className:o.isAppProfileCardBasicPermission,children:[(0,a.t)(ee.q,{className:e?o.isAppProfileCardPermission:void 0,children:l}),(0,a.t)(p.k,{column:!0,className:o.isAppProfileCardPermissionFlex,children:r})]})},Ee=()=>{const{vars:e}=(0,r.L)();return{isAppProfileCardBasicPermission:e("extensibility",["isAppProfileCardBasicPermission"]),isAppProfileCardPermission:e("extensibility",["isAppProfileCardPermission"]),isAppProfileCardLink:e("extensibility",["isAppProfileCardLink"]),isAppProfileCardDeveloper:e("extensibility",["isAppProfileCardDeveloper"]),listStyleBullet:e("extensibility",["listStyleBullet"]),isAppProfileCardPresence:e("extensibility",["isAppProfileCardPresence"]),isAppProfileCardTitle:e("extensibility",["isAppProfileCardTitle"]),isAppProfileCardDescription:e("extensibility",["isAppProfileCardDescription"]),isAppProfileCardImageContainer:e("extensibility",["isAppProfileCardImageContainer"]),isAppProfileCard:e("extensibility",["isAppProfileCard"]),isAppProfileCardDetail:e("extensibility",["isAppProfileCardDetail"]),isAppProfileCardActionButton:e("extensibility",["isAppProfileCardActionButton"]),appProfileImageBorderRadius:e("extensibility",["appProfileImageBorderRadius"]),messageAppDivider:e("extensibility",["messageAppDivider"]),isAppProfileShortCardDescription:e("extensibility",["isAppProfileShortCardDescription"]),sceneAppProfileCard:e("extensibility",["sceneAppProfileCard"]),isSceneProfileCardDesc:e("extensibility",["isSceneProfileCardDesc"])}},we=()=>{const e=(0,h.Cq)();return{whatAppCanDo:e.translate("extensibility","app_profile_card_basicPermission_what_app_can_do"),privacy:e.translate("extensibility","app_profile_card_privacy"),termsOfUse:e.translate("extensibility","app_profile_card_terms_of_use"),presence:e.stringTranslate("extensibility","app_profile_card_presence")}};var Le=i(879565),xe=i(635943);const Oe=(e,n)=>!!n[e]?.length,je=({appDef:e})=>{const n=Oe("galleryTabs",e)||(0,s.LS)("Team",e.staticTabs),i=Oe("bots",e),t=Oe("messageExtensions",e),r=Oe("connectors",e),o=(0,s.LS)("Personal",e.staticTabs);return(0,a.t)($.W,{children:[n&&(0,a.t)(Ve,{titleKey:"app_details_capability_tab",descriptionKey:"app_details_capability_tab_description"}),i&&(0,a.t)(Ve,{titleKey:"app_details_capability_bot",descriptionKey:"app_details_capability_bot_description"}),t&&(0,a.t)(Ve,{titleKey:"app_details_capability_message_extension",descriptionKey:"app_details_capability_message_extension_description"}),r&&(0,a.t)(Ve,{titleKey:"extension_addAppDialogV3_capability_connector_title",descriptionKey:"app_details_capability_connector_description"}),o&&(0,a.t)(Ve,{titleKey:"app_details_capability_personal_app",descriptionKey:"app_details_capability_personal_app_description"})]})},Ve=({titleKey:e,descriptionKey:n})=>{const i=(0,h.Cq)(),o=t.useMemo((()=>i.translate("extensibility",e)),[i,e]),l=t.useMemo((()=>i.translate("extensibility",n)),[i,n]),{vars:s}=(0,r.L)();return(0,a.t)($.W,{children:[(0,a.t)(xe.h,{as:"h4",content:o,variables:s("extensibility",["isActionableAppProfileCardAppFeatureHeader"])}),l]})};var ze=i(114926);const Pe=(0,Y.s)({isBotSettingsButton:{a9b677:"f14z66ap",Bqenvij:"f11ysow2",Bf4jedk:"fy77jfu",qb2dma:"f1locze1"},isActionableAppProfileCardBodySection:{Be2twd7:"fy9rknc",Bg96gwp:"f7yhwew"},isActionableAppProfileCardBodySectionTitle:{Bhrd7zp:"flh3ekv"},isActionableAppProfileCardPermissionsList:{dclx09:"fuxrj8o",B6of3ja:"f1bpxv7w"},isActionableAppProfileCardConsent:{Be2twd7:"f1hn7b42",Bj7y4cg:"f11hph32"},isActionableAppProfileCardLink:{mc9l5x:"f1w7gpdv",sj55zd:"fyind8e",Bceei9c:"f1k6fduh",ha4doy:"f1cdqgvm",icvyot:"f1ern45e",vrafjx:["f1n71otn","f1deefiw"],oivjwe:"f1h8hb77",wvpqe5:["f1deefiw","f1n71otn"],z8tnut:"f1g0x7ka",z189sj:["fhxju0i","f1cnd47f"],Byoj8tv:"f1qch9an",uwmqm3:["f1cnd47f","fhxju0i"],Bf4jedk:"f18p0k4z",Bqenvij:"f11ysow2",Be2twd7:"fjoy568",Bhrd7zp:"ff5ikls",mn2c1h:"fuuohzo",B7m74wb:"f9oa3bk",Bcsz1n9:"fnmhfyr",i089h6:"f1eh06m1",lj723h:"f1bq4y7d",Bde5pd6:"f1tx3yz7",Jwef8y:"fldu4wg",Bi91k9c:"fpwtdan"},isActionableAppProfileCardBodySectionParagraph:{z8tnut:"fz04i0k"},isActionableAppProfileCardHeaderInfoBanner:{B6of3ja:"fwdhe5f",z8tnut:"f1u4y9u9",z189sj:["fwihf70","ffkyht9"],Byoj8tv:"ft977fb",uwmqm3:["ffkyht9","fwihf70"],De3pzq:"f18f03hv",B4j52fo:"f118ihkj",Bekrc4i:["fb4i99f","fgvdrvz"],Bn0qgzm:"f3bv7ky",ibv6hh:["fgvdrvz","fb4i99f"],icvyot:"fzkkow9",vrafjx:["fcdblym","fjik90z"],oivjwe:"fg706s2",wvpqe5:["fjik90z","fcdblym"],g2u3we:"fj3muxo",h3c5rm:["f1akhkt","f1lxtadh"],B9xav0g:"f1aperda",zhjwy3:["f1lxtadh","f1akhkt"],Bbmb7ep:["f1aa9q02","f16jpd5f"],Beyfa6y:["f16jpd5f","f1aa9q02"],B7oj6ja:["f1jar5jt","fyu767a"],Btl43ni:["fyu767a","f1jar5jt"],sj55zd:"f19n0e5",sshi5w:"f4x5sky",Be2twd7:"fy9rknc",Bg96gwp:"f7yhwew"},isActionableAppProfileCardDescription:{a9b677:"fly5x3f",Be2twd7:"fy9rknc",Bg96gwp:"f7yhwew",B68tc82:"f1p9o1ba",Bmxbyg5:"f1sil6mw",ygn44y:"f1cmbuwj",Bxyxcbc:"f1it27or",Bh9c35c:"f197wrh9"},isActionableAppProfileCardAppButton:{Bf4jedk:"f13bscln",Huce71:"fz5stix",t21cq0:["fvm675v","f1kdaspl"],Bqenvij:"f1sw78cg",z8tnut:"f1g0x7ka",z189sj:["f1yrrgfj","f10pi1ik"],Byoj8tv:"f1qch9an",uwmqm3:["f10pi1ik","f1yrrgfj"]},isActionableAppProfileCardAppButtonLoader:{t21cq0:["fvm675v","f1kdaspl"]},isActionableAppProfileCardImageContainer:{a9b677:"ffyv3ta",Bqenvij:"fyhdfh7",qhf8xq:"f10pi13n"},isActionableAppProfileCardFooter:{B6of3ja:"f1hu3pq6",t21cq0:["f61e7jq","feghjpc"],jrapky:"f19f4twv",Frg6f3:["feghjpc","f61e7jq"],Eo32re:"f1ter9b9",ekhr2s:"f1jf1ovi"},isActionableAppProfileCardTitle:{Be2twd7:"fkhj508",Bhrd7zp:"flh3ekv",Bg96gwp:"f15qi916"},isActionableAppProfileCardBody:{z8tnut:"f1g0x7ka",z189sj:["f10unbcs","f19apfqc"],Byoj8tv:"f1qch9an",uwmqm3:["f1cnd47f","fhxju0i"],a9b677:"f14z66ap",B68tc82:"f1oy3dpc",Bmxbyg5:"f5zp4f",B6of3ja:"f1hu3pq6",t21cq0:["f1ga0ydq","f1ikworw"],jrapky:"f19f4twv",Frg6f3:["feghjpc","f61e7jq"],z9904h:["f32gfn4","f9bbbef"]},isActionableAppProfileCardDivider:{z8tnut:"f1g0x7ka",z189sj:["fhxju0i","f1cnd47f"],Byoj8tv:"f1qch9an",uwmqm3:["f1cnd47f","fhxju0i"],B6of3ja:"fwdhe5f",t21cq0:["f11qmguv","f1tyq0we"],jrapky:"f1sq5vfh",Frg6f3:["f1tyq0we","f11qmguv"]},isActionableAppProfileCardHeader:{B6of3ja:"f17j5075",t21cq0:["f61e7jq","feghjpc"],jrapky:"f19f4twv",Frg6f3:["feghjpc","f61e7jq"]},isActionableAppProfileCardHeaderDescription:{sshi5w:"f1s7fcag",Bxyxcbc:"fivuv6",Frg6f3:["f1e3ula6","f153xw4"],t21cq0:["fbjlher","f1wtvaye"]},isActionableAppProfileCard:{a9b677:"f5m2izs",Bqenvij:"fc4x5ql",z8tnut:"f1g0x7ka",z189sj:["fhxju0i","f1cnd47f"],Byoj8tv:"ftfh06i",uwmqm3:["f1cnd47f","fhxju0i"],j0voox:"fplld7v",B6e1w0z:"fwy87ez",cg927r:"f41gd01",B0ktfmy:"fup2dot"},isActionableAppProfileCardActionButtonsWrapper:{Bow7q3s:"fuvumhg"},isActionableAppProfileCardShort:{a9b677:"f5m2izs",z8tnut:"f1g0x7ka",z189sj:["fhxju0i","f1cnd47f"],Byoj8tv:"ftfh06i",uwmqm3:["f1cnd47f","fhxju0i"]},isAppProfileCardPresence:{Be2twd7:"fy9rknc",B6of3ja:"f10kaskc"},isAppProfileShortCardDescription:{Be2twd7:"fy9rknc"},isAppProfileCardTitle:{Be2twd7:"fod5ikn",Bhrd7zp:"flh3ekv"},isAppProfileCardDeveloper:{Be2twd7:"fy9rknc"},isSceneProfileCardDesc:{jrapky:"f1sq5vfh",Be2twd7:"fy9rknc"},isContentClamped:{mc9l5x:"f1rvi9lw",B68tc82:"f1p9o1ba",Bmxbyg5:"f1sil6mw",B6of3ja:"f1hu3pq6",ygn44y:"f1cmbuwj",a9b677:"fly5x3f",Bh9c35c:"fd4kbmi",Fd1uvx:"fpfc2by"},isAppProfileCardDescription:{a9b677:"fqva8l3",Be2twd7:"fy9rknc",Bg96gwp:"f7yhwew"},listStyleBullet:{Bhrd7zp:"flh3ekv",Be2twd7:"f1fjxbv2"},isAppProfileCardPermission:{uwmqm3:["f1pui2vs","f1xqnc6q"]},isAppProfileCard:{a9b677:"ffyt4a4",Bqenvij:"f1l02sjl",z8tnut:"fjmaoex",z189sj:["f1nz66ws","fpsd8hx"],Byoj8tv:"f1tg7txk",uwmqm3:["fpsd8hx","f1nz66ws"]},isAppProfileCardImageContainer:{a9b677:"f190kgpo",Bqenvij:"fvi13kb",qhf8xq:"f10pi13n"},isAppProfileCardBasicPermission:{Be2twd7:"fy9rknc",jrapky:"f12kb92q",B6of3ja:"ficmxd5",Bg96gwp:"f7yhwew"},sceneAppProfileCard:{jrapky:"f1c0w631",B6of3ja:"fvrswf7"},isAppProfileCardDetail:{uwmqm3:["f1pui2vs","f1xqnc6q"]},isAppProfileCardActionButton:{z8tnut:"f1tdj2vy",Byoj8tv:"foxqkq2"},flexItemAlign:{qb2dma:"fjgzulp"},flexItemGrow:{Bh6795r:"fqerorx"},flexItemPush:{B6of3ja:"fgr6219"},isAppProfileCardLink:{Be2twd7:"f14d40fx",w71qe1:"f13mvf36"},isAppProfileCardPermissionFlex:{uwmqm3:["f1pui2vs","f1xqnc6q"]},messageAppDivider:{B6of3ja:"f14f5g9s",jrapky:"f1kd9ml8"},isActionableAppProfileCardHeaderButtons:{B6of3ja:"fwdhe5f"},isActionableAppProfileCardHeaderButtonsItem:{a9b677:"f14z66ap"}},{d:[".f14z66ap{width:auto;}",".f11ysow2{height:auto;}",".fy77jfu{min-width:0;}",".f1locze1{align-self:end;}",".fy9rknc{font-size:var(--fontSizeBase200);}",".f7yhwew{line-height:1.6rem;}",".flh3ekv{font-weight:var(--fontWeightBold);}",".fuxrj8o{list-style-type:disc;}",".f1bpxv7w{margin-top:0.8rem;}",".f1hn7b42{font-size:1.2rem;}",".f11hph32 a{cursor:pointer;}",".f1w7gpdv{display:inline;}",".fyind8e{color:var(--colorBrandForegroundLink);}",".f1k6fduh{cursor:pointer;}",".f1cdqgvm{vertical-align:baseline;}",".f1ern45e{border-top-style:none;}",".f1n71otn{border-right-style:none;}",".f1deefiw{border-left-style:none;}",".f1h8hb77{border-bottom-style:none;}",".f1g0x7ka{padding-top:0;}",".fhxju0i{padding-right:0;}",".f1cnd47f{padding-left:0;}",".f1qch9an{padding-bottom:0;}",".f18p0k4z{min-width:unset;}",".fjoy568{font-size:inherit;}",".ff5ikls{font-weight:inherit;}",".fuuohzo span{font-size:inherit;}",".f9oa3bk span{font-weight:inherit;}",".fz04i0k{padding-top:1.6rem;}",".fwdhe5f{margin-top:1.6rem;}",".f1u4y9u9{padding-top:0.8rem;}",".fwihf70{padding-right:1.8rem;}",".ffkyht9{padding-left:1.8rem;}",".ft977fb{padding-bottom:0.8rem;}",".f18f03hv{background-color:var(--colorNeutralBackground6);}",".f118ihkj{border-top-width:0.1rem;}",".fb4i99f{border-right-width:0.1rem;}",".fgvdrvz{border-left-width:0.1rem;}",".f3bv7ky{border-bottom-width:0.1rem;}",".fzkkow9{border-top-style:solid;}",".fcdblym{border-right-style:solid;}",".fjik90z{border-left-style:solid;}",".fg706s2{border-bottom-style:solid;}",".fj3muxo{border-top-color:var(--colorNeutralStroke1);}",".f1akhkt{border-right-color:var(--colorNeutralStroke1);}",".f1lxtadh{border-left-color:var(--colorNeutralStroke1);}",".f1aperda{border-bottom-color:var(--colorNeutralStroke1);}",".f1aa9q02{border-bottom-right-radius:var(--borderRadiusMedium);}",".f16jpd5f{border-bottom-left-radius:var(--borderRadiusMedium);}",".f1jar5jt{border-top-right-radius:var(--borderRadiusMedium);}",".fyu767a{border-top-left-radius:var(--borderRadiusMedium);}",".f19n0e5{color:var(--colorNeutralForeground1);}",".f4x5sky{min-height:4.8rem;}",".fly5x3f{width:100%;}",".f1p9o1ba{overflow-x:hidden;}",".f1sil6mw{overflow-y:hidden;}",".f1cmbuwj{text-overflow:ellipsis;}",".f1it27or{max-height:4.8rem;}",".f197wrh9{-webkit-line-clamp:3;}",".f13bscln{min-width:9.6rem;}",".fz5stix{white-space:nowrap;}",".fvm675v{margin-right:0.8rem;}",".f1kdaspl{margin-left:0.8rem;}",".f1sw78cg{height:3.2rem;}",".f1yrrgfj{padding-right:1.2rem;}",".f10pi1ik{padding-left:1.2rem;}",".ffyv3ta{width:8rem;}",".fyhdfh7{height:7.2rem;}",".f10pi13n{position:relative;}",".f1hu3pq6{margin-top:0;}",".f61e7jq{margin-right:2.4rem;}",".feghjpc{margin-left:2.4rem;}",".f19f4twv{margin-bottom:0;}",".f1ter9b9 form>div:last-child{margin-top:0;}",".f1jf1ovi form>div:last-child{margin-bottom:1.6rem;}",".fkhj508{font-size:var(--fontSizeBase300);}",".f15qi916{line-height:2rem;}",".f10unbcs{padding-right:0.9rem;}",".f19apfqc{padding-left:0.9rem;}",".f1oy3dpc{overflow-x:auto;}",".f5zp4f{overflow-y:auto;}",".f1ga0ydq{margin-right:0.1rem;}",".f1ikworw{margin-left:0.1rem;}",".f11qmguv{margin-right:0;}",".f1tyq0we{margin-left:0;}",".f1sq5vfh{margin-bottom:1.6rem;}",".f17j5075{margin-top:2.4rem;}",".f1s7fcag{min-height:7.2rem;}",".fivuv6{max-height:8.9rem;}",".f1e3ula6{margin-left:1.6rem;}",".f153xw4{margin-right:1.6rem;}",".fbjlher{margin-right:1rem;}",".f1wtvaye{margin-left:1rem;}",".f5m2izs{width:34rem;}",".fc4x5ql{height:62.8rem;}",".ftfh06i{padding-bottom:1.6rem;}",".fuvumhg>*{width:auto;}",".f10kaskc{margin-top:0.1rem;}",".fod5ikn{font-size:var(--fontSizeBase400);}",".f1rvi9lw{display:-webkit-box;}",".fd4kbmi{-webkit-line-clamp:6;}",".fpfc2by{-webkit-box-orient:vertical;}",".fqva8l3{width:20rem;}",".f1fjxbv2{font-size:1.8rem;}",".f1pui2vs{padding-left:0.5rem;}",".f1xqnc6q{padding-right:0.5rem;}",".ffyt4a4{width:31rem;}",".f1l02sjl{height:100%;}",".fjmaoex{padding-top:1.9rem;}",".f1nz66ws{padding-right:2.4rem;}",".fpsd8hx{padding-left:2.4rem;}",".f1tg7txk{padding-bottom:1.9rem;}",".f190kgpo{width:7.2rem;}",".fvi13kb{height:6.4rem;}",".f12kb92q{margin-bottom:1.0rem;}",".ficmxd5{margin-top:1.0rem;}",".f1c0w631{margin-bottom:1.2rem;}",".fvrswf7{margin-top:1.2rem;}",".f1tdj2vy{padding-top:1rem;}",".foxqkq2{padding-bottom:1rem;}",".fjgzulp{align-self:flex-start;}",".fqerorx{flex-grow:1;}",".fgr6219{margin-top:auto;}",".f14d40fx{font-size:1.1rem;}",".f13mvf36{text-decoration-line:underline;}",".f14f5g9s{margin-top:.2rem;}",".f1kd9ml8{margin-bottom:.5rem;}"],f:[".fnmhfyr:focus{text-decoration-line:underline;}"],a:[".f1eh06m1:active{text-decoration-line:underline;}",".f1bq4y7d:active{color:var(--colorBrandForegroundLink);}"],h:[".f1tx3yz7:hover{text-decoration-line:underline;}",".fldu4wg:hover{background-color:none;}",".fpwtdan:hover{color:var(--colorBrandForegroundLink);}",".f32gfn4:hover{padding-right:2.3rem;}",".f9bbbef:hover{padding-left:2.3rem;}"],m:[]});var Re=i(444156);var Be;!function(e){e[e.Default=0]="Default",e[e.InfoBanner=1]="InfoBanner"}(Be||(Be={}));const Qe=({appDef:e,botName:n,iconUrl:i,description:r,privacyUrl:o,termsOfUseUrl:l,botIdOrAppId:s,sceneCount:d,showActionButtons:c,isSceneApp:m,sceneName:u,showRectAppImage:p,botCallingCapabilities:k,appId:g,supportsMeetingStreaming:N,isInstalled:f,hasPersonalScope:h,botConfiguration:M})=>{const y=t.useMemo((()=>({botIdOrAppId:s,appName:n,appId:g})),[g,s,n]),{host:S}=(0,C.SE)(),A=(0,se.WG)(),{entity:I}=(0,de.sV)(),b=I.type===ce.py.channels?"Team":"GroupChat",D=I.type===ce.py.channels?(e=>e.id&&(e=>{try{JSON.parse(e)}catch(e){return!1}return!0})(e.id)?JSON.parse(e.id).channelId:e.id)(I):I.id,F=(0,se.LZ)(e,b),U=t.useCallback((()=>{A(D,b,e,se.ku.ReConfig)}),[e,D,A,b]),{enableFetchAPIForNonAdaptiveCardImages:E}=(0,v.NC)(T.J.Extensibility,["enableFetchAPIForNonAdaptiveCardImages"]),w=(0,ue.x)(),[{result:L}]=(0,pe.b)(w,E&&((0,ke.HM)(i,S.location.origin)||(0,ge.$O)(i))?i:"",!0,"Url"),x=L?.blob??i;return m?(0,a.t)(he,{botName:n,description:r,iconUrl:x,sceneCount:d,sceneName:u,showRectAppImage:p,privacyUrl:o,termsOfUseUrl:l}):g?(0,a.t)(We,{appDef:e,appProfile:y,description:r,iconUrl:x,showRectAppImage:p,botCallingCapabilities:k,supportsMeetingStreaming:N,privacyUrl:o,termsOfUseUrl:l,showActionButtons:c,isInstalled:f,hasPersonalScope:h,botConfiguration:F?M:null,launchBotConfig:U}):(0,a.t)(Ze,{appName:n,iconUrl:x,showRectAppImage:p})},We=({appDef:e,appProfile:n,iconUrl:i,description:r,privacyUrl:o,termsOfUseUrl:l,showActionButtons:s,showRectAppImage:d,botCallingCapabilities:c,supportsMeetingStreaming:m,isInstalled:u,hasPersonalScope:k,botConfiguration:g,launchBotConfig:N})=>{const{enableBotConfiguration:f}=(0,v.NC)(T.J.Extensibility,["enableBotConfiguration"]),h=Pe(),M=t.useRef(null),y=t.useRef(null),{recordPanelAction:S}=(0,U.It)(),A=t.useCallback((()=>{if(y.current&&M.current){const{appId:e,appName:i}=n;y.current.scrollTo({top:M.current.offsetTop-y.current.offsetTop,behavior:"smooth"}),S({actionGesture:F.uS.click,actionOutcome:F.$K.scroll,moduleName:F.rA.appProfileCard,panelRegion:F.Ai.popover,panelType:F.wh.AppProfileCardPopover,extensibilityData:{id:e,name:i}})}}),[n,M,y,S]);return(0,a.t)(p.k,{column:!0,className:h.isActionableAppProfileCard,children:[(0,a.t)(Ye,{appProfile:n,botCallingCapabilities:c,description:r,iconUrl:i,showActionButtons:s,showRectAppImage:d,isInstalled:u,hasPersonalScope:k}),f&&g?(0,a.t)(Q.z,{"data-tid":"bot-settings-button",appearance:"transparent",className:h.isBotSettingsButton,onClick:N,icon:(0,a.t)(te.e,{outline:!0,size:"medium"})}):(0,a.t)(t.Fragment,{}),(0,a.t)(ne.i,{className:h.isActionableAppProfileCardDivider}),(0,a.t)(Ge,{appDef:e,appProfile:n,bodyRef:y,permissionsRef:M,supportsMeetingStreaming:!!m}),(0,a.t)(ne.i,{className:h.isActionableAppProfileCardDivider}),(0,a.t)(_e,{appProfile:n,showActionButtons:s,onPermissionsClick:A,privacyUrl:o,termsOfUseUrl:l})]})},Ze=({appName:e,iconUrl:n,showRectAppImage:i})=>{const t=Pe();return(0,a.t)(p.k,{column:!0,className:t.isActionableAppProfileCardShort,children:[(0,a.t)(p.k,{className:t.isActionableAppProfileCardHeader,children:[(0,a.t)(Je,{iconUrl:n,showRectAppImage:i}),(0,a.t)(p.k,{column:!0,className:t.isActionableAppProfileCardHeaderDescription,children:(0,a.t)(Xe,{name:e})})]}),(0,a.t)(ne.i,{className:t.isActionableAppProfileCardDivider}),(0,a.t)(an,{isShortCard:!0})]})},Ye=({appProfile:e,botCallingCapabilities:n,description:i,iconUrl:t,showActionButtons:r,showRectAppImage:o,isInstalled:l,hasPersonalScope:s})=>{const{actionableAppProfileCardType:d}=(0,v.NC)(T.J.Extensibility,["actionableAppProfileCardType"]),c=d===Be.InfoBanner,m=Pe();return(0,a.t)(p.k,{column:!0,className:m.isActionableAppProfileCardHeader,children:[(0,a.t)(p.k,{children:[(0,a.t)(Je,{iconUrl:t,showRectAppImage:o}),(0,a.t)(p.k,{column:!0,className:m.isActionableAppProfileCardHeaderDescription,children:[(0,a.t)(Xe,{name:e.appName}),(0,a.t)(Ke,{description:i})]})]}),(0,a.t)(p.k,{fill:!0,className:m.isActionableAppProfileCardHeaderButtons,children:[s?(0,a.t)(qe,{appId:e.appId,appName:e.appName,isInstalled:l,isInfoBannerType:c}):null,r?(0,a.t)(p.k,{className:m.isActionableAppProfileCardActionButtonsWrapper,children:(0,a.t)(j,{appProfile:e,botCallingCapabilities:n})}):null]}),c&&!l?(0,a.t)($e,{}):null]})},Ge=({appDef:e,appProfile:{appId:n,appName:i},bodyRef:t,permissionsRef:r,supportsMeetingStreaming:o})=>{const{recordPanelAction:l}=(0,U.It)(),s=(0,ze.K)((()=>l({actionGesture:F.uS.scroll,actionOutcome:F.$K.read,moduleName:F.rA.appProfileCard,panelRegion:F.Ai.popover,panelType:F.wh.AppProfileCardPopover,extensibilityData:{id:n,name:i}})),1e3),d=Pe();return(0,a.t)(p.k,{column:!0,ref:t,className:d.isActionableAppProfileCardBody,onScroll:s,children:[(0,a.t)(tn,{appDef:e}),(0,a.t)(ne.i,{className:d.isActionableAppProfileCardDivider}),(0,a.t)(an,{permissionsRef:r,supportsMeetingStreaming:o})]})},_e=({appProfile:e,onPermissionsClick:n,privacyUrl:i,showActionButtons:t,termsOfUseUrl:r})=>{const o=Pe();return(0,a.t)(p.k,{column:!0,className:o.isActionableAppProfileCardFooter,children:[t?(0,a.t)(X,{appProfile:e}):null,(0,a.t)(nn,{appName:e.appName,onPermissionsClick:n,privacyUrl:i,termsOfUseUrl:r})]})},Je=({iconUrl:e,showRectAppImage:n})=>{const{appProfileImageBorderRadius:i}=on();return n?(0,a.t)(He,{iconUrl:e,width:80,height:72,variables:i}):(0,a.t)(He,{iconUrl:e,width:80,height:72,isHexagon:!0})},He=({iconUrl:e,width:n,height:i,isHexagon:t,variables:r})=>{const o=Pe(),l=(0,a.t)(d.J,{src:e,width:n,height:i,variables:r});return(0,a.t)($.W,{className:o.isActionableAppProfileCardImageContainer,children:t?(0,a.t)(u,{children:l}):l})},qe=({appId:e,appName:n,isInstalled:i,isInfoBannerType:r})=>{const{addAppButton:o,addToYourAppsButton:l,openAppButton:d}=ln(),[c,m]=t.useState(!1),[u,p]=t.useState(!1),k=(()=>{const e=(0,ue.x)(),{scenarioFactory:n}=(0,C.SE)(),i=(0,D.w)("useInstallPersonalApp"),{enableAppsQueryOptimization:a}=(0,v.NC)(T.J.Extensibility,["enableAppsQueryOptimization"]);return t.useCallback((t=>(0,s.eI)(e,n,E.RG.AppProfileCardInstallApp,t,"Personal",i,a)),[e,i,n,a])})(),g=(0,Le.Y)(),{recordPanelAction:N}=(0,U.It)();t.useEffect((()=>(p(!0),()=>p(!1))),[]);const{enablePersonalAppNavigationV2:f}=(0,v.NC)(T.J.Extensibility,["enablePersonalAppNavigationV2"]),h=t.useCallback((()=>{c||void 0===e||(m(!0),k(e).then((()=>g(e,!!f))).catch((()=>{u&&m(!1)})),N(rn({isAppInstallAction:!0,appId:e,appName:n})))}),[e,n,c,u,f,k,g,N]),M=t.useCallback((()=>{void 0!==e&&g(e,!!f),N(rn({appId:e,appName:n}))}),[e,n,f,g,N]),y=i?d:r?o:l,S=Pe();return(0,a.t)(Q.z,{disabled:void 0===e,onClick:i?M:h,className:S.isActionableAppProfileCardAppButton,title:y,children:[c&&(0,a.t)(Re.$,{size:"extra-small",className:S.isActionableAppProfileCardAppButtonLoader}),y]})},Xe=({name:e})=>{const n=Pe();return(0,a.t)(ee.q,{className:n.isActionableAppProfileCardTitle,children:e})},Ke=({description:e})=>{const n=Pe();return(0,a.t)(ee.q,{className:n.isActionableAppProfileCardDescription,children:e})},$e=()=>{const{addAppInfoBanner:e}=ln(),n=Pe();return(0,a.t)(p.k,{gap:"gap.smaller",className:n.isActionableAppProfileCardHeaderInfoBanner,children:[(0,a.t)(c.s,{}),(0,a.t)(ee.q,{children:e})]})},en=({developerName:e,developerUrl:n})=>{const i=(0,h.Cq)(),r=t.useMemo((()=>i.getTransForNs("extensibility")),[i]),o=Pe();return(0,a.t)(ee.q,{className:o.isActionableAppProfileCardBodySectionParagraph,children:(0,a.t)(r,{i18nKey:"ext_actionable_app_profile_card_app_features_created_by",children:(0,a.t)(ae.r,{target:"_blank",href:n,children:e})})})},nn=({appName:e,onPermissionsClick:n,privacyUrl:i,termsOfUseUrl:r})=>{const o=(0,h.Cq)(),l=t.useMemo((()=>o.getTransForNs("extensibility")),[o]),{termsOfUse:s,privacyPolicy:d,permissions:c}=ln(),m=Pe();return(0,a.t)(p.k,{vAlign:"end",gap:"gap.medium",children:(0,a.t)(ee.q,{className:m.isActionableAppProfileCardConsent,children:(0,a.t)(l,{i18nKey:"ext_actionable_app_profile_card_consent",children:[(0,a.t)(ee.q,{children:{appName:e}}),(0,a.t)(ae.r,{target:"_blank",href:i,children:{privacyPolicy:d}}),(0,a.t)(ae.r,{target:"_blank",href:r,children:{termsOfUse:s}}),(0,a.t)(Q.z,{appearance:"transparent",onClick:n,className:m.isActionableAppProfileCardLink,children:{permissions:c}})]})})})},an=({isShortCard:e,permissionsRef:n,supportsMeetingStreaming:i})=>{const r=(0,h.Cq)(),{isActionableAppProfileCardPermission:o,isActionableAppProfileCardPermissionsList:l}=on(),s=t.useMemo((()=>{const n=e?["app_profile_card_imsend","app_profile_card_imreceive"]:["extension_addAppDialogBasicPermission1","extension_addAppDialogBasicPermission2","extension_addAppDialogIdentityPermission1","extensibility_addAppDialogAppCardPermission1","extensibility_addAppDialogAppCardPermission2","extension_addAppDialogIdentityPermission2"];return i&&n.push("extension_addAppDialog_Permission_Meeting_Streaming_Access"),n}),[e,i]),d=t.useMemo((()=>s.map((e=>({key:e,content:r.translate("extensibility",e),variables:o})))),[o,s,r]),{permissionsTitle:c}=ln(),u=Pe();return(0,a.t)(p.k,{column:!0,ref:n,className:u.isActionableAppProfileCardBodySection,children:[(0,a.t)(ee.q,{className:u.isActionableAppProfileCardBodySectionTitle,children:c}),(0,a.t)(m.a,{variables:l,items:d})]})},tn=({appDef:e})=>{const{appFeaturesTitle:n}=ln(),{developerName:i,developerUrl:t}=e,r=Pe();return(0,a.t)(p.k,{column:!0,className:r.isActionableAppProfileCardBodySection,children:[(0,a.t)(ee.q,{className:r.isActionableAppProfileCardBodySectionTitle,children:n}),(0,a.t)(je,{appDef:e}),(0,a.t)(en,{developerName:i||"",developerUrl:t||""})]})},rn=({isAppInstallAction:e,appId:n,appName:i})=>({actionGesture:F.uS.click,actionOutcome:F.$K.nav,actionScenario:e?F.Tk.appCardAdd:F.Tk.appCardOpen,actionScenarioType:F.Yu.appCardActions,moduleName:F.rA.appProfileCard,panelRegion:F.Ai.popover,panelType:F.wh.AppProfileCardPopover,extensibilityData:{id:n,name:i}}),on=()=>{const{vars:e}=(0,r.L)();return t.useMemo((()=>({isActionableAppProfileCardActionButtonsWrapper:e("extensibility",["isActionableAppProfileCardActionButtonsWrapper"]),isActionableAppProfileCardAppButton:e("extensibility",["isActionableAppProfileCardAppButton"]),isActionableAppProfileCardPermission:e("extensibility",["isActionableAppProfileCardPermission"]),isActionableAppProfileCardPermissionsList:e("extensibility",["isActionableAppProfileCardPermissionsList"]),isActionableAppProfileCardConsent:e("extensibility",["isActionableAppProfileCardConsent"]),isActionableAppProfileCardDeveloper:e("extensibility",["isActionableAppProfileCardDeveloper"]),isActionableAppProfileCardLink:e("extensibility",["isActionableAppProfileCardLink"]),isActionableAppProfileCardPresence:e("extensibility",["isActionableAppProfileCardPresence"]),isActionableAppProfileCardTitle:e("extensibility",["isActionableAppProfileCardTitle"]),isActionableAppProfileCardDescription:e("extensibility",["isActionableAppProfileCardDescription"]),isActionableAppProfileCardImageContainer:e("extensibility",["isActionableAppProfileCardImageContainer"]),isActionableAppProfileCard:e("extensibility",["isActionableAppProfileCard"]),isActionableAppProfileCardShort:e("extensibility",["isActionableAppProfileCardShort"]),appProfileImageBorderRadius:e("extensibility",["appProfileImageBorderRadius"]),isActionableAppProfileCardHeader:e("extensibility",["isActionableAppProfileCardHeader"]),isActionableAppProfileCardHeaderDescription:e("extensibility",["isActionableAppProfileCardHeaderDescription"]),isActionableAppProfileCardHeaderButtons:e("extensibility",["isActionableAppProfileCardHeaderButtons"]),isActionableAppProfileCardHeaderInfoBanner:e("extensibility",["isActionableAppProfileCardHeaderInfoBanner"]),isActionableAppProfileCardDivider:e("extensibility",["isActionableAppProfileCardDivider"]),isActionableAppProfileCardBody:e("extensibility",["isActionableAppProfileCardBody","customScrollbar"]),isActionableAppProfileCardBodySection:e("extensibility",["isActionableAppProfileCardBodySection"]),isActionableAppProfileCardBodySectionParagrahp:e("extensibility",["isActionableAppProfileCardBodySectionParagrahp"]),isActionableAppProfileCardBodySectionTitle:e("extensibility",["isActionableAppProfileCardBodySectionTitle"]),isActionableAppProfileCardFooter:e("extensibility",["isActionableAppProfileCardFooter"])})),[e])},ln=()=>{const e=(0,h.Cq)();return t.useMemo((()=>({addAppButton:e.stringTranslate("extensibility","ext_actionable_app_profile_card_add_app_button_text"),addAppInfoBanner:e.stringTranslate("extensibility","ext_actionable_app_profile_card_add_app_info_banner_text"),addToYourAppsButton:e.stringTranslate("extensibility","ext_actionable_app_profile_card_add_to_your_apps_button_text"),appFeaturesTitle:e.stringTranslate("extensibility","ext_actionable_app_profile_card_app_features_title"),openAppButton:e.stringTranslate("extensibility","ext_actionable_app_profile_card_open_app_button_text"),permissions:e.stringTranslate("extensibility","ext_actionable_app_profile_card_permissions_link_text"),permissionsTitle:e.stringTranslate("extensibility","ext_actionable_app_profile_card_permissions_title"),privacyPolicy:e.stringTranslate("extensibility","ext_actionable_app_profile_card_privacy_policy_link_text"),termsOfUse:e.stringTranslate("extensibility","ext_actionable_app_profile_card_terms_of_use_link_text")})),[e])};var sn=i(750949),dn=i(121375),cn=i(981917),mn=i(894917),un=i(803238);const pn={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"user"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"mri"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"user"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"mri"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"imageUri"}}]}}]}}]};var kn=i(610597),gn=i(665641);const Nn=[],fn=(e,n,i,a,t,r)=>{const o=Nn.find((o=>o.botOrAppId===e&&o.isWebhook===n&&(0,un.isEqual)(o.conversationId,a)&&(0,un.isEqual)(o.connectorSenderGuid,t)&&(0,un.isEqual)(o.displayName,r)&&(0,un.isEqual)(o.togetherModeParams,i)));if(o)return o;const l={botOrAppId:e,togetherModeParams:i,conversationId:a,connectorSenderGuid:t,displayName:r,isWebhook:n,isGetAppDefinitionCallInProgress:!1,listeners:[]};return Nn.push(l),l},hn=(e,n)=>{e&&(e.listeners.forEach((e=>{e(n)})),e.isGetAppDefinitionCallInProgress=!1)},vn=(e,n,i,a,r,o,l=!1,s=!1)=>{const[d,c]=(0,t.useState)(),{loggerFactory:{newLogger:m},scenarioFactory:u}=(0,C.SE)(),p=(0,t.useMemo)((()=>m("AppProfileCardContentContainer","app-profile-card-data")),[m]),k=(0,w.bp)(),{convId:g}=k.chatServiceSubscriptionFilter,{appDefinition:N,isSceneApp:f}=i||{},{entity:h}=(0,de.sV)(),v=g||a||"",T=(0,t.useRef)(!1);return(0,t.useEffect)((()=>{const e=fn(n,l,i,a,r,o);return e.listeners.push(c),()=>{e.listeners=e.listeners.filter((e=>e!==c)),0===e.listeners.length&&(e=>{const n=Nn.findIndex((n=>n.botOrAppId===e.botOrAppId&&n.isWebhook===e.isWebhook&&(0,un.isEqual)(n.conversationId,e.conversationId)&&(0,un.isEqual)(n.connectorSenderGuid,e.connectorSenderGuid)&&(0,un.isEqual)(n.displayName,e.displayName)&&(0,un.isEqual)(n.togetherModeParams,e.togetherModeParams)));n>=0&&Nn.splice(n,1)})(e)}}),[n,i,a,r,o,l]),(0,t.useEffect)((()=>{let t;T.current=!0;const d=fn(n,l,i,a,r,o);if(!d.isGetAppDefinitionCallInProgress){d.isGetAppDefinitionCallInProgress=!0,t=u.newScenario(E.RG.AppProfileCardGetAppDefinition);const i=(0,J.bl)(n)?"Bot.Id":"App.Id";t.appendEventData({[i]:n}),N?T.current&&(hn(d,N),t.stop()):Tn(e,p,u,n,v,h,f,r,o,l,s).then((e=>{T.current&&(hn(d,e),t.stop())})).catch((e=>{const i=`Unable to fetch appDefinition for BotOrAppId: ${n}, Failed with error: ${e}`;!v&&i.toLowerCase().includes("conversationId is undefined".toLowerCase())?T.current&&t&&t.stop():(p.error(i,{botOrAppId:n}),T.current&&t&&t.fail({message:i})),d.isGetAppDefinitionCallInProgress=!1}))}return()=>{T.current=!1,t&&t.cancel()}}),[e,n,f,p,c,u,N,v,r,h,o,l,a,i,s]),d},Tn=async(e,n,i,a,t,r,o,l,s,d=!1,c=!1)=>{let m,u;const p=r.type===ce.py.channels;if(p)m="Team";else{const n=t?await In(e,t):null;if(n){u=n?.chatSubType===cn.k2.Channel;const e=bn(a,n);m=u?"Team":e||o?"Personal":"GroupChat"}}return(p||u)&&(t=await(0,kn.RD)(e,t)??""),Mn(e,n,i,a,t,l,m,s,d,c)},Mn=async(e,n,i,a,t,r,o,l,d=!1,c=!1)=>{const m=(0,J.bl)(a),u=(0,J.cQ)(a)&&!!r,p=d?await(async(e,n,i,a,t,r,o=!1)=>{const l=await(0,s.xJ)(e,i,t,a,!0,"outgoing-webhook",{conversation:{scope:r||"Team",id:n||""},enableInstalledAppQueryOptimization:o});return l?.[0]?.definition??null})(e,t,n,a,i,o,c):u?await(async(e,n,i,a)=>{if(!i)return null;const{data:t}=await e.query({query:dn.r,variables:{conversationId:n,scope:a,options:{capabilityFilter:["Connector"]}},context:{callerInfo:"app-profile-card-data-getAppDefinitionForConnector"}});if(t?.appDefinitions&&t.appDefinitions.length>0){const e=t.appDefinitions.filter((e=>e?.connectors&&e?.connectors[0].connectorId===i));if(e.length&&e[0])return e[0]}return null})(e,t,r,o):m?await(async(e,n,i,a)=>{const{data:t}=await e.query({query:dn.r,variables:{conversationId:i,scope:a,options:{botId:(0,gn.HC)(n)}},context:{callerInfo:"app-profile-card-data-getAppDefinitionForBot"}});return t?.appDefinitions?.length&&t.appDefinitions[0]?t.appDefinitions[0]:null})(e,a,t,o):await(async(e,n,i,a)=>{const{data:t}=await e.query({query:sn.V,variables:{conversationId:i,scope:a,appId:n}});return t?.appDefinition?t.appDefinition:null})(e,a,t,o);if(p)return p;const k=m?await(async(e,n,i)=>{if((0,J.cQ)(n)&&i)return{name:i,largeImageUrl:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0IiBmaWxsPSIjMjkzODRGIi8+CjxwYXRoIGQ9Ik0xMS45OTAyIDMuMjVDMTIuNTgyNyAzLjI1IDEzLjE0OTEgMy4zMjgxMiAxMy42ODk1IDMuNDg0MzhDMTQuMjI5OCAzLjYzNDExIDE0LjczMTEgMy44NDU3IDE1LjE5MzQgNC4xMTkxNEMxNS42NTU2IDQuMzkyNTggMTYuMDcyMyA0LjcyNDYxIDE2LjQ0MzQgNS4xMTUyM0MxNi44MjEgNS41MDU4NiAxNy4xNDMyIDUuOTM1NTUgMTcuNDEwMiA2LjQwNDNDMTcuNjc3MSA2Ljg3MzA1IDE3Ljg4MjIgNy4zODA4NiAxOC4wMjU0IDcuOTI3NzNDMTguMTY4NiA4LjQ2ODEgMTguMjQwMiA5LjAzMTI1IDE4LjI0MDIgOS42MTcxOUMxOC40MjkgOS42ODIyOSAxOC41OTgzIDkuNzczNDQgMTguNzQ4IDkuODkwNjJDMTguOTA0MyAxMC4wMDc4IDE5LjAzNDUgMTAuMTQ0NSAxOS4xMzg3IDEwLjMwMDhDMTkuMjQ5MyAxMC40NTA1IDE5LjMzNCAxMC42MTk4IDE5LjM5MjYgMTAuODA4NkMxOS40NTc3IDEwLjk5MDkgMTkuNDkwMiAxMS4xNzk3IDE5LjQ5MDIgMTEuMzc1VjEzLjg3NUMxOS40OTAyIDE0LjEyODkgMTkuNDQxNCAxNC4zNjk4IDE5LjM0MzggMTQuNTk3N0MxOS4yNDYxIDE0LjgyNTUgMTkuMTA5NCAxNS4wMjczIDE4LjkzMzYgMTUuMjAzMUMxOC43NjQzIDE1LjM3MjQgMTguNTY1OCAxNS41MDU5IDE4LjMzNzkgMTUuNjAzNUMxOC4xMSAxNS43MDEyIDE3Ljg2OTEgMTUuNzUgMTcuNjE1MiAxNS43NUgxNi4zNjUyQzE2LjE5NiAxNS43NSAxNi4wNDk1IDE1LjY4ODIgMTUuOTI1OCAxNS41NjQ1QzE1LjgwMjEgMTUuNDQwOCAxNS43NDAyIDE1LjI5NDMgMTUuNzQwMiAxNS4xMjVWMTAuMTI1QzE1Ljc0MDIgOS45NDkyMiAxNS43ODI2IDkuODE5MDEgMTUuODY3MiA5LjczNDM4QzE1Ljk1MTggOS42NDMyMyAxNi4wNTYgOS41ODEzOCAxNi4xNzk3IDkuNTQ4ODNDMTYuMzAzNCA5LjUwOTc3IDE2LjQzNjggOS40OTM0OSAxNi41ODAxIDkuNUMxNi43Mjk4IDkuNSAxNi44NjY1IDkuNSAxNi45OTAyIDkuNUMxNi45OTAyIDguODA5OSAxNi44NTY4IDguMTYyMTEgMTYuNTg5OCA3LjU1NjY0QzE2LjMyOTQgNi45NTExNyAxNS45NzE0IDYuNDIzODMgMTUuNTE1NiA1Ljk3NDYxQzE1LjA2NjQgNS41MTg4OCAxNC41MzkxIDUuMTYwODEgMTMuOTMzNiA0LjkwMDM5QzEzLjMyODEgNC42MzM0NiAxMi42ODAzIDQuNSAxMS45OTAyIDQuNUMxMS4zMDAxIDQuNSAxMC42NTIzIDQuNjMzNDYgMTAuMDQ2OSA0LjkwMDM5QzkuNDQxNDEgNS4xNjA4MSA4LjkxMDgxIDUuNTE4ODggOC40NTUwOCA1Ljk3NDYxQzguMDA1ODYgNi40MjM4MyA3LjY0Nzc5IDYuOTUxMTcgNy4zODA4NiA3LjU1NjY0QzcuMTIwNDQgOC4xNjIxMSA2Ljk5MDIzIDguODA5OSA2Ljk5MDIzIDkuNUg3LjI3MzQ0QzcuMzg0MTEgOS41IDcuNDk4MDUgOS41MDY1MSA3LjYxNTIzIDkuNTE5NTNDNy43MzI0MiA5LjUyNjA0IDcuODM2NTkgOS41NTIwOCA3LjkyNzczIDkuNTk3NjZDOC4wMTg4OCA5LjYzNjcyIDguMDkzNzUgOS42OTg1NyA4LjE1MjM0IDkuNzgzMkM4LjIxMDk0IDkuODY3ODQgOC4yNDAyMyA5Ljk4MTc3IDguMjQwMjMgMTAuMTI1VjE1LjEyNUM4LjI0MDIzIDE1LjMwMDggOC4xOTc5MiAxNS40MzQyIDguMTEzMjggMTUuNTI1NEM4LjAyODY1IDE1LjYxIDcuOTI0NDggMTUuNjcxOSA3LjgwMDc4IDE1LjcxMDlDNy42NzcwOCAxNS43NDM1IDcuNTQwMzYgMTUuNzU5OCA3LjM5MDYyIDE1Ljc1OThDNy4yNDc0IDE1Ljc1MzMgNy4xMTM5MyAxNS43NSA2Ljk5MDIzIDE1Ljc1VjE3Ljk3NjZDNi45OTAyMyAxOC4xMzI4IDcuMDM5MDYgMTguMjYzIDcuMTM2NzIgMTguMzY3MkM3LjI0MDg5IDE4LjQ2NDggNy4zNzEwOSAxOC41NDYyIDcuNTI3MzQgMTguNjExM0M3LjY5MDEgMTguNjc2NCA3Ljg2OTE0IDE4LjcyNTMgOC4wNjQ0NSAxOC43NTc4QzguMjU5NzcgMTguNzkwNCA4LjQ1NTA4IDE4LjgxNjQgOC42NTAzOSAxOC44MzU5QzguODQ1NyAxOC44NDkgOS4wMjc5OSAxOC44NTg3IDkuMTk3MjcgMTguODY1MkM5LjM2NjU0IDE4Ljg2NTIgOS41MDMyNiAxOC44NjUyIDkuNjA3NDIgMTguODY1MkM5LjY3OTA0IDE4LjY4MjkgOS43NzM0NCAxOC41MTY5IDkuODkwNjIgMTguMzY3MkMxMC4wMDc4IDE4LjIxNzQgMTAuMTQxMyAxOC4wODcyIDEwLjI5MSAxNy45NzY2QzEwLjQ0NzMgMTcuODY1OSAxMC42MTY1IDE3Ljc4MTIgMTAuNzk4OCAxNy43MjI3QzEwLjk4MTEgMTcuNjU3NiAxMS4xNjk5IDE3LjYyNSAxMS4zNjUyIDE3LjYyNUgxMS45OTAyQzEyLjI0NDEgMTcuNjI1IDEyLjQ4NSAxNy42NzM4IDEyLjcxMjkgMTcuNzcxNUMxMi45NDA4IDE3Ljg2OTEgMTMuMTM5MyAxOC4wMDU5IDEzLjMwODYgMTguMTgxNkMxMy40ODQ0IDE4LjM1MDkgMTMuNjIxMSAxOC41NDk1IDEzLjcxODggMTguNzc3M0MxMy44MTY0IDE5LjAwNTIgMTMuODY1MiAxOS4yNDYxIDEzLjg2NTIgMTkuNUMxMy44NjUyIDE5Ljc1MzkgMTMuODE2NCAxOS45OTQ4IDEzLjcxODggMjAuMjIyN0MxMy42MjExIDIwLjQ1MDUgMTMuNDg0NCAyMC42NTIzIDEzLjMwODYgMjAuODI4MUMxMy4xMzkzIDIwLjk5NzQgMTIuOTQwOCAyMS4xMzA5IDEyLjcxMjkgMjEuMjI4NUMxMi40ODUgMjEuMzI2MiAxMi4yNDQxIDIxLjM3NSAxMS45OTAyIDIxLjM3NUgxMS4zNjUyQzEwLjk2MTYgMjEuMzc1IDEwLjYwMDMgMjEuMjYxMSAxMC4yODEyIDIxLjAzMzJDOS45NjIyNCAyMC43OTg4IDkuNzM0MzggMjAuNDkyOCA5LjU5NzY2IDIwLjExNTJDOS4zNTAyNiAyMC4xMDg3IDkuMDgwMDggMjAuMDk5IDguNzg3MTEgMjAuMDg1OUM4LjUwMDY1IDIwLjA3MjkgOC4yMTQxOSAyMC4wNDY5IDcuOTI3NzMgMjAuMDA3OEM3LjY0MTI4IDE5Ljk2MjIgNy4zNjQ1OCAxOS44OTcxIDcuMDk3NjYgMTkuODEyNUM2LjgzNzI0IDE5LjcyMTQgNi42MDYxMiAxOS41OTc3IDYuNDA0MyAxOS40NDE0QzYuMjAyNDcgMTkuMjc4NiA2LjAzOTcxIDE5LjA4MDEgNS45MTYwMiAxOC44NDU3QzUuNzk4ODMgMTguNjA0OCA1Ljc0MDIzIDE4LjMxNTEgNS43NDAyMyAxNy45NzY2VjE1LjYzMjhDNS41NTc5NCAxNS41Njc3IDUuMzg4NjcgMTUuNDc2NiA1LjIzMjQyIDE1LjM1OTRDNS4wNzYxNyAxNS4yNDIyIDQuOTQyNzEgMTUuMTA4NyA0LjgzMjAzIDE0Ljk1OUM0LjcyNzg2IDE0LjgwMjcgNC42NDMyMyAxNC42MzM1IDQuNTc4MTIgMTQuNDUxMkM0LjUxOTUzIDE0LjI2MjQgNC40OTAyMyAxNC4wNzAzIDQuNDkwMjMgMTMuODc1VjExLjM3NUM0LjQ5MDIzIDExLjE3OTcgNC41MTk1MyAxMC45OTA5IDQuNTc4MTIgMTAuODA4NkM0LjY0MzIzIDEwLjYxOTggNC43Mjc4NiAxMC40NTA1IDQuODMyMDMgMTAuMzAwOEM0Ljk0MjcxIDEwLjE0NDUgNS4wNzYxNyAxMC4wMDc4IDUuMjMyNDIgOS44OTA2MkM1LjM4ODY3IDkuNzczNDQgNS41NTc5NCA5LjY4MjI5IDUuNzQwMjMgOS42MTcxOUM1Ljc0MDIzIDkuMDMxMjUgNS44MTE4NSA4LjQ2ODEgNS45NTUwOCA3LjkyNzczQzYuMDk4MzEgNy4zODA4NiA2LjMwMzM5IDYuODczMDUgNi41NzAzMSA2LjQwNDNDNi44MzcyNCA1LjkzNTU1IDcuMTU2MjUgNS41MDU4NiA3LjUyNzM0IDUuMTE1MjNDNy45MDQ5NSA0LjcyNDYxIDguMzI0ODcgNC4zOTI1OCA4Ljc4NzExIDQuMTE5MTRDOS4yNDkzNSAzLjg0NTcgOS43NTA2NSAzLjYzNDExIDEwLjI5MSAzLjQ4NDM4QzEwLjgzMTQgMy4zMjgxMiAxMS4zOTc4IDMuMjUgMTEuOTkwMiAzLjI1Wk0xMS4zNjUyIDE4Ljg3NUMxMS4xOTYgMTguODc1IDExLjA0OTUgMTguOTM2OCAxMC45MjU4IDE5LjA2MDVDMTAuODAyMSAxOS4xODQyIDEwLjc0MDIgMTkuMzMwNyAxMC43NDAyIDE5LjVDMTAuNzQwMiAxOS42NjkzIDEwLjgwMjEgMTkuODE1OCAxMC45MjU4IDE5LjkzOTVDMTEuMDQ5NSAyMC4wNjMyIDExLjE5NiAyMC4xMjUgMTEuMzY1MiAyMC4xMjVIMTEuOTkwMkMxMi4xNTk1IDIwLjEyNSAxMi4zMDYgMjAuMDYzMiAxMi40Mjk3IDE5LjkzOTVDMTIuNTUzNCAxOS44MTU4IDEyLjYxNTIgMTkuNjY5MyAxMi42MTUyIDE5LjVDMTIuNjE1MiAxOS4zMzA3IDEyLjU1MzQgMTkuMTg0MiAxMi40Mjk3IDE5LjA2MDVDMTIuMzA2IDE4LjkzNjggMTIuMTU5NSAxOC44NzUgMTEuOTkwMiAxOC44NzVIMTEuMzY1MlpNNi4zNjUyMyAxMC43NUM2LjE5NTk2IDEwLjc1IDYuMDQ5NDggMTAuODExOCA1LjkyNTc4IDEwLjkzNTVDNS44MDIwOCAxMS4wNTkyIDUuNzQwMjMgMTEuMjA1NyA1Ljc0MDIzIDExLjM3NVYxMy44NzVDNS43NDAyMyAxNC4wNDQzIDUuODAyMDggMTQuMTkwOCA1LjkyNTc4IDE0LjMxNDVDNi4wNDk0OCAxNC40MzgyIDYuMTk1OTYgMTQuNSA2LjM2NTIzIDE0LjVINi45OTAyM1YxMC43NUg2LjM2NTIzWk0xNi45OTAyIDEwLjc1VjE0LjVIMTcuNjE1MkMxNy43ODQ1IDE0LjUgMTcuOTMxIDE0LjQzODIgMTguMDU0NyAxNC4zMTQ1QzE4LjE3ODQgMTQuMTkwOCAxOC4yNDAyIDE0LjA0NDMgMTguMjQwMiAxMy44NzVWMTEuMzc1QzE4LjI0MDIgMTEuMjA1NyAxOC4xNzg0IDExLjA1OTIgMTguMDU0NyAxMC45MzU1QzE3LjkzMSAxMC44MTE4IDE3Ljc4NDUgMTAuNzUgMTcuNjE1MiAxMC43NUgxNi45OTAyWiIgZmlsbD0id2hpdGUiLz4KPC9zdmc+Cg=="};const{data:a}=await e.query({query:pn,variables:{mri:n},context:{callerInfo:"app-profile-card-data"}}),t=a?.user;if(t)return{name:t.displayName||"",largeImageUrl:t.imageUri||""};return null})(e,a,l):null;return k},yn=e=>e.bots&&e.bots.length>0&&(0,un.includes)(e.bots[0].scopes,"Personal")||!1,Sn=(e,n,i)=>{const[a,r]=(0,t.useState)(!1),[o,l]=(0,t.useState)(!1),[s,d]=(0,t.useState)(!0),c=(0,w.bp)(),{scenarioFactory:m}=(0,C.SE)(),u=(0,D.w)("AppProfileCardContentContainer");return(0,t.useEffect)((()=>{const a=Dn(n);if(!a)return;const{convId:t}=c.chatServiceSubscriptionFilter;let o,s=!1;const p=t||i;return p&&(s=!0,o=m.newScenario(E.RG.UseOneOnOneAndDisabledByTenantChecker),In(e,p).then((e=>{s&&(r(!e||bn(a,e)),l(!e||Cn(a,e)),d(!e||bn(a,e)),o.stop())})).catch((()=>{const e=`Failed to get conversation with conversationId:${t} for bot/app:${a}`;u.error(e,{botMri:a}),s&&o&&o.fail({message:e})}))),()=>{s=!1,o&&o.cancel()}}),[c.chatServiceSubscriptionFilter,n,e,u,m,i]),{isDisabledByTenant:o,isOneOnOne:a,isOneOnOneBotChat:s}},An=(e,n)=>{const[i,a]=(0,t.useState)(!1),{scenarioFactory:r}=(0,C.SE)(),o=(0,D.w)("AppProfileCardContentContainer");return(0,t.useEffect)((()=>{const i=Dn(n);if(!i)return;let t=!0;const l=r.newScenario(E.RG.UseDisabledByUserChecker);return(0,b.cc)(e,i).then((e=>{t&&(a(!e||Cn(i,e)),l.stop())})).catch((()=>{const e=`Failed to get conversation for bot/app:${i}`;o.error(e,{botMri:i}),t&&l&&l.fail({message:e})})),()=>{t=!1,l&&l.cancel()}}),[n,e,o,r]),i},In=async(e,n)=>{const i=await e.query({query:mn.v,variables:{convId:n},context:{callerInfo:"app-profile-card-data"}});return i.data?.chat},bn=(e,n)=>!!n&&!!n.isOneOnOne&&!!n.memberIds&&-1!==n.memberIds.indexOf(e),Cn=(e,n)=>!!n&&!!n.isDisabled&&!!n.memberIds&&-1!==n.memberIds.indexOf(e),Dn=e=>{let n=e&&e.bots&&e.bots.length>0&&e.bots[0].id;if(n){const e=n?.startsWith(H.at.BotPrefix);n=e?n:`${H.at.BotPrefix}${n}`}return n||null},Fn=e=>e&&e.meetingExtensionDefinition&&e.meetingExtensionDefinition.scenes&&e.meetingExtensionDefinition.scenes.length>0?e.meetingExtensionDefinition.scenes.length:0,Un=e=>{const n={supportsCalling:!1,supportsVideo:!1},i=e.bots&&e?.bots[0]?.capabilities;return n.supportsCalling=i?.supportsCalling??!1,n.supportsVideo=i?.supportsVideo??!1,n},En=e=>e.bots&&e?.bots[0]?.configuration,wn="ext_actionable_app_profile_card_use_is_app_installed_get_installed_apps",Ln=({client:e,botIdOrAppId:n,hideActionButtons:i,appDef:r,togetherModeParams:o,convId:l})=>{const{isOneOnOne:d,isDisabledByTenant:c,isOneOnOneBotChat:m}=Sn(e,r,l),u=An(e,r),p=r&&Dn(r),k=r&&Fn(r),g=r&&Un(r),N=r&&En(r),{id:f,name:h,privacyUrl:M,termsOfUseUrl:y,largeImageUrl:S,shortDescription:A,meetingExtensionDefinition:I}=r,b=yn(r),F=!b&&!!i,U=((e,n)=>{const[i,a]=t.useState(null),{scenarioFactory:r}=(0,C.SE)(),o=(0,D.w)("useIsAppInstalled"),{enableAppsQueryOptimization:l,enableInstalledAppQueryOptimization:d}=(0,v.NC)(T.J.Extensibility,["enableAppsQueryOptimization","enableInstalledAppQueryOptimization"]);return t.useEffect((()=>{(0,s.xJ)(e,o,r,n,l,"use-is-app-installed",{shouldFetchPersonalApps:!0,enableInstalledAppQueryOptimization:d}).then((e=>{const n=`Loaded installed apps. Length: ${e.length}`;o.infoToTelemetry?o.infoToTelemetry(n,wn):o.log(`${wn}: ${n}`),a(e.length>0)})).catch((()=>{const e=`Failed to get installed apps by ID for app id: ${n}`;o.errorToTelemetry?o.errorToTelemetry(e,wn):o.error(`${wn}: ${e}`)}))}),[e,o,r,n,l,d]),i})(e,f),E=(0,s.WW)("Personal",r);return(0,a.t)(Qe,{appDef:r,botName:xn(h),privacyUrl:xn(M),termsOfUseUrl:xn(y),iconUrl:xn(S),description:xn(A),botIdOrAppId:p||n,showRectAppImage:!!o?.isSceneApp||F,sceneCount:k||0,isSceneApp:!!o?.isSceneApp,showActionButtons:b&&!d&&!c&&!u&&!i,sceneName:xn(o?.sceneName),botCallingCapabilities:g,appId:f,supportsMeetingStreaming:I?.supportsStreaming,hasPersonalScope:E,isInstalled:!!U,botConfiguration:m?null:N})},xn=e=>e||"",On=({client:e,botIdOrAppId:n,hideActionButtons:i,appDef:t,togetherModeParams:r,convId:o})=>{const{isOneOnOne:l,isDisabledByTenant:s,isOneOnOneBotChat:d}=Sn(e,t,o),c=An(e,t),m=t&&Dn(t),u=t&&Fn(t),p=t&&Un(t),k=t&&En(t),{id:g,name:N,privacyUrl:f,termsOfUseUrl:h,developerName:v,largeImageUrl:T,longDescription:M,shortDescription:y,meetingExtensionDefinition:S}=t,A=yn(t),I=!A&&i||!1,b=!t?.id&&!i;return(0,a.t)(Ne,{botName:jn(N),privacyUrl:jn(f),termsOfUseUrl:jn(h),developerName:Vn(r)?"":jn(v),iconUrl:jn(T),description:Vn(r)?jn(y):jn(M),botIdOrAppId:m||n,showRectAppImage:Vn(r)||I,isShortProfileCard:b,sceneCount:u||0,isSceneApp:!!Vn(r),showActionButtons:A&&!l&&!s&&!c&&!i&&!b,sceneName:jn(r&&r.sceneName),botCallingCapabilities:p,appId:g,supportsMeetingStreaming:S?.supportsStreaming,botConfiguration:d?null:k,appDef:t})},jn=e=>e||"",Vn=e=>e&&e.isSceneApp;var zn=i(185273);const Pn=({className:e})=>(0,a.t)($.W,{className:e,children:(0,a.t)(p.k,{fill:!0,vAlign:"center",hAlign:"center",children:(0,a.t)(Re.$,{})})});var Rn=i(832259);const Bn=(0,Y.s)({isAppProfileCard:{a9b677:"ffyt4a4",Bqenvij:"f1l02sjl",z8tnut:"fjmaoex",z189sj:["f1nz66ws","fpsd8hx"],Byoj8tv:"f1tg7txk",uwmqm3:["fpsd8hx","f1nz66ws"]}},{d:[".ffyt4a4{width:31rem;}",".f1l02sjl{height:100%;}",".fjmaoex{padding-top:1.9rem;}",".f1nz66ws{padding-right:2.4rem;}",".fpsd8hx{padding-left:2.4rem;}",".f1tg7txk{padding-bottom:1.9rem;}"]}),Qn=t.memo((({children:e,client:n,botIdOrAppId:i,hideActionButtons:s,position:d,align:c,offset:m,togetherModeParams:u,autoFocus:p,connectorSenderGuid:k,conversationId:g,onBehalfOfId:N,renderTriggerAsLink:f=!0,displayName:h,tabbableTrigger:M,nonFocusableTrigger:y})=>{const S=t.useContext(zn.I18nContext),{recordPanelAction:A,createDatabag:I}=(0,U.It)(),b=t.useRef(!1),{enableAppProfileCard:C,enableActionableAppProfileCard:D,enableInstalledAppQueryOptimization:E}=(0,v.NC)(T.J.Extensibility,["enableAppProfileCard","enableActionableAppProfileCard","enableInstalledAppQueryOptimization"]),w=Bn(),{vars:L}=(0,r.L)(),[O,j]=t.useState(!1),V=(0,J.YQ)(i),z=vn(n,V&&N?N:i,u,g,k,h,V,!!E),P=(0,un.debounce)((()=>{j(!0)}),1e3),R=t.useCallback(((e,n)=>{const i=n?.open;if(P.cancel(),!0===i?P():j(!1),i&&!b.current){const e=x(F.uS.hover,F.$K.inspect,F.Tk.appProfileCardAppear,F.rA.appProfileCard,z?.name??void 0,z?.id,z?.bots?.[0]?.id);D&&(e.dataBag=I(),e.dataBag.actionableAppProfileCard=!0),A(e)}void 0!==i&&i!==b.current&&(b.current=i)}),[I,A,z,D,b,P]),B=t.useMemo((()=>Zn(!!D)),[D]);if(!C)return(0,a.t)(t.Fragment,{children:e});let Q="";if(null===z)return null;if(z){const{name:e,developerName:n,longDescription:i,shortDescription:a}=z,t=(D?a:i)||"";Q=S.stringTranslate("extensibility","app_profile_card_app_information_dialog_aria_label",{name:e||"",developerName:n||"",longDescription:t})}const W=e??z?.name;return(0,a.t)(o.G,{on:"hover",position:d||"before",align:c||"center",offset:m,open:O,onOpenChange:R,autoFocus:p,trapFocus:Wn(p),autoSize:!0,content:{"aria-label":Q,autoFocus:!0,className:Rn.L,content:z?(0,a.t)(B,{botIdOrAppId:i,client:n,appDef:z,hideActionButtons:s,togetherModeParams:u,convId:g}):(0,a.t)(Pn,{className:w.isAppProfileCard}),variables:{removePopupContentPadding:!0,hasNoBorder:!0}},tabbableTrigger:M,trigger:(0,a.t)(l.x,{link:!!f,content:W,variables:L("extensibility",["isFocusableOutlineBorder"]),...y&&{tabIndex:"-1"}}),overflowBoundary:"window",flipBoundary:"window"})})),Wn=e=>!!e&&!e,Zn=(e=!1)=>e?Ln:On,Yn=(0,A.C)(Qn)},372076:(e,n,i)=>{"use strict";i.d(n,{Vo:()=>c,bH:()=>u,Qq:()=>m,Yx:()=>p});var a=i(250033),t=i(818319),r=i(811537),o=i(681971);const l={clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0px",width:"1px",position:"absolute"},s=t.forwardRef((({assertive:e,targetDocument:n},i)=>{const[s,d]=t.useState(""),c=t.useRef(),m=(0,o.SE)(),u=m?m.host:window,p=/Mac|iPod|iPhone|iPad/.test(u.navigator.platform),k=t.useCallback((e=>{d(e),null!==c.current&&u.clearTimeout(c.current),c.current=u.setTimeout((()=>{d(""),null!==c.current&&u.clearTimeout(c.current),c.current=null}),2e3)}),[c,u,d]);t.useImperativeHandle(i,(()=>({announce:k}))),t.useEffect((()=>()=>{null!==c.current&&u.clearTimeout(c.current)}),[c,u]);const g=n?n.body:u.document.body;let N=null;if(p){const e=n?n.activeElement:u.document.activeElement;N=e?.closest("*[aria-modal='true']")}const f=N||g;return r.createPortal((0,a.t)("div",{"aria-live":e?"assertive":"polite","aria-atomic":"true",style:l,children:s}),f)}));var d=i(219114);const c=t.createContext(void 0),m=({children:e,targetDocument:n})=>{const i=t.useRef(),r=t.useRef(),o=t.useCallback(((e,n)=>{const a=n?r.current:i.current;a&&a.announce(e)}),[r,i]),l=t.useMemo((()=>({announce:o})),[o]),m=t.useMemo((()=>({announce:(e,n)=>{const i=!!n&&!n.polite;o(e,i)}})),[o]);return(0,a.t)(t.Fragment,{children:[(0,a.t)(s,{assertive:!1,ref:i,targetDocument:n}),(0,a.t)(s,{assertive:!0,ref:r,targetDocument:n}),(0,a.t)(d.Q,{value:m,children:(0,a.t)(c.Provider,{value:l,children:e})})]})},u=c.Consumer,p=()=>t.useContext(c)},557687:(e,n,i)=>{"use strict";i.d(n,{mw:()=>se});var a=i(250033),t=i(818319),r=i(316877),o=i(700310),l=i(436328),s=i(917978),d=i(823847),c=i(747322),m=i(564087),u=i(780989),p=i(994575),k=i(681971),g=i(588592),N=i(686219),f=i(323356),h=i(629494),v=i(683184),T=i(543491),M=i(811957),y=i(467192);var S=i(438587),A=i(895007),I=i(341443),b=i(696618);const C=(0,b.s)({teamAvatarBorder:{Bbmb7ep:["f1aa9q02","f16jpd5f"],Beyfa6y:["f16jpd5f","f1aa9q02"],B7oj6ja:["f1jar5jt","fyu767a"],Btl43ni:["fyu767a","f1jar5jt"]},teamHighContrastAvatarBorder:{icvyot:"fzkkow9",vrafjx:["fcdblym","fjik90z"],oivjwe:"fg706s2",wvpqe5:["fjik90z","fcdblym"],g2u3we:"fdli2b0",h3c5rm:["fewyrie","f5umq98"],B9xav0g:"fp6s13d",zhjwy3:["f5umq98","fewyrie"],B4j52fo:"ftac7j7",Bekrc4i:["f1w0yd9v","f1h0xgbp"],Bn0qgzm:"fdwcyh7",ibv6hh:["f1h0xgbp","f1w0yd9v"]}},{d:[".f1aa9q02{border-bottom-right-radius:var(--borderRadiusMedium);}",".f16jpd5f{border-bottom-left-radius:var(--borderRadiusMedium);}",".f1jar5jt{border-top-right-radius:var(--borderRadiusMedium);}",".fyu767a{border-top-left-radius:var(--borderRadiusMedium);}",".fzkkow9{border-top-style:solid;}",".fcdblym{border-right-style:solid;}",".fjik90z{border-left-style:solid;}",".fg706s2{border-bottom-style:solid;}",".fdli2b0{border-top-color:white;}",".fewyrie{border-right-color:white;}",".f5umq98{border-left-color:white;}",".fp6s13d{border-bottom-color:white;}",".ftac7j7{border-top-width:2px;}",".f1w0yd9v{border-right-width:2px;}",".f1h0xgbp{border-left-width:2px;}",".fdwcyh7{border-bottom-width:2px;}"]});var D=i(435191),F=i(96496);const U=(0,b.s)({avatarObjectFit:{st4lth:"f1ps3kmd"},groupChatAvatarObjectFit:{st4lth:"f1plgu50"}},{d:[".f1ps3kmd{object-fit:cover;}",".f1plgu50{object-fit:none;}"]});var E=i(470453);const w=t.memo((({simpleAvatarType:e,...n})=>{const{enableFluentV9Avatar:i}=(0,h.NC)(v.J.People,["enableFluentV9Avatar"]);return e?(0,a.t)(J,{enableFluentV9Avatar:!!i,simpleAvatarType:e,...n}):(0,a.t)(L,{...n})})),L=({accessibilityLabel:e,alt:n,presenceUserId:i,profilePictureType:a,presenceSource:r,isPresencePrefetched:o,isEmergencyCallTarget:l,shouldAllowContextMenu:s,isFocusable:d,hexagonal:c,square:u,userId:g,personaType:N,hostConversationId:f,isDoubleClickDisabled:T,narrateProfilePicture:M,callerInfo:y,statusSize:I,isSharedChannel:b,isXtapUserUrl:E,draggable:w,isTeamHeaderEmblemExpanded:L,hidePersonaCard:x,v9ClassName:O,role:j,avatarUrl:_,cacheKey:J,isGroupChatAvatarPresetOrEmojiPicture:H=!1,...q})=>{const X=(0,p.w)("AvatarRenderer"),{isOnline:K}=(0,k.cJ)(),{themeType:$}=(0,D.LV)(),{msgEnableSelfChat:ee}=(0,h.NC)(v.J.Host,["msgEnableSelfChat"]),[ne,ie]=t.useState(!1),[ae,te]=t.useState(_),[re,oe]=t.useState(!1),{entityCommanding:le,user:se,scenarioFactory:de,avatarImageCache:ce}=(0,k.SE)(),{allowUserChat:me,enableChatActionFromAvatar:ue}=(0,h.NC)(v.J.Messaging,["allowUserChat","enableChatActionFromAvatar"]),{enableShowPresenceInCriticalPhase:pe}=(0,h.NC)(v.J.Presence,["enableShowPresenceInCriticalPhase"]),ke=R(M,e),{enableFluentV9Avatar:ge,enableFailedAvatarReloadOnNetworkReconnect:Ne,enableFBSTelemetryForAvatarStatus:fe}=(0,h.NC)(v.J.People,["enableFluentV9Avatar","enableFailedAvatarReloadOnNetworkReconnect","enableFBSTelemetryForAvatarStatus"]),he=t.useCallback((e=>{ie(e.isError),te(e.currentUrl),oe(e.shouldReload)}),[]),ve=t.useRef(null),Te=U(),Me=(()=>{const{host:e}=(0,k.SE)(),{avatarDoubleClickDelayInMs:n}=(0,h.NC)(v.J.People,["avatarDoubleClickDelayInMs"]),i=t.useRef(null),a=n||0,r=e=>{o(),null!==e&&null!==e.current&&e.current.dispatchEvent(new MouseEvent("click",{bubbles:!0}))},o=()=>{i.current&&e.clearTimeout(i.current),i.current=null};return t.useEffect((()=>()=>{i.current&&(e.clearTimeout(i.current),i.current=null)}),[e,i]),(n,t,l,s)=>{a>0&&!l?(n.preventDefault(),n.stopPropagation(),i.current?o():i.current=e.setTimeout((()=>{r(t),s&&s(n)}),a)):s&&s(n)}})(),ye=C(),Se=(0,A.z)((a===m.tS.Team||u)&&ye.teamAvatarBorder,$===F.f8.Contrast&&ye.teamHighContrastAvatarBorder,O),Ae=G(!!Ne,ne,K,re,_,a,l),Ie=W(a,d,u),be={...q.variables,...Ie},Ce={callerInfo:y||"Not available",profilePictureType:a,imageUrl:Ae,isEmergencyCallTarget:l,logger:X,scenarioFactory:de,avatarState:{currentUrl:ae,isError:ne,shouldReload:re},isOnline:K,setAvatarState:he,sharedChannelTelemetryInfo:{isSharedChannel:b,isXtapUserUrl:E}},De=ge?void 0:P(i,r,o,I),{onClick:Fe,onKeyDown:Ue,onMouseEnter:Ee,onMouseLeave:we}=(0,S.z)({userId:g,personaType:N,hostConversationId:f}),Le=!!c,xe={...V(!!d,Ae,n,w,e,H?Te.groupChatAvatarObjectFit:Te.avatarObjectFit),onError:e=>{Y(Ce,!!fe)},onLoad:e=>{(e=>{try{const n=new URL(e);if("https:"!==n.protocol)return!1;const i=n.searchParams.get("size");if(null!==i&&i!==m.$D.Small)return!1}catch(e){return!1}return!0})(Ae)&&ce?.add(J||Ae,Ae),Z(Ce)},onContextMenu:e=>B(e,s),onDoubleClick:e=>{Q(T,me,ue,g,a,se,le,ee),e.stopPropagation()},onClickCapture:e=>Me(e,ve,T,Fe),...!x&&!Le&&{onKeyDown:Ue,onMouseEnter:Ee,onMouseLeave:we}},Oe={root:{isTeamHeaderEmblemExpanded:L},image:{...ke,...xe,variables:be},status:De?{...De,variables:be}:De,...q},je=Oe["data-tid"],Ve=ke["aria-label"];return z(i,r,Oe,xe,ve,Se,Ie,c,!!ge,je,j,!!d,Ve,!!pe)},x=e=>{if(!(0,E.WD)(g.nh.POST_CRITICAL)||!e.presenceUserId)return(0,a.t)(O,{...e,isFocusable:!1});const{hexagonal:n,presenceUserId:i,presenceSource:t,avatarRef:r,commonImgAttributes:o,role:l,isFocusable:s,v9AllStyles:d,dataTid:c,ariaLabel:m,size:u}=e;return(0,a.t)(j,{hexagonal:!!n,presenceUserId:i,presenceSource:t||"ups",avatarRef:r,commonImgAttributes:{...o,role:l||(s?"img":"presentation")},v9AllStyles:d,dataTid:c,ariaLabel:m,size:u})},O=({hexagonal:e,dataTid:n,v9AllStyles:i,commonImgAttributes:t,size:r,isFocusable:o,role:l,avatarRef:s})=>e?(0,a.t)(u.Z,{commonImgAttributes:t,className:i,size:(0,y.LA)(r)}):(0,a.t)(I.q,{"data-tid":n,image:{...t},ref:s,className:i,size:(0,y.LA)(r),role:l||(o?"img":"presentation")}),j=({hexagonal:e,presenceUserId:n,presenceSource:i,avatarRef:t,commonImgAttributes:r,v9AllStyles:o,dataTid:l,size:s,ariaLabel:d,role:m})=>{const p=(0,c.bE)(n,i);return e?(0,a.t)(u.Z,{"aria-label":d,badgeProps:p,commonImgAttributes:r,className:o,size:(0,y.LA)(s)}):(0,a.t)(I.q,{"aria-hidden":!0,"aria-label":d,badge:p,"data-tid":l,image:{...r},ref:t,className:o,size:(0,y.LA)(s),role:m})},V=(e,n,i,a,t,r)=>({alt:i,src:n,draggable:a,...e&&{"data-is-focusable":!0,"aria-haspopup":!0,"aria-hidden":!1,"aria-label":t,tabIndex:0},className:r}),z=(e,n,i,t,r,o,l,d,c,m,p,k,g,N)=>{const f=d?u.Z:s.q;return c?e&&N?(0,a.t)(j,{hexagonal:!!d,presenceUserId:e,presenceSource:n||"ups",avatarRef:r,commonImgAttributes:{...t,role:p||(k?"img":"presentation")},v9AllStyles:o,dataTid:m,ariaLabel:g,size:i?.size}):(0,a.t)(x,{hexagonal:!!d,presenceUserId:e,presenceSource:n||"ups",commonImgAttributes:t,v9AllStyles:o,size:i?.size,avatarRef:r,role:p??"presentation",isFocusable:k,dataTid:m}):(0,a.t)(f,{...i,variables:{...i?.variables,...l},ref:r})},P=(e,n,i,t)=>e?{children:(r,o)=>{const l=t?{size:t}:{};return(0,a.t)(c.Rq,{userId:e,ProvidedStatus:r,presenceSource:n,isPresencePrefetched:i,...o,...l})}}:void 0,R=(e,n)=>{const i={};return"boolean"==typeof e&&(i["aria-hidden"]=!e),n&&(i["aria-label"]=n),i},B=(e,n)=>{n||(e.preventDefault(),e.stopPropagation())},Q=async(e,n,i,a,t,r,o,l)=>{!e&&n&&i&&a&&!(0,M.y)(a)&&t===m.tS.User&&(l||r?.id!==a)&&await o.chat.chatWithUsers({userIds:[a],entityCommand:{stateTransition:N.su.new,visibilityState:N.fe.show,correlation:{source:f.D.Avatar}}})},W=(e,n,i)=>({...(e===m.tS.Team||i)&&{isTeamProfilePicture:!0},...n&&{hasCursorPointer:!0}}),Z=e=>{e.avatarState.isError?e.isOnline&&e.avatarState.shouldReload?e.setAvatarState({...e.avatarState,isError:!1,shouldReload:!1}):e.logger.debug("Avatar onLoad. Returning without triggering state change."):e.setAvatarState({...e.avatarState,isError:!1})},Y=(e,n)=>{const i=n?e.scenarioFactory.newScenario(T.RG.AvatarStatus):void 0,a={caller:e.callerInfo,numericType:e.profilePictureType,sharedChannelTelemetryInfo:e.sharedChannelTelemetryInfo};return e.avatarState.isError?(e.avatarState.shouldReload?e.setAvatarState({currentUrl:(0,y.WJ)(e.profilePictureType,e.isEmergencyCallTarget),isError:!0,shouldReload:!1}):e.logger.debug("Avatar onError. Returning without triggering state change"),i?.stop(a,"failure"),!1):(e.logger.warn("Avatar load failed. Handling onError by setting currentUrl in state to default image."),_(e.imageUrl)?i?.cancel(a):i?.stop(a,"failure"),e.setAvatarState({currentUrl:"",isError:!0,shouldReload:!e.isOnline}),!1)},G=(e,n,i,a,t,r,o)=>{let l=t;if(n&&(!e||!i||!a)){l=(0,y.WJ)(r,o)}return l},_=e=>{const n=(e=>{const n=new URLSearchParams(e.slice(e.indexOf("?")));return n.get("displayName")||n.get("displayname")||""})(e);return/^[^\p{Letter}]/u.test(n)},J=({simpleAvatarType:e,enableFluentV9Avatar:n,...i})=>{if(n)return(0,a.t)(I.q,{className:i.v9ClassName,size:(0,y.LA)(i.size),...i.label&&{initials:{children:(0,a.t)(t.Fragment,{children:i.label})}},...i.v9Icon&&{icon:i.v9Icon},...i.name&&{name:i.name},...i.avatarUrl&&{image:{src:i.avatarUrl}}});{const{variables:e}=i;return(0,a.t)(s.q,{variables:e,size:i.size,...i.label&&{label:{children:(0,a.t)(t.Fragment,{children:i.label})}},...i.icon&&{icon:i.icon},...i.name&&{name:i.name},...i.avatarUrl&&{image:{src:i.avatarUrl}}})}};var H=i(803238),q=i(649883),X=i(922790);const K={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"msaProfileAvatarChangedEvent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"isSelfProfileAvatar"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"msaProfileAvatarChangedEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"isSelfProfileAvatar"},value:{kind:"Variable",name:{kind:"Name",value:"isSelfProfileAvatar"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"updateType"}},{kind:"Field",name:{kind:"Name",value:"updatedTime"}}]}}]}}]};var $=i(332534),ee=i(507078),ne=i(907203),ie=i(237867);var ae=i(42395),te=i(449473),re=i(628918);const oe=[m.tS.User,m.tS.Group,m.tS.Team],le=(e,n=m.$D.Small,i,a,t,r,o,l)=>{const{avatarImageCache:s,coreSettings:d}=(0,k.SE)(),{enableAvatarUrlCacheLookup:c}=(0,h.NC)(v.J.ImageCache,["enableAvatarUrlCacheLookup"]);if(!c||!s||l)return null;const u=(0,y.HA)(i,a,t,r,o||!1,void 0,void 0,void 0,e,d);if(!oe.includes(u))return null;const p=[n];if((e=>"id"in e&&!!e.id)(e))p.push("user"),p.push(e.id),p.push(e.displayName),p.push(e.imageUri);else if((e=>Array.isArray(e))(e)&&e.length>1)p.push("group"),p.push(e.map((e=>`${e.id}-${e.displayName}`)).slice(0,re.Ww).join("-"));else{if(!(e=>"groupId"in e&&!!e.groupId)(e))return null;p.push("team"),p.push(e.groupId),p.push(e.displayName),p.push(e.pictureETag)}const g=p.filter(Boolean).join("-"),N=s?.getUrl(g);return{cacheKey:g,cachedUrl:N}},se=({simpleAvatarType:e,avatarUrl:n,...i})=>e?(0,a.t)(w,{simpleAvatarType:e,avatarUrl:n||"",profilePictureType:m.tS.Simple,...i}):(0,a.t)(de,{avatarUrl:n,...i}),de=({users:e,team:n,showPresence:i,hidePersonaCard:a,isFocusable:t,profilePictureSize:r,isEmergencyCallTarget:o,shouldAllowContextMenu:l,isDoubleClickDisabled:s,showDefaultAvatar:d,conversationId:c,hostTenantId:m,isSharedChannel:u,statusSize:g,connectorSenderGuid:N,onBehalfOfId:f,square:T,requesterObjectId:S,baseImageUrl:A,skipAvatarQuery:I,showMergedAvatarForGroup:b,showUpdatedGroupAvatar:C,role:D,avatarUrl:F,...U})=>{const E=(0,p.w)("AvataContainer"),w=((e,n)=>{if(!e&&n&&1===n.length&&n[0].id){const e=n[0].id;return e!==te.xw&&e!==te.HE}return!1})(n,e),L=w&&e?e[0].id:void 0,x=(e=>{const n=(0,p.w)("AvatarContainer"),i=(0,$.dL)(),a=(0,ee.ii)(),t=(0,ee.x2)(),r=(0,ie.x)(),{user:o,authenticationUser:l,scenarioFactory:s}=(0,k.SE)(),{customViewBots:d}=(0,h.NC)(v.J.Calling,["customViewBots"]),c=!!(d&&d.length>0),m=o?.id===e,u=l?.type===ne.Ch.Anonymous,g=l?.type===ne.Ch.Msa||l?.type===ne.Ch.MsaLife,N=l?.id,{enableMSAProfilePicture:f,enableMsaSelfProfileAvatarUpdateSubscription:T,enableCachedAvatarCheck:M,enableProfilePicturesWithObjectId:y,enableSampleAvatarFetch:S,enableAvatarUrlQuery:A,enableFBSTelemetryForAvatarStatus:I,enableCacheCheckOnAvatarUrlFromCaller:b}=(0,h.NC)(v.J.People,["enableMSAProfilePicture","enableMsaSelfProfileAvatarUpdateSubscription","enableCachedAvatarCheck","enableProfilePicturesWithObjectId","enableSampleAvatarFetch","enableAvatarUrlQuery","enableFBSTelemetryForAvatarStatus","enableCacheCheckOnAvatarUrlFromCaller"]),{enableConnectorsProfileInChannels:C}=(0,h.NC)(v.J.Extensibility,["enableConnectorsProfileInChannels"]);return{baseImageUrl:a||"",canSubscribeForAvatarUpdate:m&&!!T,client:r,customViewBots:d||[],enableCachedAvatarCheck:!!M,enableConnectorsProfileInChannels:!!C,enableMSAProfilePicture:!!f,enableMsaSelfProfileAvatarUpdateSubscription:!!T,enableFBSTelemetryForAvatarStatus:!!I,i18n:i,isAnonymousAccount:u,isCustomViewBots:c,isImageAuthCookieValid:t,isSelfProfileAvatar:m,isTflUser:g,logger:n,user:o,scenarioFactory:s,currentUserOid:N,isProfilePictureWithObjectIdEnabled:!!y,enableSampleAvatarFetch:!!S,enableAvatarUrlQuery:!!A,enableCacheCheckOnAvatarUrlFromCaller:!!b}})(L),{user:O}=x,j=(e=>{const n=(0,p.w)("MsaProfileAvatarSubscription"),{data:i,loading:a,error:t}=(0,X.m)(K,{skip:!e,variables:{isSelfProfileAvatar:e}});return(t||!a&&!i&&e)&&n.error("msa profile avatar subscription failed"),i?.msaProfileAvatarChangedEvent})(!!x.canSubscribeForAvatarUpdate),V=(0,y.sq)(j,O,L),z=ce(w,n,e),P=(0,y.NO)(n,w);x.currentUserOid=S||x.currentUserOid,x.baseImageUrl=A||x.baseImageUrl;const R=(0,q.tw)(F||e?.[0]?.avatarUrl,r,w&&(0,M.lp)(L),!n&&!w&&!!c,x.enableCacheCheckOnAvatarUrlFromCaller,x.isImageAuthCookieValid),B=n?.groupId||n?.teamThreadId,{cacheKey:Q,cachedUrl:W}=le(z,r,L,c,B,x.enableMSAProfilePicture,b,x.isSelfProfileAvatar)||{};I&&E.log(`Generating URL via hook is skipped for caller: ${U.callerInfo}`);const Z={userId:L,conversationId:c,teamId:B,entity:z,profilePictureSize:r,isEmergencyCallTarget:o,generator:P,isSharedChannel:u,hostTenantId:m,avatarEtag:V,showMergedAvatarForGroup:b,showUpdatedGroupAvatar:C,onBehalfOfId:f,skipAvatarQuery:I||!!R||!!W,...x},Y=(0,q.Ou)(Z,U.callerInfo),{customViewBots:G,isCustomViewBots:_}=x,J=_?G[0]:{},H=!!L&&(0,y.Gt)(w,L,i)?P.getPresenceUserId(z):void 0,ae=ue(w,e);return me({accessibilityLabel:U.accessibilityLabel,generator:P,hidePersonaCard:a,isEmergencyCallTarget:o,isFocusable:t,presenceUserId:H,role:D,shouldAllowContextMenu:l,userId:L,customViewBotIds:J,isDoubleClickDisabled:s,statusSize:g,conversationId:c,hostTenantId:m,isSharedChannel:u,avatarUrl:R||W||Y,draggable:!1,isTflUser:x.isTflUser,connectorSenderGuid:N,onBehalfOfId:f,displayName:ae,square:T,isBotAvatar:(0,y.oG)(w?e?.[0]:void 0),cacheKey:Q,...U})},ce=(e,n,i)=>n||(i?e?i[0]:i:[]),me=({accessibilityLabel:e,avatarUrl:n,generator:i,hidePersonaCard:c,isEmergencyCallTarget:m,isFocusable:u,presenceUserId:p,role:k,shouldAllowContextMenu:g,userId:N,customViewBotIds:f,isDoubleClickDisabled:T,statusSize:M,isSharedChannel:S,conversationId:A,hostTenantId:I,draggable:b,isTflUser:C,connectorSenderGuid:D,onBehalfOfId:F,displayName:U,isBotAvatar:E,square:L,cacheKey:x,...O})=>{const{vars:j}=(0,l.L)(),V=Array.isArray(O.variables)?O.variables:[],z=t.useMemo((()=>(0,r.v4)()),[]),{enableEntityMoreInfo:P}=(0,h.NC)(v.J.Core,["enableEntityMoreInfo"]),R=(0,y.AZ)(n);if(O.isMeetingChat)return(0,a.t)(s.q,{icon:(0,a.t)(d.Q,{circular:!0,outline:!0}),variables:j("search",(0,H.merge)(["meetingChatAvatar"],V))});const B=(0,a.t)(w,{accessibilityLabel:e,presenceUserId:p,profilePictureType:i.profilePictureType,role:k||(u?"button":"presentation"),shouldAllowContextMenu:g,isEmergencyCallTarget:m,isFocusable:u,hexagonal:!L&&E&&!(0,y.sB)(N,f),square:L,userId:N,isDoubleClickDisabled:E&&C||T,statusSize:M,avatarUrl:n,draggable:b,isSharedChannel:S,isXtapUserUrl:R,hidePersonaCard:c,cacheKey:x,...O}),Q=c||P||!N?B:(0,a.t)(ae.Im,{userId:N,isSharedChannel:S,hostConversationId:A,hostTenantId:I,disableAccessibilityDefaults:!0,externalAppSessionCorrelationId:z,displayName:U,callerInfo:O.callerInfo,"data-tid":"avatar",children:B},N);return c||!N||!(0,y.B4)(N)&&E?!c&&N&&E?(0,a.t)(o.W_,{botIdOrAppId:N,connectorSenderGuid:D,conversationId:A,onBehalfOfId:F,displayName:U,renderTriggerAsLink:!1,nonFocusableTrigger:!0,children:B},N):B:Q},ue=(e,n)=>e&&n?.[0]?.displayName?n[0]?.displayName:void 0},332305:(e,n,i)=>{"use strict";i.d(n,{ku:()=>a,LZ:()=>v,WG:()=>y});var a,t=i(818319),r=i(629494),o=i(683184),l=i(668587),s=i(681971),d=i(994575),c=i(185273),m=i(400966),u=i(469483),p=i(309501),k=i(803238),g=i(745780),N=i(316877),f=i(262723),h=i(543491);!function(e){e.InitialConfig="config",e.ReConfig="reconfig"}(a||(a={}));const v=(e,n)=>{if(e.bots?.[0]?.configuration){if(n===g.qi.Team)return T(e)?e.bots[0].configuration.team:null;if(n===g.qi.GroupChat)return M(e)?e.bots[0].configuration.groupChat:null}return null},T=e=>null!==e.bots?.[0]?.configuration?.team?.fetchTask,M=e=>null!==e.bots?.[0]?.configuration?.groupChat?.fetchTask,y=()=>{const{enableBotConfiguration:e}=(0,r.NC)(o.J.Extensibility,["enableBotConfiguration"]),{scenarioFactory:n}=(0,s.SE)(),i=(0,d.w)("BotConfigLauncher"),a=t.useContext(c.I18nContext),{entityCommanding:l}=(0,s.SE)(),m=(0,f.b)();return t.useCallback(((t,r,o,s)=>{const d=n.newScenario(h.RG.ExtBotConfig),c=v(o,r);c&&e&&(d.appendEventData({configEntryPoint:s}),S(o,c,t,a,i,l,r,m,d))}),[e,i,l,m,a,n])},S=async(e,n,i,a,t,r,o,l,s)=>{const d=A(e,i,a,n);if(n&&d)try{const n=(0,N.v4)();r.platform.launchTaskModule(n,{taskModuleOptions:{input:d,launchContext:o===g.qi.GroupChat?{type:m.p.chat,parentMessageId:l.replyChainId,...l,chatId:i,launchId:n}:{type:m.p.channel,channelId:l.channelId,parentMessageId:l.replyChainId,teamId:i,launchId:n}}}).subscribe({complete:()=>{t.log(`task module complete for entrypoint ${d.entryPoint}`),s.stop({"App.Id":e.id,"Bot.Id":e.bots?.[0].id})},error:n=>{const i=`error launching task module for entry point ${d.entryPoint}. errorCode: ${n.ErrorCode}, errorName: ${n.name}, innerErrorCode: ${n.innerError?.code}`;t.error(`${i} Error:`,n),s.fail({"App.Id":e.id,"Bot.Id":e.bots?.[0].id,errors:i})}})}catch(n){t.log("error","Error while launching task module",n),s.fail({"App.Id":e.id,"Bot.Id":e.bots?.[0].id,errors:"Error in launching task module with bot config entry point"})}},A=(e,n,i,a)=>({appName:e.name||"",appIcon:e.largeImageUrl||"",appId:e.id,isFullScreenApp:e.isFullScreenApp||!1,isFullTrustApp:e.isFullTrustApp||!1,validDomains:e.validDomains||[],tenantId:e.tenantId||"",entryPoint:u.gV.BotConfig,botInvokeParams:{threadId:n,botMri:(0,k.first)(e.bots)?.id?`${p.at.BotPrefix}${(0,k.first)(e.bots)?.id}`:""},fetchTask:a.fetchTask||!1,taskInfo:(0,l.Un)(i,a.taskInfo)??{},isMicrosoftOwned:e.isMicrosoftOwned||!1,externalId:e.externalId||""})},575110:(e,n,i)=>{"use strict";i.d(n,{py:()=>g,Zk:()=>k});var a=i(250033),t=i(818319),r=i(861316),o=i(863495),l=i(237867),s=i(67081),d=i(839779);const c={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"call"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"call"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingFields"}}]}}]}},...i(455146).f.definitions]};var m=i(353513),u=i(803238);const[p,k]=(0,r.j)("CallDataProviderContext"),g=e=>{const n=(0,l.x)(),{teamsCallId:i,children:r}=e,[k,g]=t.useMemo((()=>i?((e,n)=>{const i=new d.X(n),a=e.subscribe(i);return[i,()=>a.unsubscribe()]})(n.watchQuery({query:c,variables:{id:i}}),(()=>{const e=(0,m.P)(i,n);return e?{loading:!1,error:void 0,networkStatus:o.I.ready,data:{call:e}}:{loading:!0,error:void 0,networkStatus:o.I.ready,data:{call:null}}})()):[new s.y((e=>e.complete())),u.noop]),[n,i]);return t.useEffect((()=>()=>g()),[g]),(0,a.t)(p,{source$:k,children:r})}},29635:(e,n,i)=>{"use strict";i.d(n,{W:()=>p});var a=i(818319),t=i(575110),r=i(59083),o=i(242111),l=i(803238),s=i(629494),d=i(683184),c=i(194175),m=i(5466),u=i(445217);function p(e,n){const i=(0,u.Q)(e),p=a.useCallback((({loading:e,errors:n,data:a})=>({loading:e,error:n&&n.length>0&&new c.c({graphQLErrors:n})||void 0,data:a?.call&&{call:(0,l.pick)(a.call,i)}||void 0})),[i]),k=a.useCallback((e=>e.pipe((0,r.U)(p),(0,o.x)(((e,n)=>e.loading===n.loading&&(0,l.isEqual)(e.data?.call,n.data?.call)&&(0,m.V)(e.error,n.error))))),[p]),{doNotRestartObservableOnErrors:g}=(0,s.NC)(d.J.Calling,["doNotRestartObservableOnErrors"]),[N]=(0,t.Zk)(k,n,p,!g&&void 0);return!N&&n?{data:void 0,loading:!1,error:void 0}:N??{data:void 0,loading:!0,error:void 0}}},317649:(e,n,i)=>{"use strict";i.d(n,{E:()=>r,n:()=>l});var a=i(250033),t=i(818319);const r=({channelData:e,children:n,isLoadingData:i})=>{const r=t.useMemo((()=>({channelType:e?.channelType,displayName:e?.displayName,id:e?.id,createdAt:e?.createdAt,description:e?.description,isGeneral:e?.isGeneral,isArchived:e?.isArchived,isDeleted:e?.isDeleted,isUserMember:e?.isUserMember,isUserMuted:e?.isUserMuted,isChannelExternallyShared:e?.isChannelExternallyShared,isLie:e?.isLie,realThreadId:e?.realThreadId,parentTeamId:e?.parentTeamId,isSharedWithParentTeam:e?.isSharedWithParentTeam,isCreationFailed:e?.isCreationFailed,substrateGroupId:e?.substrateGroupId,hostTeamId:e?.hostTeamId,hostTenantId:e?.hostTenantId,hostTeamGroupId:e?.hostTeamGroupId,memberRole:e?.memberRole,membershipSummary:e?.membershipSummary,sensitivityLabel:e?.sensitivityLabel,owningTeam:e?.owningTeam,sharepointSiteUrl:e?.sharepointSiteUrl,spaceAdminSettings:e?.spaceAdminSettings,moderation:e?.moderation,isSubCommunity:!(!e?.hostTeamId||!e?.id)&&e.hostTeamId!==e.id,ifConvUxChannel:e?.ifConvUxChannel})),[e?.channelType,e?.displayName,e?.id,e?.createdAt,e?.description,e?.isGeneral,e?.isArchived,e?.isDeleted,e?.isUserMember,e?.isUserMuted,e?.isChannelExternallyShared,e?.isLie,e?.realThreadId,e?.parentTeamId,e?.isSharedWithParentTeam,e?.isCreationFailed,e?.substrateGroupId,e?.hostTeamId,e?.hostTenantId,e?.hostTeamGroupId,e?.memberRole,e?.membershipSummary,e?.sensitivityLabel,e?.owningTeam,e?.sharepointSiteUrl,e?.spaceAdminSettings,e?.moderation,e?.ifConvUxChannel]);return(0,a.t)(o.Provider,{value:i?void 0:r,children:n})},o=t.createContext(void 0),l=()=>t.useContext(o)},470453:(e,n,i)=>{"use strict";i.d(n,{WD:()=>k,HH:()=>g,FH:()=>N,Jb:()=>f,gr:()=>h,Du:()=>v});var a=i(250033),t=i(818319),r=i(59083),o=i(242111),l=i(848476),s=i(252278);const{useCallback:d,useEffect:c,useMemo:m,useRef:u,useState:p}=t,k=e=>{const{layoutPhaseStateMachineRef:n}=(0,s.hc)(),i=n.current,a=u(i),[t,d]=p(i.currentPhase>=e),k=m((()=>a.current.currentPhaseObservable.pipe((0,r.U)((n=>n>=e)),(0,o.x)())),[e,a]),g=(0,l.m)(k,{next:t?()=>t:d},!0);return c((()=>()=>g()),[g]),t&&g(),a.current===i||t?t||a.current.currentPhase>=e||i.currentPhase>=e:(d(!0),!0)},g=e=>{const{layoutPhaseStateMachineRef:n}=(0,s.hc)();return d((()=>n.current.currentPhase>=e),[n,e])},N=()=>{const{reportFirstPaintCallbackRef:e}=(0,s.hc)();e.current()},f=({component:e,fallback:n,minimumAppPhase:i})=>t=>k(i)?(0,a.t)(e,{...t}):n?(0,a.t)(n,{}):null,h=()=>{const{useAppPhasePostCriticalOnEveryPhaseCycle:e}=(0,s.hc)();return e()},v=()=>{const{useAppPhaseCompleteOnEveryPhaseCycle:e}=(0,s.hc)();return e()}},649641:(e,n,i)=>{"use strict";i.d(n,{E:()=>s,i:()=>d});var a=i(250033),t=i(803238),r=i(818319),o=i(445217);const l=r.createContext(void 0),s=e=>{const{children:n,...i}=e,r={...i,context:{hostCommunicationService:i.hostCommunicationService}};return(0,a.t)(l.Provider,{value:(0,o.Q)(r,t.isEqual),children:n})},d=()=>r.useContext(l)},33549:(e,n,i)=>{"use strict";i.d(n,{cX:()=>c,pl:()=>m});var a=i(250033),t=i(818319),r=i(445217);const{createContext:o,memo:l,useContext:s}=t,d=o({UNSAFE_overflowAndFlipBoundaryRef:null});d.displayName="UNSAFE_OverflowAndFlipBoundaryContext";const c=l((e=>{const{children:n,...i}=e;return(0,a.t)(d.Provider,{value:(0,r.Q)(i),children:n})}));c.displayName="UNSAFE_OverflowAndFlipBoundaryContextProvider";const m=()=>s(d)},252278:(e,n,i)=>{"use strict";i.d(n,{jH:()=>c,hc:()=>m});var a=i(250033),t=i(818319),r=i(445217);const{createContext:o,memo:l,useContext:s}=t,d=o(void 0),c=l((({children:e,...n})=>(0,a.t)(d.Provider,{value:(0,r.Q)(n),children:e}))),m=()=>s(d)},379263:(e,n,i)=>{"use strict";i.d(n,{Ih:()=>d,sV:()=>c,f8:()=>m,Sx:()=>u});var a=i(250033),t=i(803238),r=i(818319),o=i(445217);const{memo:l}=r,s=r.createContext(void 0),d=l((({children:e,commandReportingCallbacks:n,doesChildViewEntityMatch:i=(()=>!1),UNSAFE_doesMainViewEntityMatch:r=(()=>!1),...l})=>(0,a.t)(s.Provider,{value:(0,o.Q)({...l,...n,doesChildViewEntityMatch:i,UNSAFE_doesMainViewEntityMatch:r},t.isEqual),children:e}))),c=(s.Consumer,()=>r.useContext(s)),m=()=>{const{appId:e}=r.useContext(s);return e},u=e=>function(n){const i=c();return(0,a.t)(e,{...{...n,viewContext:i}})}},435191:(e,n,i)=>{"use strict";i.d(n,{_r:()=>o,LV:()=>l});var a=i(250033),t=i(818319);const r=t.createContext({}),o=t.memo((({children:e,setCoreThemeType:n,themeType:i,themeOptions:o})=>{const l=t.useMemo((()=>({setCoreThemeType:n,themeType:i,themeOptions:o})),[n,i,o]);return(0,a.t)(r.Provider,{value:l,children:e})})),l=()=>t.useContext(r)},749321:(e,n,i)=>{"use strict";i.d(n,{Fh:()=>s,y3:()=>k,_o:()=>g,I6:()=>m,Jd:()=>v,sb:()=>h,rt:()=>p,t:()=>u});var a=i(316877),t=i(993737),r=i(683184),o=i(839413);const l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsCortexTopicsSdkAuthenticationAcquireTokenQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"acquireTokenOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"AcquireTokenOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationToken"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resource"},value:{kind:"Variable",name:{kind:"Name",value:"resource"}}},{kind:"Argument",name:{kind:"Name",value:"acquireTokenOptions"},value:{kind:"Variable",name:{kind:"Name",value:"acquireTokenOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"token"}}]}}]}}]},s="https://substrate.office.com",d=new Map,c=6e4;function m(e){return(0,t.I6)(e)}async function u(e,n,i,a,t){const r=m(i);return r?(await g(n,i,a,r),e(r)):t?t():void 0}function p(e,n,i,a,t){const r=m(i);return r?(g(n,i,a,r),e(r)):t?t():void 0}function k(e,n){const i=(0,a.v4)();return async(a,t)=>{const r=f(e,n);if(d.has(r)){const e=d.get(r);e?.token&&a(e.token,i)}else t("No token in Reference",i)}}async function g(e,n,i,a){const{enableSilentLokiAuthTokenRetrieval:t,lokiTokenResourceUrl:l}=i.get(r.J.People),{enableCallKMApiDirectly:d}=i.get(r.J.Messaging),c=N(e,n,l||o.s$,t,a),m=d?N(e,n,s,t,a):Promise.resolve();return Promise.all([c,m]).then((()=>{}))}async function N(e,n,i,a,t){let r;const o={resourceUrl:i};t||(t=m(n));const s=d.get(f(i,n));if(s){if(Date.now()-s.lastRefreshTime<c)return}t&&(r=t.createQosEvent("Cortex.TopicAnnotations.RenewToken.Execute"));try{let t;if(e){const{data:s}=await e.query({query:l,variables:{resource:i,acquireTokenOptions:{silent:a}},fetchPolicy:"network-only"});t={token:s?.authenticationToken?.token,lastRefreshTime:Date.now()},t.token?(d.set(f(i,n),{token:t.token,lastRefreshTime:t.lastRefreshTime}),r?.logSuccess(o)):r?.logUnexpectedFailure("NoTokenReceived",void 0,o)}else r?.logUnexpectedFailure("NoApolloClient",void 0,o)}catch(e){r?.logUnexpectedFailure("ErrorThrowRetrievingToken",e,o)}}function f(e,n){return`${e}_${n.userAadObjectId??""}_${n.tenantAadObjectId??""}`}function h(e,n,i,a){const{enableCortexTopicsAuthRefactor:t}=i.get(r.J.Messaging),o=m(n);return t&&a?p(e,a,n,i):o?e(o):void 0}async function v(e,n,i,a){const{enableCortexTopicsAuthRefactor:t}=i.get(r.J.Messaging),o=m(n);return t&&a?u(e,a,n,i):o?e(o):void 0}},438587:(e,n,i)=>{"use strict";i.d(n,{z:()=>m,F7:()=>u,p6:()=>p});var a=i(818319),t=i(629494),r=i(683184),o=i(158425),l=i(883282),s=i(114926);const{useCallback:d,useMemo:c}=a,m=({userId:e,displayName:n,personaType:i,hostConversationId:a,ariaLabel:m,tabIndex:u})=>{const{enableEntityMoreInfo:p}=(0,t.NC)(r.J.Core,["enableEntityMoreInfo"]),k=(0,l.useNovaEventing)(),g=d(((e,{userId:n,ariaLabel:i,tabIndex:a,displayName:t,personaType:r,hostConversationId:l})=>{if(n){const{left:s,top:d,width:c,height:m}=e.target.getBoundingClientRect();k.bubble({event:o.U3.requestPersonMoreInfo({eventType:e.type,height:m,left:s,top:d,width:c,userId:n,displayName:t,personaType:r,hostConversationId:l,ariaLabel:i,tabIndex:a}),reactEvent:e})}}),[k]),N=d((t=>{p&&g(t,{userId:e,ariaLabel:m,tabIndex:u,displayName:n,personaType:i,hostConversationId:a})}),[p,g,e,m,u,n,i,a]),f=(0,s.K)(N,500),h=d((t=>{f.cancel(),p&&g(t,{userId:e,ariaLabel:m,tabIndex:u,displayName:n,personaType:i,hostConversationId:a})}),[p,f,g,e,m,u,n,i,a]),v=d((i=>{!p||"Enter"!==i.key&&" "!==i.key||g(i,{userId:e,ariaLabel:m,tabIndex:u,displayName:n})}),[p,g,e,m,u,n]),T=d((e=>{f.cancel()}),[f]);return c((()=>({onClick:h,onKeyDown:v,onMouseEnter:f,onMouseLeave:T})),[h,v,f,T])},u=({userId:e,displayName:n,ariaLabel:i,tabIndex:a})=>{const{enableEntityMoreInfo:s}=(0,t.NC)(r.J.Core,["enableEntityMoreInfo"]),m=(0,l.useNovaEventing)(),u=d(((e,{userId:n,ariaLabel:i,tabIndex:a,displayName:t})=>{if(n){const{left:r,top:l,width:s,height:d}=e.target.getBoundingClientRect();m.bubble({event:o.U3.requestPersonMoreOrgInfo({eventType:e.type,height:d,left:r,top:l,width:s,userId:n,displayName:t,ariaLabel:i,tabIndex:a}),reactEvent:e})}}),[m]),p=d((t=>{s&&u(t,{userId:e,ariaLabel:i,tabIndex:a,displayName:n})}),[s,u,e,i,a,n]),k=d((t=>{!s||"Enter"!==t.key&&" "!==t.key||u(t,{userId:e,ariaLabel:i,tabIndex:a,displayName:n})}),[s,u,e,i,a,n]);return c((()=>({onClick:p,onKeyDown:k})),[p,k])},p=({userId:e,ariaLabel:n,tabIndex:i,topicId:a})=>{const{enableEntityMoreInfo:s}=(0,t.NC)(r.J.Core,["enableEntityMoreInfo"]),m=(0,l.useNovaEventing)(),u=d(((e,{userId:n,ariaLabel:i,tabIndex:a,topicId:t})=>{if(n){const{left:r,top:l,width:s,height:d}=e.target.getBoundingClientRect();m.bubble({event:o.U3.requestTopicMoreInfo({eventType:e.type,height:d,left:r,top:l,width:s,userId:n,ariaLabel:i,tabIndex:a,topicId:t}),reactEvent:e})}}),[m]),p=d((t=>s?u(t,{userId:e,ariaLabel:n,tabIndex:i,topicId:a}):void 0),[s,u,e,n,i,a]),k=d((t=>{!s||"Enter"!==t.key&&" "!==t.key||u(t,{userId:e,ariaLabel:n,tabIndex:i,topicId:a})}),[s,u,e,n,i,a]),g=d((t=>s?u(t,{userId:e,ariaLabel:n,tabIndex:i,topicId:a}):void 0),[s,u,e,n,i,a]);return c((()=>({onClick:p,onKeyDown:k,onMouseEnter:g})),[p,k,g])}},689427:(e,n,i)=>{"use strict";i.d(n,{S:()=>l});var a=i(250033),t=i(818319),r=i(681971);class o extends t.PureComponent{constructor(e){super(e),this.render=()=>{const{children:e,fallbackUI:n=null}=this.props,{error:i}=this.state;return i?"function"==typeof n?n(i,this.resetError.bind(this)):n:e},this.handleError=(e,n)=>{const{errorHandler:i,onErrorCallback:a,scenarios:t,rethrowError:r,loggerName:o}=this.props;if(a&&a(e),i){if(i(e,n),r)throw e;return}let l="";try{l=JSON.stringify(e)}catch(n){l=`Failed to stringify error: ${e}`}if(t?.forEach((e=>{e.fail({reason:`Error in ${o}: ${l}`})})),this.logger.error(`error: \n    ${l}\n    componentStack: \n    ${n.componentStack}`),r)throw e};const{loggerName:n,newLogger:i}=this.props;this.state={error:null},this.logger=i(n,"components-error-boundary")}static getDerivedStateFromError(e){return{error:e}}componentDidCatch(e,n){this.logger.error(`Error message: ${e?.message}.`),this.handleError(e,n)}resetError(){this.setState({error:null})}}const l=e=>(0,a.t)(o,{...e,newLogger:(0,r.SE)().loggerFactory.newLogger})},780989:(e,n,i)=>{"use strict";i.d(n,{Z:()=>M});var a=i(250033),t=i(818319),r=i(811537),o=i(681971),l=i(629494),s=i(683184),d=i(917978);const c=e=>{const{hexagonal:n,...i}=e;if(n){const e=(e,n)=>{const{"aria-label":t,src:r,...o}=n;return(0,a.t)("svg",{viewBox:"0 0 34 34",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"100%",children:[(0,a.t)("title",{children:i.name||o.alt||""}),(0,a.t)("rect",{fill:"transparent",clipPath:"url(#bot-hexagon-clip-path)",width:"34px",height:"34px"}),(0,a.t)(e,{as:"image",clipPath:"url(#bot-hexagon-clip-path)",width:"34px",height:"34px",xlinkHref:r,"aria-label":t||i.name||o.alt||"",...o})]})};return(0,a.t)(d.q,{...i,image:{..."object"==typeof i.image&&i.image,children:e}})}return(0,a.t)(d.q,{...i})};var m=i(341443),u=i(895007),p=i(994575),k=i(543491),g=i(301644),N=i(237867),f=i(56056);const h=(0,i(696618).s)({transparent:{sj55zd:"f44pa96",De3pzq:"f3rmtva",Bic5iru:"f1pspie5"}},{d:[".f44pa96{color:transparent;}",".f3rmtva{background-color:transparent;}",".f1pspie5::before{color:transparent;}"]}),v=({badge:e,name:n,size:i,src:r,className:l,setShouldFallbackToDefault:s,setBlobUrl:d,enableFetchApiForBotAvatar:c,setError:v,error:T})=>{const M=h(),y=(0,N.x)(),S=(0,p.w)("custom-avatar-v9"),{scenarioFactory:A}=(0,o.SE)();let I=A.findScenario(k.RG.ExtBotAvatar);I||(I=A.newScenario(k.RG.ExtBotAvatar),I.appendEventData({"App.Name":n}));const b=(e,n)=>{I?.mark(k.ck.ExtBotAvatarFetchApi,{errors:n??""},e),"failure"===e&&(S.errorToTelemetry?.("CustomAvatarV9:: bot avatar did not load properly, rendering fallback","platform_bot_avatar_error"),s&&s(!0),v&&v(!0))};return(0,a.t)(t.Fragment,{children:(0,a.t)(m.q,{badge:e,className:(0,u.z)(M.transparent,l),icon:{children:()=>(0,a.t)("svg",{viewBox:"0 0 34 34",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",width:"100%",children:[(0,a.t)("title",{children:""}),(0,a.t)("rect",{fill:"transparent",clipPath:"url(#bot-hexagon-clip-path)",width:"34px",height:"34px"}),(0,a.t)("image",{clipPath:"url(#bot-hexagon-clip-path)",width:"34px",height:"34px",xlinkHref:r})]})},initials:null,name:n,size:i,onError:async()=>{try{if(c)if(r&&(0,f.$O)(r)){const e=await(0,g.H)(y,r,"Url",!0);if(e.result?.blob)d&&d(e.result.blob),b("success");else{b("failure",`CustomAvatarV9:: amsDownload did not return a blob for app: ${n}`)}}else{b("failure",`CustomAvatarV9:: non-AMS image did not load properly for app: ${n}`)}else s&&s(!0)}catch(e){b("failure",`CustomAvatarv9:: Failed to load bot avatar for app: ${n}`)}},onLoad:()=>{T?I?.fail():I?.stop()}})})},T=(0,a.t)("svg",{xmlns:"http://w3.org/2000/svg",style:{width:0,height:0,position:"absolute"},children:(0,a.t)("defs",{role:"presentation",children:(0,a.t)("clipPath",{id:"bot-hexagon-clip-path",children:(0,a.t)("path",{d:"M23.93,2H10.07C9,2,8.01,2.57,7.47,3.5l-6.92,12c-0.54,0.93-0.54,2.07,0,3l6.93,12c0.54,0.93,1.53,1.5,2.6,1.5h13.85c1.07,0,2.06-0.57,2.6-1.5l6.93-12c0.54-0.93,0.54-2.07,0-3l-6.93-12C25.99,2.57,25,2,23.93,2z"})})})}),M=e=>{const{host:n}=(0,o.SE)(),{enableFluentV9Avatar:i}=(0,l.NC)(s.J.People,["enableFluentV9Avatar"]),{enableFetchApiForBotAvatar:d}=(0,l.NC)(s.J.Extensibility,["enableFetchApiForBotAvatar"]),m=(e=>{const n="bot-hexagon-clip-path-container";let i=e.document.body.querySelector(`[id='${n}']`);return i||(i=e.document.createElement("div"),i.id=n,e.document.body.insertBefore(i,e.document.body.childNodes[0])),i})(n),[u,p]=t.useState(!1),[k,g]=t.useState(""),[N,f]=t.useState(!1);return t.useEffect((()=>{m.hasChildNodes()||r.render(T,m)}),[m]),i?(0,a.t)(v,{src:k&&d?k:u?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAYAAAB5fY51AAAABGdBTUEAALGPC/xhBQAAIGhJREFUeAHtnQl4VuWZhj8IJCxhDZAERGQT12rVuuCCgChWQVu7zkwvO52pV2eKgKJtHTdwA3cExNmns9aZ6bRVtC6I+9YZF1wAQXErJiEJW9gCBJj3OeFUCX/Iv5z35Lzne97raiNZzv9+9/N8z/+d85+lw+iFq/c6FgmQAAkYINDRQI9skQRIgAQCAgwsGoEESMAMAQaWGanYKAmQAAOLHiABEjBDgIFlRio2SgIkwMCiB0iABMwQYGCZkYqNkgAJMLDoARIgATMEGFhmpGKjJEACDCx6gARIwAwBBpYZqdgoCZAAA4seIAESMEOAgWVGKjZKAiTAwKIHSIAEzBBgYJmRio2SAAkwsOgBEiABMwQYWGakYqMkQAIMLHqABEjADAEGlhmp2CgJkAADix4gARIwQ4CBZUYqNkoCJMDAogdIgATMEGBgmZGKjZIACTCw6AESIAEzBBhYZqRioyRAAgwseoAESMAMAQaWGanYKAmQAAOLHiABEjBDgIFlRio2SgIkwMCiB0iABMwQYGCZkYqNkgAJMLDoARIgATMEGFhmpGKjJEACDCx6gARIwAwBBpYZqdgoCZAAA4seIAESMEOAgWVGKjZKAiTAwKIHSIAEzBBgYJmRio2SAAkwsOgBEiABMwQYWGakYqMkQAIMLHqABEjADAEGlhmp2CgJkAADix4gARIwQ4CBZUYqNkoCJMDAogdIgATMEGBgmZGKjZIACTCw6AESIAEzBBhYZqRioyRAAgwseoAESMAMAQaWGanYKAmQAAOLHiABEjBDgIFlRio2SgIkwMCiB0iABMwQYGCZkYqNkgAJMLDoARIgATMEGFhmpGKjJEACDCx6gARIwAwBBpYZqdgoCZAAA4seIAESMEOAgWVGKjZKAiTAwKIHSIAEzBBgYJmRio2SAAkwsOgBEiABMwQYWGakYqMkQAIMLHqABEjADAEGlhmp2CgJkAADix4gARIwQ4CBZUYqNkoCJMDAogdIgATMEGBgmZGKjZIACTCw6AESIAEzBBhYZqRioyRAAgwseoAESMAMAQaWGanabrS4qIO7acIAN6KsuO1fTvFvYPyzhAN4sNJFgIGVEj0xOW8/v9yNH1Hq5k2u9Da0EFYY/znCATwYWikx+L5hMLBSoCcm5RyZnCcP7haMpleXIi9DKwwrjB8FHuDC0ApwpOL/GFjGZewsCs6eWO5O2RdW4XB8C62WYRVyABfwASeWfQKU0bCGzWFV4U49tHll1XIovoRWa2EV8gCf2RMrGFohEMNfGVhGxeskyt0mk/C0IZnDKhxW2kOrrbAKOYATeIEbyy4BymdQuyCszit3o9sIq3BoaQ2tbMMq5ABetwk3hlZIxN5XBpYxzTDZbpVJd/ph3XPqPG2hlWtYhbDADfwYWiERW18ZWIb0KhK1bjm33J2RY1iFQ0xLaOUbViEH8ANH8GTZIkDJjOgVhtWZQ3NbWbUcnvXQKjSsQh7gyNAKadj5ysAyoBXC6uYJ5e6sAsMqHKrV0IoqrEIO4AmuXGmFRJL/lYGVcI1wdcmscwa4McMKW1m1HKa10Io6rEIe4Aq+vIonJJLsrwysBOsThJVcEzd2eKlKl2FoDendWWX7UW0U/eFyG/SrUeCLaw8ZWhp0o90mAytanpFtDZNnpmJYhY1+tH6nW7ulKfxnIr+iP/SpWQgt8GZoaVIufNsMrMIZRr6FjhJWN8huyjillVXY8NKq7W7GozWusWlv+K1EfkV/6BP9ahZ4gzv4s5JJgIGVMF0wWW4cPyC424Bma29XN7qrDIRVyAChhX7Rt2bhLg/gz9DSpJz/thlY+bOL/C8xSa4fJ2E1UueYVdjwOzWNsmKpdtsTvrIK+w2/ol/0jf41C/yhA0NLk3J+22Zg5cct8r/CXsh14/q7cw/XD6srH6l223YlezewNcDoG/1rhxZ0gB7cO2xNifb5PgOrfbjv96phWJ13eI/9vh/1P96VlYnlsAp5hKGF8WgW9GBoaRLOfdsMrNyZRfoXCKtr5Z184ijdsFq2ttFdYXhl1RI6Qgvjwbg0C7pAH660NClnv20GVvasIv9NTIJrxvZ35yuH1fIgrGrM7ga2Br45tGocxqdZ0Ac6MbQ0KWe3bQZWdpxUfguT4IIjdFdWK2ob3fRHatzWnXtUxtDeG8W4ML4VtTtUW4FO0IvVvgQYWO3E/2dn91MPq/fqdrjpi9IbVqF0QWgtqnYYr2YhtKAbq/0IMLDagf1Px/Rzk47sqfrKK4OwqnZbUrqyagkP45wuoYVxaxZ0g36s9iHAwIqZ+0/E7JOP0g2rVTJpp8nk3bwjnbuBrUmG8WLcGL9mQT/oyIqfAAMrRuZXn9XPXaQdVvU73FQPwyqUEaGF8a8SDpoFHaEnK14CDKyYeM84s5+7+GjdldX7MkmnPezfyqqlhMFKSziAh2ZBT+jKio8AAysG1leeUea+foxuWH2wTlZWMkkbPNsNbE0+cAAPcNEs6Ap9WfEQYGApc75CzHzJsb1UX2X1up0MqwyEw9ACH82CvtCZpU+AgaXIePrpZe4bymH1YRBWVW5To18H2LOVDVymPlzlwEmzoDP0ZukSYGAp8Z0m5v3ml3RXVh/KTe0ul8m4kWF1UBXB5/JFElrKNwGE3lNHM7QOKkaBP2RgFQgw059fPrqv+5ZyWOEOnAyrTPQzf2/jdgktCXftO5d++7heDvqzdAgwsCLmOuW0vu47x/WOeKv7b+7jDQiraodJyMqeQHNoVTvw0yzoDx+woifAwIqQ6Y/FpN89XjesPkFYPVTtNmzfHWHn/mwK3MAPHDULPoAfWNESYGBFxPMvTu3r/iiGsJoik209w6og1cAPK1Tt0IIf4AtWdAQYWBGw/NEpfd2ffFl3ZfXpxubdQIZVBILJJtZtaw4tcNUs+AL+YEVDgIFVIMfLTu7jvneCblj9fuOuYDcGk4wVHYEgtGTFCr6aBX/AJ6zCCTCwCmD4QzHhpSfqGnHNpl1uiny6Vc+wKkCp1v8UXMEXnDULPoFfWIURYGDlye/Pv9LHfT+OsHpIwmorV1Z5ypTVn4HvFOGsHVrwC3zDyp8AAysPdj84qY/7U/mfZn3WgN3AKlfHsNLE/IdtgzN4g7tmwTfwDys/AgysHLn94KTe7s+U3yWrZNJM+U2Vq2VY5ahOYb8O3uAO/poF/8BHrNwJMLByYPb9ExFWup/4VCOs5EAwwyoHYSL81SC0hD900Cz4CH5i5UaAgZUlr0vlk54fnqwbVjWbd7kfy2RZu6Upy674axoEwB86QA/Ngp/gK1b2BBhYWbD6npxLc5nyuTQMqyyEiPFX4got+Ar+YmVHgIHVBqfgxD/ls5VrNjcFu4H4ykoOgbh0+ZH4S/vE4+RQLawTBtZB+P3x8b3UL63AOznuIlDNsDqIEu33I+gCfbR303EJD/zGOjgBBlYrfL4rtwn5y9N0721Ui7CSj9KrGriyakWGRHwb+kAn6KVZ8Bt8x2qdAAMrA5vviGmmKN+IrU7Mj5MVP2NYZVAged+CTtALumkWfAf/sTITYGC14PJtufHe5dphtRWfQjGsWqBP/D+D0JLdwzrRT7PgP/iQdSABBtYXmHzz2J5uqvJ9uWF2rqy+AN3Yf67ZtG+lpRxa8CH8yNqfAANrH49viDmmn6H7jLl6MTluHgfTs+wSgH7QEXpqFvwIX7I+J8DAEhaXyLPlrlAOq3XbxORy07jfK98V4HNp+V+aBKAj9ISumgVfwp+sZgLeB1bwIEzlp/euF1PjcptPle+7RFPHSwB6BneAVQ6tK8WfX1N+ani85PJ/Na8DCybQfmovwyp/c1r4y7hCa8aZZQwtMYS3gXXRUT0cTNChQwe1ebFh3214P+HKSo1xEjYMfbF7CL21Cj6FX+Fbn8vLwJosol99Vj/dsAoedFAlj5TSvYDWZ/MmaezQGWfEaz7NCKEF38K/vpZ3gTXpyB7uJ8phtXFfWH3EsPJqXkFvhBb01yqEFvwLH/tYXgXWhUf0cD8do7uyag6rannCMFdWPk4o6I7dQ+3Qgo/hZ9/Km8D66qhS97OzdcNqU+NuN1XM+qE8Rp7lLwHoP21RtYMftAorLfgZvvapvAgsiHrN2P6qx6waxJzTJKxWM6x8mj+tjvWDdRJa4gf4QqsQWvC1T6GV+sCaeHhzWHUUcbUKppwq76jvi0lZJBASgB/gC83Qgq8RWvC5D5XqwDpPRLx2XH+nGlY7ZGWFsKpnWPkwYXIdI3wBfzSIT7QK/obP4fe0V2oD69yRpe465bDaLCacLmZcxbBK+zwpaHzwB3wCv2gVQgt+h+/TXKkMrAkxhtXKOq6s0jxBohobfBJXaMH/aa2iwRdMm5mmwY0f0d3dMH6AK+qod8xqy449Yr4a957BsCoSLIN7d3bDy4qD/3Uv7uia9ux1jU17E2uD3l07uqF9i90R/Utcv+5FrrMMAhokt+PMKOvlTPjX1jS68cNLXXEnHX9ipXXmYd3cp3JxdhpPrekweuFqa7pndoN8d/zw7u7Gc2IIq0eq3YraHa32kcQfHFNeElyLNlrM3LOk6IAWV9btcE+v3up+9e4mt21X+1uiW+cO7uvH9HLjRNNRElQtC8eEXv54m/v1sgb37lpbWhw5oMTNvbDSlZbo7eDsljehWU/VuiWiaZoqNYE1Vow9U8Kqk+LKautOrKyq3XJDYdWna5G7Ss6MPntY96x8i0tLHnh1vXv0vc1Z/b7GL10gJ0TioQzoPZt69sOt7q7n61Uvi8mmj1x+5yiE1qRKhxWuVmHlPFNC65kUhVYqdgkxGWdN0A+rK2VltcxQWI2U3b75Fw10x5R3yXpOdO3c0Z05tLvr263I/e7TbbHudmF3dYaE62XygFH0kW0d1qfYjR9R6t74bLtbr3hZTLb9ZPN7dVt3uzertssKUnYPMXCFwu7hWaIlrnNMyzWt5gNrzNBu7qZzy9VXVggrS7seg3p2cg98baAr69Ypr6mA3RascF7+ZFtef5/PH2ElmO99n0plpYLdR6y2NsvxLQtVG1NojZE39I/khOY03DUk+7exBDrg9CESVhN0w2rbrj1uxqO2wgqLk9vPr3A9u2S3S9WatBfL/cImx3SRLV4Hr1dIYbwYdw6Ls0JeLpK/xZsg/AWfaRUOk2CeYL5YL7OBNbRPZzcTu4FKy2kIG4TVIzXunRpbB3UvObZX8KlaFObEU4k1j7OgR2wfrxNF4dNEjN9SwV8zxGeqoSXzBPMF88ZymQ0sXI7QTfGtdLu84131aI17u6bRlL44HnLpCb0j67mXrFq0n97yLXnQAl4nqsL4tY4LRdVjy+3AZ/AbfKdVmC+YN5bLZGCdemhXd3QOB5JzFQimmSHmeavaVlhhnCcO6lrwrmBLXjhvSLNw4DnKwq4hOFgr+E07tDBvMH+slsnAGpvlR/T5iNIoYXX1b22GFcY7ekj0ZhwmnzaWl+Z38L4tDbBdbD/q0uAQdY+ZtrdUQgv+gw+1SnP+aPUcbtdkYB1XGf2kBJAwrN6ssreyCgUd1FPnGMVA+dRRo7S2q8VBg0HLbcJ/mqGlNX9ajkPj3yYDC5dnRF07mmRl9ViNe8NwWIFJmQKbYLtyXpZGlSltF+eRWS74EH6EL6MujfkTdY+tbc9kYGlcOIKT7EqKTOLYT9sdStcEWtvuzt0aLtkPtfo/4Ef4MuqyTMbkDK3bEv3TdnFB7W0Ty91phg9Iwtj1cjKiRuHCXY1S264SBw0GmbYJH84WP8KXUZfG/Im6x9a2ZzKwcGBSo/BR+G0TK0x/irKqPvpzxrBa+Vjp1s/YrsZqaKUCBw3PZdomPsWDDzXCCq+nNX8yjSXq75kMLNxVQKsQWrPFLCcP1jmwr9V3uN3nP4r+UprX12x325V2NbFdbD/qekGBQ9Q9ZtreKeI7+E/zPLIlH2zJ9NImvmcysF4Tgy+VC0e1CmaZI8vxkw+xF1p4YsvytdGuQB9e0aCFOthu1NtfJuO3+OQi+A27gZphhXnz+mfR+kPVHC02bjKwMIbZz9ap3nK2pFNHN+f8cvcVg6F1/yvrW8ic/z/fkTOwNVZtX+wI28frRFULIxx/VD21tR34DH6D77QKt2jGvLFcenSUqazZ1OSue7JW5fhH2DrMc7uY6CRjoYVjFL98Z1M4jLy/4v5fc2IyOF4Hr1doYdzWjtHAX/CZZljhOCHmC+aN5TIbWICOXcNrHq9RD607xEwnDMr+nlJJMMS8l9YF97PKt5ddYvAbF9fGdh8l3K8Jr4fXzbdw/y6M21LBV/CXdlhhnmC+WC/z98PCO8Yqub3vWLkeTes+7rg9xzi5HOhd2W2p3mzjHQrT/qnVW4Ib8eFe6LkU7jqKa9pelxvixVlr5D7kb8jxldPlNs653MAPPT60vMHNWlLrCsi7OIcavNYJA7u4O79a4booXsSPN4C/krB69dN4tdSCaT6wACYILXmUEq6RUgstORCPG8ThWEuNldCS1HpJbsCH+7WPkOv12rrlMG6p+9Dyze562XVor5u9rZVz7B5buSUIrJH9its8cRI3ppv9TJ178K1Nbm/+izOt+dXqdr8sYXVXHGH1xFr3SkrCCjBTc093DAY3KLv1PJ2T7bB9lNU7OeBW98fLJMEtc3E/8X7dO0kodHDr5YTQqoYmeQfeJgfXtzrcujcp1V8uM0K/px7azeGaQ1xus10ekFG/tSm4rz76XSqXsEjOmqrjKru4uy+oyHkVmcsgsbK6VsIKb1hpqlQFFoQ5Q3YnbsUtk2VFpFVWQ0uLB7ebPYE4wqoJYfXkWveiPFUobWX6oHsmMSDSdSIWRNMqHF+5S94hv1Rh60C8Fg9uNzsC8At8k+vxuey23vxb8D38n8awwghTF1gY1AsSWtcv1g0t3L3x7gsr3LEVuR3QRn8s/wjAJ/CL5l1yEVbwPfyf1kplYEEsnIx4ozyTDQeStSoIrQsq5TFaDC0txmnYLvxxt/hENazE5/C79km+7a1HagMLYPHIJ5zboxlaeIDCPfIU36MZWu3t5US+PnwBf2g+yAP+hs/h97RXqgML4kFEPP1WO7TuFVPi0zcWCYQE4Af4Qjus4G8fwgpcUx9YGCQe1X2TiLpbcfcQpoQ58QBSFgnAB9phBT/D12l6FH1bzvEisABhiYRWcCa0YmiVlnR0cyW0cj2zvC2R+HNbBKA/fAA/aBXCCn6Gr30qPaIJpLjkg63u5qfrVFdaQWhNqpDQiv5JMAlEypZaEIDuc0V/7bCCj+Fn38qrwIK4i9/f4m4RsfcoXsfRo6RITFvpRjG0vJpP0Bu6Q3+tgm/hX/jYx/IusCDykzGG1uFyPRwr/QSgc1xhBf/6Wl4GFsR+YtUWd6vySqunvNPeJ++4uIiXlV4C0Bc6Q2+twsoKfoVvfS5vAwuiPy7i40p/zd1DPDZ9npgZd0tgpY8AdIW+0Fmr4E/4FH71vbwOLIj/W7mVCcywV/GYVhBakyvd8L4MrTRNOOg5T3TVDCv4Ev6ET1menIfVltAww5xn61VDqxdWWmLuYQyttuQw8XPoCD2hq1YhrOBLhtXnhL1fYYUoHnlvs7v9Od3Q6t21yM0Xkw/t2zl8WX41SAD6Iaygp1YhrOBH+JL1OQEG1ucs3KIVm90dz8cRWgPd0D4MrS+gN/Of0G3+5IFt3r21kAEhrOBD+JG1PwEG1v483MNyi+A7lUMLtyqG6Q9jaLWgn+x/Qq84wgr+gw9ZBxJgYB3IJLiv+d0v6D59pY/c7he7h0N6c6WVQYLEfQs6QS/oplVYWcF3uK8+KzMBBlZmLu7XyxrEPPWt/DSab/ft1sktuKjSHcrQigao0lagD3SCXpp1z4vrAt9pvob1bTOwDqLgr95tcPcwtA5CKP0/ii2sxGfwG+vgBBhYB+fj/kdMdO+LuiutMnnnxu7G4F7cPWxDjlh/DD2gC/TRLPgLPmO1TYCB1TYjeex7g7vvJd3QwmO35stuxyG9dCdHFsPlrwgB6AA9oItmwVfwFys7Agys7Di5/3q7Qf0x6P1lciyQTw8HyTP4WO1HAPyhA/TQrHkvrQt8pfkaads2AysHRf/z7U1u/su6nx72L+3k7r+IoZWDLJH+KsIK/KGDZsFH8BMrNwIMrNx4BY9EXxBDaC1gaOWoTOG/HqysYggr+OfBtxhW+SjGwMqD2i/EbAtf0V1pDZB3+PkyefCIdpY+AXAGb3DXLPgG/mHlR4CBlR839+9LN7kHXl2f519n92flCC05llLZQ3cSZddNen8LfMEZvDULfoFvWPkTYGDlz87925sb3d/8Tje0KmQy4aRFfGVFTyAuvvAJ/MIqjAADqzB+7l/e2Oj+Vj205ExrOR9IewVQIApzfw6e4FrRQ/f8N/gDPmEVToCBVThD989ixr/7X92VVmXPzvLpFUMrArmCTSCswBNcNQu+gD9Y0RBgYEXD0f389Y3uH/5PP7Swezigu94FuBHhSPRmwA8ctcMKfoAvWNERYGBFx9L942sIrQ0RbvHATQ2UFcGCi3FSI0PrQDptfwfcwA8cNQs+gB9Y0RJgYEXLU0y6wf2T/E+zBiG0cL4QQysnzEFYCTfw0yzoDx+woifAwIqeqft7eXf9+eu6hj1ELsxFaPVjaGWlIDiBF7hpFnSH/iwdAgwsHa5yEH6DfDKka9wgtOT8oX6KN5VTwhPrZsEH1wZqhxX0hu4sPQIMLD22co7WBvevyp8QDcadMOUAchlDK6OS4AI+4KRZ0Bl6s3QJMLB0+bq/juGEwUN7Fwf3beqr+BQXZUwqmwcP3M8KfDQLJ4RCZ5Y+AQaWPuPgEp7/WKr7idGQPsXBR/UMrWZBwQGnLoCLZkFX7Uu0NPu3tm0GVkyK3f/KeveLGEILuz94Ko/PFTyVKIawgp7QlRUfAQZWfKzdAjH3g2/prrQOkxUFdoN6d/VTWowb4wcHzYKO0JMVLwE/XR0v4/1ebf7L6+Uuk7pX7A+Vx6jj7gO9u/glL8aLcWP8mgX9oCMrfgJ+OTp+vhlf8T65Ne5/K4fWMM9CKwwrjFuzoBv0Y7UPAQZW+3B3c8X0v3xHd6U1rKzYzZMVR6+Ur7QwPowT49Us6AXdWO1HgIHVfuzl8WHr5Fl0uqE1PAitStezJJ1SY1zz5JgVxqlZ0Al6sdqXQDpd3L5Mc3p1PJpc+wGaI8pKgkmdttAKwwrj0yzoA51Y7U+AgdX+GshkqHe/Wab7bLqR/UrcfbIS6ZGSlRbGgfFgXJoFXaAPKxkEGFjJ0MHd+Xy9e2i5bmgdLpN73iT7oYWwwjgwHs2CHtCFlRwCDKzkaOHueK7ePawdWv1lpWU4tIKVFcJKxqFZ0AF6sJJFgIGVLD3c7TJJFq3QXWmNksl+74WVrrTYlvzoF32jf80Cf+jASh4BW45NHj+VjuY8W+8efW+zyrbDjR45oMTNnVThuhsJLfSJftG3ZoE7+LOSSYCBlUxd3Oxn6mIIrS5u7oUVrrioQ0IpNLeF/tDnkQO6qPaJsAJ3VnIJMLASqs1e6QuT57GVuiutpdWNbuduvFpyC/29WdWo2iA4g3eySagiMLFxBlaCZcLkufXpOve4Umjh1ihW7jawEE9NVnoQKfiCM8MqwZNhX2sMrIRrhEl0i0ymJ1ZFu9KyFFahRBqhBa7gy7AKKSf7KwMr2foE3YWh9eSqLZF0azGswoFHGVrgybAKydr4ysCyoZPbI6l189O17qn3Cwsty2EVShVFaIEjeIIryw4BBpYdrYLJNWuJhNYH+YVWGsIqlKuQ0AI/cGRYhTTtfGVg2dEq6BST7Kanat3Tq3MLrTSFVShZPqEFbuDHsAop2vrKwLKlV9AtzkKYubjWPZNlaKUxrELZcgkt8AK3hJ/FEQ6NXzMQYGBlgGLhW5h0N8rke/bDrQdtN81hFQ48m9ACJ/BiWIXUbH5lYNnULegak++GxWvdc62Elg9hFcp3sNACH3BiWIW07H5lYNnVLuh89x7nrpfJ+PxH+6+0cJKllZNCo5IgU2iBC/iAE8s+AQaWfQ2DyXjdk2vdC/tCC2GFyetjfTG0wANcGFbpcUKH0QtXy44FKw0EOsnbz4SRpXL9YW6fIKZh7C3HcP6oUrdYzrVq4sqqJRrT/2ZgmZaPzZOAXwS4S+iX3hwtCZgmwMAyLR+bJwG/CDCw/NKboyUB0wQYWKblY/Mk4BcBBpZfenO0JGCaAAPLtHxsngT8IsDA8ktvjpYETBNgYJmWj82TgF8EGFh+6c3RkoBpAgws0/KxeRLwiwADyy+9OVoSME2AgWVaPjZPAn4RYGD5pTdHSwKmCTCwTMvH5knALwIMLL/05mhJwDQBBpZp+dg8CfhFgIHll94cLQmYJsDAMi0fmycBvwgwsPzSm6MlAdMEGFim5WPzJOAXAQaWX3pztCRgmgADy7R8bJ4E/CLAwPJLb46WBEwTYGCZlo/Nk4BfBBhYfunN0ZKAaQIMLNPysXkS8IsAA8svvTlaEjBNgIFlWj42TwJ+EWBg+aU3R0sCpgkwsEzLx+ZJwC8CDCy/9OZoScA0AQaWafnYPAn4RYCB5ZfeHC0JmCbAwDItH5snAb8IMLD80pujJQHTBBhYpuVj8yTgFwEGll96c7QkYJoAA8u0fGyeBPwiwMDyS2+OlgRME2BgmZaPzZOAXwQYWH7pzdGSgGkCDCzT8rF5EvCLAAPLL705WhIwTYCBZVo+Nk8CfhFgYPmlN0dLAqYJMLBMy8fmScAvAgwsv/TmaEnANAEGlmn52DwJ+EWAgeWX3hwtCZgmwMAyLR+bJwG/CDCw/NKboyUB0wQYWKblY/Mk4BcBBpZfenO0JGCaAAPLtHxsngT8IsDA8ktvjpYETBNgYJmWj82TgF8EGFh+6c3RkoBpAgws0/KxeRLwiwADyy+9OVoSME2AgWVaPjZPAn4RYGD5pTdHSwKmCTCwTMvH5knALwIMLL/05mhJwDQBBpZp+dg8CfhFgIHll94cLQmYJsDAMi0fmycBvwgwsPzSm6MlAdMEGFim5WPzJOAXAQaWX3pztCRgmgADy7R8bJ4E/CLAwPJLb46WBEwTYGCZlo/Nk4BfBP4fdKKKT3sfOPsAAAAASUVORK5CYII=":e.commonImgAttributes?.src,badge:e.badgeProps,size:"number"==typeof e.size?e.size:void 0,setShouldFallbackToDefault:p,setBlobUrl:g,enableFetchApiForBotAvatar:!!d,error:N,setError:f,...e}):(0,a.t)(c,{hexagonal:!0,...e})}},839413:(e,n,i)=>{"use strict";i.d(n,{s$:()=>l,EG:()=>o,Vf:()=>s});var a=i(316877),t=i(379658);const r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authenticationToken"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"acquireTokenOptions"}},type:{kind:"NamedType",name:{kind:"Name",value:"AcquireTokenOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationToken"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resource"},value:{kind:"Variable",name:{kind:"Name",value:"resource"}}},{kind:"Argument",name:{kind:"Name",value:"acquireTokenOptions"},value:{kind:"Variable",name:{kind:"Name",value:"acquireTokenOptions"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"token"}}]}}]}}]},o=(e,n)=>{if("df"===n)return"Df";if("msit"===n)return"Msit";switch(e){case t.s.prod:case t.s.life:return"Prod";case t.s.gcc:return"GccModerate";case t.s.gcchigh:return"GccHigh";case t.s.dod:return"DoD";case t.s.ag08:return"AG08";case t.s.ag09:return"AG09";case t.s.gallatin:return"Gallatin";default:return"Unknown"}},l="https://unknownregion.loki.delve.office.com",s=(e,n,i)=>{const t=(0,a.v4)();return async(a,o)=>{try{let l;e.current?l=(await e.current.query({query:r,variables:{resource:n,acquireTokenOptions:{silent:i}},fetchPolicy:"network-only"})).data?.authenticationToken?.token:o("Error no apollo client to retrieve token",t),l?a(l,t):o("No auth token found",t)}catch{o("Error retrieving auth token",t)}}}},208418:(e,n,i)=>{"use strict";i.d(n,{p3:()=>u,Lk:()=>p});var a=i(250033),t=i(818319),r=i(651908),o=i(349409);const l={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"lpcState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lpcState"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isLivePersonaCardInitialized"}},{kind:"Field",name:{kind:"Name",value:"lastLoggedInUserMri"}}]}}]}}]};var s=i(445217),d=i(803238);const c=t.createContext({IsLivePersonaCardInitialized:!1,LastLoggedInUserMri:void 0}),m=e=>{const n={IsLivePersonaCardInitialized:e.IsLivePersonaCardInitialized,LastLoggedInUserMri:e.LastLoggedInUserMri};return(0,a.t)(c.Provider,{value:(0,s.Q)(n,d.isEqual),children:e.children})},u=(0,o.C)((e=>(0,a.t)(r.A,{query:l,children:({data:n,loading:i,error:t})=>{const r=!i&&!t&&!!n&&!!n.lpcState&&n.lpcState.isLivePersonaCardInitialized;return(0,a.t)(m,{children:e.children,IsLivePersonaCardInitialized:r,LastLoggedInUserMri:n?.lpcState.lastLoggedInUserMri})}}))),p=()=>t.useContext(c)},861316:(e,n,i)=>{"use strict";i.d(n,{j:()=>g,g:()=>v});var a=i(250033),t=i(803238),r=i(818319),o=i(88202),l=i(839779),s=i(242111),d=i(5466),c=i(59083),m=i(841763);var u=i(848476),p=i(445217),k=i(994575);const g=(e,n=o.E)=>{const i=r.createContext(n);return i.displayName=e,[N(i),f(i),h(i)]},N=({Provider:e})=>({source$:n,children:i})=>(0,a.t)(e,{value:n,children:i}),f=e=>(n,i=!1,a,s=!0)=>{(0,t.isBoolean)(n)&&(s=i,i=n,n=void 0);const d=(0,k.w)("setupUseObservableContext"),c=r.useContext(e),m=r.useRef(o.E);r.useEffect((()=>{c===o.E&&d.log("No provider set yet for context",e.displayName)}),[c,d]);const p=r.useMemo((()=>n?c.pipe(n):c),[c,n]),g=r.useRef(),N=r.useRef(!1),[f,h]=r.useState(!1),v=r.useCallback((e=>{const n=e.getValue();return void 0!==n&&a?a(n):n}),[a]);if(m.current!==c&&c instanceof l.X)try{N.current=!0,g.current=v(c),m.current=c}catch(e){return}const T=r.useCallback((e=>{if(N.current&&(N.current=!1,c instanceof l.X)){const e=v(c);if((0,t.isEqual)(e,g.current))return}g.current!==e&&(g.current=e,h((e=>!e)))}),[v,c]),M=i?t.noop:T,y=(0,u.m)(p,{next:M},s);return[i?void 0:g.current,y]},h=e=>()=>r.useContext(e),v=e=>(n,i)=>{const a=(0,p.Q)(n),o=r.useCallback((e=>e.pipe((e=>n=>n.pipe((0,c.U)((n=>e?(0,t.pick)(n,e):n)),(0,m.h)((e=>!(0,t.isEmpty)(e)))))(a),(0,s.x)(d.V))),[a]),[l]=e(o);return l||i}},42395:(e,n,i)=>{"use strict";i.d(n,{Im:()=>M});var a=i(250033),t=i(818319),r=i(803238),o=i(29635),l=i(470453),s=i(681971),d=i(994575),c=i(485510),m=i(683184),u=i(588592),p=i(749321),k=i(611741),g=i(689427),N=i(208418),f=i(237867);const h=(0,i(696618).s)({defaultPersona:{mc9l5x:"fau6ura",Bqenvij:"f3052tw"}},{d:[".fau6ura{display:initial;}",".f3052tw{height:fit-content;}"]});var v=i(257135);const T=e=>{const n=(0,l.WD)(u.nh.POST_CRITICAL),i=(0,N.Lk)(),T=(0,f.x)(),{host:{LivePersonaCardHoverTargetV2:M},coreSettings:y}=(0,s.SE)(),S=((e,n,i,a)=>{const[r,l]=t.useState(!0),s=t.useRef(!1),{userId:d,hostConversationId:c,hostTenantId:m,isSharedChannel:u}=e,{data:p}=(0,o.W)(["meetingDetails","meetingRole"]),k=!!p?.call?.meetingDetails?.meetingCapability?.maskIdentitiesForRole,g=p?.call?.meetingRole??"";return t.useEffect((()=>(s.current=!0,(async()=>{const e=await(0,v.nv)(d,k,g,!!u,c,m,n,i,a);s.current&&l(e)})(),()=>{s.current=!1})),[i,n,a,d,k,g,c,m,u]),r})(e,y,T,(0,d.w)("PersonaInner")),A=(e=>{const{host:n,userBiService:i,coreSettings:a,authenticationUser:r}=(0,s.SE)(),o=(0,d.w)("PersonaRenderer"),l=(0,f.x)(),{topicId:u,personaType:g}=e,N=t.useCallback((()=>{n.document.dispatchEvent(new MouseEvent("mousemove"))}),[n]),{ariaLabel:h,behavior:T,disableAccessibilityDefaults:M,externalAppSessionCorrelationId:y,hostConversationId:S,hostTenantId:A,isSharedChannel:I,tabIndex:b,userId:C,displayName:D,module:F,source:U,highlightedText:E}=e,w=t.useCallback((async()=>{if(n.document.addEventListener("mouseleave",N),"Topic"===g&&u){const e=(0,p.I6)({userAadObjectId:r?.profile.objectId,tenantAadObjectId:r?.profile.tenantId});e?.logEvent(k.z.TopicCardOpen,{topicId:u,module:F??"",source:U??""})}const e=await(0,v.rH)(C,i,l),a={panelRegion:c.Ai.popover,panelType:c.wh.LivePersonaCard,dataBag:e};i.recordPanelView(a,o)}),[r,n,N,o,i,l,u,g,F,U,C]),L=t.useCallback((()=>{n.document.removeEventListener("mouseleave",N);const e={actionGesture:c.uS.mouseleave,actionOutcome:c.$K.closePanel,actionScenarioType:c.Yu.people,actionScenario:c.Tk.closePanel,moduleName:c.rA.lpcClose,panelRegion:c.Ai.popover,panelType:c.wh.LivePersonaCard};i.recordPanelAction(e,o)}),[n,i,o,N]),x=!!a.get(m.J.People).isInIframe,O=t.useMemo((()=>(0,v.g3)({ariaLabel:h,behavior:T,disableAccessibilityDefaults:M,externalAppSessionCorrelationId:y,hostConversationId:S,hostTenantId:A,isSharedChannel:I,tabIndex:b,userId:C,handleOnCardOpen:w,handleOnCardClose:L,personaType:g,topicId:u,shouldDeferCardOpenToParentWindow:x,displayName:D,module:F,source:U,highlightedText:E})),[h,T,M,y,S,A,I,b,C,w,L,u,g,x,D,F,U,E]);return t.useEffect((()=>()=>{n.document.removeEventListener("mouseleave",N)}),[n,N]),O})(e),{enableEntityMoreInfo:I}=y.get(m.J.Core),{enableFluentV9Avatar:b}=y.get(m.J.People),C=h(),D={"data-tid":e.callerInfo};return!I&&n&&!(0,r.isEmpty)(e.userId)&&S&&i?.IsLivePersonaCardInitialized&&M?(0,a.t)(g.S,{fallbackUI:(0,a.t)(t.Fragment,{children:e.children}),loggerName:"PersonaInner",children:(0,a.t)(M,{...A,children:b?(0,a.t)("div",{className:e.classNames||C.defaultPersona,...D,children:e.children}):e.children})}):(0,a.t)(t.Fragment,{children:e.children})},M=t.memo((e=>T(e)))},262723:(e,n,i)=>{"use strict";i.d(n,{b:()=>s,m:()=>d});var a=i(379263),t=i(12978),r=i(233304),o=i(818319),l=i(665641);const s=()=>{const{entity:e,getEntityOptions:n}=(0,a.sV)();return o.useMemo((()=>d(e,n)),[e,n])},d=(e,n)=>{let i={};const a=e&&e.type;switch(a){case t.py.extensions:i=c(e,n),i={...i,...n(t.py.extensions,t.uk.view)};break;case t.py.communities:case t.py.channels:case t.py.connectorinstanceconfiguration:i=e.id?{channelId:(0,l.s3)(e)}:{channelId:void 0};break;case t.py.chats:const r=e.id?.split(";replyChainId=")??[],o=r[0],s=r[1];i={chatId:o,channelId:s?o:void 0,replyChainId:s,channelMeetingMessageId:s};break;case t.py.platformapp:if(e.action===t.uk.config){const e=n(t.py.platformapp,t.uk.config),a=e?.messageId&&"0"!==e.messageId,r={chatId:e?.convId,channelId:a?e?.convId:void 0,parentMessageId:a?e.messageId:void 0,channelMeetingMessageId:a?e.messageId:void 0,eventId:e?.eventId};i={...i,...r}}else i={...n(t.py.platformapp,t.uk.create)};break;case t.py.platformStage:case t.py.platformstagewithoutchat:case t.py.platformstagemodal:i=m(a,n)}return i},c=(e,n)=>{if(e.linkedEntity?.id)switch(e.linkedEntity.type){case t.py.chats:return{chatId:e.linkedEntity.id};case t.py.communities:case t.py.channels:case t.py.extensions:case t.py.schoolteams:return JSON.parse(e.linkedEntity.id);case t.py.calls:return function(e){const{options:n}=e;if(!n)return{};const{convId:i,messageId:a}=JSON.parse(n);return function(e){return!!e&&"0"!==e}(a)?{channelId:i,chatId:i,parentMessageId:a,channelMeetingMessageId:a}:{chatId:i}}(e);case t.py.schedulingform:return function(e,n){if(!e.linkedEntity?.id)return{};const{threadId:i,messageId:a}=e.id&&JSON.parse(e.id)||{},{channelId:r}=e.linkedEntity.id&&JSON.parse(e.linkedEntity.id)||{},{isChannelMeeting:o,messageId:l}=function(e,n){let{isChannelMeeting:i,messageId:a}=n(t.py.extensions,t.uk.view);if(void 0===i){const{options:n}=e;if(n){const{isChannelMeeting:e,backFilledOptions:{messageId:t}}=JSON.parse(n);i=e,a=t}}return{isChannelMeeting:i,messageId:a}}(e,n);return o?{channelId:r,chatId:i,parentMessageId:a??l,channelMeetingMessageId:a??l}:{chatId:i}}(e,n)}return{}},m=(e,n)=>{const i=((e,n)=>e===t.py.platformStage?n(t.py.platformStage,t.uk.create):e===t.py.platformstagewithoutchat?n(t.py.platformstagewithoutchat,t.uk.view):n(t.py.platformstagemodal,t.uk.view))(e,n),a=JSON.parse(i.tabInfo);return i.entryPoint===r.mQ.adaptiveCardCollabStage||i.entryPoint===r.mQ.adaptiveCardStageModal?i.replyChainId?{channelId:i.channelId??i.convId,replyChainId:i.replyChainId,entityId:a.tabInfo?.entityId,chatId:void 0}:{chatId:i.convId,entityId:a.tabInfo?.entityId}:i.replyChainId||i.channelId?{channelId:i.channelId??i.convId,replyChainId:i.replyChainId,entityId:a.tabInfo?.entityId,parentMessageId:i.messageId,channelMeetingMessageId:i.messageId,chatId:i.messageId?i.channelId??i.convId:void 0}:{chatId:i.convId,entityId:a.tabInfo?.entityId}}},747322:(e,n,i)=>{"use strict";i.d(n,{Rq:()=>Q,Tq:()=>L,en:()=>R,oO:()=>z,bE:()=>P});var a=i(250033),t=i(818319),r=i(237867),o=i(922790),l=i(899617),s=i(436328),d=i(197882),c=i(332534),m=i(930427);const u="Disabled",p={InAConferenceCall:{backgroundImage:m.F.OnThePhone,title:"status_inACall"},InACall:{backgroundImage:m.F.OnThePhone,title:"status_inACall"},Presenting:{backgroundImage:m.F.DoNotDisturb,title:"status_presenting"},OffWork:{backgroundImage:m.F.Offline,title:"status_offline"},InAMeeting:{backgroundImage:m.F.Busy,title:"status_inAMeeting"},Available:{backgroundImage:m.F.Online,title:"status_online"},Inactive:{backgroundImage:m.F.Away,title:"status_away"},Busy:{backgroundImage:m.F.Busy,title:"status_busy"},DoNotDisturb:{backgroundImage:m.F.DoNotDisturb,title:"status_doNotDisturb"},BeRightBack:{backgroundImage:m.F.BeRightBack,title:"status_beRightBack"},Away:{backgroundImage:m.F.Away,title:"status_away"},OutOfOffice:{backgroundImage:m.F.Away,title:"status_away"},Offline:{backgroundImage:m.F.Offline,title:"status_offline"},UrgentInterruptionsOnly:{backgroundImage:m.F.DoNotDisturb,title:"status_doNotDisturb"},PresenceUnknown:{backgroundImage:m.F.Unknown,title:"status_unknown"},AvailableIdle:{backgroundImage:m.F.Idle,title:"status_away"},BusyIdle:{backgroundImage:m.F.Idle,title:"status_away"},OnShift:{backgroundImage:m.F.OnShift,title:"status_onShift"},OffShift:{backgroundImage:m.F.OffShift,title:"status_offShift"},[u]:{backgroundImage:m.F.Disabled,title:"status_disabled"}},k={status_inACall:"inACall",status_presenting:"presenting",status_offline:"offline",status_inAMeeting:"inAMeeting",status_online:"online",status_away:"away",status_Busy:"busy",status_doNotDisturb:"doNotDisturb",status_beRightBack:"beRightBack",status_unknown:"unknown",status_onShift:"onShift",status_offShift:"offShift",status_disabled:"disabled",status_blocked:"blocked"},g={InAConferenceCall:{backgroundImage:m.F.OnThePhoneOof,title:p.InAConferenceCall.title},InACall:{backgroundImage:m.F.OnThePhoneOof,title:p.InACall.title},Presenting:{backgroundImage:m.F.DoNotDisturbOof,title:p.Presenting.title},InAMeeting:{backgroundImage:m.F.BusyOof,title:p.InAMeeting.title},Busy:{backgroundImage:m.F.BusyOof,title:p.Busy.title},DoNotDisturb:{backgroundImage:m.F.DoNotDisturbOof,title:p.DoNotDisturb.title},Available:{backgroundImage:m.F.OnlineOof,title:p.Available.title}},N=(e,n)=>{switch(e){case"Available":return n.stringTranslate("nova","me_control_presence_activity_available");case"Away":case"Inactive":return n.stringTranslate("nova","me_control_presence_activity_away");case"BeRightBack":return n.stringTranslate("nova","me_control_presence_activity_be_right_back");case"Busy":return n.stringTranslate("nova","me_control_presence_activity_busy");case"DoNotDisturb":case"UrgentInterruptionsOnly":return n.stringTranslate("nova","me_control_presence_activity_do_not_disturb");case"InACall":case"InAConferenceCall":return n.stringTranslate("nova","me_control_presence_activity_in_a_call");case"InAMeeting":return n.stringTranslate("nova","me_control_presence_activity_in_a_meeting");case"Offline":case"OffWork":return n.stringTranslate("nova","me_control_presence_activity_offline");case"PresenceUnknown":default:return n.stringTranslate("nova","me_control_presence_activity_unknown");case"Presenting":return n.stringTranslate("nova","me_control_presence_activity_presenting")}},f=e=>!!e&&["Available","Busy","InAMeeting","InACall","InAConferenceCall","DoNotDisturb","Presenting","UrgentInterruptionsOnly"].includes(e),h=e=>{const n=(0,c.Cq)(),{siteVariables:i}=(0,s.L)(),t=i,{status:{backgroundImage:r,title:o,subTitle:l},ProvidedStatus:m,size:u,styles:p,userId:g,variables:N}=e,f=n.stringTranslate("messaging",o),h={id:`presence-pill-${g}`,title:l?`${f}, ${n.stringTranslate("messaging",l)}`:f,style:{backgroundImage:`url('${r}')`,backgroundColor:t.colorScheme.default.background},styles:p,size:u,variables:N},v=k[o]||"presence";return m?(0,a.t)(m,{...h,"data-tid":"presence","data-pstatus":v}):(0,a.t)(d.q,{...h,"data-tid":"presence","data-pstatus":v})};var v=i(588592),T=i(681971),M=i(867840);const y={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"ComponentsPresenceLegacySubscription"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"source"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PresenceSource"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"presenceUpdateEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}},{kind:"Argument",name:{kind:"Name",value:"source"},value:{kind:"Variable",name:{kind:"Name",value:"source"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"userPresenceData"}}]}}]}},...i(550214).O.definitions]};var S=i(309501),A=i(629494),I=i(683184);const b={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"blockedContactChangedEvent"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"userId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"blockedContactChangedEvent"},arguments:[{kind:"Argument",name:{kind:"Name",value:"userId"},value:{kind:"Variable",name:{kind:"Name",value:"userId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"isBlocked"}}]}}]}}]};var C=i(470453),D=i(121375);const F={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ComponentsPresenceFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Presence"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"availability"}},{kind:"Field",name:{kind:"Name",value:"activity"}},{kind:"Field",name:{kind:"Name",value:"isOutOfOffice"}},{kind:"Field",name:{kind:"Name",value:"statusNote"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"message"}},{kind:"Field",name:{kind:"Name",value:"publishTime"}},{kind:"Field",name:{kind:"Name",value:"expiry"}}]}},{kind:"Field",name:{kind:"Name",value:"flwPresence"}},{kind:"Field",name:{kind:"Name",value:"flwShifts"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"previousShift"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teamId"}},{kind:"Field",name:{kind:"Name",value:"teamName"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"scheduleGroupDisplayName"}},{kind:"Field",name:{kind:"Name",value:"teamOlsonCode"}}]}},{kind:"Field",name:{kind:"Name",value:"currentShift"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teamId"}},{kind:"Field",name:{kind:"Name",value:"teamName"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"scheduleGroupDisplayName"}},{kind:"Field",name:{kind:"Name",value:"teamOlsonCode"}}]}},{kind:"Field",name:{kind:"Name",value:"nextShift"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teamId"}},{kind:"Field",name:{kind:"Name",value:"teamName"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"scheduleGroupDisplayName"}},{kind:"Field",name:{kind:"Name",value:"teamOlsonCode"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"isFocus"}},{kind:"Field",name:{kind:"Name",value:"workLocation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"location"}},{kind:"Field",name:{kind:"Name",value:"locationSource"}},{kind:"Field",name:{kind:"Name",value:"approximateDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"idType"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"isBlocked"}},{kind:"Field",name:{kind:"Name",value:"isDisabled"}}]}}]};var U=i(43191);const E={backgroundImage:m.F.Unknown,title:"status_unknown"},w={backgroundImage:m.F.Blocked,title:"status_blocked"},L=(e,n)=>{const i=x(e);if(!n)return i;const a=((e,n,i,a,t)=>a&&!f(e)?t.stringTranslate("nova","me_control_presence_out_of_office"):a&&f(e)?t.stringTranslate("nova","me_control_presence_activity_with_out_of_office",{activity:N(e,t)}):i&&"DoNotDisturb"===n&&"Presenting"!==e?t.stringTranslate("nova","me_control_presence_activity_focusing"):N(e,t))(e?.activity??null,e?.availability??null,e?.isFocus??null,e?.isOutOfOffice??null,n);return{...i,ariaLabel:a}},x=e=>{if(!e)return E;const{isOutOfOffice:n,flwPresence:i,isFocus:a}=e;if(O(e)){const{isBlocked:n,isDisabled:i}=e;if(i)return p[u];if(n)return w}const t=e.activity,r=e.availability;if(!i||"None"===i)return a&&("DoNotDisturb"===t||!t&&"DoNotDisturb"===r)?(e=>{const n="status_focusing";return e?{backgroundImage:m.F.FocusingOof,title:n,subTitle:"out_of_office_title"}:{backgroundImage:m.F.Focusing,title:n}})(n):n?((e,n)=>{const i=e?g[e]:g[n],a="out_of_office_title";return i?{...i,subTitle:a}:{backgroundImage:m.F.OutOfOffice,title:a}})(t,r):t?p[t]:p[r];if("OffShift"===i)return p.OffShift;if(!t)return"Busy"===r?p[r]:p.OnShift;switch(t){case"InAConferenceCall":case"InACall":case"InAMeeting":case"Presenting":case"Busy":return p[t];default:return p.OnShift}},O=e=>!!e&&("isBlocked"in e||"isDisabled"in e),j=(e,n)=>{const i=(0,r.x)(),a=(0,c.Cq)(),t=(0,C.WD)(v.nh.POST_CRITICAL),{data:l}=(0,o.m)(M.z,{variables:{userId:e,source:n},skip:!t}),{setUserPresence:s}=(0,U.N)(),d=l?.presenceUpdateEvent??((e,n)=>{try{return e.readFragment({id:`Presence:${n}`,fragment:F})??void 0}catch(e){return}})(i,e);s(d);return L(d,a)},V=(e,n)=>{const{isSideLoadingInteractionEnabled:i}=(0,A.NC)(I.J.Extensibility,["isSideLoadingInteractionEnabled"]),a=e.startsWith(S.at.BotPrefix),t=e.substr(S.at.BotPrefix.length),{data:r}=(0,l.a)(D.r,{variables:{options:{botId:t}},skip:!a||Boolean(i)}),s=0===r?.appDefinitions?.length,{data:d}=(0,o.m)(y,{variables:{userId:e,source:n},skip:a}),{data:c}=(0,o.m)(b,{variables:{userId:e},skip:a});if(a)return s?p[u]:p.Available;if(c?.blockedContactChangedEvent?.isBlocked)return w;return L(d?.presenceUpdateEvent)},z=(e,n)=>{const{enableUsePresenceV2:i}=(0,A.NC)(I.J.Presence,["enableUsePresenceV2"]);return(e=>e?j:V)(t.useRef(!!i).current)(e,n)},P=(e,n)=>{const i=z(e,n),a=(e=>{const{title:n,backgroundImage:i}=e,a={status:"unknown",outOfOffice:!1};switch(n){case"status_online":a.status="available";break;case"status_busy":case"status_inAMeeting":case"status_inACall":a.status="busy";break;case"status_presenting":case"status_doNotDisturb":case"status_focusing":a.status="do-not-disturb";break;case"status_away":case"status_beRightBack":a.status="away";break;case"status_offline":a.status="offline";break;case"out_of_office_title":a.status="out-of-office";break;case"status_blocked":case"status_disabled":a.status="blocked";break;default:a.status="unknown"}switch(i){case m.F.OutOfOffice:case m.F.OnThePhoneOof:case m.F.DoNotDisturbOof:case m.F.BusyOof:case m.F.OnlineOof:a.outOfOffice=!0}return a})(i);return a.id=`presence-pill-${e}`,a["aria-label"]=i.ariaLabel,a},R=(e,n,i,a)=>!(!e||i&&i===a||"status_unknown"!==n.title&&"status_offline"!==n.title),B=e=>{const{userId:n,presenceSource:i}=e,{enableHideOfflinePresenceInTFL:t}=(0,A.NC)(I.J.Presence,["enableHideOfflinePresenceInTFL"]),{user:r}=(0,T.SE)(),o=z(n||"",i||"ups"),{ProvidedStatus:l,...s}=e;return R(!!t,o,n,r?.id)?null:(0,a.t)(h,{status:{backgroundImage:o.backgroundImage,title:o.title,subTitle:o.subTitle},ProvidedStatus:l,userId:n||"",...s})},Q=e=>(0,C.WD)(v.nh.POST_CRITICAL)?(0,a.t)(B,{...e}):null},930427:(e,n,i)=>{"use strict";i.d(n,{F:()=>C});var a=i(333239),t=i.n(a),r=i(508776),o=i.n(r),l=i(191628),s=i.n(l),d=i(121982),c=i.n(d),m=i(156354),u=i.n(m),p=i(17826),k=i.n(p),g=i(822585),N=i.n(g),f=i(855573),h=i.n(f),v=i(144238),T=i.n(v),M=i(152937),y=i.n(M),S=i(764859),A=i.n(S),I=i(88077),b=i.n(I);const C={Online:t(),OnShift:t(),DoNotDisturb:o(),Focusing:o(),Busy:s(),OnThePhone:s(),Away:c(),Idle:c(),BeRightBack:c(),Offline:u(),OffShift:u(),OutOfOffice:k(),Unknown:N(),OnlineOof:h(),BusyOof:T(),OnThePhoneOof:T(),DoNotDisturbOof:y(),FocusingOof:y(),Disabled:A(),Blocked:b()}},43191:(e,n,i)=>{"use strict";i.d(n,{z:()=>o,N:()=>l});var a=i(250033),t=i(818319);const r=t.createContext({userPresence:void 0,setUserPresence:()=>{}}),o=({children:e})=>{const[n,i]=t.useState();return(0,a.t)(r.Provider,{value:{userPresence:n,setUserPresence:i},children:e})},l=()=>t.useContext(r)},808054:(e,n,i)=>{"use strict";i.d(n,{hW:()=>y,WX:()=>S,Et:()=>I,bC:()=>b,nS:()=>C,Xx:()=>D,Fc:()=>U,t1:()=>E,v2:()=>w,Gk:()=>L,wx:()=>x,Dt:()=>O});var a=i(250033),t=i(818319),r=i(88202),o=i(67081),l=i(841763),s=i(59083),d=i(461381),c=i(242111),m=i(681971),u=i(848476),p=i(588641),k=i(100113);const{createContext:g,memo:N,useContext:f,useMemo:h,useState:v}=t,T={minHeightBreakpoint:p.Ai.IS_GREATER_THAN_0,minWidthBreakpoint:p.Rd.IS_GREATER_THAN_0,minHeightViewportBreakpoint:p.Ai.IS_GREATER_THAN_0,minWidthViewportBreakpoint:p.Rd.IS_GREATER_THAN_0},M=g({responsiveBreakpoints:{...T},responsiveBreakpointsVariables:(0,k.KR)(T)}),y=(e,n)=>n?new o.y((i=>{const a=new e.ResizeObserver((([e])=>i.next(e)));return a.observe(n),()=>a.disconnect()})):r.E,S=()=>e=>e.pipe((0,l.h)((e=>e.contentRect.width>0))),A=(e,n)=>y(e,n).pipe((0,d.p)(250,void 0,{trailing:!0}),(e=>n=>n.pipe(S(),(0,s.U)((n=>(0,k.RB)({height:n.contentRect.height,width:n.contentRect.width,host:e})))))(e),(0,c.x)()),I=N((({children:e,containerRef:n,initialSize:i})=>{const{host:t}=(0,m.SE)(),[r,o]=v({minHeightBreakpoint:i?.minHeightBreakpoint??p.Ai.IS_GREATER_THAN_0,minWidthBreakpoint:i?.minWidthBreakpoint??p.Rd.IS_GREATER_THAN_0,minHeightViewportBreakpoint:t.self.innerHeight??p.Ai.IS_GREATER_THAN_0,minWidthViewportBreakpoint:t.self.innerWidth??p.Rd.IS_GREATER_THAN_0}),l=h((()=>{const e=(0,k.KR)(r);return{responsiveBreakpoints:r,responsiveBreakpointsVariables:e}}),[r]),s=n.current,d=h((()=>A(t,s)),[t,s]);return(0,u.m)(d,{next:o},!0),(0,a.t)(M.Provider,{value:l,children:e})})),b=()=>f(M).responsiveBreakpoints,C=()=>{const{responsiveBreakpoints:{minHeightBreakpoint:e}}=f(M);return h((()=>({minHeightBreakpoint:e})),[e])},D=()=>{const{responsiveBreakpoints:{minWidthBreakpoint:e}}=f(M);return h((()=>({minWidthBreakpoint:e})),[e])},F=({children:e})=>(0,a.t)(M.Consumer,{children:n=>e(n)}),U=e=>n=>(0,a.t)(F,{children:i=>(0,a.t)(e,{...{...n,...i}})}),E=()=>f(M).responsiveBreakpointsVariables,w=e=>{let n=C();return n=e||n,h((()=>(0,k.iA)(n)),[n])},L=e=>{let n=(()=>{const{responsiveBreakpoints:{minHeightViewportBreakpoint:e}}=f(M);return h((()=>({minHeightViewportBreakpoint:e})),[e])})();return n=e||n,h((()=>(0,k.jH)(n)),[n])},x=e=>{let n=D();return n=e||n,h((()=>(0,k.nf)(n)),[n])},O=e=>{let n=(()=>{const{responsiveBreakpoints:{minWidthViewportBreakpoint:e}}=f(M);return h((()=>({minWidthViewportBreakpoint:e})),[e])})();return n=e||n,h((()=>(0,k.q0)(n)),[n])}},298456:(e,n,i)=>{"use strict";i.d(n,{r:()=>d});var a=i(818319),t=i(607074),r=i(812819),o=i(895007),l=i(21572);const s=(0,i(696618).s)({root:{oivjwe:"f1h8hb77",dvvfom:"f1x7u7e9",w71qe1:"f13mvf36",Bkioxbp:"f1cmlufx",C4gs1y:"f10aw75t",Beapcnx:"fsle3fq",Jkg3mj:"f17ae5zn"},subtle:{C4gs1y:"f18y0hww",Beapcnx:"f8r86f8"},inline:{dvvfom:"f1lqvz6u"},inlineSubtle:{dvvfom:"f1842k2q"},disabled:{dvvfom:"f1x7u7e9",C4gs1y:"f1y8dcps",Beapcnx:"f16x84av"}},{d:[".f1h8hb77{border-bottom-style:none;}",".f1x7u7e9{text-decoration-color:transparent;}",".f13mvf36{text-decoration-line:underline;}",".f1cmlufx{text-decoration-thickness:var(--strokeWidthThin);}",".f1lqvz6u{text-decoration-color:var(--colorBrandForegroundLink);}",".f1842k2q{text-decoration-color:var(--colorNeutralForeground2);}"],h:[".f10aw75t:hover{text-decoration-color:var(--colorBrandForegroundLinkHover);}",".f18y0hww:hover{text-decoration-color:var(--colorNeutralForeground2Hover);}",".f1y8dcps:hover{text-decoration-color:transparent;}"],a:[".fsle3fq:active{text-decoration-color:var(--colorBrandForegroundLinkPressed);}",".f8r86f8:active{text-decoration-color:var(--colorNeutralForeground2Pressed);}",".f16x84av:active{text-decoration-color:transparent;}"],i:[".f17ae5zn:focus-visible{text-decoration-color:var(--colorBrandForegroundLink);}"]}),d=a.forwardRef(((e,n)=>{const i=(0,t.h)(e,n);i.root.dir="string"==typeof e.children?"auto":void 0,(0,r.U)(i);const{appearance:a,disabled:d,inline:c}=i,m=s();return i.root.className=(0,o.z)(i.root.className,m.root,"subtle"===a&&m.subtle,c&&m.inline,"subtle"===a&&c&&m.inlineSubtle,d&&m.disabled,e.className),(0,l.t)(i)}))},836410:(e,n,i)=>{"use strict";i.d(n,{U9:()=>u,wY:()=>k});var a=i(250033),t=i(818319),r=i(215938),o=i(56725),l=i(877445),s=i(803238),d=i(681971),c=i(42678);const m="333ms";var u;!function(e){e[e.Fail=0]="Fail",e[e.Loading=1]="Loading",e[e.Succeed=2]="Succeed"}(u||(u={}));class p extends t.PureComponent{constructor(){super(...arguments),this._loaderImage=null,this.state={...this._getInitialState(this.props)},this._getImageComponent=e=>{const{fixedAspectRatio:n,variables:i,isInlineImageWrapper:t,isImageInlineOrAttached:l,dataImageMode:s}=this.props,{maxHeight:d,maxWidth:c}=this.state,u=this._shouldShowImage(),p=this._shouldAddPlaceholder();return(0,a.t)(r.k,{as:"span",itemType:s,style:{...!l&&{maxHeight:n?`${d}rem`:void 0,maxWidth:`${c}rem`}},variables:{...i,hasFixedAspectRatio:n,isRelativePositioned:p,isInlineImageWrapper:t},children:[(0,a.t)(o.f,{visible:u,name:"fadeInInPlace",duration:m,iterationCount:"1",fillMode:"forwards",children:e}),this._getImagePlaceholder()]})},this._getHeightsAndWidths=()=>{const{width:e,height:n}=this.props;let i,a=20;if(e&&n){const t=this._getMaxHeightAndMaxWidth(n,e);a=t.maxHeight,i=t.maxWidth}return{height:n,maxHeight:a,maxWidth:i,width:e}},this._getImagePlaceholder=()=>{const{placeholder:e,preLoadState:n}=this.props,{loadState:i}=this.state;if(e&&this._shouldAddPlaceholder())return i===u.Fail||n===u.Fail?e.failureCbElem:e.loadingCbElem},this._loadImageEventListener=()=>{this.props.scenarioHandler&&this.props.scenarioHandler(u.Succeed),this.setState({src:this.props.src,loadState:u.Succeed})},this._errorImageEventListener=()=>{this.props.scenarioHandler&&this.props.scenarioHandler(u.Fail),this.setState({src:this.props.src,loadState:u.Fail})},this._lazyLoadImage=()=>{const{host:{Image:e}}=this.props;this._loaderImage=new e,this._loaderImage.addEventListener("load",this._loadImageEventListener,{once:!0}),this._loaderImage.addEventListener("error",this._errorImageEventListener,{once:!0}),this._loaderImage.src=this.props.src},this._shouldShowImage=()=>{const{preLoadState:e}=this.props,{loadState:n}=this.state;return e===u.Succeed||n===u.Succeed},this._shouldAddPlaceholder=()=>{const{placeholder:e}=this.props;return!this._shouldShowImage()&&!!e}}componentDidMount(){(0,s.isEmpty)(this.props.src)||this._lazyLoadImage()}componentWillUnmount(){this._loaderImage?.removeEventListener("load",this._loadImageEventListener),this._loaderImage?.removeEventListener("error",this._errorImageEventListener)}componentDidUpdate(e,n){const{src:i,preLoadState:a,scenarioHandler:t}=this.props,{loadState:r}=this.state;a===u.Succeed&&this.setState({src:i});const o=a===u.Fail||r===u.Fail;if(e.src===i||o)o&&t&&t(u.Fail);else{const{height:e,maxHeight:n,maxWidth:i,width:a}=this._getHeightsAndWidths();this._lazyLoadImage(),this.setState({height:e,loadState:u.Loading,maxHeight:n,maxWidth:i,width:a})}}render(){const{alt:e,as:n,fixedAspectRatio:i,height:t,id:s,itemType:d,placeholder:u,preLoadState:p,scenarioHandler:k,src:g,styles:N,variables:f,width:h,host:v,isInlineImageWrapper:T,isImageInlineOrAttached:M,isMosaicIcon:y,dataImageMode:S,...A}=this.props,{height:I,maxHeight:b,maxWidth:C,src:D,width:F,loadState:U}=this.state,E=`lazy-image-${U}`,w=this._shouldShowImage();let L;const x=this._shouldAddPlaceholder();if(F&&I){let t=c.Bo.NONE;return M&&(t=(0,c.Zn)(F,I)),L=(0,a.t)(l.E,{as:n,"data-tid":E,alt:e,className:"ui-known-width-and-height",id:s,itemType:d,"data-image-type":t,"data-image-mode":S,src:i?"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7":D,style:{...!M&&{maxHeight:`${b}rem`,maxWidth:`${C}rem`},...i&&{backgroundImage:`url("${D}")`}},styles:{...i?{backgroundPosition:"center",backgroundSize:"cover",height:"100%",width:"100%"}:N,...y&&{padding:0}},variables:{...f,hasKnownWidthAndHeight:!0,isImageInlineOrAttached:M},...A}),this._getImageComponent(L)}return i?(L=(0,a.t)(l.E,{as:n,"data-tid":E,alt:e,id:s,itemType:d,src:D,className:"ui-unknown-width-or-height","data-image-type":M?c.Bo.STANDARD:null,"data-image-mode":S,style:{...i&&{backgroundImage:`url("${D}")`}},variables:{...f,responsiveImageUnknownHeightAndWidth:!0},...A}),this._getImageComponent(L)):(0,a.t)(r.k,{as:"span",variables:{...f,isRelativePositioned:x},children:[(0,a.t)(o.f,{visible:w,name:"fadeInInPlace",duration:m,iterationCount:"1",fillMode:"forwards",children:(0,a.t)(l.E,{as:n,"data-tid":E,"aria-label":e,className:"ui-unknown-width-or-height","data-image-type":M?c.Bo.STANDARD:null,"data-image-mode":S,id:s,itemType:d,role:"img",style:{backgroundImage:`url("${D}")`,...!M&&{paddingTop:`${b}rem`}},styles:{...N,...M&&{backgroundSize:"cover"}},variables:{...f,hasUnknownWidthOrHeight:!0},...A})}),this._getImagePlaceholder()]})}_getInitialState(e){const{width:n,height:i,isVideoThumbnail:a,preLoadState:t}=e,r=t===u.Succeed;let o,l,s=20;if(n&&i){const e=this._getMaxHeightAndMaxWidth(i,n,a);s=e.maxHeight,o=e.maxWidth,l=`0 0 ${n} ${i}`}else l=`0 0 1 ${s}`;return{height:i,maxHeight:s,maxWidth:o,src:r?e.src:`data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="${l}"%3E%3C/svg%3E`,width:n,loadState:r?u.Succeed:u.Loading}}_getMaxHeightAndMaxWidth(e,n,i){const a=n/e;let t=e/10,r=n/10>62?62:n/10;return(t>48||a<.5)&&(i||(t=48),r=a*t),{maxHeight:t,maxWidth:r}}}const k=e=>{const{host:n}=(0,d.SE)();return(0,a.t)(p,{...e,host:n})}},208460:(e,n,i)=>{"use strict";i.d(n,{G:()=>c});var a=i(250033),t=i(818319),r=i(516035),o=i(629494),l=i(683184),s=i(33549);const d=({children:e})=>{const{disallowAppRegionOverrides:n}=(0,o.NC)(l.J.Core,["disallowAppRegionOverrides"]);return(0,a.t)(t.Fragment,{children:e({disallowAppRegionOverrides:!!n})})},c=e=>{const{UNSAFE_overflowAndFlipBoundaryRef:n}=(0,s.pl)(),{disableOverflowAndFlipBoundaryContext:i,...t}=e,l=i?{}:{flipBoundary:n?.current||"window",overflowBoundary:n?.current||"window"};o.NC._isMockFunction;return(0,a.t)(d,{children:({disallowAppRegionOverrides:e})=>(e&&(t.content={...t.content,variables:{...t.content?.variables,disallowAppRegionOverrides:e}}),(0,a.t)(r.G,{...t,...l}))})}},479509:(e,n,i)=>{"use strict";i.d(n,{J:()=>l});var a=i(250033),t=i(818319),r=i(808054),o=i(836410);const l=e=>{const n=(0,r.t1)(),{variables:i}=e,l=t.useMemo((()=>({...i,...n})),[n,i]);return(0,a.t)(o.wY,{...e,variables:l})}},121982:(e,n,i)=>{e.exports=i.p+"133bf0a0b104ec3dfc5b9ab207e54873.svg"},88077:(e,n,i)=>{e.exports=i.p+"c52bdfa460d7b878541ff0d9833e3c7b.svg"},191628:(e,n,i)=>{e.exports=i.p+"93bf1cc8b8b8092aab2c385d85d22c8d.svg"},144238:(e,n,i)=>{e.exports=i.p+"79f07ba26ed583574678b31546848509.svg"},764859:(e,n,i)=>{e.exports=i.p+"33c8b3e3c8d71273ed9abc4d1bec9bcc.svg"},508776:(e,n,i)=>{e.exports=i.p+"5d07fdf28991f39897b8734021141a6f.svg"},152937:(e,n,i)=>{e.exports=i.p+"0d10d16cedc7b8262d0863ae455bb683.svg"},156354:(e,n,i)=>{e.exports=i.p+"774888c01ebff051c2cad178c17079b3.svg"},333239:(e,n,i)=>{e.exports=i.p+"36fd037c0c6525c9044c5c8ef757c740.svg"},855573:(e,n,i)=>{e.exports=i.p+"5066e146579e847ea9f2d818aab586bb.svg"},17826:(e,n,i)=>{e.exports=i.p+"7aa4c2455abe8a0c8cfa1e8e4b93494c.svg"},822585:(e,n,i)=>{e.exports=i.p+"e0420569cdac40ed7e659a1dae697de8.svg"},555128:(e,n,i)=>{"use strict";i.d(n,{$K:()=>a,Nw:()=>t,CN:()=>r});const a="corelayout",t={closeMonitor:"closeMonitor",collapseHeader:"collapseHeader",defaultCommand:"defaultCommand",expandHeader:"expandHeader",expandTab:"expandTab",updateDialogState:"updateDialogState",hideHeader:"hideHeader",hideMonitor:"hideMonitor",maximizeTab:"maximizeTab",openCoreDialog:"openCoreDialog",resetLayoutOverrides:"resetLayoutOverrides",showMonitor:"showMonitor",showOopsPage:"showOopsPage",unhideHeader:"unhideHeader",unhideMonitor:"unhideMonitor"},r={collapseHeader:()=>({actor:a,action:t.collapseHeader}),expandHeader:()=>({actor:a,action:t.expandHeader}),hideHeader:()=>({actor:a,action:t.hideHeader}),unhideHeader:()=>({actor:a,action:t.unhideHeader}),defaultCommand:e=>({actor:a,action:t.defaultCommand,data:e}),expandTab:e=>({actor:a,action:t.expandTab,data:e}),maximizeTab:()=>({actor:a,action:t.maximizeTab}),closeMonitor:()=>({actor:a,action:t.closeMonitor}),hideMonitor:()=>({actor:a,action:t.hideMonitor}),updateDialogState:e=>({actor:a,action:t.updateDialogState,data:e}),openCoreDialog:e=>({actor:a,action:t.openCoreDialog,data:e}),showMonitor:e=>({actor:a,action:t.showMonitor,data:e}),unhideMonitor:()=>({actor:a,action:t.unhideMonitor}),showOopsPage:e=>({actor:a,action:t.showOopsPage,data:e}),resetLayoutOverrides:()=>({actor:a,action:t.resetLayoutOverrides})}},714138:(e,n,i)=>{"use strict";i.d(n,{Zb:()=>a});i(803238);const a={chat:0,channel:0}},447567:(e,n,i)=>{"use strict";i.d(n,{m:()=>a});const a={Chat:"Chat",EduEmptyState:"EduEmptyState",Meeting:"Meeting",Channel:"Channel",ChannelMeeting:"ChannelMeeting",PrivateMeetingSchedulingForm:"PrivateMeetingSchedulingForm",ChannelMeetingSchedulingForm:"ChannelMeetingSchedulingForm",SingleTeamGridView:"SingleTeamGridView",MeetingChat:"MeetingChat",SelectAppEntity:"SelectAppEntity",ChatMakeAsATab:"ChatMakeAsATab",ChannelMakeAsATab:"ChannelMakeAsATab"}},469483:(e,n,i)=>{"use strict";var a,t,r;i.d(n,{gV:()=>a,XY:()=>t,Jc:()=>r,Ae:()=>o}),function(e){e[e.Card=0]="Card",e[e.MessageExtension=1]="MessageExtension",e[e.PlatformExtensionTab=2]="PlatformExtensionTab",e[e.DeepLink=3]="DeepLink",e[e.ShareToOutlook=4]="ShareToOutlook",e[e.ContentBubble=5]="ContentBubble",e[e.AdaptiveCardTab=6]="AdaptiveCardTab",e[e.BotConfig=7]="BotConfig",e[e.StoreApp=8]="StoreApp",e[e.Workflows=9]="Workflows",e[e.VirtualEvent=10]="VirtualEvent"}(a||(a={})),function(e){e.contentBubble="contentBubble",e.targetedMeetingNotification="targetedMeetingNotification"}(t||(t={})),function(e){e.Small="small",e.Medium="medium",e.Large="large"}(r||(r={}));const o={message:"message",compose:"compose",commandBox:"commandBox",copilot:"copilot",thirdParty:"thirdParty"}},400966:(e,n,i)=>{"use strict";var a;i.d(n,{p:()=>a}),function(e){e[e.chat=0]="chat",e[e.channel=1]="channel",e[e.tab=2]="tab",e[e.powerbar=3]="powerbar"}(a||(a={}))},90934:(e,n,i)=>{"use strict";var a,t,r;i.d(n,{dB:()=>a,em:()=>t,Fi:()=>r}),function(e){e.Bot="Bot",e.Connector="Connector",e.MessagingExtension="MessagingExtension",e.Tab="Tab"}(a||(a={})),function(e){e.None="None",e.Files="Files",e.Links="Links",e.Location="Location",e.People="People",e.PinnedMessages="PinnedMessages",e.Photos="Photos",e.Pinned="Pinned",e.Search="Search",e.Tasks="Tasks",e.TimeZone="TimeZone",e.Highlights="Highlights"}(t||(t={})),function(e){e.ORG="org",e.PROJECT="project"}(r||(r={}))},12978:(e,n,i)=>{"use strict";i.d(n,{uk:()=>a,py:()=>t,$z:()=>r});const a={config:"config",confirm:"confirm",create:"create",default:"default",delete:"delete",empty:"empty",error:"error",health:"health",info:"info",infoDetails:"infoDetails",join:"join",leave:"leave",list:"list",loading:"loading",locationhandler:"locationhandler",manage:"manage",mutate:"mutate",pin:"pin",share:"share",signin:"signin",tenantLogin:"tenantLogin",tenantRedemption:"tenantRedemption",update:"update",view:"view"},t={acceptsharedchannelinvitationdialog:"acceptsharedchannelinvitationdialog",accessibilitypanel:"accessibilitypanel",accounts:"accounts",accountselectiondialog:"accountselectiondialog",activity:"activity",activityinapptoastundo:"activityinapptoastundo",activityslices:"activityslices",activityslicecontent:"activityslicecontent",addchannel:"addchannel",addcontactdialog:"addcontactdialog",addmember:"addmember",addmembernewteam:"addmembernewteam",addmembertoprivatechanneldialog:"addmembertoprivatechanneldialog",addmembertoteamdialog:"addmembertoteamdialog",addphonelinkdialog:"addphonelinkdialog",agendapage:"agendapage",alttext:"alttext",appswitcherdesktopactivecalldialog:"appswitcherdesktopactivecalldialog",appswitchert1downloaddialog:"appswitchert1downloaddialog",appswitcherwebactivecalldialog:"appswitcherwebactivecalldialog",appswitcherwebmultipletabsdialog:"appswitcherwebmultipletabsdialog",archiveteam:"archiveteam",attendancereport:"attendancereport",annotation:"annotation",appdetails:"appdetails",attendeeview:"attendeeview",audiosettings:"audiosettings",authaccounttransfer:"authaccounttransfer",authrefreshdialog:"authrefreshdialog",autobrbconfirmationdialog:"autobrbconfirmationdialog",autobrbflowdialog:"autobrbflowdialog",autoinstallnotification:"autoinstallnotification",bannerNotification:"bannerNotification",blank:"blank",blockChat:"blockChat",brbfeedbackdialog:"brbfeedbackdialog",breakoutrooms:"breakoutrooms",breakoutroomsassignment:"breakoutroomsassignment",breakoutroomsassignmenttype:"breakoutroomsassignmenttype",breakoutroomscreaterooms:"breakoutroomscreaterooms",breakoutroomsdeleteroom:"breakoutroomsdeleteroom",breakoutroomsdeleterooms:"breakoutroomsdeleterooms",breakoutroomseditroom:"breakoutroomseditroom",breakoutroomssettings:"breakoutroomssettings",breakoutroomspanel:"breakoutroomspanel",broadcastfeedback:"broadcastfeedback",broadcastliveevent:"broadcastliveevent",broadcastqna:"broadcastqna",broadcasts:"broadcasts",broadcastwebjoinnotsupporteddialog:"broadcastwebjoinnotsupporteddialog",byodattendeewindow:"byodattendeewindow",byodchat:"byodchat",byodroster:"byodroster",calendar:"calendar",callablechannels:"callablechannels",callhistoryrow:"callhistoryrow",callingconfirmdialog:"callingconfirmdialog",callingalertdialog:"callingalertdialog",callingbannernotification:"callingbannernotification",callingdeeplink:"callingdeeplink",callingdeeplinkDialog:"callingdeeplinkDialog",callingdialog:"callingdialog",callingprotocoldeeplinkdialog:"callingprotocoldeeplinkdialog",calls:"calls",callscontent:"callscontent",callsgallery:"callsgallery",callsgalleryandcontent:"callsgalleryandcontent",callskeypad:"callskeypad",callsmain:"callsmain",callsmonitor:"callsmonitor",callstransfer:"callstransfer",cameraeffects:"cameraeffects",cast:"cast",changeteampicture:"changeteampicture",channelcalendar:"channelcalendar",channelconnectors:"channelconnectors",channelcopilot:"channelcopilot",channelworkflows:"channelworkflows",channeldeeplink:"channeldeeplink",channeldelete:"channeldelete",channeledit:"channeledit",channelemail:"channelemail",channelemailerror:"channelemailerror",channelemailv2:"channelemailv2",channelinvitations:"channelinvitations",channelanalytics:"channelanalytics",channelapps:"channelapps",channelmanage:"channelmanage",channelmembers:"channelmembers",channelmoderators:"channelmoderators",channelsettings:"channelsettings",channeltags:"channeltags",channelnotificationsettings:"channelnotificationsettings",channelroster:"channelroster",channels:"channels",channelsPinnedPost:"channelsPinnedPost",channelsSystemMessage:"channelsSystemMessage",channelcontextualsearch:"channelcontextualsearch",channeljoindialog:"channeljoindialog",chats:"chats",chatthread:"chatthread",chatworkflows:"chatworkflows",chatschannelconv:"chatschannelconv",chatContextualSearch:"chatContextualSearch",chatcopilotsynthesis:"chatcopilotsynthesis",chatfilesdetails:"chatfilesdetails",chatfluidthread:"chatfluidthread",chatHighlightsDetails:"chatHighlightsDetails",chatInviteConfirmation:"chatInviteConfirmation",chatManageApps:"chatManageApps",chatmaxmultiplepinnedmessages:"chatmaxmultiplepinnedmessages",chatpeopledetails:"chatpeopledetails",chatpinnedmessagesdetails:"chatpinnedmessagesdetails",chatsInfo:"chatsInfo",chatsInfoView:"chatsInfoView",closedcaptionsflyout:"closedcaptionsflyout",closedcaptionssettings:"closedcaptionssettings",cloudStorageDialog:"cloudStorageDialog",classesintegrationcontent:"classesintegrationcontent",coachreport:"coachreport",connectedcalendardialog:"connectedcalendardialog",connectedcalendarsurfacedialog:"connectedcalendarsurfacedialog",codesnippet:"codesnippet",communities:"communities",communitiesaddmember:"communitiesaddmember",communitiesblockmembers:"communitiesblockmembers",communitiesevents:"communitiesevents",communitiesexplore:"communitiesexplore",communitiescreatechannel:"communitiescreatechannel",communitiesdeletechannel:"communitiesdeletechannel",communitiescreateevent:"communitiescreateevent",communitieseditchannel:"communitieseditchannel",communitiesdelete:"communitiesdelete",communitiesgallery:"communitiesgallery",communitiesguidelinesdialog:"communitiesguidelinesdialog",communitiesjoinrequest:"communitiesjoinrequest",communitiesmembers:"communitiesmembers",communitiesnickname:"communitiesnickname",communitiesgetappdialog:"communitiesgetappdialog",communitiescreatedialog:"communitiescreatedialog",communitieseditdialog:"communitieseditdialog",communitiesonboarding:"communitiesonboarding",communitiesjoininviteview:"communitiesjoininviteview",communitiesremovemember:"communitiesremovemember",communitiesreplychain:"communitiesreplychain",communitiescopilot:"communitiescopilot",communitiessendpostasemaildialog:"communitiessendpostasemaildialog",communitiessettings:"communitiessettings",communitieswelcomebotconfigdialog:"communitieswelcomebotconfigdialog",connectorinstanceconfiguration:"connectorinstanceconfiguration",contactssync:"contactssync",contentcamerasetup:"contentcamerasetup",copilot:"copilot",coursecalendar:"coursecalendar",courseteams:"courseteams",createchanneldialog:"createchanneldialog",createchannelleftraildialog:"createchannelleftraildialog",crosspostchannelselectiondialog:"crosspostchannelselectiondialog",crosspostchannelselectiondialogV2:"crosspostchannelselectiondialogV2",crosspostdeletedialog:"crosspostdeletedialog",crossteamanalytics:"crossteamanalytics",customapp:"customapp",customizereactions:"customizereactions",customemojiupload:"customemojiupload",default:"default",defaultchannelnavdialog:"defaultchannelnavdialog",deletechannelreactdialog:"deletechannelreactdialog",showhidegeneralchannelwarningdialog:"showhidegeneralchannelwarningdialog",deletechat:"deletechat",deleteteam:"deleteteam",deleteActivityFeedItem:"deleteActivityFeedItem",devicedetails:"devicedetails",devicesettings:"devicesettings",discoversurface:"discoversurface",discoversurfacesettings:"discoversurfacesettings",dlp:"dlp",discoverappsnotifications:"discoverappsnotifications",eduteamcreate:"eduteamcreate",email:"email",enableappdialog:"enableappdialog",esp:"esp",error:"error",events:"events",eventsbroadcastqna:"eventsbroadcastqna",example:"example",exploratorylicense:"exploratorylicense",exploratorylicensenotificationbanner:"exploratorylicensenotificationbanner",extensions:"extensions",externalnavigation:"externalnavigation",faceenrollment:"faceenrollment",featurecommunityapplicationdialog:"featurecommunityapplicationdialog",file:"file",filepicker:"filepicker",fileopensettings:"fileopensettings",filesoneupviewer:"filesoneupviewer",floatingmonitor:"floatingmonitor",floatingufd:"floatingufd",floodgate:"floodgate",fluid:"fluid",flyout:"flyout",flyoutphonelink:"flyoutphonelink",flyoutwhatsnew:"flyoutwhatsnew",framework:"framework",freemiumupgrade:"freemiumupgrade",gallery:"gallery",galleryImages:"galleryImages",getlinktoteamorchanneldialog:"getlinktoteamorchanneldialog",giphyconsent:"giphyconsent",givefeedbackchoices:"givefeedbackchoices",guardians:"guardians",guardiansapprovalrequest:"guardiansapprovalrequest",guardianssendapprovalerror:"guardianssendapprovalerror",guardianssendapprovalsuccess:"guardianssendapprovalsuccess",help:"help",holisticrecap:"holisticrecap",homepage:"homepage",hostedflyout:"hostedflyout",hostedincontextstore:"hostedincontextstore",hybridplaceholder:"hybridplaceholder",hyperlink:"hyperlink",identity:"identity",identitydialog:"identitydialog",inAppToast:"inAppToast",incontextstore:"incontextstore",invisionwhiteboard:"invisionwhiteboard",invitecoworkers:"invitecoworkers",joinlinkdialog:"joinlinkdialog",leavechanneldialog:"leavechanneldialog",leavechannellastownerdialog:"leavechannellastownerdialog",leavechat:"leavechat",leavecommunity:"leavecommunity",leaveteam:"leaveteam",leaveGroupAndBlockUser:"leaveGroupAndBlockUser",licenses:"licenses",licenserequestdialog:"licenserequestdialog",linkedin:"linkedin",livepersonacard:"livepersonacard",livepersonaeditor:"livepersonaeditor",lobnotifications:"lobnotifications",locationapi:"locationapi",locationnotification:"locationnotification",locationnotificationbanner:"locationnotificationbanner",m365ChatDislike:"m365ChatDislike",m365ChatLike:"m365ChatLike",officeintegrationfredialog:"officeintegrationfredialog",onboardingnotifications:"onboardingnotifications",selectMediaApi:"selectMediaApi",selectpeoplepicker:"selectpeoplepicker",simplecollab:"simplecollab",simplecollabchats:"simplecollabchats",simplecollabchannels:"simplecollabchannels",viewImagesApi:"viewImagesApi",m365ChatReportHarm:"m365ChatReportHarm",manageapps:"manageapps",manageappswebhook:"manageappswebhook",meetingcollaboration:"meetingcollaboration",meetingcollaborationcontent:"meetingcollaborationcontent",mediastreams:"mediastreams",meetinganalytics:"meetinganalytics",meetingdetails:"meetingdetails",meetingoptionscreatedialog:"meetingoptionscreatedialog",meetingrecap:"meetingrecap",meetingrecapchiclet:"meetingrecapchiclet",meetingrecaptab:"meetingrecaptab",meetingroomallinone:"meetingroomallinone",meetingroomallinonecall:"meetingroomallinonecall",meetingroomconsolecall:"meetingroomconsolecall",meetingroomfrontofroom:"meetingroomfrontofroom",meetingroomfrontofroomcontent:"meetingroomfrontofroomcontent",meetingroomfrontofroomgallery:"meetingroomfrontofroomgallery",meet:"meet",meetingapis:"meetingapis",meetings:"meetings",meetingsettings:"meetingsettings",meetingstream:"meetingstream",meshavatar:"meshavatar",messagedraft:"messagedraft",messages:"messages",messageactionworkflows:"messageactionworkflows",messageextensionworkflows:"messageextensionworkflows",memenu:"memenu",minimodeMeetingScheduler:"minimodeMeetingScheduler",multiStepAcceptChat:"multiStepAcceptChat",notificationsettingsdefault:"notificationsettingsdefault",campaignnotifications:"campaignnotifications",updatemsaprofileavatardialog:"updatemsaprofileavatardialog",updatemsaprofilenamedialog:"updatemsaprofilenamedialog",notes:"notes",oauthcode:"oauthcode",open3sfeedback:"open3sfeedback",openfeedbackdialog:"openfeedbackdialog",optionssettingsdialog:"optionssettingsdialog",ownerleavecommunity:"ownerleavecommunity",pstncallmedialog:"pstncallmedialog",pearnotdefaultapp:"pearnotdefaultapp",percommunitynotificationsettingsdialog:"percommunitynotificationsettingsdialog",peopleapp:"peopleapp",pinnedchatsmaxreached:"pinnedchatsmaxreached",pinnedconversationitems:"pinnedconversationitems",pinunpinpost:"pinunpinpost",platformapp:"platformapp",platformsubscriptionplans:"platformsubscriptionplans",platformappdetails:"platformappdetails",platformappratingcoachmark:"platformappratingcoachmark",platformappconsent:"platformappconsent",platformappdevicepermissions:"platformappdevicepermissions",platformtab:"platformtab",platformapps:"platformapps",stagedapps:"stagedapps",platformauthconsentdialog:"platformauthconsentdialog",platformStage:"platformStage",platformstageinactivemeeting:"platformstageinactivemeeting",platformstagemodal:"platformstagemodal",platformstagewithoutchat:"platformstagewithoutchat",platformTabGallery:"platformTabGallery",prejoinoverlaydialog:"prejoinoverlaydialog",premiumtrialdialog:"premiumtrialdialog",presentdeeplinknomeetingcontextdialog:"presentdeeplinknomeetingcontextdialog",presenterchat:"presenterchat",presentertoolbar:"presentertoolbar",ptzextension:"ptzextension",queues:"queues",queueuser:"queueuser",queuesanalyticsheadertab:"queuesanalyticsheadertab",queuesanalyticsrealtimenavigationitem:"queuesanalyticsrealtimenavigationitem",queuesanalyticshistoricalnavigationitem:"queuesanalyticshistoricalnavigationitem",registration:"registration",removechannelemail:"removechannelemail",removechatuser:"removechatuser",reportConcern:"reportConcern",forwardMessage:"forwardMessage",reportconcerncommunities:"reportconcerncommunities",reportConcernForTFW:"reportConcernForTFW",restartrecomendeddialog:"restartrecomendeddialog",restorechannel:"restorechannel",restorechannelreactdialog:"restorechannelreactdialog",restoreteam:"restoreteam",roomremote:"roomremote",roster:"roster",schedulingform:"schedulingform",schoolteams:"schoolteams",hwctaskmodule:"hwctaskmodule",search:"search",settingsdialog:"settingsdialog",settingsstore:"settingsstore",settingsstorecallqueue:"settingsstorecallqueue",settingsstoredelegator:"settingsstoredelegator",sharechannelwithuserdialog:"sharechannelwithuserdialog",sharedchannelspendinginvites:"sharedchannelspendinginvites",sharedchannelacceptinvitation:"sharedchannelacceptinvitation",sharedchanneldeclineinvitation:"sharedchanneldeclineinvitation",sharedchanneldenyinvitation:"sharedchanneldenyinvitation",sharedchanneldeclinejoinrequestdialog:"sharedchanneldeclinejoinrequestdialog",sharewithteamyouowndialog:"sharewithteamyouowndialog",sharedchannelcreateinvitationsdialog:"sharedchannelcreateinvitationsdialog",sharechatlink:"sharechatlink",sharecommunitieslink:"sharecommunitieslink",embedcommunitycodedialog:"embedcommunitycodedialog",shareformdialog:"shareformdialog",shareMeetingInfo:"shareMeetingInfo",showchannelownersreactdialog:"showchannelownersreactdialog",showChannelOwners:"showChannelOwners",showformemberdialog:"showformemberdialog",showformemberdialogv2:"showformemberdialogv2",signoutdialog:"signoutdialog",signoutNoDialog:"signoutNoDialog",simplecollabcreateconversationfolder:"simplecollabcreateconversationfolder",simplecollabremoveconversationfolder:"simplecollabremoveconversationfolder",simplecollabrenameconversationfolder:"simplecollabrenameconversationfolder",simplecollabswitchbackconfirmationdialog:"simplecollabswitchbackconfirmationdialog",smartdeviceagendapage:"smartdeviceagendapage",smartdevicelogin:"smartdevicelogin",smartdevicelogoutdialog:"smartdevicelogoutdialog",stalechannelsadhocdialog:"stalechannelsadhocdialog",staleteamsdialog:"staleteamsdialog",staleteamsdismiss:"staleteamsdismiss",standaloneapp:"standaloneapp",stagecontent:"stagecontent",stagecustomizationpanel:"stagecustomizationpanel",stagingroomstartmeetingconfirmationdialog:"stagingroomstartmeetingconfirmationdialog",stopsharingchannelwithteam:"stopsharingchannelwithteam",stopsharingchannelwithteamreactdialog:"stopsharingchannelwithteamreactdialog",store:"store",storefre:"storefre",storecart:"storecart",storecartcheckout:"storecartcheckout",streamcamera:"streamcamera",streamcamerainchannels:"streamcamerainchannels",streamcameraincommunities:"streamcameraincommunities",survey:"survey",switchaccountdialog:"switchaccountdialog",tabapps:"tabapps",taskmodule:"taskmodule",teamarchive:"teamarchive",archivechannel:"archivechannel",unarchivechannel:"unarchivechannel",teamanalytics:"teamanalytics",teamchannels:"teamchannels",teamcreate:"teamcreate",teamdeeplink:"teamdeeplink",teamdiscover:"teamdiscover",teamedit:"teamedit",teamsgallery:"teamsgallery",teamjoin:"teamjoin",teamjoincode:"teamjoincode",teamjoindialog:"teamjoindialog",teamleave:"teamleave",teammanage:"teammanage",teammanageapps:"teammanageapps",teammanagetags:"teammanagetags",teampendingrequests:"teampendingrequests",teampicture:"teampicture",teamrenewal:"teamrenewal",teamrestore:"teamrestore",teams:"teams",teamseeallchannels:"teamseeallchannels",teamcreatedialog:"teamcreatedialog",teamserrordialog:"teamserrordialog",teamslist:"teamslist",teamsettings:"teamsettings",tflfre:"tflfre",thread:"thread",threadlist:"threadlist",toasts:"toasts",tpndialog:"tpndialog",transcript:"transcript",transcriptcontent:"transcriptcontent",transcripttab:"transcripttab",translationfeedback:"translationfeedback",twowaysmsfriendlyname:"twowaysmsfriendlyname",unparkcalldialog:"unparkcalldialog",unifiedconsentdialog:"unifiedconsentdialog",unsupporteddeeplinkdialog:"unsupporteddeeplinkdialog",unsupportedcollabstageerrordialog:"unsupportedcollabstageerrordialog",updatedesktopapp:"updatedesktopapp",updategroupchatavatar:"updategroupchatavatar",tfwupdategroupchatavatar:"tfwupdategroupchatavatar",usermediadialog:"usermediadialog",useronboardingteam:"useronboardingteam",videobackgrounds:"videobackgrounds",stylemyroom:"stylemyroom",vdirestartworkflow:"vdirestartworkflow",videoeffectsandavatar:"videoeffectsandavatar",videoeffectsandsettings:"videoeffectsandsettings",videoeffectscustomization:"videoeffectscustomization",videoeffectsmoreview:"videoeffectsmoreview",virtualconsumerevents:"virtualconsumerevents",virtualevents:"virtualevents",voiceenrollment:"voiceenrollment",whatsnewdialog:"whatsnewdialog",wiki:"wiki",windowingerrordialog:"windowingerrordialog",workflows:"workflows",yammerqna:"yammerqna",extensibilityapppickercallingpanel:"extensibilityapppickercallingpanel",channelextensibilityapppickersidepanel:"channelextensibilityapppickersidepanel",extensibilityapppickersidepanel:"extensibilityapppickersidepanel",appenabledialog:"appenabledialog"};var r;!function(e){e.midNavEntity="midNavEntity",e.subNavEntity="subNavEntity",e.headerEntity="headerEntity",e.startEntity="startEntity",e.mainEntity="mainEntity",e.endEntity="endEntity",e.monitorEntity="monitorEntity",e.inAppNotificationsEntity="inAppNotificationsEntity"}(r||(r={}))},588592:(e,n,i)=>{"use strict";var a,t,r,o;i.d(n,{nh:()=>a,WL:()=>t,u5:()=>r,Ug:()=>o,Vi:()=>l}),function(e){e[e.CRITICAL=0]="CRITICAL",e[e.POST_CRITICAL=1]="POST_CRITICAL",e[e.COMPLETE=2]="COMPLETE"}(a||(a={})),function(e){e.CONFIGURATIONS="configurations",e.CONTEXTUAL_NOTIFICATIONS="contextual-notifications",e.END="end",e.HEADER="header",e.IN_APP_NOTIFICATIONS="in-app-notifications",e.MAIN="main",e.MID_NAV="mid-nav",e.MODAL="modal",e.MONITOR="monitor",e.NAV="nav",e.NOTIFICATIONS="notifications",e.START="start",e.SUBNAV="sub-nav",e.TITLE_BAR="title-bar",e.TOASTS="toasts"}(t||(t={})),function(e){e.LINE_LOADER="line-loader"}(r||(r={})),function(e){e.ALL_PHASE_SIGNALS_RECEIVED="all-phase-signals-received",e.PHASE_PREVIOUSLY_COMPLETED="phase-previously-completed",e.PHASE_STATE_MACHINE_DISPOSED="phase-state-machine-disposed",e.PHASE_TIMEOUT_FIRED="phase-timeout-fired",e.TARGET_AND_PREVIOUS_PHASES_DO_NOT_EXIST="target-and-previous-phases-do-not-exist"}(o||(o={}));const l={[t.HEADER]:{height:{collapsed:"6.1rem",expanded:"24.3rem"}}}},379658:(e,n,i)=>{"use strict";var a;i.d(n,{s:()=>a}),function(e){e.ag08="ag08",e.ag09="ag09",e.dod="dod",e.gallatin="gallatin",e.gcc="gcc",e.gcchigh="gcchigh",e.life="life",e.prod="prod"}(a||(a={}))},288718:(e,n,i)=>{"use strict";var a,t,r,o,l,s;i.d(n,{Mv:()=>a,Bd:()=>t,Ky:()=>r,sG:()=>o,Mb:()=>l,$E:()=>s}),function(e){e[e.general=0]="general",e[e.team=1]="team",e[e.personal=2]="personal",e[e.group=4]="group",e[e.meeting=8]="meeting"}(a||(a={})),function(e){e.installed="installed",e.notInstalled="notInstalled",e.preconsented="preconsented"}(t||(t={})),function(e){e[e.na=0]="na",e[e.bots=1]="bots",e[e.tabs=2]="tabs",e[e.messaging=3]="messaging",e[e.connectors=4]="connectors"}(r||(r={})),function(e){e[e.na=0]="na",e[e.card=1]="card",e[e.deepLink=2]="deepLink",e[e.messageExtension=3]="messageExtension",e[e.platformExtensionTab=4]="platformExtensionTab",e[e.contentBubble=5]="contentBubble",e[e.shareToOutlook=6]="shareToOutlook",e[e.adaptiveCardTab=7]="adaptiveCardTab",e[e.botConfig=8]="botConfig",e[e.storeapp=9]="storeapp",e[e.workflows=10]="workflows",e[e.virtualEvent=11]="virtualEvent",e[e.personalApp=12]="personalApp",e[e.stageViewOpenSDKApi=13]="stageViewOpenSDKApi"}(o||(o={})),function(e){e.bot="bot",e.inputextension="inputextension",e.connectors="connectors"}(l||(l={})),function(e){e.carousel="carousel",e.list="list"}(s||(s={}))},366296:(e,n,i)=>{"use strict";i.d(n,{K:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"DataClientPlatformUpdateInContextStoreLaunchInstalledAppResultMutation"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"InContextStoreLaunchInstalledAppInput"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"updateInContextStoreLaunchInstalledAppResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},17182:(e,n,i)=>{"use strict";i.d(n,{U:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"mutation",name:{kind:"Name",value:"setPlatformAppsFetchPolicy"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"input"}},type:{kind:"NonNullType",type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PlatformAppsFetchPolicyInput"}}}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"setPlatformAppsFetchPolicy"},arguments:[{kind:"Argument",name:{kind:"Name",value:"input"},value:{kind:"Variable",name:{kind:"Name",value:"input"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},793563:(e,n,i)=>{"use strict";i.d(n,{E:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"appDefinition"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AppDefinition"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"developerName"}},{kind:"Field",name:{kind:"Name",value:"developerUrl"}},{kind:"Field",name:{kind:"Name",value:"privacyUrl"}},{kind:"Field",name:{kind:"Name",value:"termsOfUseUrl"}},{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"shortDescription"}},{kind:"Field",name:{kind:"Name",value:"longDescription"}},{kind:"Field",name:{kind:"Name",value:"smallImageUrl"}},{kind:"Field",name:{kind:"Name",value:"largeImageUrl"}},{kind:"Field",name:{kind:"Name",value:"accentColor"}},{kind:"Field",name:{kind:"Name",value:"categories"}},{kind:"Field",name:{kind:"Name",value:"validDomains"}},{kind:"Field",name:{kind:"Name",value:"externalId"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"isBlocked"}},{kind:"Field",name:{kind:"Name",value:"isFullScreenApp"}},{kind:"Field",name:{kind:"Name",value:"isFullTrustApp"}},{kind:"Field",name:{kind:"Name",value:"isMicrosoftOwned"}},{kind:"Field",name:{kind:"Name",value:"showTabLoadingIndicator"}},{kind:"Field",name:{kind:"Name",value:"bots"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"botDefinition"}}]}},{kind:"Field",name:{kind:"Name",value:"customBots"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"endpointUrl"}},{kind:"Field",name:{kind:"Name",value:"secret"}}]}},{kind:"Field",name:{kind:"Name",value:"connectors"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"connectorId"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"configurationUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"galleryTabs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"configurationUrl"}},{kind:"Field",name:{kind:"Name",value:"canUpdateConfiguration"}},{kind:"Field",name:{kind:"Name",value:"canHaveTabConversation"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"meetingSurfaces"}},{kind:"Field",name:{kind:"Name",value:"context"}}]}},{kind:"Field",name:{kind:"Name",value:"staticTabs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"entityId"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"order"}},{kind:"Field",name:{kind:"Name",value:"contentUrl"}},{kind:"Field",name:{kind:"Name",value:"contentBotId"}},{kind:"Field",name:{kind:"Name",value:"websiteUrl"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"containerAppIds"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingExtensionDefinition"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isAnonymousAccessAllowed"}},{kind:"Field",name:{kind:"Name",value:"supportsStreaming"}},{kind:"Field",name:{kind:"Name",value:"scenes"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"file"}},{kind:"Field",name:{kind:"Name",value:"preview"}},{kind:"Field",name:{kind:"Name",value:"maxAudience"}},{kind:"Field",name:{kind:"Name",value:"seatsReservedForOrganizersOrPresenters"}}]}},{kind:"Field",name:{kind:"Name",value:"filters"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"thumbnail"}}]}},{kind:"Field",name:{kind:"Name",value:"videoAppContentUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"authorization"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"permissions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"orgWide"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}},{kind:"Field",name:{kind:"Name",value:"resourceSpecific"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"messageExtensions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"botId"}},{kind:"Field",name:{kind:"Name",value:"canUpdateConfiguration"}},{kind:"Field",name:{kind:"Name",value:"fetchCommands"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"commands"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"context"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"initialRun"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"parameters"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"inputType"}},{kind:"Field",name:{kind:"Name",value:"value"}},{kind:"Field",name:{kind:"Name",value:"isRequired"}},{kind:"Field",name:{kind:"Name",value:"choices"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"appKey"}},{kind:"Field",name:{kind:"Name",value:"fetchTask"}},{kind:"Field",name:{kind:"Name",value:"taskInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"height"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"width"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"messageHandlers"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"value"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"domains"}},{kind:"Field",name:{kind:"Name",value:"supportsAnonymousAccess"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"authorization"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authType"}},{kind:"Field",name:{kind:"Name",value:"microsoftEntraConfiguration"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"supportsSingleSignOn"}}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"webApplicationInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"appKey"}},{kind:"Field",name:{kind:"Name",value:"resource"}},{kind:"Field",name:{kind:"Name",value:"applicationPermissions"}}]}},{kind:"Field",name:{kind:"Name",value:"screenshotUrls"}},{kind:"Field",name:{kind:"Name",value:"officeAssetId"}},{kind:"Field",name:{kind:"Name",value:"videoUrl"}},{kind:"Field",name:{kind:"Name",value:"devicePermissions"}},{kind:"Field",name:{kind:"Name",value:"securityComplianceInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"mcasId"}},{kind:"Field",name:{kind:"Name",value:"status"}},{kind:"Field",name:{kind:"Name",value:"csaId"}},{kind:"Field",name:{kind:"Name",value:"csaName"}}]}},{kind:"Field",name:{kind:"Name",value:"defaultInstallScope"}},{kind:"Field",name:{kind:"Name",value:"defaultGroupCapability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"team"}},{kind:"Field",name:{kind:"Name",value:"groupchat"}},{kind:"Field",name:{kind:"Name",value:"meetings"}}]}},{kind:"Field",name:{kind:"Name",value:"subscriptionOffer"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"offerId"}}]}},{kind:"Field",name:{kind:"Name",value:"manifestVersion"}}]}},...i(102460).g.definitions]}},802596:(e,n,i)=>{"use strict";i.d(n,{o:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"appsUsageFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AppsUsage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appIds"}},{kind:"Field",name:{kind:"Name",value:"appActions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"actionId"}}]}},{kind:"Field",name:{kind:"Name",value:"appScenes"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"sceneId"}}]}},{kind:"Field",name:{kind:"Name",value:"appsMru"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"lastUsedTimeStamp"}}]}}]}}]}},102460:(e,n,i)=>{"use strict";i.d(n,{g:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"botDefinition"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BotDefinition"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"scopes"}},{kind:"Field",name:{kind:"Name",value:"capabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isNotificationOnly"}},{kind:"Field",name:{kind:"Name",value:"supportsFiles"}},{kind:"Field",name:{kind:"Name",value:"supportsCalling"}},{kind:"Field",name:{kind:"Name",value:"supportsVideo"}}]}},{kind:"Field",name:{kind:"Name",value:"commandLists"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"commands"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"description"}}]}},{kind:"Field",name:{kind:"Name",value:"scopes"}}]}},{kind:"Field",name:{kind:"Name",value:"configuration"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"groupChat"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fetchTask"}},{kind:"Field",name:{kind:"Name",value:"taskInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"height"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"width"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"team"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"fetchTask"}},{kind:"Field",name:{kind:"Name",value:"taskInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"height"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"width"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInFloat"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"customValue"},name:{kind:"Name",value:"value"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DimensionInString"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",alias:{kind:"Name",value:"predefinedValue"},name:{kind:"Name",value:"value"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"url"}}]}}]}}]}}]}}]}},716606:(e,n,i)=>{"use strict";i.d(n,{v7:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"broadcastMeetingFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BroadcastMeeting"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"composerStreamId"}},{kind:"Field",name:{kind:"Name",value:"broadcastState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"broadcastStateFields"}}]}},{kind:"Field",name:{kind:"Name",value:"role"}},{kind:"Field",name:{kind:"Name",value:"commands"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"broadcastCommandsFields"}}]}},{kind:"Field",name:{kind:"Name",value:"broadcastMaxAllowedDuration"}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"broadcastStateFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BroadcastState"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"status"}}]}}]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"broadcastCommandsFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"BroadcastProducerAvailableCommands"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"setLayout"}},{kind:"Field",name:{kind:"Name",value:"start"}},{kind:"Field",name:{kind:"Name",value:"stop"}},{kind:"Field",name:{kind:"Name",value:"updateMediaState"}},{kind:"Field",name:{kind:"Name",value:"restart"}}]}}]}.definitions]}},455146:(e,n,i)=>{"use strict";i.d(n,{f:()=>o});var a=i(568382),t=i(716606),r=i(581657);const o={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"callingFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Call"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"__typename"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"participantId"}},{kind:"Field",name:{kind:"Name",value:"callId"}},{kind:"Field",name:{kind:"Name",value:"callType"}},{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"callMode"}},{kind:"Field",name:{kind:"Name",value:"extendedCallState"}},{kind:"Field",name:{kind:"Name",value:"transferorMri"}},{kind:"Field",name:{kind:"Name",value:"isFake"}},{kind:"Field",name:{kind:"Name",value:"isMuted"}},{kind:"Field",name:{kind:"Name",value:"isExternal"}},{kind:"Field",name:{kind:"Name",value:"isServerMuted"}},{kind:"Field",name:{kind:"Name",value:"isMutePending"}},{kind:"Field",name:{kind:"Name",value:"isSpeakerMuted"}},{kind:"Field",name:{kind:"Name",value:"isCallParked"}},{kind:"Field",name:{kind:"Name",value:"isHandRaised"}},{kind:"Field",name:{kind:"Name",value:"selfRaiseHandsRank"}},{kind:"Field",name:{kind:"Name",value:"isSpotlighted"}},{kind:"Field",name:{kind:"Name",value:"isSpotlightFeatureEnabled"}},{kind:"Field",name:{kind:"Name",value:"isCompositorEnabled"}},{kind:"Field",name:{kind:"Name",value:"isWeatherpersonCompositionEnabled"}},{kind:"Field",name:{kind:"Name",value:"isWeatherpersonPresenterEnabled"}},{kind:"Field",name:{kind:"Name",value:"isWatermarkEnabled"}},{kind:"Field",name:{kind:"Name",value:"isTogetherModePinned"}},{kind:"Field",name:{kind:"Name",value:"supportedSharingLayouts"}},{kind:"Field",name:{kind:"Name",value:"isAplCustomBackgroundEnabled"}},{kind:"Field",name:{kind:"Name",value:"aplCustomBackgroundId"}},{kind:"Field",name:{kind:"Name",value:"isPPTWeatherpersonEnabled"}},{kind:"Field",name:{kind:"Name",value:"isExtensibleAppWeatherpersonEnabled"}},{kind:"Field",name:{kind:"Name",value:"isPPTSbSAndReporterEnabled"}},{kind:"Field",name:{kind:"Name",value:"isPPTCameoEnabled"}},{kind:"Field",name:{kind:"Name",value:"isPPTSharingAvailable"}},{kind:"Field",name:{kind:"Name",value:"isCameoPresenterEnabled"}},{kind:"Field",name:{kind:"Name",value:"isAnnotationSharerWindowOn"}},{kind:"Field",name:{kind:"Name",value:"meetingInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"organizerId"}},{kind:"Field",name:{kind:"Name",value:"organizerUpn"}}]}},{kind:"Field",name:{kind:"Name",value:"screenSharingBounds"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"top"}},{kind:"Field",name:{kind:"Name",value:"left"}},{kind:"Field",name:{kind:"Name",value:"width"}},{kind:"Field",name:{kind:"Name",value:"height"}}]}},{kind:"Field",name:{kind:"Name",value:"isMovePrivateViewingToPPTEnabled"}},{kind:"Field",name:{kind:"Name",value:"isWhiteboardVideoEffectOn"}},{kind:"Field",name:{kind:"Name",value:"sharingLayoutMode"}},{kind:"Field",name:{kind:"Name",value:"isBreakoutRoomsFeatureEnabled"}},{kind:"Field",name:{kind:"Name",value:"isRaiseHandsEnabledForStreaming"}},{kind:"Field",name:{kind:"Name",value:"isNdiEnabled"}},{kind:"Field",name:{kind:"Name",value:"isRaiseHandsAllowed"}},{kind:"Field",name:{kind:"Name",value:"isVideoOn"}},{kind:"Field",name:{kind:"Name",value:"closedCaptionsLanguage"}},{kind:"Field",name:{kind:"Name",value:"optimalVideoCount"}},{kind:"Field",name:{kind:"Name",value:"isIncomingVideoOn"}},{kind:"Field",name:{kind:"Name",value:"isScreenSharingOn"}},{kind:"Field",name:{kind:"Name",value:"isSharingMuted"}},{kind:"Field",name:{kind:"Name",value:"sharingSourceType"}},{kind:"Field",name:{kind:"Name",value:"isReconciled"}},{kind:"Field",name:{kind:"Name",value:"isMergeable"}},{kind:"Field",name:{kind:"Name",value:"isPSTNEnabled"}},{kind:"Field",name:{kind:"Name",value:"isRejoinable"}},{kind:"Field",name:{kind:"Name",value:"failureType"}},{kind:"Field",name:{kind:"Name",value:"abortReason"}},{kind:"Field",name:{kind:"Name",value:"hadRelayWhitelistingIssue"}},{kind:"Field",name:{kind:"Name",value:"isRoomEndedByOrganizer"}},{kind:"Field",name:{kind:"Name",value:"isRoomEndedByTimer"}},{kind:"Field",name:{kind:"Name",value:"hadReconnectingIssue"}},{kind:"Field",name:{kind:"Name",value:"wasNotAdmittedForLongTime"}},{kind:"Field",name:{kind:"Name",value:"isPushToTalkEnabled"}},{kind:"Field",name:{kind:"Name",value:"capabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isTransferAllowed"}},{kind:"Field",name:{kind:"Name",value:"isCallParkAvailable"}},{kind:"Field",name:{kind:"Name",value:"isVideoPreviewDisabled"}},{kind:"Field",name:{kind:"Name",value:"isVideoBackgroundSettingsDisabled"}},{kind:"Field",name:{kind:"Name",value:"isPSTNCallbackOptionDisabled"}},{kind:"Field",name:{kind:"Name",value:"isSafeTransferAllowed"}},{kind:"Field",name:{kind:"Name",value:"isCloudRecordingAllowed"}},{kind:"Field",name:{kind:"Name",value:"isLocalRecordingAllowed"}},{kind:"Field",name:{kind:"Name",value:"isTranscriptionAllowed"}},{kind:"Field",name:{kind:"Name",value:"isIpVideoAllowed"}},{kind:"Field",name:{kind:"Name",value:"isSingleOutgoingVideoEnabled"}},{kind:"Field",name:{kind:"Name",value:"allowedRecorder"}},{kind:"Field",name:{kind:"Name",value:"isExternalTenantContentSharingDisabled"}}]}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"dominantSpeakerInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"dominantSpeakerInfoFields"}}]}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"isBroadcast"}},{kind:"Field",name:{kind:"Name",value:"broadcastMeeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"broadcastMeetingFields"}}]}},{kind:"Field",name:{kind:"Name",value:"extendedCallType"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isOneToOnePstn"}},{kind:"Field",name:{kind:"Name",value:"isScreenshareFromChat"}},{kind:"Field",name:{kind:"Name",value:"isFederated"}},{kind:"Field",name:{kind:"Name",value:"isInterop"}},{kind:"Field",name:{kind:"Name",value:"isVoicemailGreeting"}},{kind:"Field",name:{kind:"Name",value:"isEchoBotCall"}},{kind:"Field",name:{kind:"Name",value:"isContentOnlyMode"}},{kind:"Field",name:{kind:"Name",value:"isEmergencyCall"}},{kind:"Field",name:{kind:"Name",value:"isConsultCall"}},{kind:"Field",name:{kind:"Name",value:"isSkypeForConsumerCall"}},{kind:"Field",name:{kind:"Name",value:"isMeetingTransferred"}},{kind:"Field",name:{kind:"Name",value:"isHolographicCall"}},{kind:"Field",name:{kind:"Name",value:"isVideoTeleConferencingCall"}},{kind:"Field",name:{kind:"Name",value:"isAudioDropInCall"}},{kind:"Field",name:{kind:"Name",value:"isGroupCall"}}]}},{kind:"Field",name:{kind:"Name",value:"consultContext"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"consultingWith"}},{kind:"Field",name:{kind:"Name",value:"canTransfer"}}]}},{kind:"Field",name:{kind:"Name",value:"canBeRetried"}},{kind:"Field",name:{kind:"Name",value:"isPresenterConnected"}},{kind:"Field",name:{kind:"Name",value:"isVideoLive"}},{kind:"Field",name:{kind:"Name",value:"isScreenShareLive"}},{kind:"Field",name:{kind:"Name",value:"isCoachSupported"}},{kind:"Field",name:{kind:"Name",value:"meetingRole"}},{kind:"Field",name:{kind:"Name",value:"screenSharingControlStateAsViewer"}},{kind:"Field",name:{kind:"Name",value:"callerMri"}},{kind:"Field",name:{kind:"Name",value:"canAddParticipants"}},{kind:"Field",name:{kind:"Name",value:"callHeldAt"}},{kind:"Field",name:{kind:"Name",value:"selfCapabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"canUnmuteSelf"}},{kind:"Field",name:{kind:"Name",value:"canMuteOthers"}}]}},{kind:"Field",name:{kind:"Name",value:"emergencyCallInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"myRoleInEmergencyCall"}},{kind:"Field",name:{kind:"Name",value:"callerLocation"}},{kind:"Field",name:{kind:"Name",value:"callerNumber"}},{kind:"Field",name:{kind:"Name",value:"emergencyCalleeMri"}},{kind:"Field",name:{kind:"Name",value:"chatExists"}}]}},{kind:"Field",name:{kind:"Name",value:"reconciledOriginalId"}},{kind:"Field",name:{kind:"Name",value:"pstnCapabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isDialInEnabled"}},{kind:"Field",name:{kind:"Name",value:"isDialOutEnabled"}},{kind:"Field",name:{kind:"Name",value:"isLbrEnabledUser"}}]}},{kind:"Field",name:{kind:"Name",value:"forwardingDestinationType"}},{kind:"Field",name:{kind:"Name",value:"callStateProps"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"hyperLinkInTitle"}},{kind:"Field",name:{kind:"Name",value:"descriptionText"}},{kind:"Field",name:{kind:"Name",value:"icon"}},{kind:"Field",name:{kind:"Name",value:"useOutlineIcon"}},{kind:"Field",name:{kind:"Name",value:"telemetryContext"}}]}},{kind:"Field",name:{kind:"Name",value:"isScdEnabled"}},{kind:"Field",name:{kind:"Name",value:"isScdAvailable"}},{kind:"Field",name:{kind:"Name",value:"terminatedReason"}},{kind:"Field",name:{kind:"Name",value:"timeZoneOffset"}},{kind:"Field",name:{kind:"Name",value:"mappedToMeetingRoom"}},{kind:"Field",name:{kind:"Name",value:"breakoutRoomsParticipantDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ParticipantMainMeetingDetails"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"showJoinRoomButton"}},{kind:"Field",name:{kind:"Name",value:"assignedRoomName"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"breakoutRoomsCount"}},{kind:"Field",name:{kind:"Name",value:"openBreakoutRoomsCount"}},{kind:"Field",name:{kind:"Name",value:"breakoutRoomDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"remainingRoomDuration"}},{kind:"Field",name:{kind:"Name",value:"initializedAt"}},{kind:"Field",name:{kind:"Name",value:"remainingRoomDurationMs"}},{kind:"Field",name:{kind:"Name",value:"isBreakoutRoom"}},{kind:"Field",name:{kind:"Name",value:"isBreakoutRoomMain"}},{kind:"Field",name:{kind:"Name",value:"additionalData"}},{kind:"Field",name:{kind:"Name",value:"participantInControl"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"participantId"}}]}},{kind:"Field",name:{kind:"Name",value:"managerUserIds"}},{kind:"Field",name:{kind:"Name",value:"version"}}]}},{kind:"Field",name:{kind:"Name",value:"isBreakoutRoomInvite"}},{kind:"Field",name:{kind:"Name",value:"isMainMeetingInvite"}},{kind:"Field",name:{kind:"Name",value:"initiatedTime"}},{kind:"Field",name:{kind:"Name",value:"maskedIdentityDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isIdentityMasked"}},{kind:"Field",name:{kind:"Name",value:"maskedIdSeqNumber"}},{kind:"Field",name:{kind:"Name",value:"maskedId"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"meetingCode"}},{kind:"Field",name:{kind:"Name",value:"passcode"}},{kind:"Field",name:{kind:"Name",value:"meetingUrl"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"meetingCapability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"lockMeeting"}},{kind:"Field",name:{kind:"Name",value:"allowMeetingReactions"}},{kind:"Field",name:{kind:"Name",value:"copilotMode"}},{kind:"Field",name:{kind:"Name",value:"isHostViewModeActive"}},{kind:"Field",name:{kind:"Name",value:"yammerQNAEnabled"}},{kind:"Field",name:{kind:"Name",value:"breakoutRoomsEnabled"}},{kind:"Field",name:{kind:"Name",value:"watermarkScreenShareEnabled"}},{kind:"Field",name:{kind:"Name",value:"watermarkVideoEnabled"}},{kind:"Field",name:{kind:"Name",value:"watermarkScreenShareSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"opacity"}},{kind:"Field",name:{kind:"Name",value:"pattern"}}]}},{kind:"Field",name:{kind:"Name",value:"watermarkVideoSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"opacity"}},{kind:"Field",name:{kind:"Name",value:"pattern"}}]}},{kind:"Field",name:{kind:"Name",value:"sensitivityLabelId"}},{kind:"Field",name:{kind:"Name",value:"maskIdentitiesForRole"}},{kind:"Field",name:{kind:"Name",value:"forceAttendeeStreaming"}},{kind:"Field",name:{kind:"Name",value:"meetingEndToEndEncryptionEnabled"}},{kind:"Field",name:{kind:"Name",value:"streamingModeActive"}},{kind:"Field",name:{kind:"Name",value:"allowTranslatedCaptions"}},{kind:"Field",name:{kind:"Name",value:"enableParticipantRenaming"}},{kind:"Field",name:{kind:"Name",value:"isPresenterCapabilitiesReduced"}},{kind:"Field",name:{kind:"Name",value:"hasCommentStream"}}]}},{kind:"Field",name:{kind:"Name",value:"exchangeId"}},{kind:"Field",name:{kind:"Name",value:"iCalUid"}},{kind:"Field",name:{kind:"Name",value:"isChannelMeeting"}},{kind:"Field",name:{kind:"Name",value:"isPrivateMeeting"}},{kind:"Field",name:{kind:"Name",value:"isRecurring"}},{kind:"Field",name:{kind:"Name",value:"meetingType"}},{kind:"Field",name:{kind:"Name",value:"meetingJoinUrl"}},{kind:"Field",name:{kind:"Name",value:"anyWaterMarkLegacyUserEverInMeeting"}},{kind:"Field",name:{kind:"Name",value:"masterEventDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"eventType"}},{kind:"Field",name:{kind:"Name",value:"iCalUid"}},{kind:"Field",name:{kind:"Name",value:"isCancelled"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"subject"}}]}},{kind:"Field",name:{kind:"Name",value:"eventDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"eventType"}},{kind:"Field",name:{kind:"Name",value:"iCalUid"}},{kind:"Field",name:{kind:"Name",value:"isCancelled"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"subject"}}]}},{kind:"Field",name:{kind:"Name",value:"templateDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"channelObjectId"}},{kind:"Field",name:{kind:"Name",value:"channelTenantId"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingArtifacts"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meetingArtifactsCollection"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingInterpretationDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"hasInterpretation"}},{kind:"Field",name:{kind:"Name",value:"groups"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"label"}}]}},{kind:"Field",name:{kind:"Name",value:"floor"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"label"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"selfInterpretationDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isInterpreter"}},{kind:"Field",name:{kind:"Name",value:"group"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"label"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"appliedInteractivityLevel"}},{kind:"Field",name:{kind:"Name",value:"sharingPresenterIds"}},{kind:"Field",name:{kind:"Name",value:"isHighFidelityAudioEnabled"}},{kind:"Field",name:{kind:"Name",value:"hasOverflowRoom"}},{kind:"Field",name:{kind:"Name",value:"shouldAutoRejoin"}},{kind:"Field",name:{kind:"Name",value:"vdiCapabilities"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"video"}},{kind:"Field",name:{kind:"Name",value:"screenshare"}},{kind:"Field",name:{kind:"Name",value:"appshare"}},{kind:"Field",name:{kind:"Name",value:"hid"}},{kind:"Field",name:{kind:"Name",value:"multimonitorscreenshare"}},{kind:"Field",name:{kind:"Name",value:"remoteaudionotifications"}},{kind:"Field",name:{kind:"Name",value:"compositedevices"}},{kind:"Field",name:{kind:"Name",value:"multiwindow"}},{kind:"Field",name:{kind:"Name",value:"datachannel"}},{kind:"Field",name:{kind:"Name",value:"givecontrol"}},{kind:"Field",name:{kind:"Name",value:"sharesystemaudio"}},{kind:"Field",name:{kind:"Name",value:"backgroundeffects"}}]}},{kind:"Field",name:{kind:"Name",value:"rtmpInProperties"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"rtmpEnabled"}}]}},{kind:"Field",name:{kind:"Name",value:"stagingRoomProperties"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"eventActive"}},{kind:"Field",name:{kind:"Name",value:"stagingRoomEnabled"}},{kind:"Field",name:{kind:"Name",value:"eventIsLoading"}}]}},{kind:"Field",name:{kind:"Name",value:"callLimits"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"sponsor"}}]}},{kind:"Field",name:{kind:"Name",value:"callEndDiagnosticsInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callControllerCode"}},{kind:"Field",name:{kind:"Name",value:"callControllerSubCode"}}]}},{kind:"Field",name:{kind:"Name",value:"acceptedElsewhereBy"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"organizerId"}}]}},{kind:"Field",name:{kind:"Name",value:"isImmersiveViewActive"}},{kind:"Field",name:{kind:"Name",value:"isImmersiveViewActiveLoading"}},{kind:"Field",name:{kind:"Name",value:"userEndpointCount"}},{kind:"Field",name:{kind:"Name",value:"isAppHandlingAudio"}},{kind:"Field",name:{kind:"Name",value:"displayNameOverride"}},{kind:"Field",name:{kind:"Name",value:"brandingInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"defaultTheme"}},{kind:"Field",name:{kind:"Name",value:"meetingBrandingThemes"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"identity"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"enabled"}},{kind:"Field",name:{kind:"Name",value:"brandAccentColor"}},{kind:"Field",name:{kind:"Name",value:"logoImageLightUri"}},{kind:"Field",name:{kind:"Name",value:"logoImageDarkUri"}},{kind:"Field",name:{kind:"Name",value:"backgroundImageLightUri"}},{kind:"Field",name:{kind:"Name",value:"backgroundImageDarkUri"}}]}},{kind:"Field",name:{kind:"Name",value:"lobbyLogoBrandingImages"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"imageUri"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"transcriptOrganizerId"}},{kind:"Field",name:{kind:"Name",value:"transferTargetDisplayName"}},{kind:"Field",name:{kind:"Name",value:"intent"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"participants"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"isServerHold"}},{kind:"Field",name:{kind:"Name",value:"callOrigin"}},{kind:"Field",name:{kind:"Name",value:"participantType"}},{kind:"Field",name:{kind:"Name",value:"backroomChatThreadId"}},{kind:"Field",name:{kind:"Name",value:"isSomeoneInImmersiveSpace"}},{kind:"Field",name:{kind:"Name",value:"isOfficePreloadAllowed"}},{kind:"Field",name:{kind:"Name",value:"nativeMeetingStageCapability"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"enabled"}},{kind:"Field",name:{kind:"Name",value:"level"}}]}},{kind:"Field",name:{kind:"Name",value:"monitoredAgentState"}},{kind:"Field",name:{kind:"Name",value:"invitationData"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"proximitySource"}},{kind:"Field",name:{kind:"Name",value:"deviceType"}}]}},{kind:"Field",name:{kind:"Name",value:"isAcsInteropCall"}}]}},...a.y.definitions,...t.v7.definitions,...r.ll.definitions]}},982635:(e,n,i)=>{"use strict";i.d(n,{v:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"consumptionHorizonBookmarkFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConsumptionHorizonBookmark"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"timeStamp"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}}]}}]}},472632:(e,n,i)=>{"use strict";i.d(n,{T:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"consumptionHorizonFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConsumptionHorizon"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"timeStamp"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}}]}}]}},255567:(e,n,i)=>{"use strict";i.d(n,{_:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonChatAddMembersFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Conversation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"cfet"}},{kind:"Field",name:{kind:"Name",value:"chatSubType"}},{kind:"Field",name:{kind:"Name",value:"guardianChatInfo"}},{kind:"Field",name:{kind:"Name",value:"hasFederatedUser"}},{kind:"Field",name:{kind:"Name",value:"hasTflConsumerUser"}},{kind:"Field",name:{kind:"Name",value:"hasTflSmsUnverifiedUser"}},{kind:"Field",name:{kind:"Name",value:"hasTflSmsVerifiedUser"}},{kind:"Field",name:{kind:"Name",value:"isMeeting"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOne"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOneBotChat"}},{kind:"Field",name:{kind:"Name",value:"isUserMember"}},{kind:"Field",name:{kind:"Name",value:"memberIds"}},{kind:"Field",name:{kind:"Name",value:"tflOffNetworkUserLength"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"title"}},{kind:"Field",name:{kind:"Name",value:"interopConversationStatus"}},{kind:"Field",name:{kind:"Name",value:"mtoShadowUserInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shouldChatInHomeTenant"}},{kind:"Field",name:{kind:"Name",value:"areAllChatMembersReachableInHomeTenant"}}]}},{kind:"Field",name:{kind:"Name",value:"membersLimited"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"isFederated"}}]}},{kind:"Field",name:{kind:"Name",value:"meetingChatType"}}]}}]}},219622:(e,n,i)=>{"use strict";i.d(n,{x:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonChatMtoTelemetryFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Conversation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"hasFederatedMTOUser"}}]}}]}},217494:(e,n,i)=>{"use strict";i.d(n,{x:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonChatPaneLayoutFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Conversation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"mtoShadowUserInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shouldChatInHomeTenant"}},{kind:"Field",name:{kind:"Name",value:"areAllChatMembersReachableInHomeTenant"}}]}}]}}]}},699201:(e,n,i)=>{"use strict";i.d(n,{B:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonChatRecapFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Conversation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"hasRecap"}}]}}]}},445393:(e,n,i)=>{"use strict";i.d(n,{l:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonChatWithMtoUserBannerFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Conversation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"firstMtoMember"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"homeMri"}},{kind:"Field",name:{kind:"Name",value:"displayName"}}]}},{kind:"Field",name:{kind:"Name",value:"mtoHomeUserInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shouldChatWithFederatedIdentities"}},{kind:"Field",name:{kind:"Name",value:"areAllChatMembersReachableInTheirHomeTenant"}},{kind:"Field",name:{kind:"Name",value:"memberHomeTenantMris"}}]}}]}}]}},533185:(e,n,i)=>{"use strict";i.d(n,{e:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonRecordingMessageMiFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingInformation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"meetingType"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"templateDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]}},374504:(e,n,i)=>{"use strict";i.d(n,{g:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonUseExternalTagFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Conversation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"cfet"}},{kind:"Field",name:{kind:"Name",value:"creator"}},{kind:"Field",name:{kind:"Name",value:"hasFederatedUser"}},{kind:"Field",name:{kind:"Name",value:"hasTflConsumerUser"}},{kind:"Field",name:{kind:"Name",value:"isFederated"}},{kind:"Field",name:{kind:"Name",value:"isExternal"}},{kind:"Field",name:{kind:"Name",value:"isMeeting"}},{kind:"Field",name:{kind:"Name",value:"isOneOnOne"}},{kind:"Field",name:{kind:"Name",value:"tflOffNetworkUserLength"}},{kind:"Field",name:{kind:"Name",value:"memberIds"}},{kind:"Field",name:{kind:"Name",value:"membersLimited"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"givenName"}},{kind:"Field",name:{kind:"Name",value:"isFederated"}}]}}]}}]}},170404:(e,n,i)=>{"use strict";i.d(n,{X:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonUseMtoUserBannerFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Conversation"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"shortTitle"}},{kind:"Field",name:{kind:"Name",value:"mtoShadowUserInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shouldChatInHomeTenant"}},{kind:"Field",name:{kind:"Name",value:"areAllChatMembersReachableInHomeTenant"}},{kind:"Field",name:{kind:"Name",value:"memberHomeTenantMris"}}]}}]}}]}},568382:(e,n,i)=>{"use strict";i.d(n,{y:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"dominantSpeakerInfoFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"DominantSpeakerInfo"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"speakerList"}},{kind:"Field",name:{kind:"Name",value:"timestamp"}}]}}]}},341887:(e,n,i)=>{"use strict";i.d(n,{W:()=>l});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"DataFragmentsCommonInstallerIdentityFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"InstallerIdentity"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installerType"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"azureAdAppId"}}]}}]};var t=i(299227),r=i(793563);const o={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"appPermissions"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"AppPermissions"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"orgWide"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}},{kind:"Field",name:{kind:"Name",value:"resourceSpecific"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"type"}}]}}]}}]},l={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"installedAppFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"InstalledApp"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"installedScope"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"installationState"}},{kind:"Field",name:{kind:"Name",value:"installedAppProps"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isUninstallable"}},{kind:"Field",name:{kind:"Name",value:"isAdminPreInstalled"}},{kind:"Field",name:{kind:"Name",value:"isNewGlobalPreInstalled"}},{kind:"Field",name:{kind:"Name",value:"isNewAdminPreInstalled"}}]}},{kind:"Field",name:{kind:"Name",value:"conversationId"}},{kind:"Field",name:{kind:"Name",value:"installedVersion"}},{kind:"Field",name:{kind:"Name",value:"installerIdentity"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"DataFragmentsCommonInstallerIdentityFragment"}}]}},{kind:"Field",name:{kind:"Name",value:"messageExtensionStates"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"messageExtensionState"}}]}},{kind:"Field",name:{kind:"Name",value:"definition"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appDefinition"}}]}},{kind:"Field",name:{kind:"Name",value:"permissions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"appPermissions"}}]}}]}},...a.definitions,...t.l.definitions,...r.E.definitions,...o.definitions]}},452558:(e,n,i)=>{"use strict";i.d(n,{T:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"lastMessageFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"LastMessage"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"originalArrivalTime"}},{kind:"Field",name:{kind:"Name",value:"imDisplayName"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"clientMessageId"}},{kind:"Field",name:{kind:"Name",value:"from"}},{kind:"Field",name:{kind:"Name",value:"messageType"}},{kind:"Field",name:{kind:"Name",value:"deleteTime"}},{kind:"Field",name:{kind:"Name",value:"mentions"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"itemId"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"mentionType"}}]}},{kind:"Field",name:{kind:"Name",value:"importance"}},{kind:"Field",name:{kind:"Name",value:"files"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"cards"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appIcon"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appName"}},{kind:"Field",name:{kind:"Name",value:"cardClientId"}},{kind:"Field",name:{kind:"Name",value:"content"}},{kind:"Field",name:{kind:"Name",value:"contentType"}},{kind:"Field",name:{kind:"Name",value:"locale"}},{kind:"Field",name:{kind:"Name",value:"sourceType"}}]}}]}}]}},581657:(e,n,i)=>{"use strict";i.d(n,{KC:()=>a,$c:()=>t,ll:()=>r});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingArtifactCollection"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactCollection"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"changeKey"}},{kind:"Field",name:{kind:"Name",value:"resources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meetingArtifactV2"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingArtifactV2"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactV2"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"location"}},{kind:"Field",name:{kind:"Name",value:"metadata"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meetingArtifactMetadataEntries"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingArtifactMetadataEntries"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactMetadataEntry"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"isShared"}},{kind:"Field",name:{kind:"Name",value:"linkScope"}},{kind:"Field",name:{kind:"Name",value:"hostClient"}},{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appTitle"}},{kind:"Field",name:{kind:"Name",value:"fileTitle"}},{kind:"Field",name:{kind:"Name",value:"imageUrl"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"shareUrl"}},{kind:"Field",name:{kind:"Name",value:"fileType"}},{kind:"Field",name:{kind:"Name",value:"fileId"}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"meetingContentMetadataObject"}},{kind:"Field",name:{kind:"Name",value:"thumbnailUrl"}}]}}]}.definitions]}.definitions]},t={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"reserveMeetingArtifactResponse"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ReserveMeetingArtifactResponse"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isLeader"}},{kind:"Field",name:{kind:"Name",value:"secret"}},{kind:"Field",name:{kind:"Name",value:"resourceState"}},{kind:"Field",name:{kind:"Name",value:"expiry"}},{kind:"Field",name:{kind:"Name",value:"collab"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meetingArtifactCollection"}}]}}]}},...a.definitions]},r={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingArtifactsCollection"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactsCollection"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"changeKey"}},{kind:"Field",name:{kind:"Name",value:"resources"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"meetingArtifactV2Interface"}}]}},{kind:"Field",name:{kind:"Name",value:"errorState"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"MsTeamsDataFragmentsCommonMeetingArtifacts_meetingArtifactsErrorState"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"meetingArtifactV2Interface"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactV2Interface"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"location"}},{kind:"Field",name:{kind:"Name",value:"subType"}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactV2Transcript"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"organizerId"}},{kind:"Field",name:{kind:"Name",value:"threadId"}},{kind:"Field",name:{kind:"Name",value:"callId"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"groupId"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactV2TranscriptV2"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callId"}},{kind:"Field",name:{kind:"Name",value:"groupId"}},{kind:"Field",name:{kind:"Name",value:"messageId"}},{kind:"Field",name:{kind:"Name",value:"organizerId"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"correlationId"}},{kind:"Field",name:{kind:"Name",value:"threadId"}},{kind:"Field",name:{kind:"Name",value:"webUrl"}},{kind:"Field",name:{kind:"Name",value:"duration"}},{kind:"Field",name:{kind:"Name",value:"driveId"}},{kind:"Field",name:{kind:"Name",value:"driveItemId"}},{kind:"Field",name:{kind:"Name",value:"iCalUid"}},{kind:"Field",name:{kind:"Name",value:"transcriptId"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactV2Recording"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"thumbnailUrl"}},{kind:"Field",name:{kind:"Name",value:"callId"}},{kind:"Field",name:{kind:"Name",value:"duration"}},{kind:"Field",name:{kind:"Name",value:"ownerOid"}},{kind:"Field",name:{kind:"Name",value:"ownerTid"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"threadId"}},{kind:"Field",name:{kind:"Name",value:"threadMessageId"}},{kind:"Field",name:{kind:"Name",value:"driveItemId"}},{kind:"Field",name:{kind:"Name",value:"driveId"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactV2Notes"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"state"}},{kind:"Field",name:{kind:"Name",value:"isShared"}},{kind:"Field",name:{kind:"Name",value:"linkScope"}},{kind:"Field",name:{kind:"Name",value:"hostClient"}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactV2MeetingContent"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appTitle"}},{kind:"Field",name:{kind:"Name",value:"fileTitle"}},{kind:"Field",name:{kind:"Name",value:"imageUrl"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"meetingContentMetadataObject"}},{kind:"Field",name:{kind:"Name",value:"correlationProperties"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"CorrelationPropertiesFragment"}}]}}]}},{kind:"InlineFragment",typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactV2Default"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"appTitle"}},{kind:"Field",name:{kind:"Name",value:"fileTitle"}},{kind:"Field",name:{kind:"Name",value:"imageUrl"}},{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"shareUrl"}},{kind:"Field",name:{kind:"Name",value:"fileType"}},{kind:"Field",name:{kind:"Name",value:"fileId"}},{kind:"Field",name:{kind:"Name",value:"baseUrl"}},{kind:"Field",name:{kind:"Name",value:"objectUrl"}},{kind:"Field",name:{kind:"Name",value:"meetingContentMetadataObject"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"CorrelationPropertiesFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"CorrelationProperties"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"referenceId"}},{kind:"Field",name:{kind:"Name",value:"traceId"}},{kind:"Field",name:{kind:"Name",value:"logicalId"}}]}}]}.definitions]}.definitions,...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"MsTeamsDataFragmentsCommonMeetingArtifacts_meetingArtifactsErrorState"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MeetingArtifactsErrorState"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"code"}},{kind:"Field",name:{kind:"Name",value:"subCode"}},{kind:"Field",name:{kind:"Name",value:"subError"}}]}}]}.definitions]}},299227:(e,n,i)=>{"use strict";i.d(n,{l:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"messageExtensionState"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"MessageExtensionState"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"botId"}},{kind:"Field",name:{kind:"Name",value:"isPinned"}},{kind:"Field",name:{kind:"Name",value:"pinOrder"}}]}}]}},253170:(e,n,i)=>{"use strict";i.d(n,{E:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"pinnedMessageItemFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Message"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}},550214:(e,n,i)=>{"use strict";i.d(n,{O:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"userPresenceData"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"Presence"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"availability"}},{kind:"Field",name:{kind:"Name",value:"activity"}},{kind:"Field",name:{kind:"Name",value:"isOutOfOffice"}},{kind:"Field",name:{kind:"Name",value:"statusNote"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"message"}},{kind:"Field",name:{kind:"Name",value:"publishTime"}},{kind:"Field",name:{kind:"Name",value:"expiry"}}]}},{kind:"Field",name:{kind:"Name",value:"flwPresence"}},{kind:"Field",name:{kind:"Name",value:"flwShifts"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"previousShift"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teamId"}},{kind:"Field",name:{kind:"Name",value:"teamName"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"scheduleGroupDisplayName"}},{kind:"Field",name:{kind:"Name",value:"teamOlsonCode"}}]}},{kind:"Field",name:{kind:"Name",value:"currentShift"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teamId"}},{kind:"Field",name:{kind:"Name",value:"teamName"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"scheduleGroupDisplayName"}},{kind:"Field",name:{kind:"Name",value:"teamOlsonCode"}}]}},{kind:"Field",name:{kind:"Name",value:"nextShift"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"teamId"}},{kind:"Field",name:{kind:"Name",value:"teamName"}},{kind:"Field",name:{kind:"Name",value:"startTime"}},{kind:"Field",name:{kind:"Name",value:"endTime"}},{kind:"Field",name:{kind:"Name",value:"scheduleGroupDisplayName"}},{kind:"Field",name:{kind:"Name",value:"teamOlsonCode"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"isFocus"}},{kind:"Field",name:{kind:"Name",value:"workLocation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"location"}},{kind:"Field",name:{kind:"Name",value:"locationSource"}},{kind:"Field",name:{kind:"Name",value:"approximateDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"idType"}}]}}]}}]}}]}},15051:(e,n,i)=>{"use strict";i.d(n,{o:()=>a,f:()=>t});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"featureSettingsFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"UserFeatureSettingsInfo"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"coExistenceMode"}},{kind:"Field",name:{kind:"Name",value:"isPrivateChatEnabled"}}]}}]},t={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"userFields"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"User"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"objectId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"decoratedDisplayName"}},{kind:"Field",name:{kind:"Name",value:"givenName"}},{kind:"Field",name:{kind:"Name",value:"surname"}},{kind:"Field",name:{kind:"Name",value:"email"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}},{kind:"Field",name:{kind:"Name",value:"tenantName"}},{kind:"Field",name:{kind:"Name",value:"isFederated"}},{kind:"Field",name:{kind:"Name",value:"jobTitle"}},{kind:"Field",name:{kind:"Name",value:"department"}},{kind:"Field",name:{kind:"Name",value:"featureSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"featureSettingsFields"}}]}},{kind:"Field",name:{kind:"Name",value:"type"}},{kind:"Field",name:{kind:"Name",value:"profileType"}},{kind:"Field",name:{kind:"Name",value:"userType"}}]}},...a.definitions]}},256350:(e,n,i)=>{"use strict";i.d(n,{I:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"userProperties"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConversationUserProperties"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"isMutedInChannel"}},{kind:"Field",name:{kind:"Name",value:"role"}},{kind:"Field",name:{kind:"Name",value:"maskId"}}]}}]}},525854:(e,n,i)=>{"use strict";i.d(n,{oU:()=>u,oD:()=>g,QO:()=>N,Mw:()=>f,ON:()=>h,Rp:()=>v,wM:()=>M,s4:()=>y,Hb:()=>S,DB:()=>A,fb:()=>I,HS:()=>D,MN:()=>F,V3:()=>U,oj:()=>E,cM:()=>j,tp:()=>z});var a=i(309501),t=i(149041),r=i(811957),o=i(744058),l=i(662537),s=i(471266);const d="default",c="CallableChannelOboCall",m="callParkService",u="delegates",p="call-log",k="sla-call-history",g=";",N=e=>{switch(e){case"default":return l.FT.Default;case"screenSharing":case"ScreenSharing":return l.FT.ScreenSharing;case"emergencyGroupCall":return l.FT.EmergencyGroupCall;default:return l.FT.Unknown}},f=e=>e?{...e,type:e.type||d}:void 0,h=e=>({type:e.type,configId:e.configId,onBehalfOf:e.onBehalfOf&&{...e.onBehalfOf,type:d},details:e.details&&{...e.details,type:d}}),v={displayName:"Unknown",id:"28:unknown",type:d},T=(e,n,i="value")=>{if(!e)return"";const a=`${i}="`,t=e.find((e=>e.indexOf(n)>=0))?.match(new RegExp(`${i}="(.*?)"`,"g"));return t?t[0].substr(a.length,t[0].length-a.length-1):""},M=(e,n,i,t,r)=>{let o,l,s,d,c=(new Date).toISOString();if(r===a.Cs.CallTranscript){const n=((e,n)=>{if(n)try{const e=JSON.parse(unescape(n.replace(/\u200b|\\/g,"")));return{callId:e.callId,userParticipantId:e.originatorParticipantId,transcriptMsg:{scopeId:e.scopeId,isExportedToOdsp:e.isExportedToOdsp}}}catch(n){return void e.error("failed to parse transcription content.",n)}})(e,i);if(!n)return;o=n.callId,l=n.userParticipantId,s=n.transcriptMsg}else if(r===a.Cs.CallLogTranscript){const n=((e,n)=>{if(n)try{const e=JSON.parse(unescape(n.replace(/\u200b|\\/g,""))),{CallId:i,UserParticipantId:a,ThreadId:t,MessageId:r}=e;return{callId:i,userParticipantId:a,transcriptMsg:{linkedMessage:{conversationId:t,messageId:r}}}}catch(n){return void e.error("failed to parse transcription content.",n)}})(e,i);if(!n)return;o=n.callId,l=n.userParticipantId,s=n.transcriptMsg}else if(r===a.Cs.CallLogRecording){const n=((e,n)=>{if(n)try{const e=JSON.parse(unescape(n.replace(/\u200b|\\/g,""))),{CallId:i,UserParticipantId:a,ThreadId:t,MessageId:r,ContentTypes:o}=e;return{callId:i,userParticipantId:a,recordingMsg:{contentTypes:o,linkedMessage:{conversationId:t,messageId:r}}}}catch(n){return void e.error("failed to parse recording message content.",n)}})(e,i);if(!n)return;o=n.callId,l=n.userParticipantId,d=n.recordingMsg}else if(r===a.Cs.CallRecording){const e=((e,n)=>{if(!e)return;const i=e.match(/<.*?>/g),t=T(i,'<Id type="callId"'),r=T(i,"<RecordingContent contentTypes=","contentTypes"),o=T(i,'<Id type="OriginatorParticipantId"'),l=T(i,"<RecordingInitiatorId ");return{callId:t,userParticipantId:o,recordingMsg:{conversationId:a.wS,messageId:n||"",initiatorId:l,content:e,contentTypes:r}}})(i,t);if(!e)return;o=e.callId,l=e.userParticipantId,d=e.recordingMsg}else o=n.callId,l=n?.userParticipantId,c=n.startTime;return{callId:o??"",userParticipantId:l,transcript:s,recordings:d&&[d]||[],startTime:c??""}},y=(e,n)=>"-1"===e?n:e,S=({skypeMessage:e,loggerFactory:n})=>{const i=e.conversationid,a=e.messagetype,r=e.content,{callHistoryInput:d,isSlaCallHistory:c}=I(e),m=y(e.id,e.clientmessageid);if(x(d,i))return;const u=n.newLogger("CallHistoryHelper","data-resolvers-calling");try{const i=O(d),{callDirection:p,callState:k,callType:T,callPhoneLineType:y,connectTime:S,endTime:A,eventTranscript:I,isDeleted:x,originatorParticipant:V,participantList:P,sessionType:R,sharedCorrelationId:B,targetParticipant:Q,threadId:W,spamProperties:Z,callAttributes:Y,forwardingInfo:G,transferInfo:_,sharedLineAppearanceParticipantList:J,targetDelegator:H}=i,q=j(i),X=M(u,i,r,m,a);if(!X)return;let K=f(V);K||(K=v,u.warn(`Could not parse valid participant from ${d}`));const $=(e=>"private"===e?s.Eg.private:null)(y),ee=(e=>{switch(e){case"missed":return l.Qv.Missed;case"accepted":return l.Qv.Accepted;case"declined":return l.Qv.Declined;case"acceptedElsewhere":return l.Qv.AcceptedElsewhere;default:return l.Qv.Unknown}})(k),ne=(e=>"incoming"===e?l.kw.Incoming:"outgoing"===e?l.kw.Outgoing:l.kw.Unknown)(p),ie=F(P,Q?.type,V?.type,Y?.transferor?.type,_?.parkType),ae=L(u,i),{validTargetParticipant:te,forwarderParticipant:re,forwardedTargetParticipant:oe}=b(ee,Q,G,Y,c,!!ae.isSharedLineAppearanceActivated,H),{transferorParticipant:le,transferTargetParticipant:se}=C(Y,_,ie),de=(e=>"twoParty"===e?l.Bd.TwoParty:"multiParty"===e?l.Bd.MultiParty:l.Bd.Unknown)(T),ce=q&&h(q),{isCallQueue:me}=(0,o.$Z)({callType:de,applicationContent:ce}),ue=ne===l.kw.Outgoing,pe=ne===l.kw.Incoming,ke=ne===l.kw.Incoming&&ee===l.Qv.Missed,ge=ee===l.Qv.Declined,Ne=ee===l.Qv.AcceptedElsewhere,fe=R===l.FT.EmergencyGroupCall&&P?.length>1,he=(0,o.r4)({endTime:A,connectTime:S,targetParticipant:Q}),ve=e.originalarrivaltime;return{id:`${m}${g}${X.callId}`,callStartTime:new Date(X.startTime).getTime(),applicationContent:ce,callDirection:ne,originalArrivalTime:ve,isMissed:ke,isIncoming:pe,isOutgoing:ue,isDeclined:ge,isAcceptedElsewhere:Ne,isEmergencyGroupCall:fe,isCallQueue:me,callState:ee,callType:de,callPhoneLineType:$,durationInMs:he,connectTime:S,endTime:A,isDeleted:x,messageId:m,messageType:(0,t.DE)(n,a,e.properties),originatorParticipant:K,participantList:P?P.map(f):[],targetParticipant:te,threadId:W,sessionType:N(R),sharedCorrelationId:B??"",spamRiskLevel:Z?Z.riskLevel:null,...X,transferorParticipant:le,transferTargetParticipant:se,transferTime:_?.transferTime,transferStatus:_?.transferStatus&&D(_.transferStatus),forwarderParticipant:re,forwardedTargetParticipant:oe,forwardedTargetType:E(G?.forwardingDestinationType),forwardingType:U(G?.forwardingType),isSharedLineAppearanceCallHistory:c,...c?w(u,i):ae,sharedLineAppearanceParticipantList:J?J.map(f):[],sharedLineAppearanceCallActionList:I?z(I):[]}}catch(e){u.warn(`UnhandledException in message transformation: ${e}`)}},A=({targetParticipant:e,originatorParticipant:n,applicationContent:i},a,t)=>e&&n&&a?t?i?.onBehalfOf?.id:i?.details?.id||null:null,I=e=>{const{properties:n,callLogsOwnerId:i}=e,a={callHistoryInput:void 0,isSlaCallHistory:!!i};return n&&(n[k]?(a.callHistoryInput=n[k],a.isSlaCallHistory=!0):n[p]&&(a.callHistoryInput=n[p])),a},b=(e,n,i,a,t,r,o)=>{let s,d,c=n&&f(n);return e===l.Qv.Accepted&&i?.acceptedBy&&(s=t?o&&f(o):c,c=f(i.acceptedBy)),a?.forwardedFrom&&(s=f(a.forwardedFrom)),(e===l.Qv.AcceptedElsewhere||t||r)&&i?.acceptedBy&&(d=f(i.acceptedBy)),a?.delegator&&(s=f(a.delegator)),{validTargetParticipant:c,forwarderParticipant:s,forwardedTargetParticipant:d}},C=(e,n,i)=>{let a,t;return i||(e?.transferor&&(a=f(e.transferor)),n?.transferor&&(a=f(n.transferor)),n?.transferTarget&&(t=f(n.transferTarget))),{transferorParticipant:a,transferTargetParticipant:t}},D=e=>{switch(e){case"transferred":return l.hy.Transferred;case"transferAccepted":return l.hy.TransferAccepted;case"transferFailed":return l.hy.TransferFailed;case"transferSucceeded":return l.hy.TransferSucceeded;default:return l.hy.Unknown}},F=(e,n,i,a,t)=>{const r=t&&"none"!==t&&"Unknown"!==t;return r||r&&!!e?.find((e=>e.type&&e.type===m))||n===m||i===m||a===m},U=e=>{switch(e){case"immediate":return l.Io.Immediate;case"simultaneous":return l.Io.Simultaneous;default:return}},E=e=>{switch(e){case"user":return l.Ry.SingleTarget;case"group":return l.Ry.Group;case"delegates":return l.Ry.MyDelegates;case"voicemail":return l.Ry.Voicemail;default:return}},w=(e,n)=>{const{sharedLineAppearanceForwardType:i,originatorDelegator:a,targetDelegator:t}=n;return e.log("[toCallHistoryItem] This is an SLA Call created as part of Shared History"),{forwardingType:U(i),originatorDelegator:a&&f(a),targetDelegator:t&&f(t)}},L=(e,n)=>{const{callAttributes:i,forwardingInfo:a,sharedLineAppearanceActivated:t}=n,o=i?.onBehalfOf?.id&&(0,r.lp)(i.onBehalfOf.id);return e.log("[toCallHistoryItem] This is an SLA Call created as part of Personal History"),{isSharedLineAppearanceActivated:!!(t||i?.delegator||o||a?.forwardingDestinationType===u),originatorDelegator:o&&i?.onBehalfOf?f(i.onBehalfOf):void 0,targetDelegator:i?.delegator?f(i.delegator):void 0}},x=(e,n)=>void 0===n?!e:n!==a.wS&&n!==a.tP,O=e=>e?JSON.parse(e):{},j=e=>{const{applicationContent:n,callAttributes:i,onBehalfOfContext:a}=e;let t;return t=a&&!n?{type:c,configId:a.id||"",onBehalfOf:{type:i?.onBehalfOf?.type||c,id:i?.onBehalfOf?.id||"",displayName:i?.onBehalfOf?.displayName||""}}:n,t},V=e=>{const n=(e=>{switch(e){case"hold":return l.LW.Hold;case"resume":return l.LW.Resume;case"barge":return l.LW.Barge;default:return}})(e.callAction),i=f(e.actionOriginator);if(!n||!i)return;return{callAction:n,callActionTime:e.actionTime,callActionOriginator:i}},z=e=>{const n=[];return e.forEach((e=>{const i=V(e);i&&n.push(i)})),n}},471266:(e,n,i)=>{"use strict";i.d(n,{Eg:()=>a});const a={private:"private"}},368693:(e,n,i)=>{"use strict";i.d(n,{Nd:()=>o,nq:()=>l,NF:()=>s,gS:()=>d});var a=i(309501),t=i(981917),r=i(569864);const o=e=>{if(e)switch(e){default:case"Success":return"Success";case"SendFailure":return"SendFailure";case"SendFailureCanRetry":return"SendFailureCanRetry";case"EditFailure":return"EditFailure";case"EditFailureCanRetry":return"EditFailureCanRetry";case"DeleteSingleFailure":return"DeleteSingleFailure";case"DeleteSingleFailureCanRetry":return"DeleteSingleFailureCanRetry";case"DeleteAllFailure":return"DeleteAllFailure";case"DeleteAllFailureCanRetry":return"DeleteAllFailureCanRetry"}},l=e=>!(!e||!/^\[[^\]]+\]$/gi.test(e)),s=e=>{if(!e||!(0,r.J6)(e))return null;if((0,r.qo)(e)===t.xu.Standard){return(e=>{if(!e)return null;let n,i;try{i=e[a.Q5.ChannelSettings]&&JSON.parse(e[a.Q5.ChannelSettings])}catch{return null}if(!i)return null;switch(i?.allowReplies){case t.yt.Moderators:n="Moderators";break;case t.yt.Everyone:default:n="Everyone"}return n})(e.threadProperties)}return null},d=e=>e?!0===e.memberProperties?.isModerator||!1:null},325506:(e,n,i)=>{"use strict";i.d(n,{b6:()=>Y,NP:()=>Z,uH:()=>ee,xA:()=>q,Kn:()=>$,FX:()=>X,Hi:()=>H,Rx:()=>K,NL:()=>Kn,AY:()=>cn,pR:()=>en,xr:()=>Le,Gt:()=>De,q7:()=>Ce,qJ:()=>Qn,MB:()=>xn,fN:()=>Je,H4:()=>Te,dx:()=>ye,qA:()=>di,hj:()=>ci,Oz:()=>ui,Qq:()=>rn,vI:()=>tn,I6:()=>on,wq:()=>mi,eY:()=>zn,zT:()=>an,Dy:()=>ri,Er:()=>oi,D1:()=>wn,nI:()=>_n,YD:()=>Yn,rP:()=>Bn,UL:()=>Wn,Eu:()=>Xn,wm:()=>Gn,nm:()=>li,oQ:()=>ti,im:()=>Un,AK:()=>Zn,fM:()=>Jn,GE:()=>qn,Go:()=>On,wX:()=>Be,Ey:()=>Me,bv:()=>Ve,lg:()=>hn,yU:()=>Ue,aw:()=>Rn,x6:()=>Nn,_$:()=>gn,ph:()=>Mn,O5:()=>Sn,Hl:()=>fn,J$:()=>Oe,CH:()=>xe,sf:()=>We,TK:()=>Ie,b_:()=>nn,FH:()=>$e,nF:()=>un,Th:()=>Ae,eN:()=>In,l0:()=>En,Lr:()=>kn,it:()=>fe,YX:()=>Cn,Yv:()=>Fn,ob:()=>Qe,eH:()=>te,is:()=>de,YU:()=>Ne,_S:()=>vn,t4:()=>Tn,zK:()=>Se,ac:()=>Ee,_V:()=>Pn,iB:()=>be,RU:()=>Vn,OB:()=>re,xT:()=>jn,Pi:()=>Ln,SX:()=>ai});var a=i(683184),t=i(485510),r=i(665641),o=i(832579),l=i(42163),s=i(811957),d=i(309501),c=i(149041),m=i(494493),u=i(879789),p=i(981917),k=i(569864),g=i(725952),N=i(247225),f=i(19645),h=i(900366),v=i(980860),T=i(871471),M=i(852793),y=i(702135),S=i(689626),A=i(803238),I=i(525854),b=i(620418),C=i(443089),D=i(526462),F=i(439697);const U=e=>{if(!e)return[];const n="meeting.scheduledMeetingInfo";let i=L(e,["startTime","endTime","eventType"],n);const{eventRecurrenceRange:a,eventRecurrencePattern:t}=e;return i=[...i,...E(a,n),...w(t,n)],i},E=(e,n)=>L(e,["startDate"],`${n}.eventRecurrenceRange`),w=(e,n)=>{let i=[];if(e){const{daily:a,weekly:t,monthly:r,yearly:o,relativeMonthly:l,relativeYearly:s}=e;i=[...L(e,["patternType"],`${n}.eventRecurrencePattern`),...L(a,["interval"],`${n}.eventRecurrencePattern.daily`),...L(t,["interval","daysOfTheWeek"],`${n}.eventRecurrencePattern.weekly`),...L(r,["interval","dayOfMonth"],`${n}.eventRecurrencePattern.monthly`),...L(o,["month","dayOfTheMonth"],`${n}.eventRecurrencePattern.yearly`),...L(l,["interval","dayOfTheWeekIndex","dayOfTheWeek"],`${n}.eventRecurrencePattern.relativeMonthly`),...L(s,["month","dayOfTheWeekIndex","dayOfTheWeek"],`${n}.eventRecurrencePattern.relativeYearly`)],t&&t.daysOfTheWeek&&t.daysOfTheWeek.some((e=>(0,A.isNil)(e)))&&i.push(`${n}.eventRecurrencePattern.weekly.daysOfTheWeek`)}return i},L=(e,n,i)=>{const a=[];return(0,A.isNil)(e)||n.forEach((n=>{(0,A.isNil)(e[n])&&a.push(`${i}.${n}`)})),a};var x=i(873644),O=i(190381),j=i(368693);function V(e){return!!e&&(e.messageType&&(n=e.messageType,[d.Cs.AddMember,d.Cs.Call,d.Cs.CallRecording,d.Cs.CallLocalRecording,d.Cs.CallTranscript].indexOf(n)>=0)||function(e){return!!e.deleteTime}(e));var n}const z=(e,n)=>e?.from!==n&&!!e?.mentions?.some((e=>"everyone"===e.mentionType));var P=i(457469);const R=e=>e&&e.vivaTopicsAnnotations?(e=>{try{return(e=>{const{ApiVersion:n,EntityAnnotation:i,TraceId:a,ClientRequestId:t}=e,{SectionMatches:r}=i;return{apiVersion:n,entityAnnotation:{sectionMatches:r.map((e=>{const{EntityMatches:n,SectionId:i}=e;return{entityMatches:n.map((e=>{const{Entities:n,HighlightedName:i,Length:a,StartPos:t,OccurrenceIndex:r,TotalOccurrences:o,Relevance:l}=e;return{entities:n.map((e=>{const{DisplayName:n,Id:i,RelevanceScore:a,Source:t,Type:r}=e;return{displayName:n,id:i,relevanceScore:a,source:t,type:r}})),highlightedName:i,length:a,startPos:t,occurrenceIndex:r,totalOccurrences:o,relevance:{annotationScore:l.AnnotationScore}}})),sectionId:i}}))},traceId:a,clientRequestId:t}})((0,P.T)(e))}catch(e){return}})(e.vivaTopicsAnnotations)??null:null,B="http://schema.skype.com",Q=`${B}/StarredMessage`,W=`${B}/Mention`,Z=`${B}/File`,Y=2,G=h.F,_=new Map([["sms","SMS"],["email","Email"],["call","Call"],["teamscall","TeamsCall"],["etnp","ETNP"]]),J=new Set(["RichText/Media_LocalRecording","RichText/Media_CallRecording","RichText/Media_CallTranscript","Event/Call"]);var H;!function(e){e.FAMILY="family",e.FRIENDS="friends",e.PROJECT="projectCoord",e.WORKPLACE="company",e.TRIP_PLANNING="tripPlanning",e.GET_TOGETHER="getTogether",e.LOCAL_COMMUNITY="localCommunity",e.HOLIDAY_PLANNING="holidayPlanning"}(H||(H={}));const q="preview-",X="newchat",K="welcomePage",$="bizChatMetaOSChatListEntryPoint",ee="holisticRecapChatListEntryPoint",ne=(e,n,i=!1)=>{if(!e?.emotions)return null;const a=e.emotions.map((({key:e,users:n})=>({key:e,users:n.map((({mri:e,time:n,value:i})=>({id:G(e),time:n,value:i}))).sort(((e,n)=>e.time-n.time))})));return i&&a.sort(((e,i)=>(n?.emotions?.[i.key]??i.users.length??0)-(n?.emotions?.[e.key]??e.users.length??0))),a},ie=e=>{if(!e||!e.emotions)return null;const n=e.emotions;return Object.keys(n).map((e=>({key:e,count:n[e]})))},ae=e=>{if(!e||!e.escalations)return null;return JSON.parse(e.escalations).map((({key:e,users:n})=>({key:_.get(e),users:n.map((({mri:e,time:n,value:i})=>({mri:G(e),time:n,value:i})))})))},te=(e,n,i)=>e&&e.mentions?le(e.mentions,n,i):null,re=(e,n,i)=>e&&e.onbehalfof?le(e.onbehalfof,n,i):null,oe=(e,n)=>{if(!n||!n.atp)return null;const i=n.atp;try{return"string"==typeof i?JSON.parse(i):i}catch(n){return e.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in toAtpSharepointData: ${n}`),null}},le=(e,n,i)=>{try{if("string"==typeof e&&(0,s.lp)(e))return null;const i="string"==typeof e?JSON.parse(e):e;return i?.length?i.map((({itemid:e,mri:i,displayName:a,mentionType:t})=>({id:`${n}_${e}_${i}`,userId:i,itemId:e,displayName:a,mentionType:t}))):null}catch(e){const a=i?.newLogger("Chat Helper","data-resolvers-common");return a?.errorToTelemetry?.(`UnhandledException in messageId: ${n}, processMentions - errorcode: ${e.errorcode}, error: ${e.error}`,"process_mentions_parse_error"),null}},se=(e,n,i,a)=>{if(!n||!n.files)return null;const t=e.newLogger("Chat Helper","data-resolvers-common");try{let e=JSON.parse(n?.files),r=0;return e=e.filter((e=>"deeplink"===e.type)),r=e.length,e=e.filter((e=>e)),r!==e.length&&(t?.errorToTelemetry?.(`toDeepLinks::Files contains falsy value. Filtered out.::id=${i}::conversationId=${a}`,"process_deeplink_parse_error"),r=e.length),e=e.filter((e=>e.id)),r!==e.length&&t?.errorToTelemetry?.(`toDeepLinks::Files contains object without id field which should be a required field. Filtered out.::id=${i}::conversationId=${a}`,"process_deeplink_parse_error"),e.map((({id:e,title:n,fileInfo:i,channelId:a,state:t})=>({id:e,title:n,state:t,serverRelativeUrl:i.serverRelativeUrl,channelId:a,siteUrl:i.siteUrl,objectUrl:i.fileUrl})))}catch(e){return t?.errorToTelemetry?.(`toDeepLinks::errorcode=${e.errorcode}::error=${e.error}::id=${i}::conversationId=${a}`,"process_deeplink_parse_error"),null}},de=e=>e&&JSON.stringify((0,A.map)(e,(({content:e,...n})=>({...n,content:JSON.parse(e)})))),ce=(e,n)=>{if(!e||!e.links)return{urlPreview:null,embeddedLinks:null};try{const n=["http","https"],i=JSON.parse(e.links),a=[],t=[];return i.forEach((e=>{me(e,a,n),ue(e,t,n)})),{urlPreview:t.length>0?t[0]:null,embeddedLinks:a}}catch(e){return n.newLogger("Chat Helper","data-resolvers-common").log(`Failed to parse message link properties: ${e}`),{urlPreview:null,embeddedLinks:null}}},me=(e,n,i)=>{const{url:a,fileShareUrlMeta:t,title:r,description:o}=e,l=(0,v.Nm)(a,i);t&&n.push({objectUrl:l,title:r,description:o,fileShareUrlMeta:t})},ue=(e,n,i)=>{const{url:a,preview:t,previewenabled:r}=e,{previewurl:o,previewmeta:l,title:s,description:d}=t||{},c=(0,v.Nm)(a,i);n.push({url:c,thumbnail:(0,v.Nm)(o,i),title:s,description:d,previewEnabled:r,thumbnailMeta:l?{width:l.width,height:l.height}:null})},pe=(e,n,i,a)=>{let t=a&&a.policyViolation;const r=a&&a.genericStreamMetadata;if(!t&&!r)return null;const o={};if("string"==typeof t)try{t=JSON.parse(t)}catch(i){e.newLogger("Chat Helper","data-resolvers-common").log(`Exception in parsing PolicyViolation in message: ${n}. Error: ${i}`)}t&&(o.policyViolation=t);let l=r&&r.policyTip;if("string"==typeof r)try{l=JSON.parse(r).policyTip}catch(i){e.newLogger("Chat Helper","data-resolvers-common").log(`Exception in parsing policy tip in message: ${n}. Error: ${i}`)}if(l){const e=a&&a.subject;o.dlpData={id:n,content:i,policyTip:l,subject:e}}return o},ke=e=>{if(!e.scheduledmeetinginfo||(0,A.isNil)(e.scheduledmeetinginfo.eventType))return null;const{iCalUid:n,...i}=e.scheduledmeetinginfo;return{iCalUID:n,...i}},ge=e=>{const{iCalUID:n,...i}=e;return{scheduledmeetinginfo:{...i,iCalUid:n}}},Ne=e=>{const{itemId:n,meetingTitle:i,meetingActionType:a,scheduledMeetingInfo:t,...r}=e,o={...r,...ge(t),itemid:n,meetingtitle:i,"@type":a};return JSON.stringify(o)},fe=(e,n)=>{if(!n||!n.meeting)return null;try{const e=JSON.parse(n.meeting),{organizerId:i,tenantId:a,meetingJoinUrl:t,location:r,itemid:o,meetingtitle:l,rsvpTo:s,body:c}=e;return(e=>{const{scheduledMeetingInfo:n}=e,i=U(n);if(i.length)throw(0,y.Tr)(S.w5.DataLayerClient,S.jK.MissingParameter,`validate Meeting schema failed. Missing required prop(s): ${i.join(", ")}`);return e})({meetingActionType:e[d.BM.MeetingType],organizerId:i,tenantId:a,meetingJoinUrl:t,location:r,itemId:o,meetingTitle:l,rsvpTo:s,body:c,scheduledMeetingInfo:ke(e)})}catch(n){return e.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in toMeeting: ${n}`),null}},he=(e,n,i,a)=>{const t=n||i;if(t)return t;if(a&&J.has(e)){const e=a.match(/<id type="callId"[^>]*?\svalue="([^"]+?)"/i);return e&&e[1]||null}return null},ve=(e,n)=>"-1"===e?n:e,Te=(0,l.Z)((e=>new Intl.Collator(e,{numeric:!1,sensitivity:"accent"}))),Me=(e,n)=>{if(e.length<=1)return e;const i=Te(n),a=[...e];return a.sort(((e,n)=>i.compare(e.displayName||"",n.displayName||""))),a},ye=(e,n,i)=>{const a=Me(e,i),t=[],r=[];return(0,A.forEach)(a,(e=>{const{id:i,displayName:a}=e;if(i!==n&&!F.eo.isTFLOffNetworkUser(i)&&a){if(r.push(a),20===r.length)return!1;t.length<3&&t.push(e)}return!0})),{membersLimited:t,memberDisplayNamesLimited:r}},Se=(e,n,i,a,t,o,l,d,c)=>{if(!e?.id)return;const m=Ae(e,n,a,t,i,!!o),{id:u,messagetype:p,properties:k,callId:g,skypeguid:N,composetime:f,content:h,contentHash:v,conversationid:T,draftDetails:M,crossPostData:y}=e,S=(0,s.kw)(M),A=(0,O.xJ)(n,k?.languageStamp,l?.targetLanguageCode,h,c),b=(0,O.R4)(l,A,m.translatedContent,m.translationStatus),C=R(k),D=(0,O.bv)(u,A?.code,d);return{...m,__typename:"Message",contentHash:v,interopDeliveryState:ii(k?.deliveryState),smsDeliveryReports:k&&k.smsDeliveryReports?k.smsDeliveryReports:null,announcement:Ve(k),escalations:ae(k),notification:$n(n,k),notifications:ni(n,k),meeting:fe(n,k),onBehalfOf:re(k,u,n),callId:he(p,g,N||k&&k.skypeguid,h),callLog:k&&(0,I.Hb)({skypeMessage:e,loggerFactory:n}),skypeguid:N,composeTime:f,isCallStartedMessage:(0,r.LY)(h,p),replyPermission:k?.replyPermission??null,atpSharepointData:oe(n,k),isDeletedByAdmin:k?.adminDelete||!1,suggestedActions:k?.suggestedActions||null,scheduledSendTime:S?new Date(S).toISOString():null,draftId:k?.draftId||(S?m?.id:null),forwardedMessageContext:je(k,h),conversationId:T,vivaTopicsAnnotations:C,crossPostStatus:y?(0,j.Nd)(y.status):void 0,crossPostFailedChannels:y?.failedChannels,isWrittenInPreferredLanguage:!b,languageSeenBefore:D,sourceLanguageCode:A?.code??null}},Ae=({id:e,content:n,originalarrivaltime:i,from:a,messagetype:t,annotationsSummary:r,userHasStarred:o,properties:l,clientmessageid:s,version:d,prioritizeimdisplayname:m,imdisplayname:u,translation:p,conversationid:k,conversationLink:g},N,f,h,v,T=!1)=>{let M=n;f&&(M=f);const y=(0,c.le)(N,l,h),S=(0,O.cC)(p),A="Done"===S?.translationStatus?(0,x.MX)()[0].toString():d,I=(0,O.xJ)(N,l?.languageStamp);return{id:ve(e,s),content:M,originalArrivalTime:i,from:G(a),messageType:(0,c.DE)(N,t,l),isImportant:(0,b.wU)(l?.importance),importance:(0,b.gy)(l?.importance),emotionsSummary:ie(r),emotions:ne(l,r,T),mentions:te(l,e,N),cards:y,files:(0,c.jz)(N,l),deeplinks:se(N,l,e,k||g),...ce(l,N),deleteTime:l?.deletetime,editTime:l?.edittime,version:A,userHasSaved:o,renamedDisplayName:m?u:null,imDisplayName:u,clientMessageId:s,dlpContext:pe(N,e,n,l),atpSharepointData:oe(N,l),status:v||"Delivered",hardDeleteReason:l?.hardDeleteReason,hardDeleteTime:l?.hardDeleteTime,onBehalfOf:re(l,e,N),sourceLanguageCode:I?.code??null,...S}},Ie=({content:e,contentHash:n,id:i,messageType:a,originalArrivalTime:t,type:r,version:o})=>({__typename:"Message",content:e,contentHash:n,id:i,messageType:a,originalArrivalTime:new Date(t).toISOString(),type:r,version:o}),be=(e,n,i)=>{const a=Se(e,n,Pn(e.state),void 0,void 0,!!i?.shouldSortReactions,i?.translationSettings,i?.seenLanguages,i?.translationLanguageStampingTunerSettings);if(!a)throw(0,y.Tr)("ChatHelpers",S.jK.Undefined,"toNewMessageSchema",{resource:e},"Bad shaped NewMessage");let t=null;if(e&&e.conversationLink){const n=(0,s.P5)(e);t=n===a.id?null:n}return{convId:e.conversationid||(0,s.o_)(e),replyChainId:t,threadType:e.threadtype,threadTopic:e.threadtopic,message:a}};function Ce(e,n){return{__typename:"LastMessage",content:"",preview:"",messageType:"Text",id:e,originalArrivalTime:n,imDisplayName:null,from:null,deleteTime:null,files:null,cards:null,embeddedLinks:null,callId:null,replyPermission:null,onBehalfOf:null,atpSharepointData:null,deeplinks:null,version:null,importance:null,interopDeliveryState:null,smsDeliveryReports:null,suggestedActions:null,emotions:null,emotionsSummary:null,escalations:null,mentions:null,status:null,clientMessageId:e,urlPreview:null,dlpContext:null,editTime:null,userHasSaved:null,isSystemMessage:!1,canShowEveryoneMentionBadge:!1}}function De(e,n){return{__typename:"ConsumptionHorizon",id:e,originalArrivalTime:n,timeStamp:n,clientMessageId:(0,D.K)()}}const Fe=()=>({members:[],membersLimited:[],activeCallsCount:null,canBeDiscarded:null,canBeFavorited:null,canBeHidden:null,botMembers:null,canBeLeft:null,canBeMuted:null,canBePinned:null,canBotBeBlocked:null,canManageApps:null,canPopOut:null,canTagContact:null,chatSubType:null,isDisabled:!1,isOneOnOne:!1,isOneOnOneBotChat:!1,isRead:!0,datatid:null,displayName:null,hasActions:null,hasActiveCalls:null,hasFailedMessages:null,isBotBlocked:null,isBotUser:null,isContactTagged:null,isFederated:!1,isHidden:null,isHighImportance:null,isLastMessageFromMe:null,isLastMessageText:null,isMeeting:!1,isMuted:null,isNewChat:!0,isSfB:!1,isUrgentImportance:null,isUserMember:!0,creator:null,meetingInformation:null,userConsumptionHorizon:null,consumptionHorizonBookmark:null,lastMessageTime:null,lastContentMessageTime:null,longTitle:null,messagePreview:null,messagePreviewAria:null,otherMemberMris:null,pictureGroup:null,pictureUpn:null,pinnedIndex:null,plGroupKey:null,presenceSource:null,showAtMention:null,showMarkers:null,tooltipTitle:null,substrateGroupId:null});function Ue(e){const n=new Date,i=n.toISOString(),a=n.getTime().toString();return{...Fe(),__typename:"Conversation",id:e,memberIds:[],memberDisplayNamesLimited:[],nonTeamsFederatedUserLimitedNames:[],hasFederatedUser:!1,chatHistoryHiddenTime:null,hasTflConsumerUser:!1,hasEnterpriseUser:!1,hasUnknownConsumerUser:!1,hasUnknownEnterpriseUser:!1,hasTflSmsUnverifiedUser:!1,hasTflSmsVerifiedUser:!1,tflOffNetworkUser:null,cfet:!1,consumerGroupId:null,tenantId:null,title:"",hasBotMember:!1,hasUnresolvedFederatedUser:!1,isChatDisabledForRecipients:!1,isPrivateChatPolicyDefinedScenario:null,meetingChatPolicy:null,me:null,tflOffNetworkUserLength:null,nonTeamsFederatedUsers:[],nonTeamsFederatedUsersLength:0,chatType:"Chat",type:"Chat",lastMessage:Ce(a,i),consumptionHorizon:De(e,i),addedBy:null,addedByTenantId:null,sensitivityLabel:null}}const Ee=({annotationsSummary:e,id:n,from:i,messageType:a,properties:t,version:r,...o},l,s,d=!1)=>{if(!n)return null;try{const m=R(t);return{__typename:"Message",id:n,from:i,messageType:(0,c.DE)(s,a,t),version:(0,A.isNumber)(r)?r.toString():void 0,isImportant:(0,b.wU)(t&&t.importance),importance:(0,b.gy)(t&&t.importance),interopDeliveryState:ii(t?.deliveryState),smsDeliveryReports:t?.smsDeliveryReports||null,emotions:ne(t,e,d),emotionsSummary:ie(e),announcement:Ve(t),escalations:ae(t),mentions:te(t,n,s),onBehalfOf:re(t,n,s),cards:(0,c.le)(s,t),files:(0,c.jz)(s,t),deeplinks:se(s,t,n,l),...ce(t,s),deleteTime:t&&t.deletetime,editTime:t&&t.edittime,isDeletedByAdmin:t&&t.adminDelete,scheduledSendTime:t?.sendAt||null,draftId:t?.draftId||null,forwardedMessageContext:je(t,o.content||""),hardDeleteTime:t&&t.hardDeleteTime,hardDeleteReason:t&&t.hardDeleteReason,suggestedActions:t?.suggestedActions||null,status:"Delivered",dlpContext:pe(s,n,o.content,t),meeting:fe(s,t),callId:t&&t.skypeguid,callLog:t&&(0,I.Hb)({skypeMessage:{properties:t,id:n,conversationid:l,messagetype:a,content:o.content,originalarrivaltime:o.originalArrivalTime},loggerFactory:s}),sourceLanguageCode:(0,O.xJ)(s,t?.languageStamp)?.code??null,vivaTopicsAnnotations:m,...o}}catch(e){return s.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in message transformation: ${e}`),{id:n,from:i,messageType:(0,c.DE)(s,a,t),isImportant:null,emotions:null,mentions:null,files:null,announcement:null,urlPreview:null,deleteTime:null,status:null,...o}}},we=({originalArrivalTime:e,timeStamp:n,clientMessageId:i})=>({originalArrivalTime:new Date(e).toISOString(),timeStamp:new Date(n).toISOString(),clientMessageId:i}),Le=(e,n,i)=>xe({id:e,properties:{[d.Ff.ConsumptionHorizon]:(0,m.A1)(i)},type:n}),xe=e=>({id:e.id,...we((0,m.bf)(e))}),Oe=e=>({id:e.id,...we((0,m.BU)(e))}),je=(e,n)=>{if(!e||!e.originalMessageContext)return null;const i=n.indexOf(u.mU.ForwardedContentStart),a=n.lastIndexOf(u.mU.ForwardedContentEnd),t=n.slice(i,a+u.mU.ForwardedContentEnd.length),r="string"==typeof e.originalMessageContext?JSON.parse(e.originalMessageContext):e.originalMessageContext;return{originalSenderMri:r.originalSender,originalArrivalTime:r.originalSentTime,originalMessageId:r.messageId,originalMessageContent:t,originalThreadId:r.originalThreadId,originalChannelPostSubject:e?.subject}},Ve=e=>{const n={title:"",originalImageUrl:null,croppedImageUrl:null,colorTheme:null};if(!e?.cards)return n;const i="string"==typeof e.cards?JSON.parse(e.cards):e.cards;if(!i||0===i.length)return n;const a=i.find((e=>"application/vnd.microsoft.teams.messaging-announcementBanner"===e.contentType));if(!a)return n;const t=ze(a);return{title:e.title?e.title:"",originalImageUrl:t.originalImageUrl,croppedImageUrl:t.croppedImageUrl,colorTheme:t.colorTheme,croppedImageHeight:t.croppedImageHeight,croppedImageWidth:t.croppedImageWidth,croppedImageAltText:t.croppedImageAltText,isTeamsIllustration:t.isTeamsIllustration}},ze=e=>{let n=(0,A.get)(e,"content.imageData.origImage.src",null),i=(0,A.get)(e,"content.imageData.croppedImage.src",null);const a=(0,A.get)(e,"content.imageData.croppedImage.imageHeight",null),t=(0,A.get)(e,"content.imageData.croppedImage.imageWidth",null),r=(0,A.get)(e,"content.imageData.croppedImage.imageAltText",null),o=(0,A.get)(e,"content.imageData.isTeamsIllustration",null);let l=(0,A.get)(e,"content.imageData.colorTheme",null)||(0,A.get)(e,"content.colorTheme",null);return n=void 0===n?null:n,i=void 0===i?null:i,l=void 0===l?null:l,{originalImageUrl:n,croppedImageUrl:i,croppedImageHeight:a,croppedImageWidth:t,croppedImageAltText:r,colorTheme:l,isTeamsIllustration:o}},Pe=(e,n,i)=>{try{const i=Re(n),a=i?.map((n=>({activityReplyToId:n.replyToId,activityTimestamp:n.timestamp,convId:e,suggestedReplies:n.suggestedActions.actions.filter((e=>e?.channelData?.id&&e?.channelData?.utcTime)).map((e=>{const i={targetMessageId:e?.channelData?.targetMessageId||n.replyToId,type:e?.channelData?.type||"reply"};return{suggestionChannelData:{...e?.channelData,...i},value:e.value||e.title,title:e.title,whisperId:n.id}}))})));return a&&0!==a.length?{suggestedRepliesCollections:a}:null}catch(e){return i.newLogger("Chat Helper","data-resolvers-common").error(`formatQuickReplyAugmentationFromObject: Exception in parsing quick reply augmentation. Error: ${e}`),null}},Re=e=>{const n=e&&e.suggestedActivities&&e.suggestedActivities.filter((e=>e?.type===d.uV&&e?.from?.id===d.ZI&&e?.timestamp&&e?.suggestedActions?.actions?.some((e=>e.type===d.qC||e.type===d.DC))));return n&&0!==n.length?n:null},Be=(e,n,i)=>{const a=n&&n[d.Ff.SmartReplies];return a&&"string"==typeof a?((e,n,i)=>{try{const a=JSON.parse(n);return Pe(e,a,i)}catch(e){return i.newLogger("Chat Helper","data-resolvers-common").error(`formatQuickReplyAugmentationFromString: Exception in parsing quick reply augmentation. Error: ${e}`),null}})(e,a,i):null},Qe=e=>{switch(e){case p.wJ.None:return"Unknown";case p.wJ.Adhoc:return"Adhoc";case p.wJ.Scheduled:return"Scheduled";case p.wJ.Recurring:return"Recurring";case p.wJ.Broadcast:return"Broadcast";case p.wJ.MeetNow:return"MeetNow"}},We=e=>e&&e.map((e=>({id:e.id,originalArrivalTime:e.consumptionhorizon,messageVisibilityTime:e.messageVisibilityTime})))||null;function Ze(e,n){if(!e||!n)return!1;return(0,k.hu)(e,n)>0}function Ye(e,n,i,a,t,r=!1,o=!1,l,d){const m=(0,c.C)(e,i),u=e.find((({id:e})=>e===n))||null,p=Vn(e),k=(0,s.iK)(e,t,[]).members||[];return{memberIds:k.map((({id:e})=>e)),...ye(k,n,a),...en(m),...cn(n,k),me:u,isUserMember:!!u,tflOffNetworkUser:(0,A.first)(p),tflOffNetworkUserLength:p.length,hasBotMember:k.some((({id:e})=>(0,s.bl)(e))),hasFederatedUser:!!m.length||r,hasTflConsumerUser:rn(k)||o,hasEnterpriseUser:dn(k),hasUnknownEnterpriseUser:sn(k),hasUnknownConsumerUser:ln(k),hasUnresolvedFederatedUser:m.some(F.eo.isUnknownUser),hasTflSmsUnverifiedUser:tn(k),hasTflSmsVerifiedUser:on(k),isRetentionHorizonSet:Ze(d,l),hasExtendedDirectoryUsers:si(k)}}function Ge(e,n,i){if(e&&!(0,A.isEmpty)(e))return kn(Se(e,n,void 0,void 0,void 0,i))}const _e=e=>"string"==typeof e?"true"===e.toLowerCase():e,Je=e=>{const n=Object.keys(e??{}).filter((e=>e.includes(d.Q5.Liveness))).map((n=>({key:n,value:String(e[n])})));return(0,A.isEmpty)(n)?null:n};function He(e,n,i,t,r,o,l,c,m){const{id:u,lastMessage:h}=e,v=Ge(h,t,!!i?.get(a.J.Messaging).expandedReactionsConfigs?.chat?.enableSend),T=o?.id||"",M=!!(0,k.YP)(e),y=(0,j.NF)(e),S=(0,j.gS)(e),I=((e,n,i,t,r,o,l)=>{const{id:s,lastMessage:d}=e,c=Ge(d,t,!!i?.get(a.J.Messaging).expandedReactionsConfigs?.chat?.enableSend),m=o?.id||"",u=Wn(s);if(!c)return null;let p=d?.preview??"";if("string"!=typeof p&&!p){const a=(0,A.keyBy)(n,"id");i&&l&&(p=(0,N.t)({conversation:e,profilesMap:a,coreSettings:i,i18n:l,loggerFactory:t,currentUserMri:m,currentUserTenantId:r??"",addSenderName:!0}))}const k=function(e,n){return!!e?.mentions?.some((e=>e.userId===n))}(c,m);return{...c,preview:p,clientMessageId:u?Date.now().toString():c?.clientMessageId,originalArrivalTime:u?e.clientArrivalTime:c?.originalArrivalTime,isSystemMessage:V(c),hasMention:k,canShowEveryoneMentionBadge:z(c||void 0,m)&&!k}})(e,n,i,t,r,o,c),b=Ye(n,T,r,l,e.threadProperties,e.usersProps?.hasFederatedUser,e.usersProps?.hasConsumerUser,i,e),C=function(e,n,i,a){const{id:t,properties:r,threadProperties:o}=e,l=Oe(e);return{chatSubType:Mn(o.threadType),chatType:Sn(o.threadType),consumptionHorizon:xe(e),consumptionHorizonBookmark:l,quickReplyAugmentation:Be(t,r,n),creator:o[d.Q5.Creator],importState:pn(o[d.Q5.ImportState]),isDisabled:wn(o.isDisabled),disabledReason:un(o.disabledReason),isLastMessageFromMe:o.isLastMessageFromMe,meetingInformation:Mn(o.threadType)===p.k2.Channel?void 0:On(t,o[d.Q5.Meeting]),sensitivityLabel:o[d.Q5.SensitivityLabelId]?{id:o[d.Q5.SensitivityLabelId],isCopyBlocked:o[d.Q5.SensitivityLabelIsCopyBlocked]}:void 0,tenantId:o[d.Q5.TenantId],title:"backroom"===o.meetingChatType&&a?o.topic?.concat(a.stringTranslate("messaging","chat_header_backroom_chat")):o.topic,userConsumptionHorizon:l,interopConversationStatus:In(r[d.Ff.InteropConversationStatus]),gapDetectionEnabled:_e(o.gapDetectionEnabled),cfet:an(o.cfet),consumerGroupId:o[d.Q5.ConsumerGroupId],guardianChatInfo:o[d.Q5.GuardianChatInfo],groupTemplate:Hn(o[d.Q5.GroupTemplate]),themeId:o[d.Q5.ThemeId],picture:o[d.Q5.Picture],addedBy:r?.addedBy||null,addedByTenantId:r?.addedByTenantId||null,meetingChatPolicy:Cn(o[d.Q5.MeetingChatPolicy]),chatScheduleSuggestionSuppressUntil:r?.chatScheduleSuggestionSuppressUntil,isCommentStream:(0,g.Bu)(o,i,e.id),createdAt:o[d.Q5.CreatedAt],lastJoinAt:o[d.Q5.LastJoinAt],commentStreamPolicy:Cn(o.liveChatPolicy),meetingChatType:Fn(o?.meetingChatType)}}(e,t,i,c),D=e.properties.unpinnedTime?.toString(),F=(0,k.dO)(e,i).toString(),U=(0,k.ln)(e),E=(0,k.K5)(e.properties),{enableForwardMessageUnreadMarkers:w}=i?.get(a.J.Messaging)??{enableForwardMessageUnreadMarkers:!1};return{...e,...b,...C,...Xe(e.memberProperties),shortTitle:e.chatTitle?.shortTitle,longTitle:e.chatTitle?.longTitle,id:u,isRead:ti(e,o?.id||"",w??!1),isHidden:(0,s.e9)(u)?(0,f.w)(D,v?.originalArrivalTime,F,E,i):(0,f.n)(D,v?.originalArrivalTime,F),isMuted:(0,k.tl)(e)??(!!(0,s.e9)(u)&&m),isOneOnOne:M,isOneOnOneBotChat:M&&b.hasBotMember,isBotBlocked:qe(e.threadProperties?.messagingdisabled),isModerator:S,isFederated:(0,s.eX)(u),isMeeting:(0,s.e9)(u),isSfB:(0,g.Jn)(u),lastMessage:I,awarenessLiveState:Je(e.threadProperties),members:[],clearHistoryTime:F,chatHistoryHiddenTime:D,type:null,...jn(e.threadProperties.pinnedItems),quarantineCounter:U,replyPermission:y||null,fileReferences:e.threadProperties.fileReferences}}const qe=e=>"string"==typeof e?"true"===e.toLowerCase():Boolean(e),Xe=e=>{const n=e?.[d.e0.RelationshipState];return{extendedDirectoryRedemptionRequired:n?.edRedemptionRequired}},Ke=(e,n)=>(0,A.map)(n,(n=>e[n.id]||function(e){return(0,C.ne)({...e,mri:e.id,objectId:"",type:"",userPrincipalName:"",isMuted:e.isReader,displayName:e.friendlyName,role:e.role??""})}(n))),$e=(e,n,i,a,t,r,o,l,s)=>{try{return He(e,Ke(n,e.members),i,a,t,r,o,l,s)}catch(n){return a.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in toConversationSchemaFromSkypeConversationLocal transformation: ${n}`),{...e,id:e.id,isUserMember:!1,members:[],membersLimited:[],memberDisplayNamesLimited:[],type:null,lastMessage:null}}},en=e=>{const n=e.filter((e=>!F.eo.isUnknownUser(e)&&e.featureSettings?.coExistenceMode!==o.hN.TeamsOnly&&!!e.displayName));return{nonTeamsFederatedUserLimitedNames:n.slice(0,2).map((({displayName:e})=>e||"")),nonTeamsFederatedUsersLength:n.length}},nn=(e,n,i)=>{const a=e.threadProperties.tenantid,t=(0,T.D)(e.threadProperties.meeting).meetingJoinUrl??"";try{const i=Ke(n,e.members);return((e,n,i,a)=>({id:e,members:n,tenantId:i,meetingJoinUrl:a}))(e.id,i,a,t)}catch(n){return i.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in toConversationMembersSchemaFromSkypeConversationLocal transformation: ${n}`),{id:e.id,members:[],...a&&{tenantId:a},...t&&{meetingJoinUrl:t}}}},an=e=>"string"==typeof e?"true"===e?.toLowerCase():!!e,tn=e=>e.some((({id:e})=>(0,s.MR)(e))),rn=e=>e.some((e=>F.eo.isTFLConsumerUser(e))),on=e=>e.some((e=>F.eo.isTFLSmsVerifiedMri(e?.id))),ln=e=>e.some((e=>(0,s.Nl)(e.id)&&F.eo.isUnknownUser(e))),sn=e=>e.some((e=>F.eo.isEnterpriseUserMri(e.id)&&F.eo.isUnknownUser(e))),dn=e=>e.some((e=>F.eo.isEnterpriseUserMri(e.id))),cn=(e,n)=>{let i=!0;const a=n&&n.some((n=>{if(!n.isFederated&&!(0,s.B4)(n.id,d.f0)&&n.id!==e&&n.featureSettings){const e=n.featureSettings.isPrivateChatEnabled;return null==e?(i=!1,!0):!e}return!1}));return{isPrivateChatPolicyDefinedScenario:i,isChatDisabledForRecipients:a}},mn={opted_out:"OptedOut",claimed:"Claimed",deprovisioned:"Deprovisioned"},un=e=>{if(!e)return;const n=(0,T.D)(e);return{newlyCreatedUserId:n.userId,code:mn[n.code]}},pn=e=>{if(e)return(0,M.j)()("Importing","Completed").find((n=>n===e))},kn=e=>({...e,preview:"",isSystemMessage:!1,canShowEveryoneMentionBadge:!1,__typename:"LastMessage"}),gn=({id:e,members:n,consumptionHorizon:i,userConsumptionHorizon:a,lastMessage:t,creator:r,meetingInformation:o,isDisabled:l,disabledReason:s,importState:c,isMuted:m,isLastMessageFromMe:u,isRead:p,isOneOnOne:k,isOneOnOneBotChat:g,isSticky:N,isExternal:f,consumerGroupId:h,templateType:v,chatType:T,historyHiddenTime:M,createdAt:y,interopConversationStatus:S,quickReplyAugmentation:I,meetingPolicy:b,addedBy:D,addedByTenantId:F,sensitivityLabel:U,meetingChatType:E,...w},L,x,O,j)=>{try{const M=(0,A.map)(n,(e=>(0,C.ne)(e))),y=t&&kn(Ee(t,e,L)),V=o&&{id:e,subject:o.subject,startTime:o.startTime,scenario:o.scenario,endTime:o.endTime,iCalUid:o.iCalUid,location:o.location,exchangeId:o.exchangeId,meetingType:o.meetingType?Qe(o.meetingType):"Unknown",resolvedSensitivityLabelId:o.resolvedSensitivityLabelId,isCopyRestrictionEnforced:o.isCopyRestrictionEnforced,templateDetails:o.templateDetails,meetingJoinUrl:o.meetingJoinUrl,messagingPolicy:o.messagingPolicy},z=!(!k&&!N&&v!==d.Q5.ImmutableRoster),P=U&&U.id?{id:U.id,isCopyBlocked:U.protectTeamsLabelAction?.isCopyRestrictionEnforced||!1}:void 0;return{__typename:"Conversation",...Ye(M,O?.id||"",x,j),...w,id:e,consumptionHorizon:i&&{__typename:"ConsumptionHorizon",...Le(e,d.i1.Chat,i)},consumptionHorizonBookmark:a&&{__typename:"ConsumptionHorizonBookmark",...Le(e,d.i1.Chat,a)},userConsumptionHorizon:a&&{__typename:"ConsumptionHorizonBookmark",...Le(e,d.i1.Chat,a)},lastMessage:y,members:[],creator:r,meetingInformation:V,isDisabled:!!l,disabledReason:un(s),importState:pn(c),isMuted:m,isLastMessageFromMe:!!u,isRead:p,isOneOnOne:z,cfet:f,consumerGroupId:h,isOneOnOneBotChat:!!g,chatType:Sn(T),interopConversationStatus:In(S),quickReplyAugmentation:I&&Pe(e,I,L),addedBy:D,addedByTenantId:F,meetingChatPolicy:Cn(b),sensitivityLabel:P,meetingChatType:Fn(E)}}catch(n){L.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in conversation object transformation: ${n}`);return{...w,id:e,isUserMember:!1,consumptionHorizon:null,consumptionHorizonBookmark:null,userConsumptionHorizon:null,lastMessage:null,memberIds:[],members:[],membersLimited:[],chatHistoryHiddenTime:M,memberDisplayNamesLimited:[],creator:null,meetingInformation:null,chatType:null}}},Nn=({id:e,members:n,tenantId:i,meetingInformation:a},t)=>{try{const t=(0,A.map)(n,(e=>(0,C.ne)(e)));return{__typename:"ConversationMembers",id:e,tenantId:i=i??"",meetingJoinUrl:a?.meetingJoinUrl??"",members:t}}catch(n){t.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in conversation object transformation: ${n}`);return{id:e,members:[]}}},fn=(e,n,i,a,t)=>({node:gn(e,n,i,a,t),cursor:e.createdAt||e.id}),hn=e=>({activities:e.activities,callLogs:e.callLogs,chats:e.chats,total:e.total});function vn(e){return JSON.stringify((0,A.map)(e,(e=>{const n=e.mentionType,i=e.displayName;return{"@type":W,itemid:e.itemId,mri:e.userId,mentionType:n,displayName:i}})))}function Tn(e){return!e||e.length<1?null:JSON.stringify(e.map((e=>{const n=e.mentionType,i=e.displayName;return{itemid:e.itemId,mri:e.userId,mentionType:n,displayName:i}})))}const Mn=e=>{if(e)return"space"===e||"topic"===e?p.k2.Channel:"meeting"===e?p.k2.Meeting:p.k2.None},yn=new Map([["chat","Chat"],["phonechat","PhoneChat"],["phonelink1on1chat","Phonelink1on1Chat"],["phonelinkgroupchat","PhonelinkGroupChat"],["meeting","Meeting"],["sfbinteropchat","SfBInteropChat"]]),Sn=e=>{let n=null;return null==e||(n=yn.get(e),void 0===n&&(n=null)),n},An=new Map([["AcceptPending","AcceptPending"],["ExtendedDirectoryAcceptPending","ExtendedDirectoryAcceptPending"],["Accepted","Accepted"],["Blocked","Blocked"],["Quarantined","Quarantined"]]),In=e=>e&&An.get(e)||null,bn=new Map([["ChatEnabled","ChatEnabled"],["ChatDisabled","ChatDisabled"],["InMeeting","InMeeting"],["ChatEnabledAnonymousDisabled","ChatEnabledAnonymousDisabled"],["InMeetingAnonymousDisabled","InMeetingAnonymousDisabled"]]),Cn=e=>e&&bn.get(e)||null,Dn=new Map([["backroom","Backroom"]]),Fn=e=>e&&Dn.get(e)||null,Un=e=>!!e&&"PhoneChat"===e,En=e=>{if(!e)return!1;switch(typeof e){case"string":e="true"===e.toLowerCase();case"boolean":return e;default:return!1}},wn=e=>(0,A.isString)(e)?"true"===e.toLowerCase():e||!1,Ln=({id:e,conversationid:n,imdisplayname:i,from:a,composetime:t},r)=>e&&{"@type":Q,mri:G(a),imdisplayname:i,messageId:e,parentMessageId:r??e,threadId:n,isUnresolvedEmailUser:!1,originalComposeTime:t},xn=(e,n,i)=>{const a=i.find((i=>{try{const a=JSON.parse((i.properties||{}).starred),t=a&&a["@type"]===Q&&a.threadId===n?a.messageId:void 0;return e===t}catch(e){return!1}}));return a&&a.id},On=(e,n)=>{if(!n)return;const i=JSON.parse(n);return Object.keys(n).length?{id:e,...i,meetingJoinUrl:i.meetingJoinUrl||i.meetingJoinURL,meetingType:i.meetingType?Qe(p.wJ[i.meetingType]):"Unknown"}:void 0},jn=e=>{if(e)try{const n=JSON.parse(e);return{pinnedConversationItems:n.reduce(((e,n)=>("Message"===n.itemType&&e.push({__typename:"Message",id:n.itemId}),e)),[])}}catch{return}},Vn=e=>e.filter((({id:e})=>F.eo.isTFLOffNetworkUser(e))),zn=(e,n,i)=>{const a=ne(i.properties);return!!a&&a.some((i=>i.key===e&&!!i.users&&i.users.some((e=>e.id===n))))},Pn=e=>{let n;switch(e){case u.iv.Error:n="Error";break;case u.iv.Sending:n="Sending";break;default:n="Delivered"}return n},Rn=async({resourceType:e,resource:n},i,a)=>{if("ThreadUpdate"===e)try{const{id:e="",members:a}=n,t=a?await i(a,e):[];return{__typename:"ConversationMembers",id:e,members:t}}catch(e){a.newLogger("toChatMembersEvent","data-resolvers-common").error(`Failed getting thread members: ${e}`)}},Bn=e=>(0,g.Jn)(e)||(0,s.eX)(e)||(0,k.Bl)(e),Qn=(e,n)=>(0,A.filter)(e,(0,A.omit)(n,"__typename")),Wn=e=>!!e&&-1!==e.indexOf(q),Zn=e=>!!e?.startsWith("tfl:preview-"),Yn=e=>!!e&&(-1!==e.indexOf(d.X2)||-1!==e.indexOf(d.At)),Gn=e=>e===X,_n=e=>Gn(e)||Wn(e),Jn=e=>{switch(e){case H.FAMILY:case H.FRIENDS:case H.PROJECT:case H.WORKPLACE:case H.TRIP_PLANNING:case H.GET_TOGETHER:case H.LOCAL_COMMUNITY:case H.HOLIDAY_PLANNING:return!0}return!1},Hn=e=>{const n=e&&(0,T.D)(e).id;return Jn(n)?n:void 0},qn=e=>!!e&&-1!==e.indexOf(":tflfed:preview-"),Xn=e=>!!e&&e.includes("meeting"),Kn=(e,n,i,a,r,o,l,s)=>{if(!e)return;const d="Phonelink1on1Chat"===n,c="PhonelinkGroupChat"===n,m=i?t.Th.Meeting:a?r?t.Th.Botchat:Un(n)?t.Th.SMSOneOnOneChat:(0,k.Bl)(e)?t.Th.SfcInteropChat:(0,g.Jn)(e)?t.Th.SfbInteropChat:o?t.Th.NativeFederatedChat:l?t.Th.FederatedChat:(0,k.j8)(e)&&d?t.Th.Phonelink1on1Chat:t.Th.OneOnOneChat:(0,k.mB)(e)?t.Th.StreamOfNotes:(0,k.j8)(e)&&c?t.Th.PhonelinkGroupChat:(e=>!!e&&e===p.k2.Channel)(s)?t.Th.Channel:t.Th.GroupChat;return m},$n=(e,n)=>{if(!n||!n.notification)return null;try{const e=n.notification;return{alertInMeeting:e.alertInMeeting,externalResourceUrl:e.externalResourceUrl}}catch(n){return e.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in chat message notification transformation: ${n}`),null}},ei=e=>{if((0,A.isString)(e)){return{__typename:"DimensionInString",value:e}}if((0,A.isNumber)(e)){return{__typename:"DimensionInFloat",value:e}}return null},ni=(e,n)=>{if(!n||!n.notifications)return null;try{const e="string"==typeof n.notifications?JSON.parse(n.notifications):n.notifications;return e&&e.map((({surface:e,contentType:n,content:i})=>({surface:e,contentType:n,content:{value:{height:ei(i.value?.height)??void 0,width:ei(i.value?.width)??void 0,title:i.value?.title??"",url:i.value?.url??""},actions:i.actions??[]}})))}catch(n){return e.newLogger("Chat Helper","data-resolvers-common").log(`UnhandledException in message notifications parsing: ${n}`),null}};function ii(e){if(e)return"string"==typeof e?e:e.state}const ai=(e,n,i)=>{const t=i.get(a.J.Messaging).commCopilotSummarizationRequestConfig;return t?{gptVersion:t.gptVersion,summaryMode:t.summaryMode,input:{type:t.threadType,id:e,lookbackperiod:n},promptSetting:{temperature:"1.0"}}:null},ti=(e,n,i=!1)=>(0,m.uy)(e,n,i),ri=e=>e.chatSubType===p.k2.Channel,oi=e=>{if(ri(e)){const n=e.threadProperties?.[d.Q5.SpaceTypes],i=n?parseInt(n,10):0;return!!!e.threadProperties?.[d.Q5.SubstrateGroupId]&&i!==p.tG.Private}return!1};function li(e,n,i){if(!e.members)return!1;const a=e.members.find((e=>e.id!==i));return!!a&&(e.source===u.vO.PutConversationLie&&2===e.members.length&&!!n[a.id])}const si=e=>e.some((e=>F.eo.isExtendedDirectoryUser(e))),di=(e,n)=>{if(ti(e,n.currentUserMri)||!e.lastMessage)return!1;const i=e.lastMessage.properties,a=te(i,e.lastMessage.id,n.loggerFactory),t=a?.some((({mentionType:e})=>"everyone"===e)),r=e.lastMessage.from&&!e.lastMessage.from.includes(n.currentUserMri);return!(!t||!r)},ci=(e,n)=>{if(ti(e,n.currentUserMri))return!1;const i=e.lastMessage?.properties,a=i?.importance;return!(!a||!(0,b.wU)(a))},mi=(e,n)=>{if(ti(e,n.currentUserMri))return!1;const i=e.lastMessage?.properties,a=i?.importance;return!(!a||!(0,b.vA)(a))},ui=(e,n)=>{if(ti(e,n.currentUserMri)||!e.lastMessage)return!1;const i=e.lastMessage.properties,a=te(i,e.lastMessage.id,n.loggerFactory);return!!(a&&a.length>0&&a.some((e=>e.userId===n.currentUserMri)))}},526462:(e,n,i)=>{"use strict";i.d(n,{w:()=>s,K:()=>d,su:()=>c});var a=i(873644),t=i(282050),r=i(683184);const o=e=>e&&e.startsWith(t.V.Bot),l=e=>o(e)?e.slice(3):e.slice(e.includes("_")?41:8),s=(e,n)=>{let i=[];return i=o(e)&&!o(n)?[l(n),l(e)]:!o(e)&&o(n)?[l(e),l(n)]:[l(e),l(n)].sort(),`19:${i[0]}_${i[1]}@unq.gbl.spaces`};function d(){const[e,n]=(0,a.MX)(2);return`${e}${n}`.substr(0,19)}function c(e){const{ageGroup:n}=e.get(r.J.AgeConsent);return"MinorWithMsaParentalConsent"===n||"MinorWithoutMsaParentalConsent"===n||"MinorNoMsaParentalConsentRequired"===n||"MinorWithoutParentalConsent"===n||"MinorWithParentalConsent"===n||"MinorNoParentalConsentRequired"===n}},620418:(e,n,i)=>{"use strict";var a,t;i.d(n,{IF:()=>t,wU:()=>r,vA:()=>o,jY:()=>l,gy:()=>s}),function(e){e[e.Standard=0]="Standard",e[e.Important=2]="Important",e[e.Urgent=3]="Urgent"}(a||(a={})),function(e){e.Standard="",e.Important="high",e.Urgent="urgent"}(t||(t={}));const r=e=>"Important"===s(e),o=e=>"Urgent"===s(e),l=e=>t[e]||t.Standard,s=e=>{switch(e){case t.Important:case a.Important:return"Important";case t.Urgent:case a.Urgent:return"Urgent";case t.Standard:case a.Standard:default:return"Standard"}}},449473:(e,n,i)=>{"use strict";i.d(n,{xw:()=>a,HE:()=>t,OB:()=>o});const a="suggested-org-group-chat",t="suggested-project-group-chat",r=[a,t];function o(e){return r.includes(e)}},208689:(e,n,i)=>{"use strict";i.d(n,{c4:()=>o,zf:()=>l,Bd:()=>s,RJ:()=>d,FL:()=>c});var a=i(981917),t=i(569864),r=i(803238);const o=e=>{switch(e){case a.m1.Moderate:return"Moderate";case a.m1.NoRestriction:return"NoRestriction";case a.m1.Strict:default:return"Strict"}},l=(e,n,i,a)=>d(n,e.threadProperties.spaceThreadTopic,e.threadProperties.pictureETag,e.threadProperties.groupId,i,a),s=(e,n,i,a,t)=>d(i,e.threadProperties.topicThreadTopic,n?.threadProperties.pictureETag,n?.threadProperties.groupId,a,t),d=(e,n,i,a,t,o)=>{const l=encodeURIComponent(n);return t&&o&&!(0,r.isEmpty)(o)?e+"beta/users/{objectId}/profilepicturev2/teams/{teamGroupId}?etag={etag}&displayName={displayName}&voidCache=true".replace("{objectId}",o).replace("{teamGroupId}",a||"").replace("{etag}",i||"").replace("{displayName}",l):e+"beta/teams/{teamGroupId}/profilepicturev2?etag={etag}&displayName={displayName}&voidCache=true".replace("{teamGroupId}",a||"").replace("{etag}",i||"").replace("{displayName}",l)};function c(e,n,i,a){const r=i?"Parent team":"Channel";return(0,t.uY)(e)?{isDiscarded:!0,reasonToDiscard:`${r} is deleted`}:(0,t.Il)(e)&&!(0,t.Dq)(e)&&n?{isDiscarded:!0,reasonToDiscard:`${r} is archived and not favorite`}:a&&(0,t.Il)(e)?{isDiscarded:!0,reasonToDiscard:`${r} is cross post channel selection and archived`}:i&&!(0,t.hP)(e)?{isDiscarded:!0,reasonToDiscard:"User is not member of the parent team"}:(0,t.pi)(e)&&!(0,t.hP)(e)?{isDiscarded:!0,reasonToDiscard:"User is not member of private channel"}:{isDiscarded:!1,reasonToDiscard:"None"}}},190381:(e,n,i)=>{"use strict";i.d(n,{Hj:()=>a,pK:()=>s,dA:()=>c,oj:()=>m,Cv:()=>k,PQ:()=>g,xJ:()=>N,R4:()=>h,cC:()=>T,bv:()=>M});var a,t=i(40493),r=i(316877),o=i(981917),l=i(932315);!function(e){e.HIGH="HIGH",e.MEDIUM="MEDIUM",e.LOW="LOW"}(a||(a={}));const s=new RegExp("https?://[^\\s]+","i"),d="-",c=e=>{if(0===(e=e.toLowerCase()).lastIndexOf("zh-",0))switch(e){case"zh-cht":case"zh-hant":case"zh-hk":case"zh-tw":return"zh-cht";default:return"zh-chs"}let n=e.indexOf(d,1);if(-1===n)return e;let i=e.indexOf(d,n+1);return-1===i&&(i=e.length),i-n==5&&(n=i),e.substring(0,n)},m=e=>{const n=e?c(e):"",i=(0,t.get)("tcurlang")||n;return{targetLanguage:i,knownLanguages:[i]}},u=(e,n)=>(e=>{switch(e){case o.AO.Success:return"Done";case o.AO.MessageNotFound:return"MessageNotFound";case o.AO.VersionNotFound:return"VersionNotFound";case o.AO.LanguageDetectionFailed:return"LanguageDetectionFailed";case o.AO.SkipTranslation:case o.AO.ContentIsEmpty:return"TranslationNotNeeded";default:return"UnknownError"}})(((e,n)=>{const i=o.AO[e];return void 0!==i?i:(n?.error(`Unable to parse translation result code: ${e}`),o.AO.UnknownError)})(e,n)),p=async(e,n,i,a,t,r,l,s,d)=>{try{return await e.translateMessages(n,i,a,t,r,l,d)}catch(e){return s.error(`Failed to translate ${l}: ${e}`),r.map((({id:e,version:n})=>({id:e,version:n||"",detectedLanguage:{languageId:"",score:0},resultCode:o.AO[o.AO.UnknownError],translatedContent:"",translatedSubject:"",translatedTitle:""})))}},k=async(e,n,i,a,t,o,l)=>{const{targetLanguage:s,knownLanguages:d}=i,c=(0,r.v4)(),m=t.map((({messageId:e,version:n})=>n?{id:e,version:n}:{id:e}));return{convId:a,targetLangCode:s,correlationId:c,translations:(await p(e,a,n,s,d,m,c,o,l)).map((e=>({messageId:e.id,content:e.translatedContent||"",sourceLangCode:e.detectedLanguage?.languageId||"",resultCode:u(e.resultCode,o),version:e.version})))}},g=async(e,n,i)=>{try{return(await e.getSupportedTranslationLanguages(n)).map((({languageTag:e,languageName:n})=>({languageCode:e,languageName:n})))}catch(e){return i.error(`Unable to retrieve languages: ${e}`),[]}},N=(e,n,i,t,r)=>{if("string"!=typeof n)return null;try{const e=(0,l.d)(n),o=e.languages?.split(";")?.map((e=>{const[n,i]=e.split(":");return{code:n,score:parseInt(i,10)}})),s=o[0].code;if("null"===s)return null;let d=o.length;d>0&&""===o[d-1].code&&(o.pop(),d--);const c=void 0!==e.length,m=d>0&&"length"===o[d-1].code;if(!(c||m))return{code:s,confidenceLevel:a.LOW};const u=JSON.parse(r??"{}").settingsData,p=u?.find((n=>n.detector===e.detector));if(!(p&&i&&t&&p.minConfidence))return{code:s,confidenceLevel:a.LOW};const k=((e,n)=>{const i=e.minCharMap,a=e.minCharMapOverrides,t=new Map([["ar","arabic"],["fa","arabic"],["ku","arabic"],["ru","cyrillic"],["uk","cyrillic"],["bg","cyrillic"],["sr","cyrillic"],["sr-cyrl","cyrillic"],["sr-latn","latin"],["mk","cyrillic"],["uz","cyrillic"],["zh","han"],["zh-chs","han"],["zh-cht","han"],["ja","han"],["ko","han"],["vi","latin"],["en","latin"],["de","latin"],["fr","latin"],["es","latin"],["it","latin"],["pt","latin"],["ca","latin"],["nl","latin"],["pl","latin"],["tr","latin"],["sv","latin"],["cs","latin"],["da","latin"],["hu","latin"],["no","latin"],["nb","latin"],["ro","latin"],["fi","latin"],["ms","latin"],["sk","latin"],["et","latin"],["hr","latin"],["lt","latin"],["sl","latin"],["id","latin"],["lv","latin"],["gl","latin"],["is","latin"],["sq","latin"],["nn","latin"],["cy","latin"],["af","latin"],["mt","latin"],["ga","latin"],["eo","latin"],["so","latin"],["sw","latin"],["bs","latin"],["eu","latin"],["az","latin"],["ht","latin"],["la","latin"],["za","latin"]]);return a?.[n]??i?.[t.get(n)??""]??i?.others??5})(p,s),g=p.minConfidence??70,N=o.find((e=>e.code===i))?.score;if(i!==s){let n=0;if(c&&(n=parseInt(e.length,10)||0),m&&(n=f(o)),n<k)return{code:s,confidenceLevel:a.LOW};if(N&&N>=g)return{code:i,confidenceLevel:a.LOW}}return{code:s,confidenceLevel:a.HIGH}}catch(i){return e.newLogger("toSourceLanguageCode","data-resolvers-common").error(`Failed to calculate source language code from language stamp: ${n}.`),null}},f=e=>{const n=e.pop();return n?.score||0},h=(e,n,i,t)=>{const r=n?.code;if(!e||!r||n?.confidenceLevel===a.LOW)return!1;const o=e.knownLanguages;if(r===e.targetLanguageCode||o.includes(r))return!1;switch(e.translationMode){case"SUGGEST_TRANSLATION":return!0;case"ALWAYS_TRANSLATE":if(i&&"ShowOriginalMessage"===t)return!0}return!1},v=(e,n)=>{if(!e)return"ShowOriginalMessage";if(!n)return"Done";switch(n){case o.AO.Success:return"Done";case o.AO.SkipTranslation:return"TranslationNotNeeded";case o.AO.MessageNotFound:return"MessageNotFound";case o.AO.VersionNotFound:return"VersionNotFound";case o.AO.LanguageDetectionFailed:return"LanguageDetectionFailed";case o.AO.UnsupportedSourceLanguage:return"UnsupportedSourceLanguage";default:return"UnknownError"}},T=e=>{const{body:n,subject:i,title:a,toggled:t,detectedLanguageName:r,sourceLanguageCode:o,targetLanguageCode:l,isOnDemandTranslation:s,isInProgress:d,error:c}=e||{};if(d)return{translationStatus:"InProcess"};return(void 0!==n||void 0!==c)&&r&&o&&l?{translationStatus:v(!!t,c),translatedSubject:i,translatedContent:n,translatedTitle:a,isOnDemandTranslation:s,sourceLanguageName:r,sourceLanguageCode:o}:void 0},M=(e,n,i)=>{if(!i)return!1;let a=null;return i&&(a=i.find((e=>e.languageCode===n))),!(!a||a.messageId===e)}},443089:(e,n,i)=>{"use strict";i.d(n,{ne:()=>s,cx:()=>d,zP:()=>N});var a=i(602129),t=i(439697),r=i(882066),o=i(811957),l=i(803238);const s=(e,n,i,a)=>{const r=t.eo.getRequestCount(e),{accountEnabled:o,mri:l,objectId:s,displayName:d,givenName:k,surname:N,type:h,jobTitle:v,userPrincipalName:T,email:M,tenantId:y,sipProxyAddress:S,mobile:A,telephoneNumber:I,tenantName:b,decoratedDisplayName:C,cid:D,description:F,externalCalendarEmailAddress:U,homeMri:E,homeTenantId:w,mtoLabel:L,profileType:x,avatarETag:O}=e,j={__typename:"User",accountEnabled:o,id:f(e),objectId:s,mri:l,displayName:d,givenName:k,surname:N,type:h,jobTitle:v,userPrincipalName:T,email:M,tenantId:i||y||null,sipProxyAddress:S,mobile:A,telephoneNumber:I,requestCount:r,preferredUserName:n,tenantName:b||null,decoratedDisplayName:C||null,cid:D,description:F,externalCalendarEmailAddress:U,emailForQuery:a,homeMri:E,homeTenantId:w,mtoLabel:L,profileType:x,avatarETag:O};return function(e,n){const i=e.department;i&&(n.department=i)}(e,j),p(e,j),u(e,j),c(e,j),m(e,j),g(j),j},d=e=>{const{id:n,displayName:i,description:a,email:t,phone:r,mri:o,requestCount:l,syncSource:s}=e;return{__typename:"User",id:n,mri:o,objectId:o,displayName:i,userPrincipalName:o,givenName:i,surname:i,description:a,email:t,mobile:r,telephoneNumber:r,requestCount:l,syncSource:s}},c=(e,n)=>{if(function(e){const n=e;return void 0!==n.isFederated||void 0!==n.isAnonymousB2bUser||"federated"===n.type?.toLowerCase()}(e)){const{isFederated:i,fetchErrorCode:a,isAnonymousB2bUser:t}=e;n.isFederated=i||"federated"===e.type?.toLowerCase(),n.fetchErrorCode=a,n.isAnonymousB2bUser=t}else n.isFederated=null,n.fetchErrorCode=null,n.isAnonymousB2bUser=null},m=(e,n)=>{e.featureSettings&&(n.featureSettings=e.featureSettings),e.isBlocked&&(n.isBlocked=e.isBlocked),e.cid&&(n.cid=e.cid),e.isIbBarred&&(n.isInfoBarrierSet=e.isIbBarred),e.isAnonymousUser&&(n.isAnonymousUser=e.isAnonymousUser),e.phonesInfo&&(n.phonesInfo=(0,l.cloneDeep)(e.phonesInfo)),e.emailsInfo&&(n.emailsInfo=(0,l.cloneDeep)(e.emailsInfo)),e.xtapUser&&(n.xtapUser=e.xtapUser),e.companyName&&(n.companyName=e.companyName),e.tenantName&&(n.tenantName=e.tenantName),e.imageUri&&(n.imageUri=e.imageUri),e.selfAvatarLastupdatedTime&&(n.selfAvatarLastupdatedTime=e.selfAvatarLastupdatedTime),e.avatarUrl&&(n.avatarUrl=e.avatarUrl),n.isShortProfile=e.isShortProfile},u=(e,n)=>{(function(e){return void 0!==e.userType}(e)||function(e){const n=e;return n.type?n.type===a.t.botType:(0,o.bl)(e.mri)}(e)||function(e){return"aduser"===e.type?.toLowerCase()||"aduser"===e.$$subType?.toLowerCase()}(e))&&(n.userType=e.userType,n.description=e.description,n.isUnified=e.isUnified,n.securityEnabled=e.securityEnabled,n.featureSettings=e.featureSettings,n.imageUri=e.imageUri,n.userLocation=e.userLocation)},p=(e,n)=>{const i=e.phones;i&&(n.phones=i.map((e=>k(e))))},k=e=>({number:e.number,type:e.type}),g=e=>{const{mri:n}=e;if((0,r.EG)(n)&&!e.displayName){const i=(0,r.Ol)(n);e.displayName=i,e.givenName=i}else if(n&&(0,o.MR)(n)&&!e.displayName){const i=(0,o.vq)(n);e.displayName=i,e.givenName=i}else e.displayName||(e.displayName="Unknown User");return e},N=e=>!!e&&!("string"!=typeof e||!t.eo.isTFLSmsVerifiedMri(e)),f=e=>e.mri||e.objectId||e.concatenatedId},158425:(e,n,i)=>{"use strict";i.d(n,{uS:()=>t,U3:()=>r});const a="EntityMoreInfo",t={requestPersonMoreInfo:"requestPersonMoreInfo",requestPersonMoreOrgInfo:"requestPersonMoreOrgInfo",requestTopicMoreInfo:"requestTopicMoreInfo"},r={requestPersonMoreInfo:e=>({originator:a,type:t.requestPersonMoreInfo,data:()=>({...e})}),requestPersonMoreOrgInfo:e=>({originator:a,type:t.requestPersonMoreOrgInfo,data:()=>({...e})}),requestTopicMoreInfo:e=>({originator:a,type:t.requestTopicMoreInfo,data:()=>({...e})})}},233304:(e,n,i)=>{"use strict";i.d(n,{E4:()=>t,$c:()=>r,C9:()=>o,vV:()=>l,xu:()=>s,mQ:()=>d,Np:()=>c});var a,t,r,o,l,s,d,c;!function(e){e.Inline="inline",e.Desktop="desktop",e.Web="web"}(a||(a={})),function(e){e.web="web",e.desktop="desktop",e.rigel="rigel",e.surfaceHub="surfaceHub",e.teamsRoomsWindows="teamsRoomsWindows"}(t||(t={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.meetingStage="meetingStage"}(r||(r={})),function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"}(o||(o={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(l||(l={})),function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"}(s||(s={})),function(e){e.activityFeed="activityFeed",e.card="card",e.connectorConfiguration="connectorConfiguration",e.deepLink="deepLink",e.deepLinkStageView="deepLinkStageView",e.contentBubble="contentBubble",e.messageExtension="messageExtension",e.tab="tab",e.shareToOutlook="shareToOutlook",e.adaptiveCardTab="adaptiveCardTab",e.adaptiveCardCollabStage="adaptiveCardCollabStage",e.adaptiveCardStageModal="adaptiveCardStageModal",e.platformAppView="platformAppView",e.chatTab="chatTab",e.channelTab="channelTab",e.sidePanel="sidePanel",e.privateMeetingSchedulingForm="privateMeetingSchedulingForm",e.channelMeetingSchedulingForm="channelMeetingSchedulingForm",e.personalApp="personalApp",e.botConfig="botConfig",e.storeApp="storeApp",e.stageViewOpenSDKApi="stageViewOpenSDKApi",e.workflows="workflows",e.virtualEvent="virtualEvent",e.botChat="botChat"}(d||(d={})),function(e){e.teamsElectron="TEAMS-ELECTRON",e.teamsWeb="TEAMS-WEB",e.teamsMaglev="TEAMS-MAGLEV"}(c||(c={}))},745780:(e,n,i)=>{"use strict";i.d(n,{qi:()=>a,qb:()=>t,OM:()=>r,Pw:()=>o,aZ:()=>l,Aj:()=>s,jD:()=>d,BU:()=>c,YV:()=>m,w$:()=>u,y8:()=>p,Ye:()=>k,Uh:()=>g,i8:()=>N,b5:()=>f,Z9:()=>h,o1:()=>F,g7:()=>U,CL:()=>E,Hd:()=>w,_W:()=>L,Gr:()=>x,vb:()=>O,n$:()=>j});const a={Team:"Team",Personal:"Personal",GroupChat:"GroupChat"};var t,r;!function(e){e.Pin="Pin",e.Unpin="Unpin",e.Reorder="Reorder"}(t||(t={})),function(e){e.Team="Team",e.Personal="Personal",e.GroupChat="GroupChat",e.Channel="Channel"}(r||(r={}));const o={Tab:"Tab",Bot:"Bot",Messaging:"Messaging",Connector:"Connector",StaticTab:"StaticTab"};var l;!function(e){e.Added="Added",e.Removed="Removed",e.Updated="Updated",e.Synced="Synced",e.Mutated="Mutated",e.HashUpdate="HashUpdate"}(l||(l={}));const s={Unknown:"Unknown",SidePanel:"SidePanel",Stage:"Stage"};var d;!function(e){e.Unknown="Unknown",e.PersonalTab="PersonalTab",e.ChannelTab="ChannelTab",e.PrivateChatTab="PrivateChatTab",e.MeetingChatTab="MeetingChatTab",e.MeetingDetailsTab="MeetingDetailsTab",e.MeetingSidePanel="MeetingSidePanel",e.MeetingStage="MeetingStage",e.CallingSidePanel="CallingSidePanel"}(d||(d={}));const c={Unknown:"Unknown",PersonalTab:"PersonalTab",ChannelTab:"ChannelTab",PrivateChatTab:"PrivateChatTab",MeetingChatTab:"MeetingChatTab",MeetingDetailsTab:"MeetingDetailsTab",MeetingSidePanel:"MeetingSidePanel",MeetingStage:"MeetingStage",TeamLevelApp:"TeamLevelApp"};var m,u,p;!function(e){e.Application="Application",e.Delegated="Delegated"}(m||(m={})),function(e){e.Unknown="Unknown",e.Enabled="Enabled",e.Disabled="Disabled"}(u||(u={})),function(e){e.BotBased="botBased",e.ApiBased="apiBased"}(p||(p={}));const k={MRU:"MRU",AlphabeticalAsc:"AlphabeticalAsc",AlphabeticalDesc:"AlphabeticalDesc"};var g,N,f,h,v,T,M,y,S,A,I,b,C,D,F,U,E,w,L,x,O,j;!function(e){e.NewUpload="NewUpload",e.Update="Update",e.Upgrade="Upgrade"}(g||(g={})),function(e){e.NewUpload="NewUpload",e.Update="Update"}(N||(N={})),function(e){e.User="User",e.AzureAdApp="AzureAdApp"}(f||(f={})),function(e){e.Unknown="Unknown",e.PrivateChannel="PrivateChannel"}(h||(h={})),function(e){e.Mail="mail"}(v||(v={})),function(e){e.Desktop="desktop",e.Mobile="mobile"}(T||(T={})),function(e){e.General="general"}(M||(M={})),function(e){e.Short="short",e.Long="long"}(y||(y={})),function(e){e.MailRead="mailRead",e.MailCompose="mailCompose",e.MeetingDetailsOrganizer="meetingDetailsOrganizer",e.MeetingDetailsAttendee="meetingDetailsAttendee",e.OnlineMeetingDetailsOrganizer="onlineMeetingDetailsOrganizer",e.LogEventMeetingDetailsAttendee="logEventMeetingDetailsAttendee",e.Default="default"}(S||(S={})),function(e){e.After="after",e.Before="before"}(A||(A={})),function(e){e.Button="button",e.Menu="menu"}(I||(I={})),function(e){e.PromptUser="promptUser",e.SoftBlock="softBlock",e.Block="block"}(b||(b={})),function(e){e.Outlook="Outlook",e.Office="Office",e.Teams="Teams"}(C||(C={})),function(e){e.None="none",e.ApiSecretServiceAuth="apiSecretServiceAuth",e.MicrosoftEntra="microsoftEntra"}(D||(D={})),function(e){e.Personal="Personal",e.Team="Team",e.GroupChat="GroupChat",e.Meetings="Meetings"}(F||(F={})),function(e){e.Tab="Tab",e.Bot="Bot",e.Connector="Connector"}(U||(U={})),function(e){e.Installed="Installed",e.InstalledAndFavorited="InstalledAndFavorited",e.InstalledAndHidden="InstalledAndHidden",e.InstalledAndPermanent="InstalledAndPermanent",e.InstalledAndDeprecated="InstalledAndDeprecated",e.Featured="Featured",e.NotInstalled="NotInstalled",e.PreConsented="PreConsented",e.AdminPreInstalled="AdminPreInstalled"}(E||(E={})),function(e){e.Unknown="Unknown",e.OfficeAddIn="OfficeAddIn",e.OfficeAddIns="OfficeAddIns",e.ExchangeAddIn="ExchangeAddIn",e.ExchangeAddIns="ExchangeAddIns",e.LineOfBusiness="LineOfBusiness",e.Bot="Bot",e.Bots="Bots",e.MessageExtension="MessageExtension",e.ComposeExtensions="ComposeExtensions",e.Extension="Extension",e.Extensions="Extensions",e.FirstPartyPages="FirstPartyPages",e.Dynamics="Dynamics",e.AAD="AAD",e.LaunchPage="LaunchPage",e.StaticTabs="StaticTabs",e.GraphConnector="GraphConnector",e.ConfigurableTabs="ConfigurableTabs",e.Connector="Connector",e.Connectors="Connectors",e.Activity="Activity",e.Activities="Activities",e.MeetingExtension="MeetingExtension",e.MeetingExtensionDefinition="MeetingExtensionDefinition",e.OpenAiPlugins="OpenAiPlugins"}(w||(w={})),function(e){e.MessageReadCommandSurface="MessageReadCommandSurface",e.MessageComposeCommandSurface="MessageComposeCommandSurface",e.AppointmentOrganizerCommandSurface="AppointmentOrganizerCommandSurface",e.AppointmentAttendeeCommandSurface="AppointmentAttendeeCommandSurface"}(L||(L={})),function(e){e.chats="chats",e.channels="channels",e.channelMeetings="meetings"}(x||(x={})),function(e){e.GlobalPrepinned="GlobalPrepinned",e.UserPinned="UserPinned",e.AdminPrepinned="AdminPrepinned"}(O||(O={})),function(e){e.GET="GET",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(j||(j={}))},800398:(e,n,i)=>{"use strict";i.d(n,{bj:()=>s,A3:()=>d,Fh:()=>c,M0:()=>m,jm:()=>p,KD:()=>k,DP:()=>g,xV:()=>N,SI:()=>h,X1:()=>T});var a=i(309501),t=i(569864),r=i(803238),o=i(811957),l=i(217816);function s(e){const[n,i,t]=function(e){const n=3,i=e.split(";");return i&&i.length===n&&i[0]&&!isNaN(Number(i[0]))&&i[1]&&!isNaN(Number(i[1]))&&i[2]&&!(0,r.isNil)(Number(i[2]))?i:a.Mp.split(";")}(e),o=Number(i)||0;return{originalArrivalTime:Number(n)||0,timeStamp:o,clientMessageId:t}}const d=(e,n)=>{const i=(0,t.iX)({...n,version:0,messages:""}),a=(0,t.J6)({...n,version:0,messages:""});return i?e.chat:a?e.channel:void 0};function c(e,n){const i=s(e.properties&&e.properties[a.Ff.ConsumptionHorizon]||a.Mp);if(n){const a=d(n,e)||-1;i.originalArrivalTime=Math.max(i.originalArrivalTime,a)}return i}function m(e,n){let i=s(u(e.properties)||a.Mp);if(n){(d(n,e)||-1)>=i.timeStamp&&(i={originalArrivalTime:0,timeStamp:0,clientMessageId:"0"})}return i}const u=e=>e?.userConsumptionHorizon||e?.consumptionHorizonBookmark||null;function p(e){let n=e.lastMessageTimeUtc;if((0,r.isNil)(n)){const i=e.lastMessage?.originalarrivaltime;n=i&&new Date(i).getTime()||0}return n}const k=(e,n)=>{const i=c(e,n),a=m(e,n);return p(e)<=i.originalArrivalTime&&0===a.originalArrivalTime},g=(e,n,i,a=!1)=>{if("newchat"===e.id||(e=>!!e&&-1!==e.indexOf("preview-"))(e.id))return!0;let t=N(e,n,i,a);if(!t&&(e=>!!e&&e.includes("meeting"))(e.id)&&e.lastContentMessageTime){const n=new Date(e.lastContentMessageTime).getTime(),a=c(e,i),r=m(e,i);t=n<=a.originalArrivalTime&&0===r.originalArrivalTime}return t},N=(e,n,i,t=!1)=>{let l="";e.lastMessage&&((0,o.gs)(e.lastMessage)?l=f(e.lastMessage)||"":e.lastMessage.from&&(l=(0,r.last)(e.lastMessage.from.split("/"))||""));const s=k(e,i),d=0===m(e,i).originalArrivalTime,c=-1!==l.indexOf(n);return!!t&&c&&!!e.lastMessage?.properties?.[a.BM.OriginalMessageContext]?s:s||c&&d},f=e=>{let n="";if((0,o.gs)(e)&&e.content){const i=e.content.match(/<initiator>(.*?)<\/initiator>/i);i&&i[1]&&(n=i[1].trim())}return n},h=(e,n)=>{const{clientMessageId:i,originalArrivalTime:a}=m(e,n),t=new Date(a).toISOString();return!!i&&"0"!==i&&v(t)},v=e=>{e=e?.toString();return 0!==new Date(e&&"0"!==e?e:l.vj).valueOf()},T=(e,n,i)=>{const t=h(e,i);let r=!1;if(e.lastMessage?.messagetype===a.Cs.CallRecording){const n=new Date(e.lastContentMessageTime||l.vj),{originalArrivalTime:a}=c(e,i);r=n>new Date(a||l.vj)}else r=!k(e,i);const o=e.lastMessage?.from,s=!!(o&&n&&o?.indexOf(n)>-1);return t||r&&!s}},494493:(e,n,i)=>{"use strict";i.d(n,{A1:()=>y,bf:()=>f,BU:()=>h,BT:()=>S,xk:()=>v,oV:()=>M,Fx:()=>p,xV:()=>m,uy:()=>T,Hs:()=>u,jU:()=>k});var a=i(803238),t=i(714138),r=i(256676);const o=()=>l.instance;class l{constructor(){this._enabled=!1,this._currentAppConsumptionHorizon={current:t.Zb,timestamp:void 0}}static get instance(){return l._instance||(l._instance=new l),l._instance}get isEnabled(){return this._enabled}setEnabled(e,{logger:n}){this._enabled=e,n.infoToTelemetry?.("Enabling appConsumptionHorizon singleton","cdl_appch_singleton",void 0,!0)}get currentAppConsumptionHorizon(){return this.isEnabled?this._currentAppConsumptionHorizon.current:t.Zb}get latestAppConsumptionHorizonUpdate(){return this._currentAppConsumptionHorizon}updateAppConsumptionHorizon(e,{logger:n}){this.isEnabled?(this._currentAppConsumptionHorizon=(0,a.clone)(e),n.infoToTelemetry?.(`AppConsumptionHorizon updated to '${(0,r.u4)(e)}'.`,"cdl_appch_singleton",void 0,!0)):n.warnToTelemetry?.(`Tried updating appConsumptionHorizon while singleton was disabled '${(0,r.u4)(e)}'.`,"cdl_appch_singleton",void 0,!0)}}var s=i(800398),d=i(309501),c=i(569864);const m=e=>(0,s.KD)(e,N()?o().currentAppConsumptionHorizon:void 0),u=(e,n)=>(0,s.xV)(e,n,N()?o().currentAppConsumptionHorizon:void 0),p=e=>function(e){if(!e.properties)return!1;const n=e.properties[d.Ff.LastImportantImTime];return function(e){if(!e)return 0;const n=new Date(e);return n?n.getTime():0}(n)>Number(g(e).originalArrivalTime)}(e),k=e=>{const n=e.threadProperties[d.Q5.SharedInSpaces];return!!n&&n.includes(e.parentId)},g=e=>(0,a.isEmpty)(e.properties&&e.properties[d.Ff.ConsumptionHorizonBookmark])?f(e):h(e);function N(){return l.instance.isEnabled}const f=e=>(0,s.Fh)(e,N()?o().currentAppConsumptionHorizon:void 0),h=e=>(0,s.M0)(e,N()?o().currentAppConsumptionHorizon:void 0),v=(e,n)=>(0,s.X1)(e,n,N()?o().currentAppConsumptionHorizon:void 0),T=(e,n,i=!1)=>(0,s.DP)(e,n,N()?o().currentAppConsumptionHorizon:void 0,i),M=e=>(0,s.SI)(e,N()?o().currentAppConsumptionHorizon:void 0),y=e=>{let n="";return e&&(n=[e.originalArrivalTime,e.timeStamp,e.clientMessageId].join(";")),n};function S(e,n){if((0,c.iX)(e)&&(0,s.DP)(e,n,void 0))return{updatedConsumptionHorizon:void 0,updatedConsumptionHorizonBookmark:void 0};if((0,c.J6)(e)&&!(0,s.X1)(e,n,void 0))return{updatedConsumptionHorizon:void 0,updatedConsumptionHorizonBookmark:void 0};const i=(0,s.A3)(o().currentAppConsumptionHorizon,e),a=(0,s.M0)(e,void 0),t=(0,s.jm)(e),r=y({originalArrivalTime:t,timeStamp:Date.now().valueOf(),clientMessageId:e.lastMessage?.clientmessageid||"0"});let l;return i&&(0,s.SI)(e,void 0)&&i>=a.timeStamp&&(l=d.Mp),{updatedConsumptionHorizon:r,updatedConsumptionHorizonBookmark:l}}},247225:(e,n,i)=>{"use strict";i.d(n,{t:()=>M});var a=i(900366),t=i(309501);const r=/^([^(]+)[(]?/;function o(e,n){const i=function(e){let n="";if(!e?.displayName)return n;const i=e.displayName??"",a=e.givenName??"",t=e.surname??"",o=null!==a&&i.startsWith(a),l=null!==t&&i.startsWith(t);if(null!==a&&o&&!l)n=a;else if(l&&!o){const e=r.exec(i);e&&e.length>1&&(n=e[1].trim())}return n=n||i,n||""}(n);return i||(e?e.split(" ")[0]:"")}var l=i(683184),s=i(379658),d=i(811957),c=i(569864),m=i(725952),u=i(149041),p=i(299361);const k=(e,n,i)=>{const{enableGroupChatInviteFlow:a}=i.get(l.J.Messaging),t=(0,u.rh)(e);return!!a&&!n&&!t},g=(e,n)=>{const{enableMeetingChatAcceptBlockFlow:i}=n.get(l.J.Calling);return!!i&&(0,m.x)(e)},N=(e,n,i,a,t)=>{if(a)return!1;const r=!!(0,d.eX)(e.id);return((e,n,i)=>{const a=(0,c.Bl)(e);return!(!n||!i||a)})(e.id,i,!!e.usersProps?.hasConsumerUser)||((e,n,i,a,t)=>{const r=[];e.members?.forEach((e=>{const n=a[e.id];n&&r.push(n)}));const o=(0,u.C)(r,t);return(0,d._K)(e.id,n,i,!!o.length||n,r.map((e=>e.id)))})(e,r,i,n,t)||(o=e.id,(0,c.Bl)(o));var o};var f=i(553586);var h=i(516862);function v(e,n,i,a){const r=e.lastMessage?.content||"",o=!r&&!!e.lastMessage?.properties?.forwardTemplateId;switch(i){case t.Cs.MediaCard:return r||n.stringTranslate("messaging","chats_messagePreview_sent_a_card");case t.Cs.CallLocalRecording:case t.Cs.CallRecording:return function(e,n,i){if(i===t.Cs.CallRecording&&!/<RecordingContent[^>]*contentTypes="Recording/.test(e))return"";if(/<RecordingStatus[^>]*status="Initial"/.test(e))return n.stringTranslate("messaging","chats_messagePreview_call_recording_ongoing");if(/<RecordingStatus[^>]*status="ChunkFinished"/.test(e))return n.stringTranslate("messaging","chats_messagePreview_call_recording_processing");if(/<RecordingStatus[^>]*status="Success"/.test(e))return i===t.Cs.CallRecording?n.stringTranslate("messaging","chats_messagePreview_call_recording"):n.stringTranslate("messaging","chats_messagePreview_call_recording_processing");return""}(r,n,i);case t.Cs.AddMember:return function(e){const n={initiator:"",targets:[]};return(0,h.w)(e,{initiator:e=>{n.initiator=e.trim()},target:e=>{const i=e.trim();i!==n.initiator&&n.targets.push(i)}}),n.initiator&&0===n.targets?.length}(r)?n.stringTranslate("messaging","chats_messagePreview_user_joined"):n.stringTranslate("messaging","chats_messagePreview_user_added");case t.Cs.CallTranscript:return n.stringTranslate("messaging","chats_messagePreview_call_transcript");case t.Cs.Collaborate:return"";case t.Cs.Embed:if(!r)return n.stringTranslate("messaging","fluid_message_preview");break;case t.Cs.PhonelinkMms:return n.stringTranslate("messaging","chats_messagePreview_phonelink_mms");case t.Cs.Call:const o=a?.get(l.J.Messaging)?.enableGroupChatAudioDropin;if(o&&(0,c.Xg)(e)){if(function(e,n){if(!T(e,n))return!1;const i=-1!==e.indexOf("<ended/>")||/^<partlist[^>]*type="ended"/.test(e);return/<partlist/.test(e)&&!i}(r,i))return n.stringTranslate("messaging","chats_messagePreview_audio_drop_in_call_started");if(function(e,n){if(!T(e,n))return!1;return-1!==e.indexOf("<ended/>")||/^<partlist[^>]*type="ended"/.test(e)}(r,i))return n.stringTranslate("messaging","chats_messagePreview_audio_drop_in_call_ended")}}return/^<img\b[^>]*>$/.test(r)?n.stringTranslate("messaging","chats_messagePreview_sent_an_image"):function(e){return/<video[^>]*>[^<>]*<\/video>/.test(e)}(r)?n.stringTranslate("messaging","chats_messagePreview_sent_an_inline_video"):o?n.stringTranslate("messaging","chats_messagePreview_forwarded_message"):r}function T(e,n){return n===t.Cs.Call&&e.includes('<conversationType>"huddleGroupCall"</conversationType>')}const M=e=>{const{conversation:n,profilesMap:i,coreSettings:r,i18n:d,loggerFactory:m,currentUserMri:h,currentUserTenantId:T,addSenderName:M=!1}=e,y=!!(0,c.YP)(n),S=(0,a.F)(n?.lastMessage?.from??""),A=i[S],I=((e,n,i,a,r,o,d)=>{let c;const{environment:m}=i.get(l.J.Metadata),u=m===s.s.life,f=e.properties?.interopconversationstatus;switch(f){case t.uI.ExtendedDirectoryAcceptPending:c=a.stringTranslate("people","tfl_invite_free_chat_notification_title",{displayName:d?.displayName||a.stringTranslate("peoplePicker","unknown_user")});break;case t.uI.AcceptPending:c=k(e.id,r,i)||N(e,n,r,u,o)||g(e,i)||(0,p.br)(e)?a.stringTranslate("messaging","tmp_group_chat_invite_flow_chat_list_preview"):a.stringTranslate("people","tfl_invite_free_chat_notification_title",{displayName:d?.displayName||a.stringTranslate("peoplePicker","unknown_user")});break;case t.uI.Blocked:c=a.stringTranslate("people","blocked_sfc_chat_preview_message")}return c})(n,i,r,d,y,T,A);if(I)return I;const b=n.lastMessage;if(!b){return(0,c.xb)(n.id)?d.stringTranslate("messaging","chats_messageDraftPreview_default"):""}if(b.properties?.deletetime)return d.stringTranslate("messaging","chats_messagePreview_lastMessage_deleted");const C=(0,u.DE)(m,b.messagetype,b.properties);let D=v(n,d,C,r);if(""===D.trim()&&(D=function(e,n,i){const a=(0,u.jz)(i,e.properties),t=(0,u.le)(i,e.properties);return a?.length?n.stringTranslate("messaging","chats_messagePreview_sent_a_file"):t?.some((e=>e.contentType===f.s.Audio))?n.stringTranslate("messaging","recent_conversations_sent_an_voice_message"):t?.some((e=>"bfb101ece45946be988be560a74322f2"===e.cardClientId))?n.stringTranslate("messaging","recent_conversations_sent_a_location_message"):""}(b,d,m)),!D)return"";if(!M)return D;const F=S===h,U=function(e,n,i,a,r){if(e===t.Cs.Call||e===t.Cs.AddMember||e===t.Cs.CallRecording||e===t.Cs.CallLocalRecording||e===t.Cs.CallTranscript||r&&!a)return{key:"chats_messagePreview_withoutDisplayName"};if(a)return{key:"chats_messagePreview_fromSelf"};const l=o(n,i);return l?{key:"chats_messagePreview_withDisplayName",displayName:l}:{key:"chats_messagePreview_withoutDisplayName"}}(C,b.imdisplayname,A,F,!!y);return D=d.stringTranslate("messaging",U.key,{message:D,displayName:U.displayName}),D}},19645:(e,n,i)=>{"use strict";i.d(n,{n:()=>r,w:()=>o});var a=i(683184),t=i(309501);const r=(e,n,i)=>{const a=e?parseInt(e,10):null,t=n?new Date(n).getTime():0,r=i?parseInt(i,10):null;return!!(r&&r>=t)||!!a&&!(t&&a<t)},o=(e,n,i,o,l)=>{if(l?.get(a.J.Chat).enableRSVPBasedMeetingChatNotifications&&o===t.Gv.DECLINE){return!!(e?parseInt(e,10):null)}return r(e,n,i)}},149041:(e,n,i)=>{"use strict";i.d(n,{le:()=>d,DE:()=>c,jz:()=>k,rh:()=>g,C:()=>N});var a=i(852793),t=i(980860),r=i(702135),o=i(689626),l=i(803238),s=i(309501);const d=(e,n,i)=>{if(!n||!n.cards||"string"!=typeof n.cards&&!i)return null;try{let e=String(n.cards);i&&(e=i);return JSON.parse(e).map((({appIcon:e,appId:n,appName:i,cardClientId:a,content:t,contentType:r,locale:o,userSpecificContent:l})=>({appIcon:e,appId:n||"",appName:i,cardClientId:a,content:JSON.stringify(t),contentType:r,locale:o,...!!l&&{userSpecificContent:l}})))}catch(n){return e.newLogger("Conversation Last Message Processing","services-io-chat").log("UnhandledException in toCards."),null}},c=(e,n,i)=>{if(n===s.Cs.HTML){if(((e,n)=>{const i=d(e,n);if(!i)return!1;const a=(0,l.find)(i,(e=>"application/vnd.microsoft.card.fluid"===e.contentType));return!!a&&!!JSON.parse(a.content).componentUrl})(e,i))return s.Cs.Collaborate;if(((e,n)=>{const i=d(e,n);if(!i)return!1;const a=(0,l.find)(i,(e=>"application/vnd.microsoft.card.fluidEmbedCard"===e.contentType));return!!a&&!!JSON.parse(a.content).componentUrl})(e,i))return s.Cs.Embed}return n};var m;!function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WOPI=1]="WOPI",e[e.Google=2]="Google",e[e.OneDrive=3]="OneDrive",e[e.Recent=4]="Recent",e[e.Aggregate=5]="Aggregate",e[e.FileSystem=6]="FileSystem",e[e.Search=7]="Search",e[e.AllFiles=8]="AllFiles",e[e.SharedWithMe=9]="SharedWithMe"}(m||(m={}));const u=(e,n)=>{try{const n=JSON.parse(e);if(!n||!n.code)return;const i=(e=>{switch(e){case"BOX":return"BOX";case"DROPBOX":return"DROPBOX";case"EGNYTE":return"EGNYTE";case"GOOGLEDRIVE":return"GOOGLEDRIVE";case"SHAREFILE":return"SHAREFILE";default:throw new Error("Invalid provider code")}})(n.code);return{code:i,type:(e=>{switch(e){case m.Sharepoint:return"Sharepoint";case m.WOPI:return"WOPI";case m.Google:return"Google";case m.OneDrive:return"OneDrive";case m.Recent:return"Recent";case m.Aggregate:return"Aggregate";case m.FileSystem:return"FileSystem";case m.Search:return"Search";case m.AllFiles:return"AllFiles";case m.SharedWithMe:return"SharedWithMe";default:throw new Error("Not a valid provider type")}})(parseInt(n.type,10))}}catch(e){return void n.newLogger("Conversation Last Message Processing","services-io-chat").log(`Failed to parse provider data: ${e}`)}},p=(e,n)=>{{const i=2,l=["http","https"],{filePreview:s,chicletBreadcrumbs:d,fileInfo:c,anchorFileId:m,progressComplete:p,isUploadError:k,fileChicletState:g,providerData:N}=e,{shareUrl:f,shareId:h,itemId:v}=c,T=s||{},M=g?.serviceName,{id:y,baseUrl:S,objectUrl:A,type:I,title:b,state:C}=((e,n)=>{const{version:i}=e;let{id:a,baseUrl:t,objectUrl:l,type:s,title:d,state:c}=e;if(i!==n&&(({itemid:a,fileName:d,fileType:s,fileInfo:{fileUrl:l,siteUrl:t}}=e),c=e.fileChicletState?.state),"string"!=typeof a)throw(0,r.Tr)("ChatHelpers",o.jK.Undefined,"toFiles",{id:a,version:i,type:s},"File id is missing");return{id:a,baseUrl:t,objectUrl:l,type:s,title:d,state:c}})(e,i),D="active"!==C&&"hidden"!==C,F=u(N,n),U=(0,a.j)()("aggregatefiles","customspo","downloads","p2p","personal","recent","teams","teamsSdk"),E=(0,a.j)()("active","deleted","reference","hidden");return{id:y,itemId:v,chicletBreadcrumbs:d,baseUrl:(0,t.Nm)(S,l),objectUrl:(0,t.Nm)(A,l),shareId:h,shareUrl:f,type:I,title:b,fileId:y,isReferencedFile:D,anchorFileId:m,progressComplete:p&&parseInt(p,10)||null,serviceName:M&&U.find((e=>e===M)),state:C&&E.find((e=>e===C)),hasUploadFailed:k,providerDataV2:F,...T}}},k=(e,n)=>{if(!n||!n.files||"string"!=typeof n.files)return null;try{let i=JSON.parse(n.files);i=i.filter((e=>"deeplink"!==e.type));return(0,l.map)(i,(n=>p(n,e)))}catch(e){return null}},g=e=>!!e&&e.includes(s.IX),N=(e,n)=>e.filter((({tenantId:e,isFederated:i})=>i||n&&e&&e!==n))},299361:(e,n,i)=>{"use strict";i.d(n,{i1:()=>d,lN:()=>c,GO:()=>m,Bc:()=>u,s5:()=>p,DM:()=>k,br:()=>g,Sm:()=>N});var a=i(689626),t=i(683184),r=i(309501),o=i(811957),l=i(569864),s=i(725952);const d=(e,n)=>{const i=(0,l.HU)(e),a=(0,l.sL)(e)&&e.memberProperties?.[r.e0.ExplicitlyAdded],t=(0,l.J6)(e)&&!(0,l.iX)(e)&&!i&&!(0,l.pi)(e)&&!(0,s.vJ)(e)&&!a&&!(0,l.Xm)(e);if((0,l.hP)(e)){const i=(0,l.iE)(e,n,!0);return!!(0,s.DA)(i)&&t}return t},c=(e,n,i,t)=>{const o=e.threadProperties[r.Q5.SharedInSpaces];if(!o)return!1;{let e=[];try{e=JSON.parse(o)}catch(e){return i.error(`Error parsing ${r.Q5.SharedInSpaces} property`,t,a.jK.Deserialization),!1}for(const i of e)if(i.spaceThreadId===n)return!0}return!1},m=(e,n,i,a)=>{const t=e.threadProperties[r.Q5.SharedInSpaces];try{const e=t&&JSON.parse(t)||[];return e.find((e=>n.includes(e.spaceThreadId)))?.spaceThreadId||""}catch(n){return i.warn(`Couldnt get external team id for the channel ${e.id}`,a),""}},u=(e,n,i)=>{if(e){if(!(0,l.J6)(e))return;const a=e.threadProperties[r.Q5.SharedInSpaces],t=[];if(a){const r=p(a,n,i,e.id);if(!r)return;for(const e of r)t.push(e.spaceThreadId);return t}}},p=(e,n,i,a)=>{let t=[];try{t=JSON.parse(e)}catch(e){return void(n.errorToTelemetry&&n.errorToTelemetry(`Error parsing ${r.Q5.SharedInSpaces} property for conversationid ${a}`,"team_has_channels_get_shared_teams_failed",i,!0))}return t},k=e=>!(!(0,l.YP)(e)||!e.members?.some((e=>(0,o.EG)(e.id)))),g=e=>k(e)&&(0,l.eb)(e)?"true"===e.threadProperties?.[r.Q5.IsStickyThread]:e.id.includes(r.s$)&&"True"===e.threadProperties?.[r.Q5.IsSmsThread],N=e=>{const{enablePaidSmsChat:n,teamsUserPhoneNumbers:i}=e.get(t.J.Messaging);return!(!n||!i?.phoneNumbers?.find((e=>"Primary"===e?.assignmentCategory&&e?.acquiredCapabilities?.includes("InboundA2PSms")&&e?.acquiredCapabilities?.includes("OutboundA2PSms"))))}},725952:(e,n,i)=>{"use strict";i.d(n,{lF:()=>R,wT:()=>m,io:()=>C,lj:()=>z,oy:()=>P,MQ:()=>L,dk:()=>b,Xc:()=>x,Bu:()=>D,gw:()=>j,_T:()=>w,R8:()=>y,c_:()=>k,GS:()=>p,_2:()=>h,Iy:()=>M,re:()=>A,mO:()=>I,x:()=>F,X5:()=>U,vJ:()=>S,Ut:()=>u,LQ:()=>v,Jn:()=>T,nN:()=>V,B8:()=>f,$n:()=>E,DA:()=>O});var a=i(683184),t=i(309501),r=i(834099),o=i(803238),l=i(879789),s=i(811957),d=i(217816);var c=i(981917);const m=({isActionToAccept:e,isUserBlocked:n,isInQuarantine:i,quarantineCounter:r,creator:o,currentUserMri:l},s)=>{let d=t.uI.Accepted;if(e){if(n){const e=o===l,{maxInviteFreeQuarantineCounter:n}=s.get(a.J.People),c=r>=(n||0);i&&!e?d=t.uI.AcceptPending:e&&c&&(d=t.uI.Quarantined)}}else d=t.uI.Blocked;return d},u=e=>!!e?.startsWith(t.at.PhonelinkSmsPrefix),p=(e,n)=>k(e.id,n)&&h(e,n),k=(e,n)=>{if(!N(e))return!1;const{overrideThreadTypeForPrivateFeeds:i}=n.get(a.J.Sync);return(!(0,s.dV)(e)||!i)&&!u(e)},g=/^\d+[:]{1}.+/,N=e=>!(0,o.isUndefined)(e)&&e!==t.kK&&e!==t.Ov&&!u(e)&&!e.includes(t.YP)&&!e.includes(t.BQ)&&g.test(e),f=e=>e.startsWith(t.IK)?"MRI conv id":e,h=(e,n)=>!(v(e)&&!function(e){const{msgEnableSfbCloudFromBVD:n}=e.get(a.J.Messaging),{isSfbCloud:i,isSipEnabled:t,isSfbCloudInBVD:r,isSipEnabledInBVD:o}=e.get(a.J.UserResources);return!!(n?o&&r:t&&i)}(n));function v(e){return((0,o.isString)(e)?e:e.id).endsWith(t.GQ)}const T=e=>!!e&&v(e),M=e=>{const n=e.memberProperties?.[t.e0.RelationshipState];return!!n?.edRedemptionRequired},y=e=>{const n=e.memberProperties?.[t.e0.RelationshipState];return!!n?.blockTime};const S=e=>!!e.memberProperties?.[t.e0.IsModerator],A=e=>e.threadProperties&&!!e.threadProperties[t.Q5.ParentSpaces],I=e=>e.threadProperties&&e.threadProperties[t.Q5.ThreadType]===r.T.Team&&A(e),b=e=>{if(e.threadProperties&&e.threadProperties?.[t.Q5.ParentSpaces])try{const n=JSON.parse(e.threadProperties?.[t.Q5.ParentSpaces]);return n&&n.linkedSpaceInfoItems&&n.linkedSpaceInfoItems[0]&&n.linkedSpaceInfoItems[0].spaceThreadId&&n.linkedSpaceInfoItems[0].spaceThreadId.length>0}catch(e){return!1}return!1},C=e=>{if(e.threadProperties)try{const n=e.threadProperties.meeting,i=n?JSON.parse(n):void 0;return i?i.meetingType:void 0}catch{return}},D=(e,n,i)=>{if(n){const{enableStreamChatFeature:e,forceCommentStreamForConversations:t}=n.get(a.J.Calling);if(!e)return!1;if(i&&(t??[]).includes(i))return!0}if(e&&void 0!==e.isLiveChatEnabled)return function(e){switch(typeof e){case"boolean":return e;case"number":return 1===e;case"string":const n=e.toLowerCase();return"true"===n||"on"===n||"1"===n}return!1}(e.isLiveChatEnabled)},F=e=>U(e.type),U=e=>!!e&&e.toLowerCase&&e.toLowerCase()===t.i1.Meeting.toLowerCase(),E=e=>{let n;if(F(e)&&e.threadProperties.meeting)try{const i=JSON.parse(e.threadProperties.meeting);i.subject&&(n=i.subject)}catch{return n}return n},w=e=>e===t.Cs.Text||e===t.Cs.RichText||e===t.Cs.HTML,L=e=>!!e.members?.some((e=>(0,s.Nl)(e.id))),x=e=>e.id===l.VS.CallLogConversationId||e.id===l.VS.SharedCallLogConversationId||(0,s.u5)(e?.threadProperties?.threadType),O=e=>{if(e===t.Me)return!1;const n=1209600*d.kg*.5;if(!e||isNaN(e))return!0;return e-Date.now()<n},j=e=>e?.threadProperties&&(e?.threadProperties[t.Q5.ThreadType]===r.T.Community||e?.threadProperties[t.Q5.SpaceType]===t.Q5.SpaceType_Community),V=e=>e?.threadProperties&&e?.threadProperties[t.Q5.ThreadType]===r.T.SubCommunity,z=e=>e.threadProperties&&e.threadProperties[t.Q5.SubstrateGroupId]||"",P=e=>{const n=e.threadProperties?.[t.Q5.ThreadSubType]?.toLowerCase();return n||c.YF.Unknown},R=e=>{const n=e.threadProperties&&e.threadProperties[t.Q5.ThreadType];return B(n)},B=e=>{if(e)return"space"===e||"topic"===e?"Channel":"meeting"===e?"Meeting":"None"}},569864:(e,n,i)=>{"use strict";i.d(n,{MJ:()=>m,K6:()=>u,Du:()=>p,ut:()=>k,uY:()=>g,pl:()=>N,ky:()=>f,Fz:()=>h,zb:()=>v,s6:()=>T,rt:()=>M,xb:()=>y,eb:()=>S,s0:()=>I,Gp:()=>b,Xm:()=>C,HU:()=>D,Yk:()=>F,yi:()=>U,X3:()=>E,Dq:()=>L,SQ:()=>x,pY:()=>O,iX:()=>j,S5:()=>V,nV:()=>z,$V:()=>P,JJ:()=>R,J6:()=>B,sL:()=>Q,WN:()=>W,pi:()=>Z,Cd:()=>Y,hk:()=>G,rj:()=>_,Fv:()=>J,hu:()=>H,TJ:()=>q,dO:()=>X,BL:()=>K,jo:()=>$,nZ:()=>ee,iE:()=>ne,hP:()=>ie,qo:()=>ae,CB:()=>te,au:()=>re,ZY:()=>oe,T7:()=>le,Xg:()=>se,YP:()=>de,Zg:()=>ce,j8:()=>ue,cW:()=>pe,tq:()=>ke,W7:()=>ge,is:()=>Ne,dG:()=>Te,Lg:()=>Me,Su:()=>ye,rP:()=>Se,As:()=>Ae,nL:()=>Ie,Bl:()=>be,mB:()=>Ce,wB:()=>De,Eu:()=>Fe,hC:()=>Ue,DZ:()=>Ee,qN:()=>we,Wp:()=>Le,Ud:()=>xe,me:()=>Oe,BU:()=>je,Ii:()=>Ve,$c:()=>ze,tl:()=>Pe,K5:()=>Re,Ts:()=>Be,wU:()=>Qe,jM:()=>Ye,Il:()=>Ge,rf:()=>_e,cu:()=>Je,ln:()=>He,iK:()=>qe,y5:()=>Xe,Ti:()=>Ke,ok:()=>$e,zx:()=>en,xm:()=>nn});var a=i(879789),t=i(803238),r=i(683184),o=i(811957),l=i(309501),s=i(834099),d=i(981917),c=i(725952);var m;!function(e){e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.TWO=2]="TWO"}(m||(m={}));const u=e=>{const n=S(e);return(0,c.LQ)(e)?n:n||(0,c.Jn)(e)},p=e=>e.threadProperties?.[l.Q5.Creator]||null,k=e=>e.threadProperties&&e.threadProperties[l.Q5.CreatedAt]?e.threadProperties[l.Q5.CreatedAt]:null,g=e=>{if(!e)throw new Error("Invalid conversation passed to isDeleted()");if(!e.threadProperties)return!1;const n=e.threadProperties.isDeleted||e.threadProperties[l.Q5.IsDeleted];return!!n&&("boolean"==typeof n?n:"function"==typeof n.toLowerCase&&"true"===n.toLowerCase())},N=e=>{if(!e)throw new Error("Invalid conversation passed to isConversationDeleted()");if(!e.properties)return!1;const n=e.properties.isDeleted||e.properties[l.Ff.isDeleted];return!!n&&("boolean"==typeof n?n:"function"==typeof n.toLowerCase&&"true"===n.toLowerCase())},f=(e,n)=>{if(!e)throw new Error("Invalid conversation passed to shouldConversationDeletedByDeleteChat()");const i=X(e,n);return 0!==i&&(!(0,t.isNil)(e.lastMessageTimeUtc)&&i>=e.lastMessageTimeUtc)},h=e=>!(!e.properties||!e.properties[l.Ff.Followed])&&"true"===e.properties[l.Ff.Followed]?.toLowerCase(),v=e=>!(!e.properties||!e.properties[l.Ff.Collapsed])&&"true"===e.properties[l.Ff.Collapsed]?.toLowerCase(),T=e=>-1===e.detailsVersion?-1===e.threadVersion:0===e.threadVersion,M=e=>T(e)||!ie(e);function y(e){return e.includes(l.YP)||e.includes(l.BQ)||e===l.kK}const S=e=>(0,o.Q5)(e.id,e?.threadProperties?.threadType)&&y(e.id),A="lwgChannelLie-",I=e=>`${A}${e}`,b=e=>e.startsWith(A),C=e=>B(e)&&e.properties&&!!e.properties.isLie,D=e=>e.threadProperties&&(e.threadProperties[l.Q5.ThreadType]===s.T.Team||e.threadProperties[l.Q5.ThreadType]===s.T.Community)&&!(0,c.re)(e),F=e=>!(e.threadProperties[l.Q5.ParentSpaces]||!e.threadProperties[l.Q5.SubstrateGroupId]||!e.threadProperties[l.Q5.GroupId]||e.threadProperties[l.Q5.ThreadSubType]),U=e=>D(e)&&!F(e),E=e=>{const n=Z(e),i=F(e);return n||i?Oe(e)||"":le(e)||""};function w(e){return!!e.threadProperties&&e.threadProperties[l.Q5.ThreadType]===s.T.Team}const L=e=>{if(e.properties){if(e.properties[l.Ff.Favorite])return"true"===e.properties[l.Ff.Favorite]?.toLowerCase();if(w(e))return!0}return!1},x=e=>!e.properties||void 0===e.properties[l.Ff.GeneralChannelFavorite]||null===e.properties[l.Ff.GeneralChannelFavorite]||"true"===e.properties[l.Ff.GeneralChannelFavorite]?.toLowerCase(),O=e=>{const n=D(e);return n&&x(e)||!n&&L(e)},j=(e,n=!1)=>V(e.type,n),V=(e,n=!1)=>!(0,t.isNil)(e)&&(e.toLowerCase()===l.i1.Chat.toLowerCase()||e.toLowerCase()===l.i1.PhoneChat.toLowerCase()||e.toLowerCase()===l.i1.Phonelink1on1Chat.toLowerCase()||e.toLowerCase()===l.i1.PhonelinkGroupChat.toLowerCase()||e.toLowerCase()===l.i1.OneOnOne.toLowerCase()||e.toLowerCase()===l.i1.StreamOfNotes.toLowerCase()||!n&&(0,c.X5)(e)),z=e=>e.type===l.i1.RCC,P=e=>e.id===a.VS.NotificationConversationId||(0,o.j6)(e?.threadProperties?.threadType),R=e=>e===a.VS.AnnotationsConversationId,B=e=>e.type===l.i1.Team||e.type===l.i1.Topic,Q=e=>ae(e)===d.xu.Shared,W=e=>[l.wS,l.tP].includes(e.id),Z=e=>(0,c.mO)(e)&&(0,c.dk)(e)&&ae(e)===d.xu.Private,Y=e=>D(e)&&!!e.memberProperties&&!!e.memberProperties[l.e0.ChannelOnlyMember],G=e=>{if(!(0,c.x)(e))return!1;const n=(0,c.io)(e);return!!n&&n===l.wJ.MeetNow},_=e=>{if(!(0,c.x)(e))return!1;const n=(0,c.io)(e);return!!n&&n===l.wJ.Scheduled},J=(e,n)=>e.from.substring(e.from.indexOf("/")+1)===(-1===n.indexOf(l.rK)?l.rK+n:n),H=(e,n)=>{if(!e.threadProperties)return 0;const{enableRetentionHorizonBasedPruning:i}=n.get(r.J.Sync),a=i||Q(e)?e.threadProperties.retentionHorizonV2:0;return a&&isFinite(Number(a))?Number(a):0},q=(e,n)=>e?.members?.find((e=>e.id===n))?.shareHistoryTime??0,X=(e,n)=>{if(!e.properties)return 0;if(N(e))return e.lastMessageTimeUtc?e.lastMessageTimeUtc+1:864e13;const i=(!n||!!n.get(r.J.Messaging).enableDeleteChat)&&j(e)?e.properties.clearHistoryTime:0;return i&&isFinite(Number(i))?Number(i):0},K=e=>!!e.mruEvictedTime&&e.mruEvictedTime>0,$=(e,n,i)=>{const a=H(n,i);return!isNaN(Number(e))&&!isNaN(a)&&Number(e)<a},ee=(e,n,i)=>{const a=X(n,i),t=Number(e);return!isNaN(t)&&!isNaN(a)&&t<a},ne=(e,n,i=!1)=>{if((0,o.Q5)(e.id,e?.threadProperties?.threadType)&&!T(e)){if(e.memberProperties&&i)return e.memberProperties[l.e0.ExpirationTime];if(e.members&&n){const i=(0,t.find)(e.members,(e=>e&&e.id===n));return i&&i.memberExpirationTime}return e.memberProperties&&e.memberProperties[l.e0.ExpirationTime]}},ie=(e,n)=>!(0,o.Q5)(e.id,e?.threadProperties?.threadType)||!T(e)&&!g(e)&&((0,t.isArray)(e.members)&&n?(0,t.some)(e.members,(e=>e&&e.id===n)):!(e.threadProperties&&B(e)&&!e.threadProperties[l.Q5.LastLeaveAt]&&!e.threadProperties[l.Q5.LastJoinAt])&&!(e.threadProperties&&e.threadProperties[l.Q5.LastLeaveAt]&&(!e.threadProperties[l.Q5.LastJoinAt]||e.threadProperties[l.Q5.LastJoinAt]<e.threadProperties[l.Q5.LastLeaveAt])));function ae(e){if(!e||!B(e))return;const n=e.threadProperties[l.Q5.SpaceTypes],i=n?parseInt(n,10):0,a=!!e.threadProperties[l.Q5.SubstrateGroupId],t=(0,c.oy)(e);return F(e)?d.xu.Standalone:a?t===d.YF.PrivateChannel?d.xu.Private:d.xu.Shared:(i&d.tG.Private)===d.tG.Private?d.xu.Private:d.xu.Standard}const te=(e,n)=>{if(!!e.threadProperties.isLastMessageFromMe)return!0;const i=e.lastMessage?.from;if(!i)return!1;return n===(0,t.last)(i.split("/"))},re=(e,n)=>(0,t.reduce)(e.members,((e,i)=>{const a=i.id;return a&&a!==n&&e.push(a),e}),[]),oe=(e,n,i)=>{let a;const r=!e.members||!!e.members&&(0,t.some)(e.members,(e=>!e));if(i&&!r){const t=re(e,n);a=S(e)&&1===t.length?i[t[0]]:i[e.id]}return a},le=e=>{if(!e)throw new Error("Invalid conversation passed to topicName");if(e.threadProperties){if(j(e)){let n=e.threadProperties.topic;if(n&&-1!==n.indexOf(":")&&(n=void 0),!n&&(0,c.x)(e)){const i=(0,c.$n)(e);i&&(n=i)}return n}if(w(e)&&Te(e)){const n=Oe(e);if(n&&n.trim())return n}else{const n=e.threadProperties.topic,i=e.threadProperties[l.Q5.TopicThreadTopic];if(i&&i.trim())return i;if(n&&n.trim())return n}}return""},se=(e,n=!1)=>j(e,!0)&&!de(e,n),de=(e,n=!1)=>{const i=e.members&&e.members.length<=2;return j(e,!0)&&i&&(Ne(e)||S(e)||ve(e)||!n&&he(e)||me(e))&&!e.members?.some((e=>(0,o.$i)(e.id)))},ce=e=>de(e)&&e.members?.some((({id:e})=>(0,o.bl)(e))),me=e=>e.members&&e.members.length<=2&&fe(e)&&(e.type===l.i1.PhoneChat||e.threadProperties&&e.threadProperties[l.Q5.ThreadType]===s.T.PhoneChat),ue=e=>(0,c.Ut)(e),pe=e=>ue(e.id),ke=e=>!!e&&((0,o.EG)(e)||(0,o.MR)(e)||(0,o.Jl)(e)||(0,o.yj)(e)),ge=e=>e.type===l.i1.PhonelinkGroupChat,Ne=e=>e.type===l.i1.Phonelink1on1Chat,fe=e=>(0,t.some)(e.members,(e=>!!e.id&&e.id.startsWith(l.at.Pstn))),he=e=>j(e,!0)&&e.members&&2===e.members.length&&!(0,t.isNil)(e.threadProperties)&&parseInt(e.threadProperties[l.Q5.CreatedAt],10)<l.Yv,ve=e=>!!e.id&&e.id.indexOf(l.B3)>-1||"true"===e.threadProperties[l.Q5.P2PChatUniqueRosterThread]?.toString()?.toLowerCase()||We(e),Te=e=>e.threadProperties&&e.threadProperties[l.Q5.ThreadType]===s.T.Topic||Z(e)||Q(e)||(0,c.nN)(e)||C(e),Me=e=>(0,c.Jn)(e),ye=e=>be(e&&e.id),Se=e=>Me(e)||(e=>Ae(e))(e)||ye(e),Ae=e=>{const n=(0,t.isString)(e)?e:e.id;return(0,t.endsWith)(n,l.M9)||(0,t.endsWith)(n,l.IS)||(0,t.startsWith)(n,l.X2)},Ie=e=>Ae(e)||Qe(e),be=e=>!!e&&((0,t.endsWith)(e,l.RS)||(0,t.startsWith)(e,l.QV)),Ce=e=>e===l.Z,De=e=>!(e.id!==l.Z||e.lastMessage||e.threadProperties.retentionHorizonV2&&0!==e.threadProperties.retentionHorizonV2),Fe=e=>{const n=(0,t.endsWith)(e,l.M9)||(0,t.endsWith)(e,l.IS)||(0,t.startsWith)(e,l.X2),i=e.endsWith(l.GQ),a=be(e);return n||i||a},Ue=e=>{const n=ne(e),i=n&&n<Date.now();return ie(e)&&!i},Ee=e=>{if(e.threadProperties&&e.threadProperties[l.Q5.Topics]){const n=e.threadProperties[l.Q5.Topics];if("["!==n.substr(0,1))return n.split("|").map((e=>({id:e,name:"Unknown"})));try{return JSON.parse(n)}catch{return[]}}return[]},we=(e,n)=>{const i=Ee(e);for(const e of i)if(e.id===n)return e.isShared??!1;return!1},Le=(e,n)=>{const i=Ee(e);for(const e of i)if(e.id===n)return e.archivalLevel?.trim().toLowerCase()},xe=e=>!!e?.some((e=>(0,o.bl)(e))),Oe=e=>{if(e.threadProperties){if(e.threadProperties[l.Q5.XTeamName])return e.threadProperties[l.Q5.XTeamName];if(e.type===l.i1.Team&&e.threadProperties.topic)return e.threadProperties.topic}},je=e=>{const n=Ee(e),i=Oe(e);return n.map((n=>{const a={},t=n.name;return a[l.Q5.CreatedAt]=parseInt(n.createdat,10),a[l.Q5.Picture]=n.picture,a[l.Q5.IsDeleted]=n.isdeleted,a[l.Q5.XTeamName]=n.isShared?t:i,a.topic=t,a[l.Q5.TopicThreadTopic]=t,{threadProperties:a,id:n.id,members:[],messages:"",properties:{},version:0,type:l.i1.Topic,threadVersion:0,detailsVersion:-1,oldConsumptionHorizonKeys:[],teamId:e.id,lastMessageTimeUtc:0,isPending:void 0,memberProperties:{},mruEvictedTime:0,rosterVersion:0,rosterSummary:void 0,botMembers:[],lastSeenSkipRosterState:void 0,lastMessage:void 0,localClientId:"",isUserMember:!1,source:e.source}}))},Ve=e=>{if(e.parentId)return e.parentId;if((0,c.re)(e))try{const n=JSON.parse(e.threadProperties[l.Q5.ParentSpaces]),i=n.linkedSpaceInfoItems[0].spaceThreadId;if(!(0,t.isEmpty)(i))return i}catch{return}},ze=e=>{const n=e.threadProperties&&e.threadProperties[l.Q5.SpaceId];return(D(e)?e.id:(0,c.re)(e)?Ve(e):n)||e.teamId},Pe=e=>{const n=e.properties?e.properties[l.Ff.Alerts]?.trim().toLowerCase():void 0;return"true"!==n&&("false"===n||void 0)},Re=e=>{if(e?.meetingInfo)try{const n=JSON.parse(e.meetingInfo)?.rsvpStatus;switch(n){case"Accept":return l.Gv.ACCEPT;case"Tentative":return l.Gv.TENTATIVE;case"Follow":return l.Gv.FOLLOW;case"Decline":return l.Gv.DECLINE;default:return l.Gv.NO_RESPONSE}}catch(e){return l.Gv.NO_RESPONSE}return l.Gv.NO_RESPONSE},Be=e=>e.threadProperties&&((0,t.isBoolean)(e.threadProperties[l.Q5.GapDetectionEnabled])?e.threadProperties[l.Q5.GapDetectionEnabled]:"true"===(0,t.lowerCase)(e.threadProperties[l.Q5.GapDetectionEnabled])),Qe=e=>{const n=Ye(e);return n&&!Ae(e)&&de(e)&&(0,t.some)(e.members,(e=>e.tenantId&&e.tenantId!==n))||Ze(e.id)||Ze(e.localClientId||"")},We=e=>!(0,t.isNil)(e.threadProperties)&&(e.threadProperties[l.Q5.TemplateType]===l.Q5.ImmutableRoster||"true"===e.threadProperties[l.Q5.IsStickyThread]?.toString()?.toLowerCase()),Ze=e=>(0,t.startsWith)(e,l.At),Ye=e=>e.threadProperties&&e.threadProperties[l.Q5.TenantId],Ge=e=>{const n=e.threadProperties[l.Q5.ArchivalLevel],i=D(e)&&!!n&&n.toLowerCase()===l.C8.Space.toLowerCase(),a=B(e)&&!!n&&(n.toLowerCase()===l.C8.Topic.toLowerCase()||n.toLowerCase()===l.C8.Space.toLowerCase());return i||a},_e=e=>{if(!e||!e.properties)return!1;const n=e.properties[l.Ff.isPinned];return!!n&&("boolean"==typeof n?n:"string"==typeof n&&"true"===n.toLowerCase())},Je=e=>{const n=e.memberProperties?.[l.e0.RelationshipState];return!!n?.inQuarantine},He=e=>{const n=e.memberProperties?.[l.e0.RelationshipState];return"number"==typeof n?.quarantineCounter?n?.quarantineCounter:0},qe=e=>!!e.memberProperties?.[l.e0.ExplicitlyAdded],Xe=e=>e?.properties?.suppressLastMessageUpdate===l.Zt.Sender,Ke=e=>de(e)&&!e.usersProps?.hasFederatedUser&&(0,t.every)(e.members,(e=>e.id?.startsWith(l.rK)))||!1,$e=e=>!(!D(e)||parseInt(e.threadProperties?.[l.Q5.SpaceTypes],10)!==d.tG.TenantWide),en=(e,n)=>!!(n&&""!==n&&e.threadProperties&&e.threadProperties[l.Q5.TenantId]&&e.threadProperties[l.Q5.TenantId]!==n),nn=(e,n)=>!(!D(e)||en(e,n)||$e(e)||g(e)||!ie(e)||Y(e))},136588:(e,n,i)=>{"use strict";var a,t,r;i.d(n,{TS:()=>a,Cb:()=>t,H8:()=>r,zt:()=>o,GM:()=>l,rh:()=>s,Tj:()=>d}),function(e){e.addToCall="addToCall",e.addToChat="addToChat",e.addToMeeting="addToMeeting",e.addToMeetingForSharedChannel="addToMeetingForSharedChannel",e.addToSpeedDialOrContacts="addToSpeedDialOrContacts",e.addContacts="addContacts",e.addToTeam="addToTeam",e.atMention="atMention",e.callForwardGroupSelection="callForwardGroupSelection",e.calendarPeoplePicker="calendarPeoplePicker",e.callRouting="callToRouting",e.delegationSelection="delegationSelection",e.meetingSchedule="meetingSchedule",e.newChat="newChat",e.orgChart="orgChart",e.presenceSettings="presenceSettings",e.priorityContactsSelection="priorityContactsSelection",e.searchResults="searchResults",e.searchPeopleFilter="searchPeopleFilter",e.searchSuggestions="searchSuggestions",e.shareToTeams="shareToTeams",e.shareContact="shareContact",e.taggedContactsSelection="taggedContactSelection",e.transfer="transfer",e.escalateMessage="escalateMessage",e.addToSharedChannel="addToSharedChannel",e.allFalse="allFalse",e.allTrue="allTrue",e.meetingRoomCall="meetingRoomCall",e.voicemailTransferTarget="voicemailTransferTarget",e.exceptionHandlingPerson="exceptionHandlingPerson",e.exceptionHandlingVoiceapp="exceptionHandlingVoiceapp",e.custom="custom",e.externalSuggestedContacts="externalSuggestedContacts"}(a||(a={})),function(e){e.AADTenant="AADTenant",e.Bot="Bot",e.CallQandAA="CallQandAA",e.DisabledUser="DisabledUser",e.DL="DL",e.Federated="Federated",e.FederatedConsumer="FederatedConsumer",e.Guest="Guest",e.ModernGroup="ModernGroup",e.PersonalContact="PersonalContact",e.ExpandedPersonalContact="ExpandedPersonalContact",e.Pstn="Pstn",e.Room="Room",e.UserDefinedGroup="UserDefinedGroup",e.TeamTags="TeamTags",e.PstnNonE164="PstnNonE164",e.LetterMapNumbers="LetterMapNumbers",e.GroupChats="GroupChats",e.Meetings="Meetings",e.Xtap="Xtap",e.TflOffNetworkEmails="TflOffNetworkEmails",e.TflOffNetworkPhones="TflOffNetworkPhones",e.SkypeConsumer="SkypeConsumer",e.TflConsumer="TflConsumer",e.TflSmsName="TflSmsName",e.ImplicitContacts="ImplicitContacts",e.ImplicitContactsForSMBSuggestions="ImplicitContactsForSMBSuggestions",e.ExtendedDirectoryUsers="ExtendedDirectoryUsers",e.MTOUsers="MTOUsers",e.Tfl2WaySmsUsers="Tfl2WaySmsUsers",e.B2BMembers="B2BMembers",e.NonEmailSecurityGroupsWithDLs="NonEmailSecurityGroupsWithDLs"}(t||(t={})),function(e){e.AAD="AAD",e.IndexedDb="IndexedDB",e.MiddleTier="MT",e.Substrate="3S",e.TopNCache="TopNCache",e.Memory="Memory",e.TFLZeroState="TFLZeroState"}(r||(r={}));const o={IDBFedBot:"IDB-FedBot",IDBPeopleGroup:"IDB-PeopleGroup",TeamTag:"TeamTag",Memory:"Memory",MT:"MT"},l={EntityActionTaken:"EntityActionTaken",EntityClicked:"EntityClicked",MouseHover:"MouseHover"},s={OpenContactCard:"OpenContactCard",Remove:"Remove"},d={Vertical:"vertical"}},140560:(e,n,i)=>{"use strict";i.d(n,{a:()=>u,B:()=>m});var a=i(136588);const t=[a.Cb.AADTenant,a.Cb.Guest,a.Cb.B2BMembers,a.Cb.Federated,a.Cb.FederatedConsumer,a.Cb.Bot,a.Cb.DisabledUser,a.Cb.DL,a.Cb.ModernGroup,a.Cb.PersonalContact,a.Cb.UserDefinedGroup,a.Cb.Pstn,a.Cb.CallQandAA,a.Cb.Room,a.Cb.TeamTags,a.Cb.GroupChats,a.Cb.Xtap,a.Cb.TflOffNetworkEmails,a.Cb.TflOffNetworkPhones,a.Cb.TflConsumer,a.Cb.SkypeConsumer,a.Cb.ImplicitContacts],r=[a.Cb.AADTenant,a.Cb.Guest,a.Cb.B2BMembers,a.Cb.Bot,a.Cb.DisabledUser,a.Cb.UserDefinedGroup,a.Cb.Pstn,a.Cb.PersonalContact,a.Cb.CallQandAA,a.Cb.Federated,a.Cb.FederatedConsumer,a.Cb.ImplicitContacts,a.Cb.SkypeConsumer,a.Cb.TflConsumer],o=[a.Cb.AADTenant,a.Cb.Guest,a.Cb.B2BMembers,a.Cb.Federated,a.Cb.FederatedConsumer,a.Cb.Bot,a.Cb.DisabledUser,a.Cb.DL,a.Cb.ModernGroup,a.Cb.UserDefinedGroup,a.Cb.Pstn,a.Cb.CallQandAA,a.Cb.Room,a.Cb.TeamTags,a.Cb.GroupChats,a.Cb.Xtap,a.Cb.TflOffNetworkEmails,a.Cb.TflOffNetworkPhones,a.Cb.TflConsumer,a.Cb.SkypeConsumer,a.Cb.ImplicitContacts],l=[a.Cb.AADTenant,a.Cb.Guest,a.Cb.B2BMembers,a.Cb.Federated,a.Cb.FederatedConsumer,a.Cb.Bot,a.Cb.DisabledUser,a.Cb.DL,a.Cb.ModernGroup,a.Cb.UserDefinedGroup,a.Cb.Pstn,a.Cb.CallQandAA,a.Cb.Room,a.Cb.GroupChats,a.Cb.Xtap,a.Cb.Meetings,a.Cb.TflSmsName,a.Cb.SkypeConsumer],s=(a.Cb.AADTenant,a.Cb.Guest,a.Cb.B2BMembers,a.Cb.Federated,a.Cb.FederatedConsumer,a.Cb.Bot,a.Cb.DisabledUser,a.Cb.DL,a.Cb.ModernGroup,a.Cb.PersonalContact,a.Cb.UserDefinedGroup,a.Cb.Pstn,{[a.TS.callForwardGroupSelection]:[a.Cb.AADTenant,a.Cb.B2BMembers,a.Cb.Federated,a.Cb.FederatedConsumer,a.Cb.Pstn,a.Cb.CallQandAA],[a.TS.allTrue]:t,[a.TS.meetingRoomCall]:r,[a.TS.searchSuggestions]:l,[a.TS.addToMeetingForSharedChannel]:o,[a.TS.calendarPeoplePicker]:[a.Cb.AADTenant,a.Cb.Guest,a.Cb.Federated,a.Cb.DisabledUser,a.Cb.PersonalContact,a.Cb.ModernGroup,a.Cb.DL,a.Cb.SkypeConsumer],[a.TS.searchResults]:[a.Cb.AADTenant,a.Cb.Guest,a.Cb.B2BMembers,a.Cb.Federated,a.Cb.FederatedConsumer,a.Cb.Bot,a.Cb.DisabledUser,a.Cb.ModernGroup,a.Cb.UserDefinedGroup,a.Cb.Pstn,a.Cb.CallQandAA,a.Cb.SkypeConsumer],[a.TS.addToTeam]:[a.Cb.AADTenant,a.Cb.Guest,a.Cb.B2BMembers,a.Cb.Federated,a.Cb.FederatedConsumer,a.Cb.Bot,a.Cb.DisabledUser,a.Cb.Pstn,a.Cb.SkypeConsumer,a.Cb.NonEmailSecurityGroupsWithDLs],[a.TS.newChat]:[a.Cb.AADTenant,a.Cb.Guest,a.Cb.B2BMembers,a.Cb.Federated,a.Cb.FederatedConsumer,a.Cb.Bot,a.Cb.DisabledUser,a.Cb.DL,a.Cb.ModernGroup,a.Cb.UserDefinedGroup,a.Cb.TeamTags,a.Cb.TflSmsName,a.Cb.ExtendedDirectoryUsers,a.Cb.SkypeConsumer],[a.TS.transfer]:[a.Cb.AADTenant,a.Cb.Guest,a.Cb.B2BMembers,a.Cb.DisabledUser,a.Cb.DL,a.Cb.ModernGroup,a.Cb.UserDefinedGroup,a.Cb.Pstn,a.Cb.CallQandAA,a.Cb.SkypeConsumer],[a.TS.addToCall]:[a.Cb.AADTenant,a.Cb.Guest,a.Cb.B2BMembers,a.Cb.Bot,a.Cb.DisabledUser,a.Cb.UserDefinedGroup,a.Cb.Pstn,a.Cb.PersonalContact,a.Cb.CallQandAA,a.Cb.Federated,a.Cb.FederatedConsumer,a.Cb.ImplicitContacts,a.Cb.SkypeConsumer,a.Cb.TflConsumer,a.Cb.Xtap,a.Cb.Room],[a.TS.addToChat]:[a.Cb.AADTenant,a.Cb.Guest,a.Cb.B2BMembers,a.Cb.Federated,a.Cb.DisabledUser,a.Cb.TeamTags,a.Cb.ExtendedDirectoryUsers,a.Cb.SkypeConsumer],[a.TS.searchPeopleFilter]:[a.Cb.AADTenant,a.Cb.Guest,a.Cb.B2BMembers,a.Cb.Federated,a.Cb.FederatedConsumer,a.Cb.Bot,a.Cb.DisabledUser,a.Cb.Pstn,a.Cb.TeamTags,a.Cb.SkypeConsumer],[a.TS.callRouting]:[a.Cb.AADTenant,a.Cb.Guest,a.Cb.B2BMembers,a.Cb.Bot,a.Cb.DisabledUser,a.Cb.DL,a.Cb.UserDefinedGroup,a.Cb.Pstn,a.Cb.CallQandAA,a.Cb.SkypeConsumer],[a.TS.delegationSelection]:[a.Cb.AADTenant,a.Cb.B2BMembers,a.Cb.SkypeConsumer],[a.TS.presenceSettings]:[a.Cb.AADTenant,a.Cb.Guest,a.Cb.B2BMembers,a.Cb.Federated,a.Cb.FederatedConsumer,a.Cb.Pstn,a.Cb.SkypeConsumer],[a.TS.addToMeeting]:[a.Cb.AADTenant,a.Cb.Guest,a.Cb.B2BMembers,a.Cb.Federated,a.Cb.FederatedConsumer,a.Cb.Bot,a.Cb.DisabledUser,a.Cb.DL,a.Cb.ModernGroup,a.Cb.UserDefinedGroup,a.Cb.Pstn,a.Cb.SkypeConsumer],[a.TS.meetingSchedule]:[a.Cb.AADTenant,a.Cb.Guest,a.Cb.B2BMembers,a.Cb.Federated,a.Cb.DL,a.Cb.ModernGroup,a.Cb.Pstn,a.Cb.SkypeConsumer],[a.TS.addToSpeedDialOrContacts]:[a.Cb.AADTenant,a.Cb.Guest,a.Cb.B2BMembers,a.Cb.Federated,a.Cb.FederatedConsumer,a.Cb.Bot,a.Cb.DisabledUser,a.Cb.CallQandAA,a.Cb.SkypeConsumer],[a.TS.addContacts]:[a.Cb.AADTenant,a.Cb.Guest,a.Cb.Federated,a.Cb.FederatedConsumer,a.Cb.Bot,a.Cb.DisabledUser,a.Cb.CallQandAA,a.Cb.Pstn,a.Cb.SkypeConsumer],[a.TS.atMention]:[a.Cb.AADTenant,a.Cb.Guest,a.Cb.B2BMembers,a.Cb.Bot,a.Cb.Pstn,a.Cb.SkypeConsumer],[a.TS.orgChart]:[a.Cb.AADTenant,a.Cb.Guest,a.Cb.B2BMembers,a.Cb.Pstn,a.Cb.SkypeConsumer],[a.TS.shareContact]:[a.Cb.AADTenant,a.Cb.SkypeConsumer],[a.TS.priorityContactsSelection]:[a.Cb.AADTenant,a.Cb.B2BMembers,a.Cb.Federated,a.Cb.FederatedConsumer,a.Cb.Pstn,a.Cb.SkypeConsumer],[a.TS.taggedContactsSelection]:[a.Cb.AADTenant,a.Cb.Guest,a.Cb.B2BMembers,a.Cb.DL,a.Cb.SkypeConsumer],[a.TS.shareToTeams]:[a.Cb.AADTenant,a.Cb.Guest,a.Cb.B2BMembers,a.Cb.Federated,a.Cb.FederatedConsumer,a.Cb.DisabledUser,a.Cb.UserDefinedGroup,a.Cb.SkypeConsumer],[a.TS.escalateMessage]:[a.Cb.AADTenant,a.Cb.SkypeConsumer],[a.TS.voicemailTransferTarget]:[a.Cb.AADTenant,a.Cb.Guest,a.Cb.B2BMembers,a.Cb.Bot,a.Cb.DisabledUser,a.Cb.ModernGroup,a.Cb.UserDefinedGroup,a.Cb.Pstn,a.Cb.CallQandAA,a.Cb.SkypeConsumer],[a.TS.addToSharedChannel]:[a.Cb.AADTenant,a.Cb.Xtap,a.Cb.SkypeConsumer],[a.TS.externalSuggestedContacts]:[a.Cb.ImplicitContactsForSMBSuggestions,a.Cb.SkypeConsumer],[a.TS.exceptionHandlingPerson]:[a.Cb.AADTenant],[a.TS.exceptionHandlingVoiceapp]:[a.Cb.CallQandAA],[a.TS.allFalse]:[],[a.TS.custom]:[]});var d=i(803238);const c=(e,n)=>(0,d.flatten)(e.filter((([e,i])=>e===n)).map((([e,n])=>n))),m={[a.H8.Substrate]:[a.Cb.AADTenant,a.Cb.Guest,a.Cb.GroupChats,a.Cb.DL,a.Cb.ModernGroup,a.Cb.Room,a.Cb.ExtendedDirectoryUsers,a.Cb.PersonalContact,a.Cb.MTOUsers,a.Cb.CallQandAA],[a.H8.AAD]:[a.Cb.Guest],[a.H8.IndexedDb]:[a.Cb.Federated,a.Cb.FederatedConsumer,a.Cb.SkypeConsumer,a.Cb.Bot,a.Cb.Pstn],[a.H8.MiddleTier]:[],[a.H8.TopNCache]:[],[a.H8.Memory]:[],[a.H8.TFLZeroState]:[]};class u{constructor(e,n){this.includeFeatures=e,this.name=n,this.includeAADTenant=!1,this.includeGuest=!1,this.includeFederated=!1,this.includeFederatedConsumer=!1,this.includeBot=!1,this.includeDisabledUser=!1,this.includeDL=!1,this.includeModernGroup=!1,this.includePersonalContact=!1,this.includeExpandedPersonalContact=!1,this.includeUserDefinedGroup=!1,this.includePstn=!1,this.includeCallQandAA=!1,this.includeRoom=!1,this.includeTeamTags=!1,this.includeGroupChats=!1,this.includeMeetingChats=!1,this.includeXtap=!1,this.includeOffNetworkEmails=!1,this.includeOffNetworkPhones=!1,this.includeSkypeConsumer=!1,this.includeTflConsumer=!1,this.includeTflSmsName=!1,this.includeImplicitContacts=!1,this.includeImplicitContactsForSMBSuggestions=!1,this.includeExtendedDirectoryUsers=!1,this.includeMTOUsers=!1,this.includeTfl2WaySmsUsers=!1,this.includeB2BMembers=!1,this.includeNonEmailSecurityGroupsWithDLs=!1,this.includeAADTenant=(0,d.includes)(e,a.Cb.AADTenant),this.includeGuest=(0,d.includes)(e,a.Cb.Guest),this.includeFederated=(0,d.includes)(e,a.Cb.Federated),this.includeFederatedConsumer=(0,d.includes)(e,a.Cb.FederatedConsumer),this.includeBot=(0,d.includes)(e,a.Cb.Bot),this.includeDisabledUser=(0,d.includes)(e,a.Cb.DisabledUser),this.includeDL=(0,d.includes)(e,a.Cb.DL),this.includeModernGroup=(0,d.includes)(e,a.Cb.ModernGroup),this.includePersonalContact=(0,d.includes)(e,a.Cb.PersonalContact),this.includeExpandedPersonalContact=(0,d.includes)(e,a.Cb.ExpandedPersonalContact),this.includeUserDefinedGroup=(0,d.includes)(e,a.Cb.UserDefinedGroup),this.includePstn=(0,d.includes)(e,a.Cb.Pstn),this.includeCallQandAA=(0,d.includes)(e,a.Cb.CallQandAA),this.includeRoom=(0,d.includes)(e,a.Cb.Room),this.includeTeamTags=(0,d.includes)(e,a.Cb.TeamTags),this.includeGroupChats=(0,d.includes)(e,a.Cb.GroupChats),this.includeMeetingChats=(0,d.includes)(e,a.Cb.Meetings),this.includeXtap=(0,d.includes)(e,a.Cb.Xtap),this.includeOffNetworkEmails=(0,d.includes)(e,a.Cb.TflOffNetworkEmails),this.includeOffNetworkPhones=(0,d.includes)(e,a.Cb.TflOffNetworkPhones),this.includeSkypeConsumer=(0,d.includes)(e,a.Cb.SkypeConsumer),this.includeTflConsumer=(0,d.includes)(e,a.Cb.TflConsumer),this.includeTflSmsName=(0,d.includes)(e,a.Cb.TflSmsName),this.includeImplicitContacts=(0,d.includes)(e,a.Cb.ImplicitContacts),this.includeImplicitContactsForSMBSuggestions=(0,d.includes)(e,a.Cb.ImplicitContactsForSMBSuggestions),this.includeExtendedDirectoryUsers=(0,d.includes)(e,a.Cb.ExtendedDirectoryUsers),this.includeMTOUsers=(0,d.includes)(e,a.Cb.MTOUsers),this.includeTfl2WaySmsUsers=(0,d.includes)(e,a.Cb.Tfl2WaySmsUsers),this.includeB2BMembers=(0,d.includes)(e,a.Cb.B2BMembers),this.includeNonEmailSecurityGroupsWithDLs=(0,d.includes)(e,a.Cb.NonEmailSecurityGroupsWithDLs)}}u.fromName=(e,n=[])=>{if(!(e in s))throw new TypeError("Invalid `name` attribute passed. Please make sure it exists in PEOPLE_FILTER_NAME_CONFIG.");const i=c(n,!0),a=c(n,!1),t=d.without.apply(null,[(0,d.concat)(s[e],i),...a]);return new u(t,e)},u.createFrom=(e,n,i)=>new u(n||e.includeFeatures,i||e.name),u.includesAll=(e,n)=>(0,d.every)(n,(n=>(0,d.includes)(e.includeFeatures,n))),u.includesAny=(e,n)=>(0,d.some)(n,(n=>(0,d.includes)(e.includeFeatures,n)))},819827:(e,n,i)=>{"use strict";var a,t,r,o;i.d(n,{WH:()=>a,xd:()=>t,$D:()=>r,Uj:()=>o,Zh:()=>l,z_:()=>s,Ei:()=>d,iu:()=>c,UJ:()=>m,Je:()=>u,IE:()=>p}),function(e){e.ConsumerUser="ConsumerUser",e.NotFound="NotFound",e.Success="Success"}(a||(a={})),function(e){e[e.CoreScenario=0]="CoreScenario",e[e.DialToneScenario=1]="DialToneScenario",e[e.BackgroundTask=2]="BackgroundTask"}(t||(t={})),function(e){e.XSmall="HR32x32",e.Small="HR64x64",e.Medium="HR96x96",e.XMedium="HR120x120",e.Large="HR196x196"}(r||(r={})),function(e){e.TfwWithSfc="tfwWithSfc",e.TfwWithTfl="tfwWithTfl",e.TflWithTfw="tflWithTfw",e.TfwWithTfwFederated="tfwWithTfwFederated",e.ExtendedDirectoryTflWithTfw="extendedDirectoryTflWithTfw"}(o||(o={}));const l=["Large","XMedium","Medium","Small","XSmall"];var s;!function(e){e.Mobile="Mobile",e.Business="Business",e.Home="Home",e.Pager="Pager",e.Organization="Organization",e.HomeFax="HomeFax",e.BusinessFax="BusinessFax",e.Other="Other",e.Unknown="Unknown",e.Assistant="Assistant",e.OtherFax="OtherFax",e.Radio="Radio"}(s||(s={}));const d={Private:"Private",Public:"Public"};var c,m,u;!function(e){e.success="success",e.invalid="invalid",e.inTenantUser="intenantuser",e.consumerUser="consumeruser",e.notFound="notfound",e.notAllowed="notallowed",e.failed="failed",e.missingResponse="missingresponse",e.backendrequestfailed="backendrequestfailed"}(c||(c={})),function(e){e.UpdateMSASearchabilityStamping="updateMSASearchabilityStamping",e.UpdateMsaAliasVisibilitySetting="updateMsaAliasVisibilitySetting",e.GetPeopleProfilesByMris="getPeopleProfilesByMris",e.GetFederatedPeopleProfilesByMris="getFederatedPeopleProfilesByMris",e.GetPeopleProfilesByEmails="getPeopleProfilesByEmails",e.GetFederatedPeopleProfilesByEmails="getFederatedPeopleProfilesByEmails",e.GetMeProfile="getMeProfile",e.GetOfficeGroup="getOfficeGroup",e.GetUser="getUser",e.FetchAllUsersByMrisInSharedChannel="people_get_all_users_sharedChannel",e.FetchAllUsersByMrisInSharedChannelBatch="people_get_users_sharedChannel_batch",e.UpdateMsaUserName="update_msa_profile_displayname",e.UpdateProfileAvatar="update_profile_avatar",e.removeSelfProfilePicture="remove_msa_profile_picture",e.UpdateGroupProfileAvatar="update_group_profile_avatar",e.DeleteGroupProfileAvatar="delete-group-profile-avatar",e.GetTflConsumerProfilesByMris="getTflConsumerProfilesByMris",e.GetSkypeConsumerProfilesByMris="getSkypeConsumerProfilesByMris",e.GetTenantPrivacyPolicyStatementUrl="getTenantPrivacyPolicyStatementUrl",e.GetProfilePicturePolicy="getProfilePicturePolicy",e.GetExternalProfilesByAliases="getExternalProfilesByAliases"}(m||(m={})),function(e){e.GET="GET",e.POST="POST",e.PATCH="PATCH",e.PUT="PUT",e.DELETE="DELETE"}(u||(u={}));const p=["displayName","imageUri","selfAvatarLastupdatedTime","profileType","avatarETag"]},602129:(e,n,i)=>{"use strict";i.d(n,{MD:()=>a,t:()=>t,vf:()=>r,p_:()=>o,cT:()=>l});const a={saveUnknownUser:"unknown_user_profile_generated",unknownUserFromDB:"unknown_user_from_index_db"},t={botType:"BOT"},r={member:"Member",guest:"Guest",anonymousUser:"AnonymousUser",voiceApp:"ADVoiceApp",DistributionList:"Group",Bot:"Bot",person:"Person",federated:"Federated",skypeConsumer:"SkypeConsumer",tflUser:"TFLUser",tflOffNetwork:"TFLOffNetwork",personalContactUser:"PersonalContactUser",tflConsumer:"TflConsumer",pstn:"pstn",extendedDirectoryUser:"EDUser",PendingOrgContact:"PendingOrgContact",OrgContact:"OrgContact",MTOUser:"MTOUser",B2BMember:"B2BMember",ADUser:"ADUser",ACSUser:"ACSUser",room:"Room"},o={MTOUser:64,B2BMember:32},l={showWarningBannerMinimumThreshold:20,type:{team:"team",channel:"channel",person:"person",webhook:"webhook",bot:"BOT",addABot:"addABot",app:"app"},hintElement:"ts-hint"}},439697:(e,n,i)=>{"use strict";i.d(n,{M:()=>p,T0:()=>k,wo:()=>v,DS:()=>T,Im:()=>M,S4:()=>y,Rb:()=>S,yN:()=>A,$V:()=>b,$l:()=>C,eo:()=>D});var a,t=i(819827),r=i(136588),o=i(683184),l=i(379658),s=i(602129),d=i(803238),c=i(140560),m=i(997342),u=i(882066);const p="unknown_email_address@invalid.teams.ms",k="4:",g="8:tfloffnetwork:",N=`${g}email:`,f=`${g}phone:`,h="50:sms:",v="50:smsunverified:",T="unknown user",M="8:teamsvisitor:",y="8:guest:",S=4,A="28:orgid:",I=["live","sip_profile","myspace","c2c","sms"],b="TflContacts";var C;!function(e){e.NotResolved="NotResolved",e.External="External",e.User="User",e.DistributionList="DistributionList"}(C||(C={}));class D{static isUnknownUser(e){return e.email===p||"unknown@af4716f4-406e-409b-acc1-b8bf9efe83fa.com"===e.email}static getUnknownUserEmail(){return p}static getRequestCount(e){return e&&e.requestCount||e.$$requestCount||0}static getUserDisplayNameWithPostfixAndSecurityLabel(e,n,i,a,t,r){const{id:s}=e;let{displayName:d}=e,c=null;const{enableExternalTagForPSTNUsers:m,enableLabelingUsersByTrustLevel:u,enableMTOLabel:p}=n.get(o.J.People),k=n.get(o.J.Metadata).environment===l.s.life;if(!d)return{displayName:null,securityLabel:c};if(e.isRenamed&&(d=this.checkAndAddEditedTag(d,i),c=this.getEditedUserTag(i)),k)this.isAnonymousUser(s)&&(d=this.checkAndAddGuestTag(d,i),c=this.getGuestUserTag(i));else{if(this.isMTOUser(e))return this.getMTOUserDisplayNamePostfixHelperAndSecurityLabel(!!p,!!r,"mtoLabel"in e?e.mtoLabel:null,d,i);if(this.isAnonymousUser(s)){const n=this.getAnonymousTfwUserDisplayNamePostfixHelperAndSecurityLabel(e,d,!!u,a,i);d=n.displayName,c=n.securityLabel}else if(this.isFederatedUser(e)||this.isExtendedDirectoryUser(e)||this.isTFLConsumerUser(e)||this.isSfcUser(e))this.isAnonymousTfwUser(a)?(d=D.checkAndAddUnverifiedTag(d,i),c=this.getUnverifiedTag(i)):(d=D.checkAndAddExternalTag(d,i),c=this.getExternalTag(i));else if(u&&("isAnonymousB2bUser"in e&&e.isAnonymousB2bUser||this.isAcsUserMri(s)))d=this.checkAndAddUnverifiedTag(d,i),c=this.getUnverifiedTag(i);else if(this.isGuestUser(e))d=this.checkAndAddGuestTag(d,i),c=this.getGuestUserTag(i);else if(u&&this.isAnonymousTfwUser(a)&&this.isConsumerUserMri(s))d=this.checkAndAddUnverifiedTag(d,i),c=this.getUnverifiedTag(i);else if(m&&this.isPSTNUser({mri:e.id})){const a=D.getPSTNUserDisplayNamePostfixHelperAndSecurityLabel(e.id,d,n,!!t,i);d=a.displayName,c=a.securityLabel}}return{displayName:d,securityLabel:c}}static getUserDisplayNameWithPostfix(e,n,i,a,t,r){return this.getUserDisplayNameWithPostfixAndSecurityLabel(e,n,i,a,t,r).displayName}static getUserSecurityLabel(e,n,i,a,t,r){const o=this.getUserDisplayNameWithPostfixAndSecurityLabel(e,n,i,a,t,r).securityLabel;if(!o)return null;const l=o.match(/\(([^)]+)\)/g);return l&&l.length?l[l.length-1].slice(1,-1):null}static checkAndAddEditedTag(e,n){const i=this.getDefaultEditedDisplayName(n),a=this.getEditedUserTag(n);let t=e;return e.includes(a)||e===i||(t+=` ${a}`),t}static checkAndAddGuestTag(e,n){const i=this.getDefaultGuestDisplayName(n),a=this.getGuestUserTag(n);let t=e;return e.includes(a)||e===i||(t+=` ${a}`),t}static checkAndAddExternalTag(e,n){const i=this.getDefaultExternalDisplayname(n),a=this.getExternalTag(n);let t=e;return e.includes(a)||e===i||(t+=` ${a}`),t}static checkAndAddUnverifiedTag(e,n){const i=this.getDefaultUnverifiedDisplayname(n),a=this.getUnverifiedTag(n);let t=e;return e.includes(a)||e===i||(t+=` ${a}`),t}static getPSTNUserDisplayNamePostfixHelperAndSecurityLabel(e,n,i,a,t){const{enableLabelingUsersByTrustLevel:r,disableUnverifiedLabelForPSTNUsers:l}=i.get(o.J.People),{emergencySmsNumbers:s,hotlineSMSNumbers:d}=i.get(o.J.Messaging);return r?l||a||this.isEmergencyOrHotlinePhoneNumber(e,s||[],d||[])?{displayName:D.checkAndAddExternalTag(n,t),securityLabel:this.getExternalTag(t)}:{displayName:D.checkAndAddUnverifiedTag(n,t),securityLabel:this.getUnverifiedTag(t)}:{displayName:D.checkAndAddExternalTag(n,t),securityLabel:this.getExternalTag(t)}}static getAnonymousTfwUserDisplayNamePostfixHelperAndSecurityLabel(e,n,i,a,t){let r;return"isCcmUser"in e&&e.isCcmUser?(n=this.checkAndAddExternalTag(n,t),r=this.getExternalTag(t)):i?(n=a!==e.id?this.checkAndAddUnverifiedTag(n,t):n,r=this.getUnverifiedTag(t)):(n=this.checkAndAddGuestTag(n,t),r=this.getGuestUserTag(t)),{displayName:n,securityLabel:r}}static getMTOUserDisplayNamePostfixHelperAndSecurityLabel(e,n,i,a,t){return e&&n&&i?{displayName:`${a} (${i})`,securityLabel:`(${i})`}:e?{displayName:a,securityLabel:null}:{displayName:D.checkAndAddExternalTag(a,t),securityLabel:this.getExternalTag(t)}}static getDefaultEditedDisplayName(e){return e.stringTranslate("calling","default_edited_displayname",{defaultValue:"Edited"})}static getEditedUserTag(e){return e.stringTranslate("calling","edited_user_postfix",{defaultValue:"(Edited)"})}static getDefaultGuestDisplayName(e){return e.stringTranslate("peoplePicker","default_guest_displayname",{defaultValue:"Guest"})}static getGuestUserTag(e){return e.stringTranslate("peoplePicker","guest_user_postfix",{defaultValue:"(Guest)"})}static getDefaultExternalDisplayname(e){return e.stringTranslate("peoplePicker","default_external_displayname",{defaultValue:"External"})}static getDefaultUnverifiedDisplayname(e){return e.stringTranslate("peoplePicker","default_unverified_displayname",{defaultValue:"Unverified"})}static getExternalTag(e){return e.stringTranslate("peoplePicker","external_user_postfix",{defaultValue:"(External)"})}static getUnverifiedTag(e){return e.stringTranslate("peoplePicker","unverified_user_postfix",{defaultValue:"(Unverified)"})}static applyFeatureFlagSettings(e,n){let i=e.includeFeatures;const a=Boolean(n.get(o.J.Messaging).enableConsumerConversations);switch(e.name){case r.TS.addToMeeting:{const{enableBotsInScheduledMeetings:e,enableFederatedUsersInMeetings:t}=n.get(o.J.Federated);t||(i=(0,d.difference)(i,[r.Cb.Federated])),e&&(i=(0,d.difference)(i,[r.Cb.Bot])),i=a?(0,d.difference)(i,[r.Cb.Federated]):(0,d.difference)(i,[r.Cb.TflConsumer]);break}case r.TS.allTrue:{const{enableTflTfwFederation:e,enableTfwTflFederation:t}=n.get(o.J.Host);a?e&&(i=(0,d.difference)(i,[r.Cb.Federated])):t&&(i=(0,d.difference)(i,[r.Cb.TflConsumer]));break}case r.TS.meetingSchedule:const{enableBotsInScheduledMeetings:e,enableFederatedUsersInMeetings:t}=n.get(o.J.Federated);t||(i=(0,d.difference)(i,[r.Cb.Federated])),e&&(i=(0,d.difference)(i,[r.Cb.Bot]));break;case r.TS.addToChat:const{enableFederatedUsersInAddToChat:l}=n.get(o.J.Federated),{enableTfwFederationOnTfl:s,enableTfwTflFederation:c}=n.get(o.J.Host);a?s||(i=(0,d.difference)(i,[r.Cb.Federated])):(l||(i=(0,d.difference)(i,[r.Cb.Federated])),c||(i=(0,d.difference)(i,[r.Cb.TflConsumer])));const{enableDLsInAddToChat:m}=n.get(o.J.DistributionLists);m||(i=(0,d.difference)(i,[r.Cb.DL]));break;case r.TS.addToTeam:const{enableFederatedUsersInAddToTeam:u}=n.get(o.J.Federated);u||(i=(0,d.difference)(i,[r.Cb.Federated]));break;case r.TS.addToSpeedDialOrContacts:const{enableFederatedUsersInAddToSpeedDialOrContacts:p}=n.get(o.J.Federated);p||(i=(0,d.difference)(i,[r.Cb.Federated]))}return c.a.createFrom(e,i)}static filterSearchResults(e,n,i){let a=n;return(e=D.applyFeatureFlagSettings(e,i)).includeFederated||(a=a.filter((e=>!(D.isFederatedUser(e)||D.isSfcUser(e)||D.isTFLConsumerUser(e))))),e.includeGuest||(a=a.filter((e=>!D.isGuestUser(e)))),e.includeBot||(a=a.filter((e=>!D.isBot(e)))),e.includeDL||(a=a.filter((e=>!D.isDistributionList(e)))),e.includePstn||(a=a.filter((e=>!D.isPSTNUser(e)))),e.includeAADTenant||(a=a.filter((e=>!D.isInTenantUser(e)))),e.includeCallQandAA||(a=a.filter((e=>!D.isCallQorAAUser(e)))),e.includeSkypeConsumer||(a=a.filter((e=>!D.isSfcUser(e)))),e.includeTflConsumer||(a=a.filter((e=>!D.isTFLConsumerUser(e)))),e.includeTflSmsName||(a=a.filter((e=>!D.isTFLSmsFriendlyNameUser(e)))),e.includeMTOUsers||(a=a.filter((e=>!D.isMTOUser(e)))),e.includeTfl2WaySmsUsers||(a=a.filter((e=>!D.isTFLSmsVerifiedMri(e?.mri||"")))),e.includeB2BMembers||(a=a.filter((e=>!D.isB2BMember(e)))),e.includeRoom||(a=a.filter((e=>!D.isConfRoom(e)))),a}static isMixedChatUser(e,n){const i=!e&&D.isFederatedUser({type:n})||e&&D.isTFLConsumerUser({type:n})||e&&D.isSfcUser({type:n});return Boolean(i)}static isSfCUserPrefix(e){return-1!==I.indexOf(e)}static matchEmailAliasInMeProfile(e,n){return!(0,d.isEmpty)(n)&&(0,d.some)(n,(n=>e.toLowerCase()===n.address?.toLowerCase()))}static matchPhoneAliasInMeProfile(e,n){return!(0,d.isEmpty)(n)&&(0,d.some)(n,(n=>e===n.number))}static generatePstnProfile(e,n,i,a,t,r,l){let c;const{enableExternalTagForPSTNUsers:p,enableLabelingUsersByTrustLevel:g,disableUnverifiedLabelForPSTNUsers:N}=r?.get(o.J.People)??{},{emergencySmsNumbers:f,hotlineSMSNumbers:h,enablePaidSmsChat:v}=r?.get(o.J.Messaging)??{},T=e.slice(k.length),M=D.getHotlineNumberMapping(T,r);if(a&&i){const t=(0,u.gx)(T),r=(0,m.un)(t,i,a,!0);c={mri:e,displayName:(0,d.isEmpty)(n)?v&&M?.shortCode||r.display:n,givenName:r.display,description:v&&M?r.display:void 0,surname:"",userPrincipalName:e,accountEnabled:!1,jobTitle:"",type:s.vf.pstn,telephoneNumber:r.display}}else c={mri:e,displayName:v&&M?.shortCode||n,description:v&&M?.phoneNumber||void 0,givenName:n,surname:"",userPrincipalName:e,accountEnabled:!1,jobTitle:"",type:s.vf.pstn,telephoneNumber:M?.phoneNumber||T};return p&&t?.stringTranslate instanceof Function&&(!g||N||l||this.isEmergencyOrHotlinePhoneNumber(e,f||[],h||[])?c.decoratedDisplayName=D.checkAndAddExternalTag(c.displayName||n,t):c.decoratedDisplayName=D.checkAndAddUnverifiedTag(c.displayName||n,t)),c}static convertStringToBlobFile(e){const n=e.split(",")[1];if((0,d.isEmpty)(n))return;const i=atob(n),a=e.split(",")[0].split(":")[1].split(";")[0],t=new ArrayBuffer(i.length),r=new Uint8Array(t);for(let e=0;e<i.length;e++)r[e]=i.charCodeAt(e);return new Blob([r],{type:a})}static getPhoneNumbers(e){let n=[];return e?.telephoneNumber&&n.push(e.telephoneNumber),e?.phones&&e.phones.length>0&&(n=n.concat(e.phones.map((e=>e.number)))),n}static getExtendedDirectoryPhoneNumber(e){return D.getPhoneNumbers(e)[0]}static isPartialSCContext(e,n){return!!(e&&!n||!e&&n)}static getFederationType(e,n){let i;const a={type:n};return e?D.isTFLUser(a)?i="tflWithTfl":D.isFederatedUser(a)&&(i="tflWithTfw"):D.isSfcUser(a)?i="tfwWithSfc":D.isTFLConsumerUser(a)?i="tfwWithTfl":D.isFederatedUser(a)&&(i="tfwWithTfwFederated"),i}static getTfwExtendedDirectoryMembership(e,n={}){const{mri:i,userType:a}=e,{excludeOffNetwork:t=!0}=n;return!t&&this.isTFLOffNetworkUser(i)?"offNetwork":this.isPEUPUser(a)?"pending":this.isEUPUser(a)?"accepted":void 0}static getTflExtendedDirectoryMembership(e){return!0===e?"pending":!1===e?"accepted":void 0}static determineM365PersonaType(e){if(!e)return C.NotResolved;const{type:n,userType:i}=e;if(!n)return C.NotResolved;switch(n){case"Federated":case"TflConsumer":case"SkypeConsumer":case s.vf.pstn:return C.External;case"person":case"ADUser":return i&&"Guest"===i?C.NotResolved:C.User;case"Group":return C.DistributionList;default:return C.User}}static isValidNameForInitialsAvatarForPstnUser(e,n){return!!(D.isPSTNUser({mri:e})&&D.isValidNameForInitialsAvatar(n))}static isValidNameForInitialsAvatar(e){const n=new RegExp("(^\\p{L})","iu");return!!(!!e&&n.test(e))}static getDescriptionForPstnContact(e,n,i,a,t){let r;const{mri:l,displayName:s}=e,c=l.split(k)[1],{enablePaidSmsChat:m}=t.get(o.J.Messaging)??{};return m&&D.isPSTNUser({mri:l})&&a&&(D.isTextSameAsPhoneNumber(s,c,n)||(0,d.forEach)(a,(e=>{D.isTextSameAsPhoneNumber(c,e.number,n)&&(r=i.stringTranslate("people",D.getPhoneTypePeopleKey(e.type),{phoneNumber:e.number}))}))),r}static isTextSameAsPhoneNumber(e,n,i){if(!e||!n)return!1;if(e.toLocaleLowerCase()===n.toLocaleLowerCase())return!0;const a=(0,u.gx)(e),t=(0,m.un)(a,"peopleUtilities_isTextSameAsPhoneNumber_Name",i),r=(0,m.un)(n,"peopleUtilities_isTextSameAsPhoneNumber_Phone",i);return t?.diallable===r?.diallable}static getPhoneTypePeopleKey(e){switch(e){case t.z_.Mobile:return`phone_type_${t.z_.Mobile}`;case t.z_.Business:return`phone_type_${t.z_.Business}`;case t.z_.Home:return`phone_type_${t.z_.Home}`;case t.z_.Pager:return`phone_type_${t.z_.Pager}`;case t.z_.Organization:return`phone_type_${t.z_.Organization}`;case t.z_.HomeFax:return`phone_type_${t.z_.HomeFax}`;case t.z_.BusinessFax:return`phone_type_${t.z_.BusinessFax}`;case t.z_.Assistant:return`phone_type_${t.z_.Assistant}`;case t.z_.OtherFax:return`phone_type_${t.z_.OtherFax}`;case t.z_.Radio:return`phone_type_${t.z_.Radio}`;default:return`phone_type_${t.z_.Other}`}}static isEmergencyOrHotlinePhoneNumber(e,n,i){const a=e.slice(k.length);return n.includes(a)||i.includes(a)}static getHotlineNumberMapping(e,n){const i=n?.get(o.J.People)?.hotlineNumbersMapping||[{shortCode:"988",phoneNumber:"+18002738255"}];for(const n of i)if(e===n?.shortCode||e===n?.phoneNumber)return n}}a=D,D.isFederatedUser=e=>!!e.isFederated||e.type?.toLowerCase()===s.vf.federated.toLowerCase(),D.isGuestUser=e=>e.type===s.vf.guest||e.userType===s.vf.guest,D.isPersonalContactUser=e=>e.type===s.vf.personalContactUser||e.userType===r.Cb.PersonalContact,D.isTFLUser=e=>e.type===s.vf.tflUser,D.isTFLConsumerUser=e=>e.type===s.vf.tflConsumer,D.isTFLSmsUser=e=>e.id&&D.isTFLSmsMri(e.id),D.isTFLSmsFriendlyNameUser=e=>e.id&&D.isTFLSmsMri(e.id)&&e.friendlyName,D.isInTenantUser=e=>!(e.type?.toLowerCase()!==s.cT.type.person.toLowerCase()&&e.type!==s.vf.ADUser||D.isGuestUser(e)||e.isFederated),D.isBot=e=>e.type?.toUpperCase()===s.t.botType,D.isDistributionList=e=>e.type===s.vf.DistributionList&&(!e.objectType||e.objectType===s.vf.DistributionList),D.isPSTNUser=e=>e.mri&&0===e.mri.indexOf(k),D.isSfcUser=e=>e.type===s.vf.skypeConsumer,D.isTflOrSkypeConsumerUser=e=>D.isTFLConsumerUser(e)||D.isSfcUser(e),D.isMTOUser=e=>e.profileType===s.p_.MTOUser||e.userType===s.vf.MTOUser,D.isB2BMemberMTOUser=e=>D.isMTOUser(e)&&(e.type===s.vf.ADUser||e.type===s.vf.person),D.isFederatedMTOUser=e=>D.isMTOUser(e)&&D.isFederatedUser(e),D.isB2BMember=e=>e.profileType===s.p_.B2BMember||e.userType===s.vf.B2BMember,D.isB2BGuest=e=>e.userType===s.vf.guest,D.isExtendedDirectoryUser=e=>D.isPEUPUser(e.userType)||D.isEUPUser(e.userType)||e.type===s.vf.extendedDirectoryUser,D.isConfRoom=e=>e.userType===s.vf.room,D.isPEUPUser=e=>e===s.vf.PendingOrgContact,D.isEUPUser=e=>e===s.vf.OrgContact,D.isSfBUser=e=>Boolean(e.mri&&-1!==e.mri.indexOf("sfb:")),D.isCallQorAAUser=e=>e.type===s.vf.voiceApp,D.isAnonymousUser=e=>a.isAnonymousTfwUser(e)||a.isAnonymousTflUser(e),D.isAnonymousTfwUser=e=>e?.startsWith(M),D.isAnonymousTflUser=e=>e?.startsWith(y),D.isAnonymousPstn=e=>e?.startsWith("4:anonymous"),D.isAcsUserMri=e=>e?.startsWith("8:acs:"),D.isTFLOffNetworkUser=e=>0===e?.indexOf(g),D.isTFLOffNetworkPhoneUser=e=>0===e?.indexOf(f),D.isTFLOffNetworkEmailUser=e=>0===e?.indexOf(N),D.isTFLSmsUnVerifiedMri=e=>0===e?.indexOf(v),D.isTFLSmsVerifiedMri=e=>0===e?.indexOf(h),D.isTFLSmsMri=e=>0===e?.indexOf(h)||0===e?.indexOf(v),D.isTFLSmsOrOffNetworkPhoneMri=e=>D.isTFLOffNetworkPhoneUser(e)||D.isTFLSmsMri(e),D.isTflSmsUnverifiedOrOffNetworkPhoneMri=e=>D.isTFLSmsUnVerifiedMri(e)||D.isTFLOffNetworkPhoneUser(e),D.isEnterpriseUserMri=e=>0===e?.indexOf("8:orgid:"),D.isConsumerUserMri=e=>{if(!e||!e.startsWith("8:"))return!1;const n=e.split(":");return!!(2===n.length||3===n.length&&a.isSfCUserPrefix(n[1]))},D.isDisplayNameUnknownUser=e=>e?.toLowerCase()===T||"unknown"===e?.toLowerCase(),D.isConversationItem=e=>0===e.id?.indexOf("19:"),D.isTag=e=>"Tag"===e.type,D.getPhoneNumberFromMri=e=>e&&D.isTFLSmsUnVerifiedMri(e)?e.slice(v.length):""},932315:(e,n,i)=>{"use strict";function a(e){const n=e.startsWith("?")||e.startsWith("#");e=n?e.substring(1):e;const i={};return e.split("&").forEach((e=>{const[n,a]=e.split("=");i[n]=decodeURIComponent((a||"").replace(/^.+?(=)/,""))})),i}i.d(n,{d:()=>a})},584613:(e,n,i)=>{"use strict";i.d(n,{LP:()=>p,kf:()=>N,Ji:()=>f,sR:()=>h,HM:()=>v});var a=i(622825),t=i(980860),r=i(191366),o=i(56056);const l=new RegExp("media.*\\.giphy\\.com$","i"),s=new RegExp([".*\\.asm\\.skype\\.com$",".*\\.asyncgw\\.teams\\.microsoft\\.com$",".*\\.ams\\.gcc\\.teams\\.microsoft\\.com$",".*\\.ams\\.gov\\.teams\\.microsoft\\.us$",".*\\.ams\\.dod\\.teams\\.microsoft\\.us$",".*\\.asyncgw\\.teams\\.microsoft\\.scloud$",".*\\.asyncgw\\.teams\\.eaglex\\.ic\\.gov$",".*\\.asyncgw\\.teams\\.microsoftonline\\.cn$","\\urlp\\.sfbassets\\.com$","statics\\.gov\\.teams\\.microsoft\\.us$","statics\\.dod\\.teams\\.microsoft\\.us$","statics\\.teams\\.microsoft\\.com$","statics\\.teams\\.cdn\\.office\\.net$","staticsint\\.teams\\.cdn\\.office\\.net$","statics-dev\\.teams\\.cdn\\.office\\.net$","statics\\.teams\\.cdn\\.live\\.net$","staticsint\\.teams\\.cdn\\.live\\.net$","statics-dev\\.teams\\.cdn\\.live\\.net$","statics-cn\\.teams\\.cdn\\.office\\.net$","statics\\.teams\\.eaglex\\.ic\\.gov$","statics\\.teams\\.microsoft\\.scloud$","media.*\\.giphy\\.com$","local\\.teams\\.(?:office|live)\\.com$"].join("|"),"i"),d=new RegExp([".*\\logout*"].join("|"),"i"),c=/^\/asm\/[a-z]+/i,m="/urlp/v1/url/content",u="/urlp/v1/url/image/Favicon",p=e=>`data:${k(e)};base64,${e}`,k=e=>{const n=(0,a.v)(e);let i;return i=255===n[0]&&216===n[1]?"image/jpg":137===n[0]&&80===n[1]&&78===n[2]&&71===n[3]?"image/png":71===n[0]&&73===n[1]&&70===n[2]?"image/gif":66===n[0]&&77===n[1]?"image/bmp":"image/unknown",i},g=e=>{const n=(0,r.J)().location.origin;if((0,t.nz)(e,n))return!0;const i=(0,t.Lp)(e).toLowerCase(),a=(0,t.DW)(e).toLowerCase();return s.test(i)||"teams.microsoft.com"===i&&c.test(a)},N=e=>g(e)&&(e=>{const n=(0,t.DW)(e).toLowerCase();return!d.test(n)})(e)||e.startsWith("data:image"),f=e=>{const n=(0,t.Lp)(e).toLowerCase();return l.test(n)};function h(e){return e.endsWith("/middletier/getGif/giphy.gif")}function v(e,n){try{const i=new URL(e);return g(e)&&!(0,o.$O)(e)&&!(0,t.nz)(e,n)&&(i.pathname===m||i.pathname===u)}catch(e){return!1}}},537677:(e,n,i)=>{"use strict";i.d(n,{KH:()=>a,lj:()=>t,O:()=>r,mY:()=>o,Tb:()=>l,gc:()=>s,QB:()=>d,z4:()=>c});const a=180,t=2,r=.5,o=10,l=48,s=62,d=20,c=250},42678:(e,n,i)=>{"use strict";i.d(n,{Bo:()=>a,tg:()=>r,Zn:()=>o,pY:()=>l});var a,t=i(537677);!function(e){e.ULTRA_WIDE="ultra-wide",e.SUPER_SMALL="super-small",e.THIN="thin",e.TALL="tall",e.STANDARD="standard",e.NONE="none"}(a||(a={}));const r=(e,n)=>{let i=e,a=n;return n>t.z4&&(i=t.z4*i/a,a=t.z4),{width:i,height:a}},o=(e,n)=>{if(n/e>=t.lj)return a.TALL;const i=n<t.KH;return e/n>=t.lj?i?a.THIN:a.ULTRA_WIDE:i?a.SUPER_SMALL:a.STANDARD},l=(e,n,i)=>{if(i===a.THIN||i===a.ULTRA_WIDE){const i=e/t.mY,a=n/t.mY;let r=a;if(i>t.gc||a>t.Tb){const e=2,n=t.KH/t.mY,o=t.gc/i,l=n/a;r=Number((a*Math.min(o,l)).toFixed(e))}return{"--calculatedWideImageHeight":`${r}rem`}}return{}}},56056:(e,n,i)=>{"use strict";i.d(n,{hA:()=>T,w2:()=>M,KD:()=>y,a:()=>S,$O:()=>A,jo:()=>I,Pg:()=>b,Q3:()=>C,fY:()=>E,DP:()=>w,Ky:()=>L,yf:()=>x});var a=i(980860);const t="asm.skype.com",r="api.ams.gcc.teams.microsoft.com",o="urlp.ams.gcc.teams.microsoft.com",l="api.ams.gov.teams.microsoft.us",s="api.ams.dod.teams.microsoft.us",d="api.asyncgw.teams.microsoft.scloud",c="api.asyncgw.teams.microsoftonline.cn",m="api.asyncgw.teams.eaglex.ic.gov",u="asyncgw.teams.microsoft.com",p="/v1/objects",k="/views/video",g="/ams",N="teams.microsoft.com",f=/^\/asm\/[a-z]+/i,h=/^\/asm\/[a-z]+\/v1\/objects/i,v=/v1\/objects\/([^/]{1,300})/i;var T,M;function y(e){if(e&&A(e)){const n=e.match(v);return n&&n[1]||""}return""}function S(e){const n=(0,a.Lp)(e).toLowerCase(),i=(0,a.DW)(e);return n.endsWith(t)||n===r||n===l||n===s||n===d||n===c||n===m||n===o||n.endsWith(u)||n===N&&f.test(i)}function A(e){if(w(e))return!0;const n=(0,a.DW)(e);return S(e)&&(n.startsWith(p)||h.test(n))}function I(e){if(!e)return!1;const n=(0,a.DW)(e);return!(!w(e)||!n.endsWith(k))||S(e)&&n.endsWith(k)}function b(e){return I(e)?M.Video:A(e)?M.Image:M.None}async function C(e){const n=e instanceof Blob?new Uint8Array(await(e.arrayBuffer?.())):e;if(!n||n.length<6)return!1;if(71!==n[0]||73!==n[1]||70!==n[2])return function(e){if(!e)return!1;let n=-1,i=-1;for(let a=0;a<e.length-4;a++)if(97===e[a]&&99===e[a+1]&&84===e[a+2]&&76===e[a+3]&&(i=a),73===e[a]&&68===e[a+1]&&65===e[a+2]&&84===e[a+3]){n=a;break}return i>=0&&n>i}(n);let i=0;for(let e=0;e<n.length-9&&!(D(n,e)&&(F(n,e+8)||U(n,e+8))&&(i++,i>1));e++);return i>1}function D(e,n){return 33===e[n]&&249===e[n+1]&&4===e[n+2]}function F(e,n){return 44===e[n]}function U(e,n){return 33===e[n]&&255===e[n+1]&&11===e[n+2]}function E(e,n){if(!e||!A(e)||!n||e.startsWith(n))return e;return[n,new URL(e).pathname.substring(1)].join("")}function w(e){return(0,a.DW)(e).toLowerCase().startsWith(g+p)}function L(e){return e>20971520}function x(e){if(!e||"image/*"===e)return"";const n=e.match(/^image\/([^*]+)$/);return n?n[1]:e}!function(e){e[e.IMAGE_SIZE_TOO_LARGE=10001]="IMAGE_SIZE_TOO_LARGE",e[e.UNSUPPORTED_IMAGE_FORMAT=10002]="UNSUPPORTED_IMAGE_FORMAT"}(T||(T={})),function(e){e.None="None",e.Image="Image",e.Video="Video"}(M||(M={}))},353513:(e,n,i)=>{"use strict";i.d(n,{P:()=>t});var a=i(455146);function t(e,n,i){try{return n.readFragment({id:`Call:${e}`,fragment:a.f,fragmentName:"callingFields"})||void 0}catch(e){i?.log("getCall - call not found in cache")}}},503720:(e,n,i)=>{"use strict";var a,t,r,o,l;i.d(n,{Eh:()=>a,kI:()=>t,RM:()=>r,Tk:()=>o,Qq:()=>l}),function(e){e.Attendee="attendee",e.Presenter="presenter",e.Organizer="organizer"}(a||(a={})),function(e){e.Interactive="interactive",e.NonInteractive="nonInteractive"}(t||(t={})),function(e){e.DeeplinkNonoffice="DeeplinkNonoffice",e.DeeplinkOffice="DeeplinkOffice",e.DeeplinkFileChiclet="DeeplinkFileChiclet",e.MeetingSidepanel="MeetingSidepanel",e.DocCollab="DocCollab",e.Annotation="Annotation"}(r||(r={})),function(e){e[e.Reconnecting=1e3]="Reconnecting",e[e.Transferring=1001]="Transferring",e[e.TransferFailed=1002]="TransferFailed",e[e.TransferSucceeded=1003]="TransferSucceeded",e[e.Escalating=1004]="Escalating",e[e.EscalationFailed=1005]="EscalationFailed",e[e.EscalationSucceeded=1006]="EscalationSucceeded",e[e.Parking=1007]="Parking",e[e.ParkSucceeded=1008]="ParkSucceeded",e[e.ParkFailed=1009]="ParkFailed",e[e.MusicOnHold=1010]="MusicOnHold",e[e.Aborted=1011]="Aborted"}(o||(o={})),function(e){e[e.CallSetupFailed=0]="CallSetupFailed",e[e.CallDropped=1]="CallDropped",e[e.Undefined=2]="Undefined"}(l||(l={}))},744058:(e,n,i)=>{"use strict";i.d(n,{aW:()=>d,Pd:()=>c,uL:()=>M,$o:()=>y,B4:()=>F,$Z:()=>U,r4:()=>E,Sz:()=>x,sz:()=>O});var a=i(662537),t=i(309501),r=i(811957),o=i(282050),l=i(803238);const s="The row was removed for this reason -";var d;!function(e){e.Default="default",e.Voicemail="voicemail",e.CallParkService="callParkService",e.OriginalEmergencyCallParticipant="originalEmergencyCallParticipant"}(d||(d={}));const c=({messages:e,callLogsBlacklistedMRIs:n,currentUserMri:i,logger:a,options:{enableRichCallHistoryExtension:t,enableSLACallHistory:r,enableSLACallHistoryFromPersonalHistory:o,currentTabDelegatorId:s,isLogMergedWithSharedCorrelationId:d,enableRecordingAndTranscribingInCallsAppV2:c},tableType:h,callQueueId:M,keepTranscriptMessages:y})=>{const A=r?e.filter((({callLog:e})=>e&&e.isSharedLineAppearanceCallHistory)):[],I=r?e.filter((({callLog:e})=>e&&e.isDeleted)):[],b=new Set(I.map((({callLog:e})=>e&&e.callId))),{logIds:C,accumulateFilteredCallIds:D}=(()=>{const e=new Map;return{accumulateFilteredCallIds:(n,i,a)=>{if(!n){const n=e.get(a)||[];n.push(i),e.set(a,n)}return n},logIds:n=>{for(const[i,a]of e){const e=(0,l.take)((0,l.chunk)(a,10),10),t=e.length;e.forEach(((e,a)=>{n.log(`reduceCallHistoryMessages(${a+1}/${t}) Ids[${i}]: ${e.join(",")}`)}))}}}})(),F=e.filter((e=>{if(e.callLog){const l={callLog:e.callLog,logger:a,tableType:h},d=e.callLog.callId;return D(!m(l),d,"isScreenSharingSession")&&D(!u(l,n),d,"isTargetBlacklisted")&&D(!p(l,b),d,"isCallHistoryDeleted")&&D(!k(l,i),d,"isGroupCallDeclinedByAllParticipants")&&D(T(l,M),d,"callQueueCallsFilter")&&D(!g(l),d,"isOutgoingCallWithNoTarget")&&D(!N(l),d,"isCallHistoryWithCallParkBot")&&D(!f(l,i,A,r,o,s),d,"slaCallHistoryFiltering")&&D(!v(l,i,t),d,"hideImmediateForwardingCallForForwarder")&&D(!L(U(e.callLog,M).isCallQueue,e.callLog),d,"isIncomingNotAcceptedCallQueueCall")}return!1}));a.log(`[reduceCallHistoryMessages] [tableType=${h}]`),C(a);return S({allValidMessages:F,enableRecordingAndTranscribingInCallsAppV2:!!c,logger:a,isLogMergedWithSharedCorrelationId:d,tableType:h,callQueueId:M,keepTranscriptMessages:y})},m=e=>{const{callLog:n}=e;return n.sessionType===a.FT.ScreenSharing},u=(e,n)=>{const{callLog:i}=e;return!!i.targetParticipant&&n.indexOf(i.targetParticipant.id)>-1},p=(e,n)=>{const{callLog:i}=e;return i.isDeleted||n.has(i.callId)},k=(e,n)=>{const{callLog:i}=e;if(!i.participantList)return!1;return!i.targetParticipant&&1===i.participantList.length&&i.participantList[0].id===n},g=e=>{const{callLog:n}=e;return n.callDirection===a.kw.Outgoing&&!n.targetParticipant&&!n.participantList?.length},N=e=>{const{callLog:n}=e,i=d.CallParkService.toString();return n.targetParticipant?.type===i},f=(e,n,i,a,t,r)=>{const{callLog:o,logger:l,tableType:d}=e,{isSharedLineAppearanceCallHistory:c,isSharedLineAppearanceActivated:m,targetDelegator:u,originatorDelegator:p}=o;if(!a&&c)return l.log(`[slaCallHistoryFiltering] [tableType=${d}] [callId=${o.callId}] ${s} it is an SLA call history from shared history and enableSLACallHistory is disabled`,o),!0;if(o.recordings?.length||o.transcript)return!1;const k=c||m&&t;if(r){const e=!k||!u&&!p||u&&u.id!==r||p&&p.id!==r;return e&&l.log(`[slaCallHistoryFiltering] [tableType=${d}] [callId=${o.callId}] ${s} it is an SLA call history that is not to be displayed on the current delegator's tab. [currentTabDelegatorId=${r}]`),e}{const e=!(!k||h(o)||!(u&&u.id!==n||p&&p.id!==n)),a=!(c||!i.find((e=>e.callLog?.callId===o.callId))),t=e||a;return t&&l.log(`[slaCallHistoryFiltering] [tableType=${d}] [callId=${o.callId}] ${s} it is an SLA call history that is not to be displayed on the personal tab. [isSlaCallHistoryForDelegatorTab=${e}] [isSlaCallHistoryDuplicateOnPersonalTab=${a}]`),t}},h=e=>{const{isIncoming:n,isSharedLineAppearanceActivated:i,isSharedLineAppearanceCallHistory:a,originatorDelegator:t}=e;return n&&i&&!a&&t},v=(e,n,i)=>{const{callLog:t}=e;return!i&&M(t,n)&&t.forwardingType===a.Io.Immediate},T=({callLog:{isCallQueue:e,isMissed:n,callType:i,applicationContent:a}},t)=>{const r=U({callType:i,applicationContent:a},t||void 0).isForCurrentCallQueue;return Boolean(!t||e&&r&&!n)},M=(e,n)=>{const{forwarderParticipant:i,forwardedTargetParticipant:a}=e;return!!(!i&&a||i&&i.id===n)},y=({callType:e,threadId:n,participantList:i})=>e===a.Bd.MultiParty&&(i&&i.length>1||!!n),S=({allValidMessages:e,enableRecordingAndTranscribingInCallsAppV2:n,logger:i,isLogMergedWithSharedCorrelationId:a,tableType:t,callQueueId:r,keepTranscriptMessages:o})=>{const l=A(e,!!n,i,t,o);return a&&I(t)?b(l,i,t,r):l},A=(e,n,i,a,r)=>{if(!n)return e.filter((e=>{const n=e.callLog.messageType!==t.Cs.CallTranscript&&e.callLog.messageType!==t.Cs.CallRecording&&e.callLog.messageType!==t.Cs.CallLogTranscript&&e.callLog.messageType!==t.Cs.CallLogRecording;return n||i.log(`[mergeMessagesWithRecordingsAndTranscript] [tableType=${a}] [callId=${e.callLog.callId}] ${s} it is a call tied to transcript/recording that is filtered because enableRecordingAndTranscribingInCallsAppV2 is disabled`),n}));const o=new Map,l=new Map,d=new Map;e.forEach((e=>{const{messageType:n,callId:i,userParticipantId:a,isSharedLineAppearanceCallHistory:r}=e.callLog;if(!e.callLog)return;const s=r?i:`${i}-${a}`;(n===t.Cs.CallTranscript||n===t.Cs.CallLogTranscript)&&d.set(s,e),(n===t.Cs.CallRecording||n===t.Cs.CallLogRecording)&&l.set(s,[...l.get(s)||[],e]),n===t.Cs.HTML&&o.set(s,e)}));const c=[];return o.forEach(((e,n)=>{const t=d.get(n);return t&&d.delete(n),c.push(D(e,i,a,t,l.get(n)))})),r&&d.forEach((e=>c.push(e))),c},I=e=>e===a.o8.CallsApp,b=(e,n,i,a)=>{const t=[],r=new Map;return e.forEach((e=>{if(!e.callLog)return void n.warn(`[mergeMessageWithSharedCorrelationId] Did not receive a call log property or invalid messageId [messageId=${e.id}]`);if(!e.callLog.sharedCorrelationId)return void t.push(e);if(e.callLog.targetParticipant&&e.callLog.targetParticipant.id.startsWith(o.V.Bot))return void(F(e.callLog.targetParticipant.id)?t.push(e):n.log(`[mergeMessageWithSharedCorrelationId] [tableType=${i}] [callId=${e.callLog.callId}] ${s} the target participant is a bot that isn't the VoiceApp bot`));const l=r.get(e.callLog.sharedCorrelationId),d=U(e.callLog,a).isCallQueue;if(!l)return void r.set(e.callLog.sharedCorrelationId,{callLog:e.callLog,id:e.callLog.messageId,isCq:d,duration:E(e.callLog)});n.log(`[mergeMessageWithSharedCorrelationId] [tableType=${i}] [callId=${e.callLog.callId}] ${s} This call history row was merged into another because they share the same correlation id [sharedCorrelationId=${e.callLog.sharedCorrelationId}]`);const c=d===l.callLog.startTime<e.callLog.startTime?e.callLog:l.callLog,m=d?E(c):E(e.callLog)+l.duration,u=`${l.id}_${e.callLog.messageId}`;r.set(e.callLog.sharedCorrelationId,{callLog:c,id:u,isCq:d,duration:m})})),r.forEach((({isCq:e,id:n,callLog:i,duration:a})=>{let r=i;e||(r=i.cloneWithConnectAndEndTime?i.cloneWithConnectAndEndTime({...C(i.startTime,a),messageId:n}):{...i,...C(i.startTime,a),messageId:n}),t.push({callLog:r,id:n})})),t},C=(e,n)=>{const i=new Date(e);return{connectTime:e,endTime:new Date(i.valueOf()+n).toISOString()}},D=(e,n,i,a,t)=>{let r={...e};const o=(e=>{const n=[];return e&&e.forEach((e=>{e.callLog?.recordings?.length&&n.push(e.callLog.recordings[0])})),n})(t),l=a?.callLog?.transcript;return(l||o.length)&&(r.callLog.cloneWithTranscriptAndRecording?r.callLog=r.callLog.cloneWithTranscriptAndRecording({callId:r.callLog.callId,userParticipantId:r.callLog.userParticipantId,transcript:l,recordings:o}):r={...e,callLog:{...e.callLog,transcript:l,recordings:o}}),(r.callLog.transcript||r.callLog.recordings.length)&&n.log(`[toCallHistoryRows] [tableType=${i}] ${r.callLog.transcript?"1 transcript row & ":""} ${r.callLog.recordings?.length?`${r.callLog.recordings?.length} recording row(s)`:""} were merged into this row`,r.callLog),r},F=e=>!!e&&(0,r.B4)(e,t.f0),U=({callType:e,applicationContent:n},i)=>{const t={isCallQueue:!1,isForCurrentCallQueue:!1,callQueueType:null};if(n?.type===a.G_.HuntGroup){switch(e){case a.Bd.TwoParty:t.callQueueType=a.Fk.transfer;break;case a.Bd.MultiParty:t.callQueueType=a.Fk.conference}t.isCallQueue=void 0!==t.callQueueType,t.isForCurrentCallQueue=w(i,n.configId)}else n?.type===a.G_.CallableChannelOboCall&&(t.isCallQueue=!0,t.isForCurrentCallQueue=w(i,n.configId));return t},E=({endTime:e,connectTime:n,targetParticipant:i})=>{let a=0;if(n&&e&&i?.type!==d.Voicemail.toString()){const i=new Date(e),t=new Date(n);a+=Math.round(i.getTime()-t.getTime())}return a},w=(e,n)=>!!e&&!!n&&e===n,L=(e,n)=>e&&n.callDirection===a.kw.Incoming&&n.callState!==a.Qv.Accepted,x=e=>{let n;return n="string"!=typeof e?"":e.includes(";ext=")?e:e.split(";")[0],n},O=(e,n,i,t)=>{const r=a.o8.CallsApp===n&&!t,o=e?.userDelegates.delegates,l=o&&o.length>0,s=Boolean(i&&l&&r),d=e?.userDelegators.delegators,c=d&&d.length>0;return{userIsADelegatorOnPersonalTab:s,userIsADelegateOnPersonalTab:Boolean(i&&c&&r&&!s),userIsOnDelegatorTab:Boolean(i&&t)}}},662537:(e,n,i)=>{"use strict";i.d(n,{FT:()=>a,Bd:()=>t,Qv:()=>r,kw:()=>o,hy:()=>l,Io:()=>s,Ry:()=>d,Fk:()=>c,LW:()=>m,o8:()=>u,G_:()=>p});const a={Default:"Default",ScreenSharing:"ScreenSharing",EmergencyGroupCall:"EmergencyGroupCall",Unknown:"Unknown"},t={MultiParty:"MultiParty",TwoParty:"TwoParty",Unknown:"Unknown"},r={Accepted:"Accepted",AcceptedElsewhere:"AcceptedElsewhere",Declined:"Declined",Missed:"Missed",Unknown:"Unknown"},o={Outgoing:"Outgoing",Incoming:"Incoming",Unknown:"Unknown"},l={Transferred:"Transferred",TransferAccepted:"TransferAccepted",TransferFailed:"TransferFailed",TransferSucceeded:"TransferSucceeded",Unknown:"Unknown"},s={Immediate:"Immediate",Simultaneous:"Simultaneous",Unanswered:"Unanswered"},d={Voicemail:"Voicemail",SingleTarget:"SingleTarget",MyDelegates:"MyDelegates",DoNothing:"DoNothing",Group:"Group"};var c;!function(e){e.transfer="transfer",e.conference="conference"}(c||(c={}));const m={Hold:"Hold",Resume:"Resume",Barge:"Barge"},u={CallsApp:"CallsApp",CallableChannel:"CallableChannel",QueuesApp:"QueuesApp"};var p;!function(e){e.HuntGroup="HuntGroup",e.CallableChannelOboCall="CallableChannelOboCall"}(p||(p={}))},340307:(e,n,i)=>{"use strict";i.d(n,{h:()=>t});var a=i(803238);class t{constructor(){this._card={type:"AdaptiveCard",version:"1.5",body:[{type:"Container",items:[]}],actions:[]}}addLabel(e){return this.addElement({type:"TextBlock",text:e,weight:"bolder"}),this}addTextBlock(e){return this.addElement({type:"TextBlock",text:e}),this}addTextInput(e,n,i,a,t,r){return this.addElement({type:"Input.Text",id:e,placeholder:n,value:i,maxLength:a,isMultiline:t,label:r?.label,isRequired:r?.isRequired,errorMessage:r?.errorMessage}),this}addNumberInput(e,n,i,a){return this.addElement({type:"Input.Number",id:e,placeholder:n,value:i,label:a?.label,isRequired:a?.isRequired,errorMessage:a?.errorMessage}),this}addDateInput(e,n,i,a){return this.addElement({type:"Input.Date",id:e,placeholder:n,value:i,label:a?.label,isRequired:a?.isRequired,errorMessage:a?.errorMessage}),this}addTimeInput(e,n,i,a){return this.addElement({type:"Input.Time",id:e,placeholder:n,value:i,label:a?.label,isRequired:a?.isRequired,errorMessage:a?.errorMessage}),this}addToggle(e,n,i,a){return this.addElement({type:"Input.Toggle",id:e,title:n,value:i,isRequired:a?.isRequired,errorMessage:a?.errorMessage}),this}addChoiceSet(e,n,i,a,t,r,o){return this.addElement({type:"Input.ChoiceSet",id:e,title:n,isMultiSelect:i,style:a?"compact":"expanded",choices:t,value:r,label:o?.label,isRequired:o?.isRequired,errorMessage:o?.errorMessage}),this}addImageSet(e,n){return this.addElement({type:"ImageSet",id:e,images:n}),this}addSubmitAction(e,n,i,a){return this._card.actions&&this._card.actions.push({id:e,type:"Action.Submit",title:n,data:i,style:a?.style}),this}addSpeak(e){return this._card.speak=e,this}getCard(){return{content:JSON.stringify(this._card),contentType:"application/vnd.microsoft.card.adaptive"}}getRawJson(){return(0,a.cloneDeep)(this._card)}addElement(e){this._card.body&&this._card.body[0].items.push(e)}}},553586:(e,n,i)=>{"use strict";var a;i.d(n,{s:()=>a}),function(e){e.Adaptive="application/vnd.microsoft.card.adaptive",e.AnnouncementHeader="application/vnd.microsoft.teams.messaging-announcementBanner",e.Audio="application/vnd.microsoft.card.audio",e.CodeSnippet="application/vnd.microsoft.card.codesnippet",e.FileConsent="application/vnd.microsoft.teams.card.file.consent",e.Hero="application/vnd.microsoft.card.hero",e.Keyboard="application.vnd.microsoft.keyboard",e.List="application/vnd.microsoft.teams.card.list",e.O365connector="application/vnd.microsoft.teams.card.o365connector",e.O365connectorAlias="application/vnd.microsoft.card.o365connector",e.Profile="application/vnd.microsoft.teams.card.profile",e.Receipt="application/vnd.microsoft.card.receipt",e.Signin="application/vnd.microsoft.card.signin",e.Thumbnail="application/vnd.microsoft.card.thumbnail"}(a||(a={}))},622825:(e,n,i)=>{"use strict";function a(e){if(!e)return new Uint8Array(0);return t(e.split(",")[1])}function t(e){const n=atob(e),i=new Uint8Array(n.length);for(let e=0;e<n.length;e++)i[e]=n.charCodeAt(e);return i}i.d(n,{H:()=>a,v:()=>t})},516862:(e,n,i)=>{"use strict";function a(e,n){let i="",a="",t=!1;for(let r=0;r<e.length;r++)if("<"!==e[r])if(t){if(">"===e[r]){t=!1,a="";continue}i+=e[r]}else a+=e[r];else{if("/"===e[r+1]){if(a){const e=n[i];e&&e(a),a=""}do{r++}while(">"!==e[r]);continue}i="",t=!0}}i.d(n,{w:()=>a})},256676:(e,n,i)=>{"use strict";i.d(n,{Uw:()=>r,XC:()=>o,n:()=>l,LQ:()=>d,u4:()=>c});var a=i(803238),t=i(702135);function r(e,n,i){return e=s(e,n,i=i||o),1===n.length&&"object"==typeof n[0]&&(e=s(e,n[0],i)),e}function o(e){if(null===e)return"null";if(void 0===e)return"undefined";const n=typeof e;if("string"===n)return e;if("number"===n||"boolean"===n)return String(e);if("function"===n)return"";if((0,a.isDate)(e))return e.toISOString();try{return JSON.stringify(e)}catch(n){return c(e)}}function l(e,n){let i=`[errorType=${typeof e}]`;return i+=e?"object"==typeof e?`[errorName=${e.name}][errorMessage=${e.message}][errorStack=${e.stack}]`:`[error=${e.toString()}]`:`[error=Undefined ${n} Error]`,(0,t._S)(i)}function s(e,n,i){for(const a in n)n.hasOwnProperty(a)&&(e=e.replace(`{${a}}`,i(n[a])));return d(e)}function d(e){return null==e||0===e.length?e:` ${e}`.substr(1)}function c(e,n){const i=new WeakSet;return JSON.stringify(e,((e,n)=>{if(!i.has(n)){if(n&&"object"==typeof n){if(i.add(n),n instanceof Map||n instanceof Set)return Array.from(n);if(n instanceof Error)return`${n.name}: ${n.message}`;if(n.constructor&&n.constructor!==Object&&n.constructor!==Array||n.prototype)return}return n}}),n)}},871471:(e,n,i)=>{"use strict";i.d(n,{D:()=>a});const a=(e,n={},i)=>{let a;try{if(void 0===e)throw new Error('"undefined" is not valid JSON');a=JSON.parse(e)}catch(e){a=n,i?.(e)}return a}},852793:(e,n,i)=>{"use strict";function a(){return(...e)=>e}i.d(n,{j:()=>a})},445151:(e,n,i)=>{"use strict";i.d(n,{n:()=>a});const a={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,capsLock:20,escape:27,space:32,pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,zero:48,a:65,c:67,v:68,command:91,contextMenu:93,number0:48,number9:57,numpad0:96,numpad9:105,numpadAdd:107,numpadSubtract:109,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,semicolon:186,equal:187,hyphen:189,forwardslash:191}},282050:(e,n,i)=>{"use strict";var a;i.d(n,{V:()=>a}),function(e){e.User="8:orgid:",e.Pstn="4:",e.Bot="28:",e.GcchUser="8:gcch:",e.DodUser="8:dod:",e.AcsUser="8:acs:",e.PstnExtension=";ext="}(a||(a={}))},665641:(e,n,i)=>{"use strict";i.d(n,{Fd:()=>o,YN:()=>s,s3:()=>d,HC:()=>c,wm:()=>m,LY:()=>u,UO:()=>p,vW:()=>k,Bj:()=>g});var a=i(803238),t=i(12978),r=i(309501);function o(e,n){try{const i=l(e);if("https://local.teams.office.com"===new URL(e).origin)return!0;for(const e of(0,a.uniqBy)(n,(e=>e.toLowerCase()))){let n="";const a=e.split(".");for(let e=0;e<a.length;e++)n+=(e>0?"[.]":"")+a[e].replace("*","[^/^.]+");const t=new RegExp(`^https://${n}((/|\\?).*)?$`,"i");if(i.match(t))return!0}}catch{return!1}return!1}const l=e=>new URL(e).href,s=e=>e.replace(/;messageid=.*/,""),d=(e,n,i)=>{let a="";if(!e.id||m(e.id))return a;switch(e.type){case t.py.extensions:try{a=JSON.parse(e.id).threadId||i}catch(n){a=e.id||i||""}break;case t.py.chats:a=e.id.replace("replyChainId","messageid");break;case t.py.communities:case t.py.channels:let r;try{r=JSON.parse(e.id).channelId}catch{r=e.id}a=n?`${r};messageid=${n}`:r;break;case t.py.shareformdialog:break;case t.py.meetingcollaboration:default:a=e.id}return a},c=e=>e&&e.replace(new RegExp(`^${r.at.BotPrefix}`),""),m=e=>"newchat"===e||e?.includes("preview"),u=(e,n=r.Cs.Call)=>n===r.Cs.Call&&/<partlist/.test(e)&&!g(e,n),p=(e,n)=>!!k(e,n)&&g(e),k=(e,n)=>n===r.Cs.Call&&e.includes('<conversationType>"huddleGroupCall"</conversationType>'),g=(e,n=r.Cs.Call)=>n===r.Cs.Call&&(-1!==e.indexOf("<ended/>")||/^<partlist[^>]*type="ended"/.test(e))},997342:(e,n,i)=>{"use strict";i.d(n,{un:()=>d,jg:()=>N,xi:()=>f,PN:()=>h,iE:()=>M});var a=i(803238),t=i(282050),r=i(176082),o=i(683184),l=i(882066),s=i(23279);const d=(e,n,i,a)=>{let t={normalized:e,diallable:e,display:e};const{logger:r,userLocale:o,isDialPlansEnabled:s,allowNonE164Mri:d,phoneNumberUtil:m,phoneNumberFormat:k}=i;if(!m||!k)return r.warn(`[formatPhoneNumber] Invalid config: isPhoneNumberUtilDefined=${!!m}, isPhoneNumberFormatDefined=${!!k}`),t;if(!e)return r.warn(`[formatPhoneNumber] No phone number provided from: ${n}`),t;if(r.log(`[formatPhoneNumber] Received phoneNumber: ${e} from: ${n}`),!a){const n=(0,l.bR)(e),a=c(n,i);if(r.log("[formatPhoneNumber] cleaned_formatting"),s){if(t=v(a,i),r.log(`[formatPhoneNumber] isInternalExtension? ${t.isInternalExtension}`),t.isInternalExtension)return t}else r.log("[formatPhoneNumber] Dialplan not enabled, not applying normalization rules"),t.normalized=a;d||(t.normalized=u(t.normalized,k.E164,i,!0),r.log("[formatPhoneNumber] NonE164 mri are not allowed"))}t={...t,...p(t.normalized,i)};try{const e=m.getInstance().parseAndKeepRawInput(t.normalized,o);t.display=m.getInstance().formatInOriginalFormat(e,k.INTERNATIONAL),t.isValid=m.getInstance().isPossibleNumber(e)&&m.getInstance().isValidNumber(e)}catch(e){r.error(`[formatPhoneNumber] ${e}`),t.display=t.normalized,t.isValid=!1}return r.log(`[formatPhoneNumber] isValid? ${t.isValid}`),t},c=(e,n)=>{if(!n.phoneNumberUtil)return n.logger.warn(`[convertPhoneNumberToAlpha] Invalid config: isPhoneNumberUtilDefined=${!!n.phoneNumberUtil}`),e;const i=m(e,n),a=e.substring(i.length);return n.phoneNumberUtil.convertAlphaCharactersInNumber(i)+a},m=(e,n)=>{if(!n.phoneNumberUtil)return n.logger.warn(`[getPhoneNumberWithoutExtension] Invalid config: isPhoneNumberUtilDefined=${!!n.phoneNumberUtil}`),e;const i=n.phoneNumberUtil.EXTN_PATTERN_,a=e.search(i);return a>=0?e.substring(0,a):e},u=(e,n,i,a,t)=>{const{userLocale:r,logger:o,phoneNumberUtil:l,phoneNumberFormat:s}=i;if(!l||!s)return o.warn(`[parseAndFormatNumber] Invalid config: isPhoneNumberUtilDefined=${!!l}, isPhoneNumberFormatDefined=${!!s}`),e;const d=n||s.INTERNATIONAL,c=h(e,i,"parseAndFormatNumber");if(!f(c,i,t))return c;try{if(a){const e=l.getInstance().parse(c,r);return l.getInstance().format(e,d)}{const e=l.getInstance().parseAndKeepRawInput(c,r);return l.getInstance().formatInOriginalFormat(e,d)}}catch(e){return o.error("[parseAndFormatNumber] Failed to parse and format a phone number",e),c}},p=(e,n)=>{const{enableFormattingFixForExtension:i}=n;return{diallable:m(e,n),extension:i?g(e,n):k(e,n)}},k=(e,n)=>{const i=h(e,n,"getExtension");return g(i,n)},g=(e,n)=>{const{enablePstnWithExtnFix:i,enableFixForDtmfTone:a,logger:t,userLocale:r,phoneNumberUtil:o}=n;if(!o)return t.warn(`[getExtensionFromNormalizedNumber] Invalid config: isPhoneNumberUtilDefined=${!!o}`),"";if(!i&&!a&&!f(e,n))return t.warn(`[getExtension] Received an invalid phone number: ${e}`),"";try{return o.getInstance().parse(e,r).getExtension()||""}catch(e){return t.error("Failed to parse and format a phone number",e),""}},N=(e,n,i,a)=>{const{logger:r}=n;let o=`${t.V.Pstn}${e}`;return i&&(o+=`${t.V.PstnExtension}${i}`),r.log(`[generateMriForPstn] context: ${a} Generated MRI: ${o} for dialOutNumber: ${e} ${i?`and extension: ${i}`:""}`),o},f=(e,n,i)=>{const{userLocale:a,logger:t,phoneNumberUtil:r}=n;if(!r)return t.warn(`[isStandardFormatNormalized] Invalid config: isPhoneNumberUtilDefined=${!!r}`),!1;if(!e)return!1;try{const t=h(e,n,"isStandardFormatNormalized"),o=r.getInstance().parse(t,a),l=r.getInstance().isPossibleNumber(o);return i?l:l&&r.getInstance().isValidNumber(o)}catch(e){return t.error("[isStandardFormatNormalized] error:",e),!1}},h=(e,n,i)=>{const{isDialPlansEnabled:a,logger:t}=n;t.log(`[normalizePstnNumber] Received phoneNumber: ${e} from: ${i}`);const r=(0,l.bR)(e);return a?v(r,n).normalized:r},v=(e,n)=>{const{normalizationRules:i,logger:a,coreSettings:t,ituCountryPrefix:o}=n,l={normalized:e,diallable:e,display:e};if(!i.length)return l;const s=new r.E(i,o,a,t).normalize(e);return l.normalized=s.phoneNumber,l.diallable=s?.phoneNumber,l.display=s?.phoneNumber,l.isInternalExtension=s?.isInternalExtension,l.isValid=s.isNormalized,l},T=(e,n,i,t,r)=>{let o;if(!(0,a.isEmpty)(e)){const n=t?.getInstance().getRegionCodeForCountryCode(Number(e));if(n)return o=n.toLowerCase(),i.log(`Setting locale based on dial plan to ${o}`),o}const l=r?.()||n||"en-US";return l?(o=l.substring(l.indexOf("-")+1).toLowerCase(),i.log(`Setting locale based on teams locale to ${o}`),o):(i.warn("localizationService failed to get locale. Falling back to 'us' locale"),"us")},M=async(e,n,a,t)=>{const r=e.get(o.J.Calling);let l;try{l=await(async(e,n)=>{let a;try{const t=()=>i.e(29311).then(i.t.bind(i,424766,23));a=await(0,s.mT)(t,"libphonenumber-bundle",n),e.log("[getLibPhoneNumber] Loaded @microsoft/google-libphonenumber.")}catch(n){return e.errorToTelemetry?.(`[getLibPhoneNumber] Failed to load @microsoft/google-libphonenumber. Name: ${n?.name}, Message: ${n?.message}`,"utilities_normalization_getlibphonenumber",void 0,!0),Promise.reject(`Failed to load @microsoft/google-libphonenumber : ${n?.message}`)}return a})(a,t)}catch(e){return a.error(`[getConfig] Failed to load @microsoft/google-libphonenumber. ${e}`),Promise.reject({error:"Failed to load @microsoft/google-libphonenumber",message:e})}return{allowNonE164Mri:!!r.allowNonE164Mri,isDialPlansEnabled:!!r.enableDialPlans,enablePstnWithExtnFix:!!r.enablePstnWithExtnFix,normalizationRules:r.dialPlanPolicy?.normalizationRules||[],ituCountryPrefix:r.dialPlanPolicy?.ituCountryPrefix||"",enableFormattingFixForExtension:!!r.enableFormattingFixForExtension,userLocale:T(r.dialPlanPolicy?.ituCountryPrefix||"",n,a,l.PhoneNumberUtil),enableFixForDtmfTone:!!r.enableFixForDtmfTone,logger:a,phoneNumberUtil:l.PhoneNumberUtil,phoneNumberFormat:l.PhoneNumberFormat,coreSettings:e}}},176082:(e,n,i)=>{"use strict";i.d(n,{E:()=>r});var a=i(683184),t=i(882066);class r{constructor(e,n,i,a){this.iTUCountryPrefix=n,this.logger=i,this.coreSettings=a,this.invalidRules=[],this.normalizeRules=[],this.setRules(e)}normalize(e){let n=r.removeFormatCharacters(e);n=r.removeGuid(n);const i=this.coreSettings?.get(a.J.Calling);if(this.logger?.log(`[normalize] Feature flag: stopNormalizationOnPlus=${i?.stopNormalizationOnPlus}`),i?.stopNormalizationOnPlus&&n.startsWith("+"))return this.logger?.log(`[normalize] ${e} starts with plus. Stopping normalization.`),{phoneNumber:n,isNormalized:!0};let o=1;for(const i of this.normalizeRules){const{pattern:a,translation:t,isInternalExtension:r}=i;if(a.test(n)){const i=n.replace(a,t);return this.logger?.log(`[normalize] [${e}] was normalized into [${i}] using rule ${o} of ${this.normalizeRules.length}: ruleExpression=[${a}] translation=[${t}] isInternalExtension=[${r}].`),{phoneNumber:i,isInternalExtension:r,isNormalized:!0}}o++}if(this.logger?.log(`[normalize] No normalization rule matched. [addCountryCodeDuringNormalization=${i?.addCountryCodeDuringNormalization}].`),i?.addCountryCodeDuringNormalization&&!n.startsWith("+")&&(0,t.TE)(n)){const a=this.iTUCountryPrefix||i.dialPlanPolicy?.ituCountryPrefix,t=a?`+${a}`:"",r=`${t}${n}`;return this.logger?.log(`[normalize] [${e}] was normalized into [${r}] by adding country code [${t}].`),{phoneNumber:r,isNormalized:!!t}}return{phoneNumber:n}}getInvalidRules(){return this.invalidRules}getITUCountryPrefix(){return this.iTUCountryPrefix}static removeFormatCharacters(e){return e.replace(/[\s\(\)\-_\/]+/g,"")}static removeGuid(e){return e.replace(/_([a-z]+\d+|\d+[a-z]+)[a-z\d]*$/gi,"")}setRules(e){if(e)for(const n of e)try{this.normalizeRules.push({pattern:new RegExp(n.pattern),translation:n.translation,isInternalExtension:n.isInternalExtension})}catch(e){this.invalidRules.push(n.pattern)}}}},882066:(e,n,i)=>{"use strict";i.d(n,{EG:()=>t,em:()=>r,of:()=>d,_7:()=>c,Ol:()=>m,DI:()=>u,gx:()=>p,bR:()=>k,TE:()=>g});var a=i(282050);const t=e=>Boolean(e&&e.startsWith(a.V.Pstn)),r=e=>!(!e||!e.startsWith(a.V.AcsUser)),o=/4:[^-_]*-[^-_]*-[^-_]*-[^-_]*-.*/,l=/^\+?\d*[ ]*(\([ ]*\d+[ ]*\))?[0-9 -]+((?:;ext=([0-9]{1,7})|[ \t,]*(?:e?xt(?:ensi(?:o?|))?n?|??|[,x#~]|int|anexo|)[:\.]?[ \t,-]*([0-9]{1,7})#?|[- ]+([0-9]{1,5})#))?$/i,s=e=>e.indexOf("_"),d=e=>{if(!t(e))return!1;const n=e.slice(a.V.Pstn.length);return-1!==s(n)},c=(e,n)=>o.test(e)&&n,m=e=>{let n=e.slice(a.V.Pstn.length);const i=s(n);return-1!==i&&(n=n.slice(0,i)),n},u=e=>e?`4:${e.replace(/-/g,"").replace(/\s/g,"")}`:"",p=e=>e.replace(/_([a-z]+\d+|\d+[a-z]+)[a-z\d]*$/gi,""),k=e=>{const n=(e=>e.replace(/[ \(\)\-_\/]+/g,""))(p(e));return n},g=e=>l.test(e?.trim())},873644:(e,n,i)=>{"use strict";function a(e=1){const n=new Uint32Array(e),a=i.g;if(a.msCrypto)a.msCrypto.getRandomValues(n);else if(a.crypto)a.crypto.getRandomValues(n);else{let i=e;for(;i--;){const e=4294967296;n[i]=Math.floor(Math.random()*e)}}return Array.from(n)}function t(e){return 0===(n=1/e,Math.floor(Math.random()*n));var n}i.d(n,{MX:()=>a,uE:()=>t})},832579:(e,n,i)=>{"use strict";i.d(n,{hN:()=>a,jE:()=>r,mo:()=>c,PI:()=>m,Xn:()=>u,BN:()=>g,ye:()=>f,Np:()=>h,mW:()=>v,Qz:()=>T,zG:()=>M,cE:()=>y,MV:()=>S,Wg:()=>A,_Y:()=>I,cI:()=>C,t_:()=>D,gC:()=>E});var a,t,r,o=i(309501),l=i(811957),s=i(803238),d=i(602129);!function(e){e.TeamsOnly="TeamsOnly",e.SfBOnly="SfBOnly",e.SfBWithTeamsCollab="SfBWithTeamsCollab",e.SfBWithTeamsCollabAndMeetings="SfBWithTeamsCollabAndMeetings",e.Islands="Islands",e.IslandsWithTempInterop="IslandsWithTempInterop",e.IslandsWithVoipDeepLinking="IslandsWithVoipDeepLinking"}(a||(a={})),function(e){e[e.Islands=1]="Islands",e[e.IslandsWithTempInterop=2]="IslandsWithTempInterop",e[e.IslandsWithVoipDeepLinking=3]="IslandsWithVoipDeepLinking",e[e.SfBOnly=4]="SfBOnly",e[e.SfBWithTeamsCollab=5]="SfBWithTeamsCollab",e[e.SfBWithTeamsCollabAndMeetings=6]="SfBWithTeamsCollabAndMeetings",e[e.TeamsOnly=7]="TeamsOnly",e[e.Legacy=8]="Legacy"}(t||(t={})),function(e){e[e.Teams=0]="Teams",e[e.SfB=1]="SfB",e[e.Federated=2]="Federated",e[e.NativeFederated=3]="NativeFederated"}(r||(r={}));const c=e=>!!(e&&e.coExistenceMode&&a[e.coExistenceMode]),m=e=>!(e!==a.TeamsOnly),u=e=>!(-1===[a.Islands,a.IslandsWithTempInterop,a.IslandsWithVoipDeepLinking].indexOf(e)),p=e=>!(-1===[a.SfBOnly,a.SfBWithTeamsCollab,a.SfBWithTeamsCollabAndMeetings].indexOf(e)),k=(e,n,i=!1)=>{const a=[o.Jq,o.Dr,o.iO,o.TO,o.pk,o.P_,o.ng,o.Fp,o.cz,o.Mt,o.Md],t=e.split(":");return a.some((e=>{const a=t.findIndex((n=>n===e.slice(0,-1)));return a>=0&&(i?t.splice(a+1,1):t.splice(a+1,0,n.slice(0,-1)),!0)})),t.join(":")},g=e=>!!e&&(0,s.startsWith)(e,o.at.SkypeSpacesUser+o.pW),N=e=>!!e&&e.includes(o.pW)&&!(0,s.startsWith)(e,o.at.SkypeSpacesUser+o.pW),f=e=>!!e&&(0,s.startsWith)(e,o.d7+o.pW),h=e=>!e||N(e)?e:e.includes(o.at.SkypeSpacesUser)?k(e,o.pW):void 0,v=e=>!!e&&!(0,s.startsWith)(o.at.SkypeSpacesUser+o.m_,e)&&e.includes(o.m_),T=e=>!!e&&!(0,s.startsWith)(o.at.SkypeSpacesUser+o.U0,e)&&e.includes(`:${o.U0}`),M=e=>!e||T(e)?e:e.includes(o.at.SkypeSpacesUser)?k(e,o.U0):void 0,y=e=>!e||v(e)?e:e.includes(o.at.SkypeSpacesUser)?k(e,o.m_):void 0,S=e=>!e||(e=>!!e&&!e.startsWith(o.at.SkypeSpacesUser+o.fe)&&e.includes(o.fe))(e)?e:e.includes(o.at.SkypeSpacesUser)?k(e,o.fe):void 0,A=e=>{if(e){if(N(e))return k(e,o.pW,!0);if(v(e))return k(e,o.m_,!0)}return e},I=e=>e?T(e)?k(e,o.U0,!0):void 0:e,b={isAllowed:!1},C=(e,n,i,a,t,r,o,l)=>{const s=o&&o.coExistenceMode,d=r&&r.coExistenceMode;if(!s||!d)return{isAllowed:!0};if(a){const a=((e,n,i,a,t,r,o)=>{const l=o.newLogger("sfb-interop","services-utilities-sfb-interop");return r.isFederated?!a&&i?(l.log("Chat Disabled: current user is not provisioned on Sfb online"),b):r.coExistenceMode&&t.coExistenceMode?e&&i&&m(t.coExistenceMode)&&m(r.coExistenceMode)?{isAllowed:!1,mri:y(r.mri||"")}:i||n||!u(t.coExistenceMode)&&!u(r.coExistenceMode)?!i&&p(r.coExistenceMode)?{isAllowed:!1,toInterop:!0,mri:r.mri||""}:{isAllowed:!0}:{isAllowed:!1,toInterop:!0,mri:r.mri}:(l.log("Chat Enabled: TeamsUpgradePolicy is not defined for both users"),{isAllowed:!0}):(l.log("Federated Chat Disabled: recipient user is not federated"),(e=>({isAllowed:!1,toInterop:!1,mri:e.mri}))(r))})(e,n,i,t,r,o,l);if(!a.isAllowed)return a}else{const e=((e,n)=>n.coExistenceMode?e&&m(n.coExistenceMode)?{isAllowed:!1,mri:A(n.mri||"")}:!e&&p(n.coExistenceMode)?{isAllowed:!1,mri:h(n.mri||""),toInterop:!0}:{isAllowed:!0}:{isAllowed:!0})(i,o);if(!e.isAllowed)return e}return{isAllowed:!0}},D=e=>{const n=v(e);return F(e)||N(e)||n?(i=e)&&((0,s.startsWith)(i,o.at.SkypeSpacesUser+o.ng)||(0,s.startsWith)(i,o.at.SkypeSpacesUser+o.Fp)||(0,s.startsWith)(i,o.at.SkypeSpacesUser+o.cz)||(0,s.startsWith)(i,o.at.SkypeSpacesUser+o.Mt)||(0,s.startsWith)(i,o.at.SkypeSpacesUser+o.Md))?e:n?e.replace(o.m_,""):e.replace(o.pW,"").replace(o.zt,""):e;var i},F=e=>!!e&&!(0,s.startsWith)(o.at.SkypeSpacesUser+o.zt,e)&&e.includes(o.zt),U=(e,n,i,a)=>{const r=e.isFederated,o=(l=e.mri||"",(0,s.endsWith)(l,"@sfbonprem.unq.gbl.spaces"));var l;if(n&&r&&!o&&e.coExistenceMode){const n=t[e.coExistenceMode],r=i===t.TeamsOnly&&n===t.TeamsOnly;return r||a.log(`isNativeFederationMode is false - currentUserMessagingPolicyMode:${t[i]} recipientCoexistenceMode:${t[n]}`),r}return a.log(`isNativeFederationMode is false - enableNativeP2PFederatedChats:${n} isFederated:${r} isOnPremFederated:${o} coExistenceMode:${e.coExistenceMode}`),!1},E=(e,n,i,a,o,s)=>{if(!(e&&e.mri&&e.userType!==d.vf.guest&&e.type!==d.vf.skypeConsumer&&e.type!==d.vf.tflUser&&(0,l.eZ)(e.mri)))return i.log("getUserChatMode - Defaulting to teams chat mode as user profile is undefined or Guest or TFL user or is not a real user mri"),r.Teams;if(e.isFederated)return i.log(`getUserChatMode - federated user - mri: ${e.mri}, coExistenceMode: ${e.coExistenceMode}`),U(e,o,s,i)?r.NativeFederated:r.Federated;const c=((e,n,i)=>{const a=e.coExistenceMode,o=t[a];if(i.log(`getCoexistenceChatMode - caller: ${n}, mri: ${e.mri}, isShortProfile: ${e.isShortProfile}, coExistenceMode: ${t[o]}, MT coExistenceMode: ${a}`),t[o]!==a&&i.error(`getUserChatMode - Mapping error - coExistenceMode : ${t[o]}, MT coExistenceMode: ${a}`),o){const e=[t.SfBOnly,t.SfBWithTeamsCollab,t.SfBWithTeamsCollabAndMeetings],n=[t.TeamsOnly,t.Islands,t.IslandsWithVoipDeepLinking];if(e.includes(o))return r.SfB;if(n.includes(o))return r.Teams;i.warn(`getUserChatMode - unknown coExistenceMode ${t[o]}`)}else e.isShortProfile||i.warn(`getUserChatMode - full profile has no coExistenceMode for mri ${e.mri}`)})(e,n,i);if(c)return c;const m=g(e.mri),u=e.isSkypeTeamsUser,p=(e=>!(!e.isFederated&&void 0!==e.isPrivateChatEnabled)||e.isPrivateChatEnabled)(e);return i.log(`getUserChatMode - caller: ${n}, mri: ${e.mri}, isSfbMri: ${m}, isTeamsChatEnabled: ${p}, hasLoggedInToTeams: ${u}, isSipDisabled: ${e.isSipDisabled}, isSfBEligible: ${a}`),!m&&u&&p||e.isSipDisabled||!a?r.Teams:r.SfB}},832259:(e,n,i)=>{"use strict";i.d(n,{L:()=>a,R:()=>t});const a="vdi-occlusion",t={Rectangular:"vdi-occlusion",Popover:"popover",Circle:"vdi-circle-occlusion",Dynamic:"vdi-dynamic-occlusion",Donut:{Parent:"vdi-donut-occlusion",Child:"vdi-donut-child-occlusion"},Frame:"vdi-frame-occlusion"}}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/587118-13e9a91d53fda751.js.map