"use strict";(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[14415],{14415:(e,t,s)=>{s.d(t,{zW:()=>Q,Yk:()=>g,ox:()=>ns,wy:()=>bs,mz:()=>gs,GL:()=>ms,pM:()=>hs,BI:()=>cs,h2:()=>rs,V0:()=>us,GX:()=>as,yw:()=>ds,SG:()=>ls,w9:()=>_s,yS:()=>Re,mZ:()=>vs,dx:()=>Ae});var i=s(297644);const o="data-tabster",n="data-tabster-dummy",r=["a[href]","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])","*[tabindex]","*[contenteditable]"].join(", "),a={EscapeGroupper:1,Restorer:2,Deloser:3},l={Any:0,Accessible:1,Focusable:2},c={History:0,DeloserDefault:1,RootDefault:2,DeloserFirst:3,RootFirst:4},u={Auto:0,Manual:1},d={Invisible:0,PartiallyVisible:1,Visible:2},h={Source:0,Target:1},_={Both:0,Vertical:1,Horizontal:2,Grid:3,GridLinear:4},m={ArrowUp:1,ArrowDown:2,ArrowLeft:3,ArrowRight:4,PageUp:5,PageDown:6,Home:7,End:8},f={Unlimited:0,Limited:1,LimitedTrapFocus:2},v={Enter:1,Escape:2},b={Auto:0,Inside:1,Outside:2};var g=Object.freeze({__proto__:null,TabsterAttributeName:o,TabsterDummyInputAttributeName:n,FocusableSelector:r,AsyncFocusSources:a,ObservedElementAccesibilities:l,RestoreFocusOrders:c,DeloserStrategies:u,Visibilities:d,RestorerTypes:h,MoverDirections:_,MoverKeys:m,GroupperTabbabilities:f,GroupperMoveFocusActions:v,SysDummyInputsPositions:b});function p(e,t){var s;return null===(s=e.storageEntry(t))||void 0===s?void 0:s.tabster}function E(e,t,s){var i,n;const r=s||e._noop?void 0:t.getAttribute(o);let a,l=e.storageEntry(t);if(r){if(r===(null===(i=null==l?void 0:l.attr)||void 0===i?void 0:i.string))return;try{const e=JSON.parse(r);if("object"!=typeof e)throw new Error(`Value is not a JSON object, got '${r}'.`);a={string:r,object:e}}catch(e){0}}else if(!l)return;l||(l=e.storageEntry(t,!0)),l.tabster||(l.tabster={});const c=l.tabster||{},u=(null===(n=l.attr)||void 0===n?void 0:n.object)||{},d=(null==a?void 0:a.object)||{};for(const s of Object.keys(u))if(!d[s]){if("root"===s){const t=c[s];t&&e.root.onRoot(t,!0)}switch(s){case"deloser":case"root":case"groupper":case"modalizer":case"restorer":case"mover":const i=c[s];i&&(i.dispose(),delete c[s]);break;case"observed":delete c[s],e.observedElement&&e.observedElement.onObservedElementUpdate(t);break;case"focusable":case"outline":case"uncontrolled":case"sys":delete c[s]}}for(const s of Object.keys(d)){const i=d.sys;switch(s){case"deloser":c.deloser?c.deloser.setProps(d.deloser):e.deloser&&(c.deloser=e.deloser.createDeloser(t,d.deloser));break;case"root":c.root?c.root.setProps(d.root):c.root=e.root.createRoot(t,d.root,i),e.root.onRoot(c.root);break;case"modalizer":c.modalizer?c.modalizer.setProps(d.modalizer):e.modalizer&&(c.modalizer=e.modalizer.createModalizer(t,d.modalizer,i));break;case"restorer":c.restorer?c.restorer.setProps(d.restorer):e.restorer&&d.restorer&&(c.restorer=e.restorer.createRestorer(t,d.restorer));break;case"focusable":c.focusable=d.focusable;break;case"groupper":c.groupper?c.groupper.setProps(d.groupper):e.groupper&&(c.groupper=e.groupper.createGroupper(t,d.groupper,i));break;case"mover":c.mover?c.mover.setProps(d.mover):e.mover&&(c.mover=e.mover.createMover(t,d.mover,i));break;case"observed":e.observedElement&&(c.observed=d.observed,e.observedElement.onObservedElementUpdate(t));break;case"uncontrolled":c.uncontrolled=d.uncontrolled;break;case"outline":e.outline&&(c.outline=d.outline);break;case"sys":c.sys=d.sys;break;default:console.error(`Unknown key '${s}' in data-tabster attribute value.`)}}a?l.attr=a:(0===Object.keys(c).length&&(delete l.tabster,delete l.attr),e.storageEntry(t,!1))}const y="tabster:focusin",w="tabster:focusout",T="tabster:movefocus",F="tabster:deloser:focus-lost",I="tabster:deloser:restore-focus",D="tabster:modalizer:active",C="tabster:modalizer:inactive",O="tabster:mover:state",k="tabster:mover:movefocus",N="tabster:mover:memorized-element",R="tabster:groupper:movefocus",A="tabster:restorer:restore-focus",M="tabster:root:focus",x="tabster:root:blur",P="undefined"!=typeof CustomEvent?CustomEvent:function(){};class S extends P{constructor(e,t){super(e,{bubbles:!0,cancelable:!0,composed:!0,detail:t}),this.details=t}}class L extends S{constructor(e){super(y,e)}}class W extends S{constructor(e){super(w,e)}}class U extends S{constructor(e){super(T,e)}}class z extends S{constructor(e){super(O,e)}}class B extends S{constructor(e){super(k,e)}}class K extends S{constructor(e){super(N,e)}}class V extends S{constructor(e){super(R,e)}}class j extends S{constructor(e){super(D,e)}}class q extends S{constructor(e){super(C,e)}}class H extends S{constructor(e){super(F,e)}}class G extends S{constructor(){super(A)}}class $ extends S{constructor(e){super(M,e)}}class J extends S{constructor(e){super(x,e)}}var Q=Object.freeze({__proto__:null,TabsterFocusInEventName:y,TabsterFocusOutEventName:w,TabsterMoveFocusEventName:T,DeloserFocusLostEventName:F,DeloserRestoreFocusEventName:I,ModalizerActiveEventName:D,ModalizerInactiveEventName:C,ModalizerFocusInEventName:"tabster:modalizer:focusin",ModalizerFocusOutEventName:"tabster:modalizer:focusout",MoverStateEventName:O,MoverMoveFocusEventName:k,MoverMemorizedElementEventName:N,GroupperMoveFocusEventName:R,RestorerRestoreFocusEventName:A,RootFocusEventName:M,RootBlurEventName:x,TabsterCustomEvent:S,TabsterFocusInEvent:L,TabsterFocusOutEvent:W,TabsterMoveFocusEvent:U,MoverStateEvent:z,MoverMoveFocusEvent:B,MoverMemorizedElementEvent:K,GroupperMoveFocusEvent:V,ModalizerActiveEvent:j,ModalizerInactiveEvent:q,DeloserFocusLostEvent:H,DeloserRestoreFocusEvent:class extends S{constructor(){super(I)}},RestorerRestoreFocusEvent:G,RootFocusEvent:$,RootBlurEvent:J});const Y={createMutationObserver:e=>new MutationObserver(e),createTreeWalker:(e,t,s,i)=>e.createTreeWalker(t,s,i),getParentNode:e=>e?e.parentNode:null,getParentElement:e=>e?e.parentElement:null,nodeContains:(e,t)=>!(!t||!(null==e?void 0:e.contains(t))),getActiveElement:e=>e.activeElement,querySelector:(e,t)=>e.querySelector(t),querySelectorAll:(e,t)=>Array.prototype.slice.call(e.querySelectorAll(t),0),getElementById:(e,t)=>e.getElementById(t),getFirstChild:e=>(null==e?void 0:e.firstChild)||null,getLastChild:e=>(null==e?void 0:e.lastChild)||null,getNextSibling:e=>(null==e?void 0:e.nextSibling)||null,getPreviousSibling:e=>(null==e?void 0:e.previousSibling)||null,getFirstElementChild:e=>(null==e?void 0:e.firstElementChild)||null,getLastElementChild:e=>(null==e?void 0:e.lastElementChild)||null,getNextElementSibling:e=>(null==e?void 0:e.nextElementSibling)||null,getPreviousElementSibling:e=>(null==e?void 0:e.previousElementSibling)||null,appendChild:(e,t)=>e.appendChild(t),insertBefore:(e,t,s)=>e.insertBefore(t,s),getSelection:e=>{var t;return(null===(t=e.ownerDocument)||void 0===t?void 0:t.getSelection())||null}};let X;const Z="undefined"!=typeof DOMRect?DOMRect:class{constructor(e,t,s,i){this.left=e||0,this.top=t||0,this.right=(e||0)+(s||0),this.bottom=(t||0)+(i||0)}};let ee=0;try{document.createTreeWalker(document,NodeFilter.SHOW_ELEMENT),X=!1}catch(e){X=!0}function te(e){const t=e();let s=t.__tabsterInstanceContext;return s||(s={elementByUId:{},basics:{Promise:t.Promise||void 0,WeakRef:t.WeakRef||void 0},containerBoundingRectCache:{},lastContainerBoundingRectCacheId:0,fakeWeakRefs:[],fakeWeakRefsStarted:!1},t.__tabsterInstanceContext=s),s}class se{constructor(e){this._target=e}deref(){return this._target}static cleanup(e,t){return!e._target||!(!t&&fe(e._target.ownerDocument,e._target))&&(delete e._target,!0)}}class ie{constructor(e,t,s){const i=te(e);let o;i.WeakRef?o=new i.WeakRef(t):(o=new se(t),i.fakeWeakRefs.push(o)),this._ref=o,this._data=s}get(){const e=this._ref;let t;return e&&(t=e.deref(),t||delete this._ref),t}getData(){return this._data}}function oe(e,t){const s=te(e);s.fakeWeakRefs=s.fakeWeakRefs.filter((e=>!se.cleanup(e,t)))}function ne(e){const t=te(e);t.fakeWeakRefsStarted||(t.fakeWeakRefsStarted=!0,t.WeakRef=function(e){return e.basics.WeakRef}(t)),t.fakeWeakRefsTimer||(t.fakeWeakRefsTimer=e().setTimeout((()=>{t.fakeWeakRefsTimer=void 0,oe(e),ne(e)}),12e4))}function re(e,t,s){if(t.nodeType!==Node.ELEMENT_NODE)return;const i=X?s:{acceptNode:s};return Y.createTreeWalker(e,t,NodeFilter.SHOW_ELEMENT,i,!1)}function ae(e,t){let s=t.__tabsterCacheId;const i=te(e),o=s?i.containerBoundingRectCache[s]:void 0;if(o)return o.rect;const n=t.ownerDocument&&t.ownerDocument.documentElement;if(!n)return new Z;let r=0,a=0,l=n.clientWidth,c=n.clientHeight;if(t!==n){const e=t.getBoundingClientRect();r=Math.max(r,e.left),a=Math.max(a,e.top),l=Math.min(l,e.right),c=Math.min(c,e.bottom)}const u=new Z(r<l?r:-1,a<c?a:-1,r<l?l-r:0,a<c?c-a:0);return s||(s="r-"+ ++i.lastContainerBoundingRectCacheId,t.__tabsterCacheId=s),i.containerBoundingRectCache[s]={rect:u,element:t},i.containerBoundingRectCacheTimer||(i.containerBoundingRectCacheTimer=window.setTimeout((()=>{i.containerBoundingRectCacheTimer=void 0;for(const e of Object.keys(i.containerBoundingRectCache))delete i.containerBoundingRectCache[e].element.__tabsterCacheId;i.containerBoundingRectCache={}}),50)),u}function le(e,t,s){const i=ce(t);if(!i)return!1;const o=ae(e,i),n=t.getBoundingClientRect(),r=n.height*(1-s),a=Math.max(0,o.top-n.top)+Math.max(0,n.bottom-o.bottom);return 0===a||a<=r}function ce(e){const t=e.ownerDocument;if(t){for(let t=Y.getParentElement(e);t;t=Y.getParentElement(t))if(t.scrollWidth>t.clientWidth||t.scrollHeight>t.clientHeight)return t;return t.documentElement}return null}function ue(e){return!!e.__shouldIgnoreFocus}function de(e){const t=new Uint32Array(4);if(e.crypto&&e.crypto.getRandomValues)e.crypto.getRandomValues(t);else if(e.msCrypto&&e.msCrypto.getRandomValues)e.msCrypto.getRandomValues(t);else for(let e=0;e<t.length;e++)t[e]=4294967295*Math.random();const s=[];for(let e=0;e<t.length;e++)s.push(t[e].toString(36));return s.push("|"),s.push((++ee).toString(36)),s.push("|"),s.push(Date.now().toString(36)),s.join("")}function he(e,t){const s=te(e);let i=t.__tabsterElementUID;return i||(i=t.__tabsterElementUID=de(e())),!s.elementByUId[i]&&fe(t.ownerDocument,t)&&(s.elementByUId[i]=new ie(e,t)),i}function _e(e){let t=e.__tabsterCrossOriginWindowUID;return t||(t=e.__tabsterCrossOriginWindowUID=de(e)),t}function me(e,t){const s=te(e);for(const e of Object.keys(s.elementByUId)){const i=s.elementByUId[e],o=i&&i.get();o&&t&&!Y.nodeContains(t,o)||delete s.elementByUId[e]}}function fe(e,t){return Y.nodeContains(null==e?void 0:e.body,t)}function ve(e,t){const s=e.matches||e.matchesSelector||e.msMatchesSelector||e.webkitMatchesSelector;return s&&s.call(e,t)}function be(e){const t=te(e);if(t.basics.Promise)return t.basics.Promise;throw new Error("No Promise defined.")}let ge=0;class pe{constructor(e,t,s){const i=e.getWindow;this._tabster=e,this._element=new ie(i,t),this._props={...s},this.id="i"+ ++ge}getElement(){return this._element.get()}getProps(){return this._props}setProps(e){this._props={...e}}}class Ee{constructor(e,t,s,o,r){var a;this._focusIn=e=>{if(this._fixedTarget){const e=this._fixedTarget.get();return void(e&&(0,i.ev)(e))}const t=this.input;if(this.onFocusIn&&t){const s=e.relatedTarget;this.onFocusIn(this,this._isBackward(!0,t,s),s)}},this._focusOut=e=>{if(this._fixedTarget)return;this.useDefaultAction=!1;const t=this.input;if(this.onFocusOut&&t){const s=e.relatedTarget;this.onFocusOut(this,this._isBackward(!1,t,s),s)}};const l=e(),c=l.document.createElement("i");c.tabIndex=0,c.setAttribute("role","none"),c.setAttribute(n,""),c.setAttribute("aria-hidden","true");const u=c.style;u.position="fixed",u.width=u.height="1px",u.opacity="0.001",u.zIndex="-1",u.setProperty("content-visibility","hidden"),function(e){e.__shouldIgnoreFocus=!0}(c),this.input=c,this.isFirst=s.isFirst,this.isOutside=t,this._isPhantom=null!==(a=s.isPhantom)&&void 0!==a&&a,this._fixedTarget=r,c.addEventListener("focusin",this._focusIn),c.addEventListener("focusout",this._focusOut),c.__tabsterDummyContainer=o,this._isPhantom&&(this._disposeTimer=l.setTimeout((()=>{delete this._disposeTimer,this.dispose()}),0),this._clearDisposeTimeout=()=>{this._disposeTimer&&(l.clearTimeout(this._disposeTimer),delete this._disposeTimer),delete this._clearDisposeTimeout})}dispose(){var e;this._clearDisposeTimeout&&this._clearDisposeTimeout();const t=this.input;t&&(delete this._fixedTarget,delete this.onFocusIn,delete this.onFocusOut,delete this.input,t.removeEventListener("focusin",this._focusIn),t.removeEventListener("focusout",this._focusOut),delete t.__tabsterDummyContainer,null===(e=Y.getParentNode(t))||void 0===e||e.removeChild(t))}setTopLeft(e,t){var s;const i=null===(s=this.input)||void 0===s?void 0:s.style;i&&(i.top=`${e}px`,i.left=`${t}px`)}_isBackward(e,t,s){return e&&!s?!this.isFirst:!!(s&&t.compareDocumentPosition(s)&Node.DOCUMENT_POSITION_FOLLOWING)}}const ye=1,we=2,Te=3,Fe=4;class Ie{constructor(e,t,s,i,o,n){this._element=t,this._instance=new Ce(e,t,this,s,i,o,n)}_setHandlers(e,t){this._onFocusIn=e,this._onFocusOut=t}moveOut(e){var t;null===(t=this._instance)||void 0===t||t.moveOut(e)}moveOutWithDefaultAction(e,t){var s;null===(s=this._instance)||void 0===s||s.moveOutWithDefaultAction(e,t)}getHandler(e){return e?this._onFocusIn:this._onFocusOut}setTabbable(e){var t;null===(t=this._instance)||void 0===t||t.setTabbable(this,e)}dispose(){this._instance&&(this._instance.dispose(this),delete this._instance),delete this._onFocusIn,delete this._onFocusOut}static moveWithPhantomDummy(e,t,s,o,n){var r;const a=new Ee(e.getWindow,!0,{isPhantom:!0,isFirst:!0}).input;if(a){let l,c;if("BODY"===t.tagName)l=t,c=s&&o||!s&&!o?Y.getFirstElementChild(t):null;else{let i,n;s&&(!o||o&&!e.focusable.isFocusable(t,!1,!0,!0))?(l=t,c=o?t.firstElementChild:null):(l=Y.getParentElement(t),c=s&&o||!s&&!o?t:Y.getNextElementSibling(t));do{i=s&&o||!s&&!o?Y.getPreviousElementSibling(c):c,n=null===(r=null==i?void 0:i.__tabsterDummyContainer)||void 0===r?void 0:r.get(),n===t?c=s&&o||!s&&!o?i:Y.getNextElementSibling(i):n=void 0}while(n)}(null==l?void 0:l.dispatchEvent(new U({by:"root",owner:l,next:null,relatedEvent:n})))&&(Y.insertBefore(l,a,c),(0,i.ev)(a))}}static addPhantomDummyWithTarget(e,t,s,i){const o=new Ee(e.getWindow,!0,{isPhantom:!0,isFirst:!0},void 0,new ie(e.getWindow,i)).input;if(o){let e,i;t.querySelector(r)&&!s?(e=t,i=Y.getFirstElementChild(t)):(e=Y.getParentElement(t),i=s?t:Y.getNextElementSibling(t)),e&&Y.insertBefore(e,o,i)}}}class De{constructor(e){this._updateQueue=new Set,this._lastUpdateQueueTime=0,this._changedParents=new WeakSet,this._dummyElements=[],this._dummyCallbacks=new WeakMap,this._domChanged=e=>{var t;this._changedParents.has(e)||(this._changedParents.add(e),this._updateDummyInputsTimer||(this._updateDummyInputsTimer=null===(t=this._win)||void 0===t?void 0:t.call(this).setTimeout((()=>{delete this._updateDummyInputsTimer;for(const e of this._dummyElements){const t=e.get();if(t){const e=this._dummyCallbacks.get(t);if(e){const s=Y.getParentNode(t);s&&!this._changedParents.has(s)||e()}}}this._changedParents=new WeakSet}),100)))},this._win=e}add(e,t){!this._dummyCallbacks.has(e)&&this._win&&(this._dummyElements.push(new ie(this._win,e)),this._dummyCallbacks.set(e,t),this.domChanged=this._domChanged)}remove(e){this._dummyElements=this._dummyElements.filter((t=>{const s=t.get();return s&&s!==e})),this._dummyCallbacks.delete(e),0===this._dummyElements.length&&delete this.domChanged}dispose(){var e;const t=null===(e=this._win)||void 0===e?void 0:e.call(this);this._updateTimer&&(null==t||t.clearTimeout(this._updateTimer),delete this._updateTimer),this._updateDummyInputsTimer&&(null==t||t.clearTimeout(this._updateDummyInputsTimer),delete this._updateDummyInputsTimer),this._changedParents=new WeakSet,this._dummyCallbacks=new WeakMap,this._dummyElements=[],this._updateQueue.clear(),delete this.domChanged,delete this._win}updatePositions(e){this._win&&(this._updateQueue.add(e),this._lastUpdateQueueTime=Date.now(),this._scheduledUpdatePositions())}_scheduledUpdatePositions(){var e;this._updateTimer||(this._updateTimer=null===(e=this._win)||void 0===e?void 0:e.call(this).setTimeout((()=>{if(delete this._updateTimer,this._lastUpdateQueueTime+100<=Date.now()){const e=new Map,t=[];for(const s of this._updateQueue)t.push(s(e));this._updateQueue.clear();for(const e of t)e();e.clear()}else this._scheduledUpdatePositions()}),100))}}class Ce{constructor(e,t,s,o,n,r,a){this._wrappers=[],this._isOutside=!1,this._transformElements=new Set,this._onFocusIn=(e,t,s)=>{this._onFocus(!0,e,t,s)},this._onFocusOut=(e,t,s)=>{this._onFocus(!1,e,t,s)},this.moveOut=e=>{var t;const s=this._firstDummy,o=this._lastDummy;if(s&&o){this._ensurePosition();const n=s.input,r=o.input,a=null===(t=this._element)||void 0===t?void 0:t.get();if(n&&r&&a){let t;e?(n.tabIndex=0,t=n):(r.tabIndex=0,t=r),t&&(0,i.ev)(t)}}},this.moveOutWithDefaultAction=(e,t)=>{var s;const o=this._firstDummy,n=this._lastDummy;if(o&&n){this._ensurePosition();const r=o.input,a=n.input,l=null===(s=this._element)||void 0===s?void 0:s.get();if(r&&a&&l){let s;e?!o.isOutside&&this._tabster.focusable.isFocusable(l,!0,!0,!0)?s=l:(o.useDefaultAction=!0,r.tabIndex=0,s=r):(n.useDefaultAction=!0,a.tabIndex=0,s=a),s&&l.dispatchEvent(new U({by:"root",owner:l,next:null,relatedEvent:t}))&&(0,i.ev)(s)}}},this.setTabbable=(e,t)=>{var s,i;for(const s of this._wrappers)if(s.manager===e){s.tabbable=t;break}const o=this._getCurrent();if(o){const e=o.tabbable?0:-1;let t=null===(s=this._firstDummy)||void 0===s?void 0:s.input;t&&(t.tabIndex=e),t=null===(i=this._lastDummy)||void 0===i?void 0:i.input,t&&(t.tabIndex=e)}},this._addDummyInputs=()=>{this._addTimer||(this._addTimer=this._getWindow().setTimeout((()=>{delete this._addTimer,this._ensurePosition(),this._addTransformOffsets()}),0))},this._addTransformOffsets=()=>{this._tabster._dummyObserver.updatePositions(this._computeTransformOffsets)},this._computeTransformOffsets=e=>{var t,s;const i=(null===(t=this._firstDummy)||void 0===t?void 0:t.input)||(null===(s=this._lastDummy)||void 0===s?void 0:s.input),o=this._transformElements,n=new Set;let r=0,a=0;const l=this._getWindow();for(let t=i;t&&t.nodeType===Node.ELEMENT_NODE;t=Y.getParentElement(t)){let s=e.get(t);if(void 0===s){const i=l.getComputedStyle(t).transform;i&&"none"!==i&&(s={scrollTop:t.scrollTop,scrollLeft:t.scrollLeft}),e.set(t,s||null)}s&&(n.add(t),o.has(t)||t.addEventListener("scroll",this._addTransformOffsets),r+=s.scrollTop,a+=s.scrollLeft)}for(const e of o)n.has(e)||e.removeEventListener("scroll",this._addTransformOffsets);return this._transformElements=n,()=>{var e,t;null===(e=this._firstDummy)||void 0===e||e.setTopLeft(r,a),null===(t=this._lastDummy)||void 0===t||t.setTopLeft(r,a)}};const l=t.get();if(!l)throw new Error("No element");this._tabster=e,this._getWindow=e.getWindow,this._callForDefaultAction=a;const c=l.__tabsterDummy;if((c||this)._wrappers.push({manager:s,priority:o,tabbable:!0}),c)return c;l.__tabsterDummy=this;const u=null==n?void 0:n.dummyInputsPosition,d=l.tagName;this._isOutside=u?u===b.Outside:(r||"UL"===d||"OL"===d||"TABLE"===d)&&!("LI"===d||"TD"===d||"TH"===d),this._firstDummy=new Ee(this._getWindow,this._isOutside,{isFirst:!0},t),this._lastDummy=new Ee(this._getWindow,this._isOutside,{isFirst:!1},t);const h=this._firstDummy.input;h&&e._dummyObserver.add(h,this._addDummyInputs),this._firstDummy.onFocusIn=this._onFocusIn,this._firstDummy.onFocusOut=this._onFocusOut,this._lastDummy.onFocusIn=this._onFocusIn,this._lastDummy.onFocusOut=this._onFocusOut,this._element=t,this._addDummyInputs()}dispose(e,t){var s,i,o,n;if(0===(this._wrappers=this._wrappers.filter((s=>s.manager!==e&&!t))).length){delete(null===(s=this._element)||void 0===s?void 0:s.get()).__tabsterDummy;for(const e of this._transformElements)e.removeEventListener("scroll",this._addTransformOffsets);this._transformElements.clear();const e=this._getWindow();this._addTimer&&(e.clearTimeout(this._addTimer),delete this._addTimer);const t=null===(i=this._firstDummy)||void 0===i?void 0:i.input;t&&this._tabster._dummyObserver.remove(t),null===(o=this._firstDummy)||void 0===o||o.dispose(),null===(n=this._lastDummy)||void 0===n||n.dispose()}}_onFocus(e,t,s,i){var o;const n=this._getCurrent();!n||t.useDefaultAction&&!this._callForDefaultAction||null===(o=n.manager.getHandler(e))||void 0===o||o(t,s,i)}_getCurrent(){return this._wrappers.sort(((e,t)=>e.tabbable!==t.tabbable?e.tabbable?-1:1:e.priority-t.priority)),this._wrappers[0]}_ensurePosition(){var e,t,s;const i=null===(e=this._element)||void 0===e?void 0:e.get(),o=null===(t=this._firstDummy)||void 0===t?void 0:t.input,n=null===(s=this._lastDummy)||void 0===s?void 0:s.input;if(i&&o&&n)if(this._isOutside){const e=Y.getParentNode(i);if(e){const t=Y.getNextSibling(i);t!==n&&Y.insertBefore(e,n,t),Y.getPreviousElementSibling(i)!==o&&Y.insertBefore(e,o,i)}}else{Y.getLastElementChild(i)!==n&&Y.appendChild(i,n);const e=Y.getFirstElementChild(i);e&&e!==o&&e.parentNode&&Y.insertBefore(e.parentNode,o,e)}}}function Oe(e){let t=null;for(let s=Y.getLastElementChild(e);s;s=Y.getLastElementChild(s))t=s;return t||void 0}function ke(e,t,s,i){const o=e.storageEntry(t,!0);let n=!1;if(!o.aug){if(void 0===i)return n;o.aug={}}if(void 0===i){if(s in o.aug){const e=o.aug[s];delete o.aug[s],null===e?t.removeAttribute(s):t.setAttribute(s,e),n=!0}}else{let e;s in o.aug||(e=t.getAttribute(s)),void 0!==e&&e!==i&&(o.aug[s]=e,null===i?t.removeAttribute(s):t.setAttribute(s,i),n=!0)}return void 0===i&&0===Object.keys(o.aug).length&&(delete o.aug,e.storageEntry(t,!1)),n}function Ne(e){var t;const s=e.ownerDocument,i=null===(t=s.defaultView)||void 0===t?void 0:t.getComputedStyle(e);return null===e.offsetParent&&s.body!==e&&"fixed"!==(null==i?void 0:i.position)||"hidden"===(null==i?void 0:i.visibility)}function Re(e,t){const s=JSON.stringify(e);return!0===t?s:{[o]:s}}function Ae(e,t,s){let i;if(s){const t=e.getAttribute(o);if(t)try{i=JSON.parse(t)}catch(e){0}}i||(i={}),function(e,t){for(const s of Object.keys(t)){const i=t[s];i?e[s]=i:delete e[s]}}(i,t),Object.keys(i).length>0?e.setAttribute(o,Re(i,!0)):e.removeAttribute(o)}class Me extends Ie{constructor(e,t,s,o){super(e,t,ye,o,void 0,!0),this._onDummyInputFocus=e=>{var t;if(e.useDefaultAction)this._setFocused(!1);else{this._tabster.keyboardNavigation.setNavigatingWithKeyboard(!0);const s=this._element.get();if(s){this._setFocused(!0);const t=this._tabster.focusedElement.getFirstOrLastTabbable(e.isFirst,{container:s,ignoreAccessibility:!0});if(t)return void(0,i.ev)(t)}null===(t=e.input)||void 0===t||t.blur()}},this._setHandlers(this._onDummyInputFocus),this._tabster=e,this._setFocused=s}}class xe extends pe{constructor(e,t,s,o,n){super(e,t,o),this._isFocused=!1,this._setFocused=e=>{var t;if(this._setFocusedTimer&&(this._tabster.getWindow().clearTimeout(this._setFocusedTimer),delete this._setFocusedTimer),this._isFocused===e)return;const s=this._element.get();s&&(e?(this._isFocused=!0,null===(t=this._dummyManager)||void 0===t||t.setTabbable(!1),s.dispatchEvent(new $({element:s}))):this._setFocusedTimer=this._tabster.getWindow().setTimeout((()=>{var e;delete this._setFocusedTimer,this._isFocused=!1,null===(e=this._dummyManager)||void 0===e||e.setTabbable(!0),s.dispatchEvent(new J({element:s}))}),0))},this._onFocusIn=e=>{const t=this._tabster.getParent,s=this._element.get();let i=e.composedPath()[0];do{if(i===s)return void this._setFocused(!0);i=i&&t(i)}while(i)},this._onFocusOut=()=>{this._setFocused(!1)},this._onDispose=s;const r=e.getWindow;this.uid=he(r,t),this._sys=n,(e.controlTab||e.rootDummyInputs)&&this.addDummyInputs();const a=r().document;a.addEventListener(i.PW,this._onFocusIn),a.addEventListener(i.r$,this._onFocusOut),this._add()}addDummyInputs(){this._dummyManager||(this._dummyManager=new Me(this._tabster,this._element,this._setFocused,this._sys))}dispose(){var e;this._onDispose(this);const t=this._tabster.getWindow(),s=t.document;s.removeEventListener(i.PW,this._onFocusIn),s.removeEventListener(i.r$,this._onFocusOut),this._setFocusedTimer&&(t.clearTimeout(this._setFocusedTimer),delete this._setFocusedTimer),null===(e=this._dummyManager)||void 0===e||e.dispose(),this._remove()}moveOutWithDefaultAction(e,t){const s=this._dummyManager;if(s)s.moveOutWithDefaultAction(e,t);else{const s=this.getElement();s&&Me.moveWithPhantomDummy(this._tabster,s,!0,e,t)}}_add(){0}_remove(){0}}class Pe{constructor(e,t){this._autoRootWaiting=!1,this._roots={},this._forceDummy=!1,this.rootById={},this._autoRootCreate=()=>{var e;const t=this._win().document,s=t.body;if(s){this._autoRootUnwait(t);const i=this._autoRoot;if(i)return Ae(s,{root:i},!0),E(this._tabster,s),null===(e=p(this._tabster,s))||void 0===e?void 0:e.root}else this._autoRootWaiting||(this._autoRootWaiting=!0,t.addEventListener("readystatechange",this._autoRootCreate))},this._onRootDispose=e=>{delete this._roots[e.id]},this._tabster=e,this._win=e.getWindow,this._autoRoot=t,e.queueInit((()=>{this._autoRoot&&this._autoRootCreate()}))}_autoRootUnwait(e){e.removeEventListener("readystatechange",this._autoRootCreate),this._autoRootWaiting=!1}dispose(){const e=this._win();this._autoRootUnwait(e.document),delete this._autoRoot,Object.keys(this._roots).forEach((e=>{this._roots[e]&&(this._roots[e].dispose(),delete this._roots[e])})),this.rootById={}}createRoot(e,t,s){const i=new xe(this._tabster,e,this._onRootDispose,t,s);return this._roots[i.id]=i,this._forceDummy&&i.addDummyInputs(),i}addDummyInputs(){this._forceDummy=!0;const e=this._roots;for(const t of Object.keys(e))e[t].addDummyInputs()}static getRootByUId(e,t){const s=e().__tabsterInstance;return s&&s.root.rootById[t]}static getTabsterContext(e,t,s){var i,o,n,r;if(void 0===s&&(s={}),!t.ownerDocument)return;const{checkRtl:a,referenceElement:l}=s,c=e.getParent;let u,d,h,_;e.drainInitQueue();let m,f,v,b,g=!1,E=l||t;const y={};for(;E&&(!u||a);){const s=p(e,E);if(a&&void 0===v){const e=E.dir;e&&(v="rtl"===e.toLowerCase())}if(!s){E=c(E);continue}const r=E.tagName;(s.uncontrolled||"IFRAME"===r||"WEBVIEW"===r)&&(b=E),_||!(null===(i=s.focusable)||void 0===i?void 0:i.excludeFromMover)||h||(g=!0);const l=s.modalizer,w=s.groupper,T=s.mover;!d&&l&&(d=l),h||!w||d&&!l||(d?(!w.isActive()&&w.getProps().tabbability&&d.userId!==(null===(o=e.modalizer)||void 0===o?void 0:o.activeId)&&(d=void 0,h=w),f=w):h=w),_||!T||d&&!l||w&&E===t||(_=T,m=!!h&&h!==w),s.root&&(u=s.root),(null===(n=s.focusable)||void 0===n?void 0:n.ignoreKeydown)&&Object.assign(y,s.focusable.ignoreKeydown),E=c(E)}if(!u){const s=e.root;s._autoRoot&&(null===(r=t.ownerDocument)||void 0===r?void 0:r.body)&&(u=s._autoRootCreate())}h&&!_&&(m=!0);return u?{root:u,modalizer:d,groupper:h,mover:_,groupperBeforeMover:m,modalizerInGroupper:f,rtl:a?!!v:void 0,uncontrolled:b,excludedFromMover:g,ignoreKeydown:e=>!!y[e.key]}:void 0}static getRoot(e,t){var s;const i=e.getParent;for(let o=t;o;o=i(o)){const t=null===(s=p(e,o))||void 0===s?void 0:s.root;if(t)return t}}onRoot(e,t){t?delete this.rootById[e.uid]:this.rootById[e.uid]=e}}class Se{}class Le extends Se{constructor(e,t){super(),this.uid=t.uid,this._tabster=e,this._deloser=t}belongsTo(e){return e===this._deloser}unshift(e){this._deloser.unshift(e)}async focusAvailable(){const e=this._deloser.findAvailable(),t=this._deloser.getElement();return!(!e||!t)&&(t.dispatchEvent(new U({by:"deloser",owner:t,next:e}))?this._tabster.focusedElement.focus(e):null)}async resetFocus(){return be(this._tabster.getWindow).resolve(this._deloser.resetFocus())}}class We{constructor(e,t){this._history=[],this._tabster=e,this.rootUId=t}getLength(){return this._history.length}removeDeloser(e){this._history=this._history.filter((t=>!t.belongsTo(e)))}hasDeloser(e){return this._history.some((t=>t.belongsTo(e)))}}class Ue extends We{unshiftToDeloser(e,t){let s;for(let t=0;t<this._history.length;t++)if(this._history[t].belongsTo(e)){s=this._history[t],this._history.splice(t,1);break}s||(s=new Le(this._tabster,e)),s.unshift(t),this._history.unshift(s),this._history.splice(10,this._history.length-10)}async focusAvailable(e){let t=!!e;for(const s of this._history)if(e&&s.belongsTo(e)&&(t=!1),!t){const e=await s.focusAvailable();if(e||null===e)return e}return!1}async resetFocus(e){let t=!!e;const s={};for(const i of this._history)e&&i.belongsTo(e)&&(t=!1),t||s[i.uid]||(s[i.uid]=i);for(const e of Object.keys(s))if(await s[e].resetFocus())return!0;return!1}}class ze{constructor(e){this._history=[],this._tabster=e}dispose(){this._history=[]}process(e){var t;const s=Pe.getTabsterContext(this._tabster,e),i=s&&s.root.uid,o=Ve.getDeloser(this._tabster,e);if(!i||!o)return;const n=this.make(i,(()=>new Ue(this._tabster,i)));return s&&s.modalizer&&!(null===(t=s.modalizer)||void 0===t?void 0:t.isActive())||n.unshiftToDeloser(o,e),o}make(e,t){let s;for(let t=0;t<this._history.length;t++){const i=this._history[t];if(i.rootUId===e){s=i,this._history.splice(t,1);break}}return s||(s=t()),this._history.unshift(s),this._history.splice(10,this._history.length-10),s}removeDeloser(e){this._history.forEach((t=>{t.removeDeloser(e)})),this._history=this._history.filter((e=>e.getLength()>0))}async focusAvailable(e){let t=!!e;for(const s of this._history)if(e&&s.hasDeloser(e)&&(t=!1),!t){const t=await s.focusAvailable(e);if(t||null===t)return t}return!1}async resetFocus(e){let t=!!e;for(const s of this._history)if(e&&s.hasDeloser(e)&&(t=!1),!t&&await s.resetFocus(e))return!0;return!1}}function Be(e,t,s){const i=[],o=/(:|\.|\[|\]|,|=|@)/g,n=e.getAttribute("id");n&&i.push("#"+n.replace(o,"\\$1")),!1!==t&&e.className&&e.className.split(" ").forEach((e=>{(e=e.trim())&&i.push("."+e.replace(o,"\\$1"))}));let r,a=0;if(!1!==s&&0===i.length){for(r=e;r;)a++,r=r.previousElementSibling;i.unshift(":nth-child("+a+")")}return i.unshift(e.tagName.toLowerCase()),i.join("")}class Ke extends pe{constructor(e,t,s,i){super(e,t,i),this._isActive=!1,this._history=[[]],this._snapshotIndex=0,this.isActive=()=>this._isActive,this.setSnapshot=e=>{this._snapshotIndex=e,this._history.length>e+1&&this._history.splice(e+1,this._history.length-e-1),this._history[e]||(this._history[e]=[])},this.focusFirst=()=>{const e=this._element.get();return!!e&&this._tabster.focusedElement.focusFirst({container:e})},this.focusDefault=()=>{const e=this._element.get();return!!e&&this._tabster.focusedElement.focusDefault(e)},this.resetFocus=()=>{const e=this._element.get();return!!e&&this._tabster.focusedElement.resetFocus(e)},this.clearHistory=e=>{const t=this._element.get();this._history[this._snapshotIndex]=t?this._history[this._snapshotIndex].filter((s=>{const i=s.get();return!(!i||!e)&&Y.nodeContains(t,i)})):[]},this.uid=he(e.getWindow,t),this.strategy=i.strategy||u.Auto,this._onDispose=s}dispose(){this._remove(),this._onDispose(this),this._isActive=!1,this._snapshotIndex=0,this._props={},this._history=[]}setActive(e){this._isActive=e}getActions(){return{focusDefault:this.focusDefault,focusFirst:this.focusFirst,resetFocus:this.resetFocus,clearHistory:this.clearHistory,setSnapshot:this.setSnapshot,isActive:this.isActive}}unshift(e){let t=this._history[this._snapshotIndex];for(t=this._history[this._snapshotIndex]=t.filter((t=>{const s=t.get();return s&&s!==e})),t.unshift(new ie(this._tabster.getWindow,e,function(e){if(!fe(e.ownerDocument,e))return;const t=[Be(e)];let s=Y.getParentNode(e);for(;s&&s.nodeType!==Node.DOCUMENT_FRAGMENT_NODE;){if(s.nodeType===Node.ELEMENT_NODE){const e="BODY"===s.tagName;if(t.unshift(Be(s,!1,!e)),e)break}s=Y.getParentNode(s)}return t.join(" ")}(e)));t.length>10;)t.pop()}findAvailable(){const e=this._element.get();if(!e||!this._tabster.focusable.isVisible(e))return null;let t=this._props.restoreFocusOrder,s=null;const i=Pe.getTabsterContext(this._tabster,e);if(!i)return null;const o=i.root,n=o.getElement();if(!n)return null;if(void 0===t&&(t=o.getProps().restoreFocusOrder),t===c.RootDefault&&(s=this._tabster.focusable.findDefault({container:n})),s||t!==c.RootFirst||(s=this._findFirst(n)),s)return s;const r=this._findInHistory();if(r&&t===c.History)return r;const a=this._tabster.focusable.findDefault({container:e});if(a&&t===c.DeloserDefault)return a;const l=this._findFirst(e);return l&&t===c.DeloserFirst?l:a||r||l||null}customFocusLostHandler(e){return e.dispatchEvent(new H(this.getActions()))}_findInHistory(){const e=this._history[this._snapshotIndex].slice(0);this.clearHistory(!0);for(let t=0;t<e.length;t++){const s=e[t],i=s.get(),o=this._element.get();if(i&&o&&Y.nodeContains(o,i)){if(this._tabster.focusable.isFocusable(i))return i}else if(!this._props.noSelectorCheck){const e=s.getData();if(e&&o){let t;try{t=Y.querySelectorAll(o.ownerDocument,e)}catch(e){0;continue}for(let e=0;e<t.length;e++){const s=t[e];if(s&&this._tabster.focusable.isFocusable(s))return s}}}}return null}_findFirst(e){if(this._tabster.keyboardNavigation.isNavigatingWithKeyboard()){const t=this._tabster.focusable.findFirst({container:e,useActiveModalizer:!0});if(t)return t}return null}_remove(){0}}class Ve{constructor(e,t){this._inDeloser=!1,this._isRestoringFocus=!1,this._isPaused=!1,this._onRestoreFocus=e=>{var t;const s=e.composedPath()[0];if(s){const i=null===(t=Ve.getDeloser(this._tabster,s))||void 0===t?void 0:t.findAvailable();i&&this._tabster.focusedElement.focus(i),e.stopImmediatePropagation()}},this._onFocus=e=>{if(this._restoreFocusTimer&&(this._win().clearTimeout(this._restoreFocusTimer),this._restoreFocusTimer=void 0),!e)return void this._scheduleRestoreFocus();const t=this._history.process(e);t?this._activate(t):this._deactivate()},this._onDeloserDispose=e=>{this._history.removeDeloser(e),e.isActive()&&this._scheduleRestoreFocus()},this._tabster=e,this._win=e.getWindow,this._history=new ze(e),e.queueInit((()=>{this._tabster.focusedElement.subscribe(this._onFocus);const e=this._win().document;e.addEventListener(I,this._onRestoreFocus);const t=Y.getActiveElement(e);t&&t!==e.body&&this._onFocus(t)}));const s=null==t?void 0:t.autoDeloser;s&&(this._autoDeloser=s)}dispose(){const e=this._win();this._restoreFocusTimer&&(e.clearTimeout(this._restoreFocusTimer),this._restoreFocusTimer=void 0),this._autoDeloserInstance&&(this._autoDeloserInstance.dispose(),delete this._autoDeloserInstance,delete this._autoDeloser),this._tabster.focusedElement.unsubscribe(this._onFocus),e.document.removeEventListener(I,this._onRestoreFocus),this._history.dispose(),delete this._curDeloser}createDeloser(e,t){var s;const i=new Ke(this._tabster,e,this._onDeloserDispose,t);return Y.nodeContains(e,null!==(s=this._tabster.focusedElement.getFocusedElement())&&void 0!==s?s:null)&&this._activate(i),i}getActions(e){for(let t=e;t;t=Y.getParentElement(t)){const e=p(this._tabster,t);if(e&&e.deloser)return e.deloser.getActions()}}pause(){this._isPaused=!0,this._restoreFocusTimer&&(this._win().clearTimeout(this._restoreFocusTimer),this._restoreFocusTimer=void 0)}resume(e){this._isPaused=!1,e&&this._scheduleRestoreFocus()}_activate(e){const t=this._curDeloser;t!==e&&(this._inDeloser=!0,null==t||t.setActive(!1),e.setActive(!0),this._curDeloser=e)}_deactivate(){var e;this._inDeloser=!1,null===(e=this._curDeloser)||void 0===e||e.setActive(!1),this._curDeloser=void 0}_scheduleRestoreFocus(e){if(this._isPaused||this._isRestoringFocus)return;const t=async()=>{this._restoreFocusTimer=void 0;const t=this._tabster.focusedElement.getLastFocusedElement();if(!e&&(this._isRestoringFocus||!this._inDeloser||t&&!Ne(t)))return;const s=this._curDeloser;let i=!1;if(s){if(t&&s.customFocusLostHandler(t))return;if(s.strategy===u.Manual)i=!0;else{const e=s.getElement(),t=s.findAvailable();if(t&&(!(null==e?void 0:e.dispatchEvent(new U({by:"deloser",owner:e,next:t})))||this._tabster.focusedElement.focus(t)))return}}this._deactivate(),i||(this._isRestoringFocus=!0,!1===await this._history.focusAvailable(null)&&await this._history.resetFocus(null),this._isRestoringFocus=!1)};e?t():this._restoreFocusTimer=this._win().setTimeout(t,100)}static getDeloser(e,t){var s;let i;for(let s=t;s;s=Y.getParentElement(s)){const t=p(e,s);if(t){i||(i=t.root);const e=t.deloser;if(e)return e}}const o=e.deloser&&e.deloser;if(o){if(o._autoDeloserInstance)return o._autoDeloserInstance;const n=o._autoDeloser;if(i&&!o._autoDeloserInstance&&n){const i=null===(s=t.ownerDocument)||void 0===s?void 0:s.body;i&&(o._autoDeloserInstance=new Ke(e,i,e.deloser._onDeloserDispose,n))}return o._autoDeloserInstance}}static getHistory(e){return e._history}static forceRestoreFocus(e){e._scheduleRestoreFocus(!0)}}class je{constructor(){this._callbacks=[]}dispose(){this._callbacks=[],delete this._val}subscribe(e){const t=this._callbacks;t.indexOf(e)<0&&t.push(e)}subscribeFirst(e){const t=this._callbacks,s=t.indexOf(e);s>=0&&t.splice(s,1),t.unshift(e)}unsubscribe(e){const t=this._callbacks.indexOf(e);t>=0&&this._callbacks.splice(t,1)}setVal(e,t){this._val!==e&&(this._val=e,this._callCallbacks(e,t))}getVal(){return this._val}trigger(e,t){this._callCallbacks(e,t)}_callCallbacks(e,t){this._callbacks.forEach((s=>s(e,t)))}}const qe="up",He=1,Ge=2,$e=3,Je=4,Qe=5,Ye=6;class Xe extends Se{constructor(e,t,s){super(),this._deloser=t,this._transactions=s}belongsTo(e){return e.deloserUId===this._deloser.deloserUId}async focusAvailable(){const e={...this._deloser,reset:!1};return this._transactions.beginTransaction(dt,e).then((e=>!!e))}async resetFocus(){const e={...this._deloser,reset:!0};return this._transactions.beginTransaction(dt,e).then((e=>!!e))}}class Ze extends We{constructor(e,t,s){super(e,t),this._transactions=s}unshift(e){let t;for(let s=0;s<this._history.length;s++)if(this._history[s].belongsTo(e)){t=this._history[s],this._history.splice(s,1);break}t||(t=new Xe(this._tabster,e,this._transactions)),this._history.unshift(t),this._history.splice(10,this._history.length-10)}async focusAvailable(){for(const e of this._history)if(await e.focusAvailable())return!0;return!1}async resetFocus(){for(const e of this._history)if(await e.resetFocus())return!0;return!1}}class et{constructor(e,t,s,i,o,n,r,a){this._inProgress={},this._isDone=!1,this._isSelfResponding=!1,this._sentCount=0,this.tabster=e,this.owner=t,this.ownerId=_e(t()),this.id=de(t()),this.beginData=i,this._knownTargets=s,this._sentTo=n||{[this.ownerId]:!0},this.targetId=r,this.sendUp=a,this.timeout=o,this._promise=new(be(t))(((e,t)=>{this._resolve=e,this._reject=t}))}getTargets(e){return this.targetId===qe?this.sendUp?{[qe]:{send:this.sendUp}}:null:this.targetId?e[this.targetId]?{[this.targetId]:{send:e[this.targetId].send}}:null:0===Object.keys(e).length&&this.sendUp?{[qe]:{send:this.sendUp}}:Object.keys(e).length>0?e:null}begin(e){const t=this.getTargets(this._knownTargets),s={...this._sentTo};if(t)for(const e of Object.keys(t))s[e]=!0;const i={transaction:this.id,type:this.type,isResponse:!1,timestamp:Date.now(),owner:this.ownerId,sentto:s,timeout:this.timeout,beginData:this.beginData};if(this.targetId&&(i.target=this.targetId),e&&(this._isSelfResponding=!0,e(i).then((e=>{this._isSelfResponding=!1,void 0!==e&&(this.endData||(this.endData=e)),(this.endData||0===this._sentCount)&&this.end()}))),t)for(const e of Object.keys(t))e in this._sentTo||this._send(t[e].send,e,i);return 0!==this._sentCount||this._isSelfResponding||this.end(),this._promise}_send(e,t,s){void 0===this._inProgress[t]&&(this._inProgress[t]=!0,this._sentCount++,e(s))}end(e){this._isDone||(this._isDone=!0,void 0===this.endData&&e?this._reject&&this._reject(e):this._resolve&&this._resolve(this.endData))}onResponse(e){const t=e.endData;void 0===t||this.endData||(this.endData=t);const s=e.target===qe?qe:e.owner;this._inProgress[s]&&(this._inProgress[s]=!1,this._sentCount--,(this.endData||0===this._sentCount&&!this._isSelfResponding)&&this.end())}}class tt extends et{constructor(){super(...arguments),this.type=He}static shouldForward(){return!1}static async makeResponse(e){return{isNavigatingWithKeyboard:e.keyboardNavigation.isNavigatingWithKeyboard()}}}class st extends et{constructor(){super(...arguments),this.type=Ge}static shouldSelfRespond(){return!0}static shouldForward(e,t,s){const i=ut.findElement(e,s,t.beginData);return!i||!e.focusable.isFocusable(i)}static async makeResponse(e,t,s,i,o,n){const r=ut.findElement(e,s,t.beginData);return!!r&&e.focusedElement.focus(r,!0)||!!await n}}const it=1,ot=2,nt=3,rt=4,at=5,lt=6;class ct extends et{constructor(){super(...arguments),this.type=$e}static shouldSelfRespond(e,t){return t.state!==rt&&t.state!==at}static async makeResponse(e,t,s,i,o,n,r){const a=t.timestamp,l=t.beginData;if(a&&l)switch(l.state){case it:return ct._makeFocusedResponse(e,a,l,o,r);case ot:return ct._makeBlurredResponse(e,a,l,o.ctx);case nt:return ct._makeObservedResponse(e,l);case rt:return ct._makeDeadWindowResponse(e,l,o,n);case at:return ct._makeKeyboardNavigationResponse(e,o.ctx,l.isNavigatingWithKeyboard);case lt:return ct._makeOutlineResponse(e,o.ctx,l.outline)}return!0}static createElement(e,t){return t.uid?new mt(e,t.uid,t.ownerUId,t.id,t.rootUId,t.observedName,t.observedDetails):null}static async _makeFocusedResponse(e,t,s,i,o){const n=ct.createElement(e,s);if(s&&s.ownerUId&&n){if(i.ctx.focusOwner=s.ownerUId,i.ctx.focusOwnerTimestamp=t,!o&&s.rootUId&&s.deloserUId){const t=e.deloser;if(t){const o=Ve.getHistory(t),n={ownerUId:s.ownerUId,deloserUId:s.deloserUId,rootUId:s.rootUId};o.make(s.rootUId,(()=>new Ze(e,n.rootUId,i))).unshift(n)}}ft.setVal(e.crossOrigin.focusedElement,n,{isFocusedProgrammatically:s.isFocusedProgrammatically})}return!0}static async _makeBlurredResponse(e,t,s,i){return s&&(s.ownerUId===i.focusOwner||s.force)&&(!i.focusOwnerTimestamp||i.focusOwnerTimestamp<t)&&ft.setVal(e.crossOrigin.focusedElement,void 0,{}),!0}static async _makeObservedResponse(e,t){const s=t.observedName,i=ct.createElement(e,t);return s&&i&&vt.trigger(e.crossOrigin.observedElement,i,{names:[s],details:t.observedDetails}),!0}static async _makeDeadWindowResponse(e,t,s,i){const o=t&&t.ownerUId;return o&&s.removeTarget(o),i.then((()=>{if(o===s.ctx.focusOwner){const t=e.deloser;t&&Ve.forceRestoreFocus(t)}return!0}))}static async _makeKeyboardNavigationResponse(e,t,s){return void 0!==s&&e.keyboardNavigation.isNavigatingWithKeyboard()!==s&&(t.ignoreKeyboardNavigationStateUpdate=!0,e.keyboardNavigation.setNavigatingWithKeyboard(s),t.ignoreKeyboardNavigationStateUpdate=!1),!0}static async _makeOutlineResponse(e,t,s){return t.origOutlineSetup&&t.origOutlineSetup.call(e.outline,s),!0}}class ut extends et{constructor(){super(...arguments),this.type=Je}static shouldSelfRespond(){return!0}static findElement(e,t,s){let i;if(s&&(!s.ownerId||s.ownerId===_e(t())))if(s.id){if(i=Y.getElementById(t().document,s.id),i&&s.rootId){const t=Pe.getTabsterContext(e,i);if(!t||t.root.uid!==s.rootId)return null}}else if(s.uid){const e=te(t).elementByUId[s.uid];i=e&&e.get()}else s.observedName&&(i=e.observedElement.getElement(s.observedName,s.accessibility));return i||null}static getElementData(e,t,s,i,o){const n=Ve.getDeloser(e,t),r=Pe.getTabsterContext(e,t),a=p(e,t),l=a&&a.observed;return{uid:he(s,t),ownerUId:o,id:t.id||void 0,rootUId:r?r.root.uid:void 0,deloserUId:n?gt(s,i,n):void 0,observedName:l&&l.names&&l.names[0],observedDetails:l&&l.details}}static async makeResponse(e,t,s,i,o,n){const r=t.beginData;let a,l;if(void 0===r?a=e.focusedElement.getFocusedElement():r&&(a=ut.findElement(e,s,r)||void 0),!a&&r){const i=r.observedName,o=t.timeout,c=r.accessibility;if(i&&o){const t=await new(be(s))((t=>{let s=!1,r=!1,a=!1;e.observedElement.waitElement(i,o,c).result.then((e=>{s=!0,a||!e&&!r||(a=!0,t({element:e}))})),n.then((e=>{r=!0,a||!e&&!s||(a=!0,t({crossOrigin:e}))}))}));t.element?a=t.element:t.crossOrigin&&(l=t.crossOrigin)}}return a?ut.getElementData(e,a,s,o.ctx,i):l}}class dt extends et{constructor(){super(...arguments),this.type=Qe}static async makeResponse(e,t,s,i,o,n){const r=await n,a=!r&&t.beginData,l=a&&a.deloserUId,c=l&&o.ctx.deloserByUId[l],u=e.deloser;if(a&&c&&u){const e=Ve.getHistory(u);return a.reset?e.resetFocus(c):e.focusAvailable(c)}return!!r}}class ht extends et{constructor(){super(...arguments),this.type=Ye}static shouldForward(){return!1}static async makeResponse(){return!0}}class _t{constructor(e,t,s){this._knownTargets={},this._transactions={},this._isDefaultSendUp=!1,this.isSetUp=!1,this._onMessage=e=>{if(e.data.owner===this._ownerUId||!this._tabster)return;const t=e.data;let s;if(!(t&&(s=t.transaction)&&t.type&&t.timestamp&&t.owner&&t.sentto))return;let i=this._knownTargets[t.owner];if(!i&&e.send&&t.owner!==this._ownerUId&&(i=this._knownTargets[t.owner]={send:e.send}),i&&(i.last=Date.now()),t.isResponse){const e=this._transactions[s];e&&e.transaction&&e.transaction.type===t.type&&e.transaction.onResponse(t)}else{const s=this._getTransactionClass(t.type),i=this.forwardTransaction(t);s&&e.send&&s.makeResponse(this._tabster,t,this._owner,this._ownerUId,this,i,!1).then((s=>{const i={transaction:t.transaction,type:t.type,isResponse:!0,timestamp:Date.now(),owner:this._ownerUId,timeout:t.timeout,sentto:{},target:t.target===qe?qe:t.owner,endData:s};e.send(i)}))}},this._onPageHide=()=>{this._dead()},this._onBrowserMessage=e=>{if(e.source===this._owner())return;const t=t=>{e.source&&e.source.postMessage&&e.source.postMessage(JSON.stringify(t),"*")};try{this._onMessage({data:JSON.parse(e.data),send:t})}catch(e){}},this._tabster=e,this._owner=t,this._ownerUId=_e(t()),this.ctx=s}setup(e){return this.isSetUp||(this.isSetUp=!0,this.setSendUp(e),this._owner().addEventListener("pagehide",this._onPageHide),this._ping()),this._onMessage}setSendUp(e){if(!this.isSetUp)throw new Error("CrossOrigin is not set up.");this.sendUp=e||void 0;const t=this._owner();return void 0===e?this._isDefaultSendUp||t.document&&(this._isDefaultSendUp=!0,t.parent&&t.parent!==t&&t.parent.postMessage&&(this.sendUp=e=>{t.parent.postMessage(JSON.stringify(e),"*")}),t.addEventListener("message",this._onBrowserMessage)):this._isDefaultSendUp&&(t.removeEventListener("message",this._onBrowserMessage),this._isDefaultSendUp=!1),this._onMessage}async dispose(){const e=this._owner();this._pingTimer&&(e.clearTimeout(this._pingTimer),this._pingTimer=void 0),e.removeEventListener("message",this._onBrowserMessage),e.removeEventListener("pagehide",this._onPageHide),await this._dead(),delete this._deadPromise;for(const t of Object.keys(this._transactions)){const s=this._transactions[t];s.timer&&(e.clearTimeout(s.timer),delete s.timer),s.transaction.end()}this._knownTargets={},delete this.sendUp}beginTransaction(e,t,s,i,o,n){if(!this._owner)return be(this._owner).reject();const r=new e(this._tabster,this._owner,this._knownTargets,t,s,i,o,this.sendUp);let a;return e.shouldSelfRespond&&e.shouldSelfRespond(this._tabster,t,this._owner,this._ownerUId)&&(a=t=>e.makeResponse(this._tabster,t,this._owner,this._ownerUId,this,be(this._owner).resolve(void 0),!0)),this._beginTransaction(r,s,a,n)}removeTarget(e){delete this._knownTargets[e]}_beginTransaction(e,t,s,i){const o=this._owner(),n={transaction:e,timer:o.setTimeout((()=>{delete n.timer,e.end("Cross origin transaction timed out.")}),1500+(t||0))};this._transactions[e.id]=n;const r=e.begin(s);return r.catch((()=>{})).finally((()=>{n.timer&&o.clearTimeout(n.timer),delete this._transactions[e.id]})),r.then((e=>e),i?void 0:()=>{})}forwardTransaction(e){const t=this._owner;let s=e.target;if(s===this._ownerUId)return be(t).resolve();const i=this._getTransactionClass(e.type);if(i){if(void 0===i.shouldForward||i.shouldForward(this._tabster,e,t,this._ownerUId)){const o=e.sentto;return s===qe&&(s=void 0,o[this._ownerUId]=!0),delete o[qe],this._beginTransaction(new i(this._tabster,t,this._knownTargets,e.beginData,e.timeout,o,s,this.sendUp),e.timeout)}return be(t).resolve()}return be(t).reject(`Unknown transaction type ${e.type}`)}_getTransactionClass(e){switch(e){case He:return tt;case Ge:return st;case $e:return ct;case Je:return ut;case Qe:return dt;case Ye:return ht;default:return null}}async _dead(){this._deadPromise||this.ctx.focusOwner!==this._ownerUId||(this._deadPromise=this.beginTransaction(ct,{ownerUId:this._ownerUId,state:rt})),this._deadPromise&&await this._deadPromise}async _ping(){if(this._pingTimer)return;let e;const t=Date.now(),s=Object.keys(this._knownTargets).filter((e=>t-(this._knownTargets[e].last||0)>3e3));if(this.sendUp&&s.push(qe),s.length&&await be(this._owner).all(s.map((t=>this.beginTransaction(ht,void 0,void 0,void 0,t,!0).then((()=>!0),(()=>(t!==qe&&(e||(e={}),e[t]=!0,delete this._knownTargets[t]),!1)))))),e){if(!await this.beginTransaction(ut,void 0)&&this.ctx.focusOwner&&this.ctx.focusOwner in e){await this.beginTransaction(ct,{ownerUId:this._ownerUId,state:ot,force:!0});const e=this._tabster.deloser;e&&Ve.forceRestoreFocus(e)}}this._pingTimer=this._owner().setTimeout((()=>{this._pingTimer=void 0,this._ping()}),3e3)}}class mt{constructor(e,t,s,i,o,n,r){this._tabster=e,this.uid=t,this.ownerId=s,this.id=i,this.rootId=o,this.observedName=n,this.observedDetails=r}focus(e,t){return this._tabster.crossOrigin.focusedElement.focus(this,e,t)}}class ft extends je{constructor(e){super(),this._transactions=e}async focus(e,t,s){return this._focus({uid:e.uid,id:e.id,rootId:e.rootId,ownerId:e.ownerId,observedName:e.observedName},t,s)}async focusById(e,t,s,i){return this._focus({id:e,rootId:t},s,i)}async focusByObservedName(e,t,s,i,o){return this._focus({observedName:e,rootId:s},i,o,t)}async _focus(e,t,s,i){return this._transactions.beginTransaction(st,{...e,noFocusedProgrammaticallyFlag:t,noAccessibleCheck:s},i).then((e=>!!e))}static setVal(e,t,s){e.setVal(t,s)}}class vt extends je{constructor(e,t){super(),this._lastRequestFocusId=0,this._tabster=e,this._transactions=t}async getElement(e,t){return this.waitElement(e,0,t)}async waitElement(e,t,s){return this._transactions.beginTransaction(ut,{observedName:e,accessibility:s},t).then((e=>e?ct.createElement(this._tabster,e):null))}async requestFocus(e,t){const s=++this._lastRequestFocusId;return this.waitElement(e,t,l.Focusable).then((e=>!(this._lastRequestFocusId!==s||!e)&&this._tabster.crossOrigin.focusedElement.focus(e,!0)))}static trigger(e,t,s){e.trigger(t,s)}}class bt{constructor(e){this._init=()=>{const e=this._tabster;e.keyboardNavigation.subscribe(this._onKeyboardNavigationStateChanged),e.focusedElement.subscribe(this._onFocus),e.observedElement.subscribe(this._onObserved),this._ctx.origOutlineSetup||(this._ctx.origOutlineSetup=e.outline.setup,e.outline.setup=this._outlineSetup),this._transactions.beginTransaction(tt,void 0,void 0,void 0,qe).then((e=>{e&&this._tabster.keyboardNavigation.isNavigatingWithKeyboard()!==e.isNavigatingWithKeyboard&&(this._ctx.ignoreKeyboardNavigationStateUpdate=!0,this._tabster.keyboardNavigation.setNavigatingWithKeyboard(e.isNavigatingWithKeyboard),this._ctx.ignoreKeyboardNavigationStateUpdate=!1)}))},this._onKeyboardNavigationStateChanged=e=>{this._ctx.ignoreKeyboardNavigationStateUpdate||this._transactions.beginTransaction(ct,{state:at,ownerUId:_e(this._win()),isNavigatingWithKeyboard:e})},this._onFocus=e=>{const t=this._win(),s=_e(t);this._blurTimer&&(t.clearTimeout(this._blurTimer),this._blurTimer=void 0),e?this._transactions.beginTransaction(ct,{...ut.getElementData(this._tabster,e,this._win,this._ctx,s),state:it}):this._blurTimer=t.setTimeout((()=>{this._blurTimer=void 0,this._ctx.focusOwner&&this._ctx.focusOwner===s&&this._transactions.beginTransaction(ut,void 0).then((e=>{e||this._ctx.focusOwner!==s||this._transactions.beginTransaction(ct,{ownerUId:s,state:ot,force:!1})}))}),0)},this._onObserved=(e,t)=>{var s;const i=ut.getElementData(this._tabster,e,this._win,this._ctx,_e(this._win()));i.state=nt,i.observedName=null===(s=t.names)||void 0===s?void 0:s[0],i.observedDetails=t.details,this._transactions.beginTransaction(ct,i)},this._outlineSetup=e=>{this._transactions.beginTransaction(ct,{state:lt,ownerUId:_e(this._win()),outline:e})},this._tabster=e,this._win=e.getWindow,this._ctx={ignoreKeyboardNavigationStateUpdate:!1,deloserByUId:{}},this._transactions=new _t(e,this._win,this._ctx),this.focusedElement=new ft(this._transactions),this.observedElement=new vt(e,this._transactions)}setup(e){return this.isSetUp()?this._transactions.setSendUp(e):(this._tabster.queueInit(this._init),this._transactions.setup(e))}isSetUp(){return this._transactions.isSetUp}dispose(){var e;const t=this._tabster;t.keyboardNavigation.unsubscribe(this._onKeyboardNavigationStateChanged),t.focusedElement.unsubscribe(this._onFocus),null===(e=t.observedElement)||void 0===e||e.unsubscribe(this._onObserved),this._transactions.dispose(),this.focusedElement.dispose(),this.observedElement.dispose(),this._ctx.deloserByUId={}}}function gt(e,t,s){const i=s.getElement();if(i){const o=he(e,i);return t.deloserByUId[o]||(t.deloserByUId[o]=s),o}}class pt{constructor(e){this._tabster=e}dispose(){}getProps(e){const t=p(this._tabster,e);return t&&t.focusable||{}}isFocusable(e,t,s,i){return!(!ve(e,r)||!t&&-1===e.tabIndex)&&((s||this.isVisible(e))&&(i||this.isAccessible(e)))}isVisible(e){if(!e.ownerDocument||e.nodeType!==Node.ELEMENT_NODE)return!1;if(Ne(e))return!1;const t=e.ownerDocument.body.getBoundingClientRect();return 0!==t.width||0!==t.height}isAccessible(e){var t;for(let s=e;s;s=Y.getParentElement(s)){const e=p(this._tabster,s);if(this._isHidden(s))return!1;if(!(null===(t=null==e?void 0:e.focusable)||void 0===t?void 0:t.ignoreAriaDisabled)&&this._isDisabled(s))return!1}return!0}_isDisabled(e){return e.hasAttribute("disabled")}_isHidden(e){var t;const s=e.getAttribute("aria-hidden");return!(!s||"true"!==s.toLowerCase()||(null===(t=this._tabster.modalizer)||void 0===t?void 0:t.isAugmented(e)))}findFirst(e,t){return this.findElement({...e},t)}findLast(e,t){return this.findElement({isBackward:!0,...e},t)}findNext(e,t){return this.findElement({...e},t)}findPrev(e,t){return this.findElement({...e,isBackward:!0},t)}findDefault(e,t){return this.findElement({...e,acceptCondition:t=>this.isFocusable(t,e.includeProgrammaticallyFocusable)&&!!this.getProps(t).isDefault},t)||null}findAll(e){return this._findElements(!0,e)||[]}findElement(e,t){const s=this._findElements(!1,e,t);return s?s[0]:s}_findElements(e,t,s){var i,o,n;const{container:r,currentElement:a=null,includeProgrammaticallyFocusable:l,useActiveModalizer:c,ignoreAccessibility:u,modalizerId:d,isBackward:h,onElement:_}=t;s||(s={});const m=[];let{acceptCondition:f}=t;const v=!!f;if(!r)return null;f||(f=e=>this.isFocusable(e,l,!1,u));const b={container:r,modalizerUserId:void 0===d&&c?null===(i=this._tabster.modalizer)||void 0===i?void 0:i.activeId:d||(null===(n=null===(o=Pe.getTabsterContext(this._tabster,r))||void 0===o?void 0:o.modalizer)||void 0===n?void 0:n.userId),from:a||r,isBackward:h,acceptCondition:f,hasCustomCondition:v,includeProgrammaticallyFocusable:l,ignoreAccessibility:u,cachedGrouppers:{}},g=re(r.ownerDocument,r,(e=>this._acceptElement(e,b)));if(!g)return null;const p=t=>{var i,o;const n=null!==(i=b.foundElement)&&void 0!==i?i:b.foundBackward;return n&&m.push(n),e?!(n&&(b.found=!1,delete b.foundElement,delete b.foundBackward,delete b.fromCtx,b.from=n,_&&!_(n)))&&!(!n&&!t):(n&&s&&(s.uncontrolled=null===(o=Pe.getTabsterContext(this._tabster,n))||void 0===o?void 0:o.uncontrolled),!(!t||n))};if(a||(s.outOfDOMOrder=!0),a&&Y.nodeContains(r,a))g.currentNode=a;else if(h){const e=Oe(r);if(!e)return null;if(this._acceptElement(e,b)===NodeFilter.FILTER_ACCEPT&&!p(!0))return b.skippedFocusable&&(s.outOfDOMOrder=!0),m;g.currentNode=e}do{h?g.previousNode():g.nextNode()}while(p());return b.skippedFocusable&&(s.outOfDOMOrder=!0),m.length?m:null}_acceptElement(e,t){var s,i,o;if(t.found)return NodeFilter.FILTER_ACCEPT;const n=t.foundBackward;if(n&&(e===n||!Y.nodeContains(n,e)))return t.found=!0,t.foundElement=n,NodeFilter.FILTER_ACCEPT;const r=t.container;if(e===r)return NodeFilter.FILTER_SKIP;if(!Y.nodeContains(r,e))return NodeFilter.FILTER_REJECT;if(e.__tabsterDummyContainer)return NodeFilter.FILTER_REJECT;if(Y.nodeContains(t.rejectElementsFrom,e))return NodeFilter.FILTER_REJECT;const a=t.currentCtx=Pe.getTabsterContext(this._tabster,e);if(!a)return NodeFilter.FILTER_SKIP;if(ue(e))return this.isFocusable(e,void 0,!0,!0)&&(t.skippedFocusable=!0),NodeFilter.FILTER_SKIP;if(!t.hasCustomCondition&&("IFRAME"===e.tagName||"WEBVIEW"===e.tagName))return(null===(s=a.modalizer)||void 0===s?void 0:s.userId)===(null===(i=this._tabster.modalizer)||void 0===i?void 0:i.activeId)?(t.found=!0,t.rejectElementsFrom=t.foundElement=e,NodeFilter.FILTER_ACCEPT):NodeFilter.FILTER_REJECT;if(!t.ignoreAccessibility&&!this.isAccessible(e))return this.isFocusable(e,!1,!0,!0)&&(t.skippedFocusable=!0),NodeFilter.FILTER_REJECT;let l,c=t.fromCtx;c||(c=t.fromCtx=Pe.getTabsterContext(this._tabster,t.from));const u=null==c?void 0:c.mover;let d=a.groupper,h=a.mover;if(l=null===(o=this._tabster.modalizer)||void 0===o?void 0:o.acceptElement(e,t),void 0!==l&&(t.skippedFocusable=!0),void 0===l&&(d||h||u)){const s=null==d?void 0:d.getElement(),i=null==u?void 0:u.getElement();let o=null==h?void 0:h.getElement();o&&Y.nodeContains(i,o)&&Y.nodeContains(r,i)&&(!s||!h||Y.nodeContains(i,s))&&(h=u,o=i),!s||s!==r&&Y.nodeContains(r,s)||(d=void 0),o&&!Y.nodeContains(r,o)&&(h=void 0),d&&h&&(o&&s&&!Y.nodeContains(s,o)?h=void 0:d=void 0),d&&(l=d.acceptElement(e,t)),h&&(l=h.acceptElement(e,t))}return void 0===l&&(l=t.acceptCondition(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP,l===NodeFilter.FILTER_SKIP&&this.isFocusable(e,!1,!0,!0)&&(t.skippedFocusable=!0)),l!==NodeFilter.FILTER_ACCEPT||t.found||(t.isBackward?(t.foundBackward=e,l=NodeFilter.FILTER_SKIP):(t.found=!0,t.foundElement=e)),l}}const Et="Tab",yt="Enter",wt="Escape",Tt="PageUp",Ft="PageDown",It="End",Dt="Home",Ct="ArrowLeft",Ot="ArrowUp",kt="ArrowRight",Nt="ArrowDown";const Rt={[a.Restorer]:0,[a.Deloser]:1,[a.EscapeGroupper]:2};class At extends je{constructor(e,t){super(),this._init=()=>{const e=this._win(),t=e.document;t.addEventListener(i.PW,this._onFocusIn,!0),t.addEventListener(i.r$,this._onFocusOut,!0),e.addEventListener("keydown",this._onKeyDown,!0);const s=Y.getActiveElement(t);s&&s!==t.body&&this._setFocusedElement(s),this.subscribe(this._onChanged)},this._onFocusIn=e=>{const t=e.composedPath()[0];t&&this._setFocusedElement(t,e.detail.relatedTarget,e.detail.isFocusedProgrammatically)},this._onFocusOut=e=>{var t;this._setFocusedElement(void 0,null===(t=e.detail)||void 0===t?void 0:t.originalEvent.relatedTarget)},this._validateFocusedElement=e=>{},this._onKeyDown=e=>{if(e.key!==Et||e.ctrlKey)return;const t=this.getVal();if(!t||!t.ownerDocument||"true"===t.contentEditable)return;const s=this._tabster,o=s.controlTab,n=Pe.getTabsterContext(s,t);if(!n||n.ignoreKeydown(e))return;const r=e.shiftKey,a=At.findNextTabbable(s,n,void 0,t,void 0,r,!0),l=n.root.getElement();if(!l)return;const c=null==a?void 0:a.element,u=function(e,t){var s;const i=e.getParent;let o=t;do{const t=null===(s=p(e,o))||void 0===s?void 0:s.uncontrolled;if(t&&e.uncontrolled.isUncontrolledCompletely(o,!!t.completely))return o;o=i(o)}while(o)}(s,t);if(c){const d=a.uncontrolled;if(n.uncontrolled||Y.nodeContains(d,t)){if(!a.outOfDOMOrder&&d===n.uncontrolled||u&&!Y.nodeContains(u,c))return;return void Ie.addPhantomDummyWithTarget(s,t,r,c)}if(d||"IFRAME"===c.tagName)return void(l.dispatchEvent(new U({by:"root",owner:l,next:c,relatedEvent:e}))&&Ie.moveWithPhantomDummy(this._tabster,null!=d?d:c,!1,r,e));(o||(null==a?void 0:a.outOfDOMOrder))&&l.dispatchEvent(new U({by:"root",owner:l,next:c,relatedEvent:e}))&&(e.preventDefault(),e.stopImmediatePropagation(),(0,i.ev)(c))}else!u&&l.dispatchEvent(new U({by:"root",owner:l,next:null,relatedEvent:e}))&&n.root.moveOutWithDefaultAction(r,e)},this._onChanged=(e,t)=>{var s,i;if(e)e.dispatchEvent(new L(t));else{const e=null===(s=this._lastVal)||void 0===s?void 0:s.get();if(e){const s={...t},o=Pe.getTabsterContext(this._tabster,e),n=null===(i=null==o?void 0:o.modalizer)||void 0===i?void 0:i.userId;n&&(s.modalizerId=n),e.dispatchEvent(new W(s))}}},this._tabster=e,this._win=t,e.queueInit(this._init)}dispose(){super.dispose();const e=this._win(),t=e.document;t.removeEventListener(i.PW,this._onFocusIn,!0),t.removeEventListener(i.r$,this._onFocusOut,!0),e.removeEventListener("keydown",this._onKeyDown,!0),this.unsubscribe(this._onChanged);const s=this._asyncFocus;s&&(e.clearTimeout(s.timeout),delete this._asyncFocus),delete At._lastResetElement,delete this._nextVal,delete this._lastVal}static forgetMemorized(e,t){var s,i;let o=At._lastResetElement,n=o&&o.get();n&&Y.nodeContains(t,n)&&delete At._lastResetElement,n=null===(i=null===(s=e._nextVal)||void 0===s?void 0:s.element)||void 0===i?void 0:i.get(),n&&Y.nodeContains(t,n)&&delete e._nextVal,o=e._lastVal,n=o&&o.get(),n&&Y.nodeContains(t,n)&&delete e._lastVal}getFocusedElement(){return this.getVal()}getLastFocusedElement(){var e;let t=null===(e=this._lastVal)||void 0===e?void 0:e.get();return(!t||t&&!fe(t.ownerDocument,t))&&(this._lastVal=t=void 0),t}focus(e,t,s){return!!this._tabster.focusable.isFocusable(e,t,!1,s)&&(e.focus(),!0)}focusDefault(e){const t=this._tabster.focusable.findDefault({container:e});return!!t&&(this._tabster.focusedElement.focus(t),!0)}getFirstOrLastTabbable(e,t){var s;const{container:i,ignoreAccessibility:o}=t;let n;if(i){const t=Pe.getTabsterContext(this._tabster,i);t&&(n=null===(s=At.findNextTabbable(this._tabster,t,i,void 0,void 0,!e,o))||void 0===s?void 0:s.element)}return n&&!Y.nodeContains(i,n)&&(n=void 0),n||void 0}_focusFirstOrLast(e,t){const s=this.getFirstOrLastTabbable(e,t);return!!s&&(this.focus(s,!1,!0),!0)}focusFirst(e){return this._focusFirstOrLast(!0,e)}focusLast(e){return this._focusFirstOrLast(!1,e)}resetFocus(e){if(!this._tabster.focusable.isVisible(e))return!1;if(this._tabster.focusable.isFocusable(e,!0,!0,!0))this.focus(e);else{const t=e.getAttribute("tabindex"),s=e.getAttribute("aria-hidden");e.tabIndex=-1,e.setAttribute("aria-hidden","true"),At._lastResetElement=new ie(this._win,e),this.focus(e,!0,!0),this._setOrRemoveAttribute(e,"tabindex",t),this._setOrRemoveAttribute(e,"aria-hidden",s)}return!0}requestAsyncFocus(e,t,s){const i=this._tabster.getWindow(),o=this._asyncFocus;if(o){if(Rt[e]>Rt[o.source])return;i.clearTimeout(o.timeout)}this._asyncFocus={source:e,callback:t,timeout:i.setTimeout((()=>{this._asyncFocus=void 0,t()}),s)}}cancelAsyncFocus(e){const t=this._asyncFocus;(null==t?void 0:t.source)===e&&(this._tabster.getWindow().clearTimeout(t.timeout),this._asyncFocus=void 0)}_setOrRemoveAttribute(e,t,s){null===s?e.removeAttribute(t):e.setAttribute(t,s)}_setFocusedElement(e,t,s){var i,o;if(this._tabster._noop)return;const n={relatedTarget:t};if(e){const t=null===(i=At._lastResetElement)||void 0===i?void 0:i.get();if(At._lastResetElement=void 0,t===e||ue(e))return;n.isFocusedProgrammatically=s;const r=Pe.getTabsterContext(this._tabster,e),a=null===(o=null==r?void 0:r.modalizer)||void 0===o?void 0:o.userId;a&&(n.modalizerId=a)}const r=this._nextVal={element:e?new ie(this._win,e):void 0,detail:n};e&&e!==this._val&&this._validateFocusedElement(e),this._nextVal===r&&this.setVal(e,n),this._nextVal=void 0}setVal(e,t){super.setVal(e,t),e&&(this._lastVal=new ie(this._win,e))}static findNextTabbable(e,t,s,i,o,n,r){const a=s||t.root.getElement();if(!a)return null;let l=null;const c=At._isTabbingTimer,u=e.getWindow();c&&u.clearTimeout(c),At.isTabbing=!0,At._isTabbingTimer=u.setTimeout((()=>{delete At._isTabbingTimer,At.isTabbing=!1}),0);const d=t.modalizer,h=t.groupper,_=t.mover,m=t=>{if(l=t.findNextTabbable(i,o,n,r),i&&!(null==l?void 0:l.element)){const o=t!==d&&Y.getParentElement(t.getElement());if(o){const a=Pe.getTabsterContext(e,i,{referenceElement:o});if(a){const i=t.getElement(),c=n?i:i&&Oe(i)||i;c&&(l=At.findNextTabbable(e,a,s,c,o,n,r),l&&(l.outOfDOMOrder=!0))}}}};if(h&&_)m(t.groupperBeforeMover?h:_);else if(h)m(h);else if(_)m(_);else if(d)m(d);else{const t={container:a,currentElement:i,referenceElement:o,ignoreAccessibility:r,useActiveModalizer:!0},s={},c=e.focusable[n?"findPrev":"findNext"](t,s);l={element:c,outOfDOMOrder:s.outOfDOMOrder,uncontrolled:s.uncontrolled}}return l}}At.isTabbing=!1;class Mt extends Ie{constructor(e,t,s,o){super(s,e,Fe,o,!0),this._setHandlers(((o,n,r)=>{var a,l;const c=e.get(),u=o.input;if(c&&u){const e=Pe.getTabsterContext(s,u);if(e){let d;d=null===(a=t.findNextTabbable(r||void 0,void 0,n,!0))||void 0===a?void 0:a.element,d||(d=null===(l=At.findNextTabbable(s,e,void 0,o.isOutside?u:function(e,t){let s=e,i=null;for(;s&&!i;)i=t?Y.getPreviousElementSibling(s):Y.getNextElementSibling(s),s=Y.getParentElement(s);return i||void 0}(c,!n),void 0,n,!0))||void 0===l?void 0:l.element),d&&(0,i.ev)(d)}}}))}}class xt extends pe{constructor(e,t,s,i,o){super(e,t,i),this._shouldTabInside=!1,this.makeTabbable(!1),this._onDispose=s,e.controlTab||(this.dummyManager=new Mt(this._element,this,e,o))}dispose(){var e;this._onDispose(this);this._element.get();null===(e=this.dummyManager)||void 0===e||e.dispose(),delete this.dummyManager,delete this._first}findNextTabbable(e,t,s,i){var o;const n=this.getElement();if(!n)return null;const r=(null===(o=null==e?void 0:e.__tabsterDummyContainer)||void 0===o?void 0:o.get())===n;if(!this._shouldTabInside&&e&&Y.nodeContains(n,e)&&!r)return{element:void 0,outOfDOMOrder:!0};const a=this.getFirst(!0);if(!e||!Y.nodeContains(n,e)||r)return{element:a,outOfDOMOrder:!0};const l=this._tabster;let c,u=null,d=!1;if(this._shouldTabInside&&a){const o={container:n,currentElement:e,referenceElement:t,ignoreAccessibility:i,useActiveModalizer:!0},r={};u=l.focusable[s?"findPrev":"findNext"](o,r),d=!!r.outOfDOMOrder,u||this._props.tabbability!==f.LimitedTrapFocus||(u=l.focusable[s?"findLast":"findFirst"]({container:n,ignoreAccessibility:i,useActiveModalizer:!0},r),d=!0),c=r.uncontrolled}return{element:u,uncontrolled:c,outOfDOMOrder:d}}makeTabbable(e){this._shouldTabInside=e||!this._props.tabbability}isActive(e){var t;const s=this.getElement()||null;let i=!0;for(let e=Y.getParentElement(s);e;e=Y.getParentElement(e)){const s=null===(t=p(this._tabster,e))||void 0===t?void 0:t.groupper;s&&(s._shouldTabInside||(i=!1))}let o=i?!!this._props.tabbability&&this._shouldTabInside:void 0;if(o&&e){const e=this._tabster.focusedElement.getFocusedElement();e&&(o=e!==this.getFirst(!0))}return o}getFirst(e){var t;const s=this.getElement();let i;if(s){if(e&&this._tabster.focusable.isFocusable(s))return s;i=null===(t=this._first)||void 0===t?void 0:t.get(),i||(i=this._tabster.focusable.findFirst({container:s,useActiveModalizer:!0})||void 0,i&&this.setFirst(i))}return i}setFirst(e){e?this._first=new ie(this._tabster.getWindow,e):delete this._first}acceptElement(e,t){const s=t.cachedGrouppers,i=Y.getParentElement(this.getElement()),o=i&&Pe.getTabsterContext(this._tabster,i),n=null==o?void 0:o.groupper,r=(null==o?void 0:o.groupperBeforeMover)?n:void 0;let a;const l=e=>{let t,i=s[e.id];return i?t=i.isActive:(t=this.isActive(!0),i=s[e.id]={isActive:t}),t};if(r&&(a=r.getElement(),!l(r)&&a&&t.container!==a&&Y.nodeContains(t.container,a)))return t.skippedFocusable=!0,NodeFilter.FILTER_REJECT;const c=l(this),u=this.getElement();if(u&&!0!==c){if(u===e&&n&&(a||(a=n.getElement()),a&&!l(n)&&Y.nodeContains(t.container,a)&&a!==t.container))return t.skippedFocusable=!0,NodeFilter.FILTER_REJECT;if(u!==e&&Y.nodeContains(u,e))return t.skippedFocusable=!0,NodeFilter.FILTER_REJECT;const i=s[this.id];let o;if(o="first"in i?i.first:i.first=this.getFirst(!0),o&&t.acceptCondition(o))return t.rejectElementsFrom=u,t.skippedFocusable=!0,o!==t.from?(t.found=!0,t.foundElement=o,NodeFilter.FILTER_ACCEPT):NodeFilter.FILTER_REJECT}}}class Pt{constructor(e,t){this._current={},this._grouppers={},this._init=()=>{const e=this._win();this._tabster.focusedElement.subscribeFirst(this._onFocus);const t=e.document,s=Y.getActiveElement(t);s&&this._onFocus(s),t.addEventListener("mousedown",this._onMouseDown,!0),e.addEventListener("keydown",this._onKeyDown,!0),e.addEventListener(R,this._onMoveFocus)},this._onGroupperDispose=e=>{delete this._grouppers[e.id]},this._onFocus=e=>{e&&this._updateCurrent(e,!0,!0)},this._onMouseDown=e=>{e.target&&this._updateCurrent(e.target,!0)},this._onKeyDown=e=>{if(e.key!==yt&&e.key!==wt)return;if(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)return;const t=this._tabster.focusedElement.getFocusedElement();t&&this.handleKeyPress(t,e)},this._onMoveFocus=e=>{var t;const s=e.composedPath()[0],i=null===(t=e.detail)||void 0===t?void 0:t.action;s&&void 0!==i&&!e.defaultPrevented&&(i===v.Enter?this._enterGroupper(s):this._escapeGroupper(s),e.stopImmediatePropagation())},this._tabster=e,this._win=t,e.queueInit(this._init)}dispose(){const e=this._win();this._tabster.focusedElement.cancelAsyncFocus(a.EscapeGroupper),this._current={},this._updateTimer&&(e.clearTimeout(this._updateTimer),delete this._updateTimer),this._tabster.focusedElement.unsubscribe(this._onFocus),e.document.removeEventListener("mousedown",this._onMouseDown,!0),e.removeEventListener("keydown",this._onKeyDown,!0),e.removeEventListener(R,this._onMoveFocus),Object.keys(this._grouppers).forEach((e=>{this._grouppers[e]&&(this._grouppers[e].dispose(),delete this._grouppers[e])}))}createGroupper(e,t,s){const i=new xt(this._tabster,e,this._onGroupperDispose,t,s);this._grouppers[i.id]=i;const o=this._tabster.focusedElement.getFocusedElement();return o&&Y.nodeContains(e,o)&&!this._updateTimer&&(this._updateTimer=this._win().setTimeout((()=>{delete this._updateTimer,o===this._tabster.focusedElement.getFocusedElement()&&this._updateCurrent(o,!0,!0)}),0)),i}forgetCurrentGrouppers(){this._current={}}_updateCurrent(e,t,s){var i;this._updateTimer&&(this._win().clearTimeout(this._updateTimer),delete this._updateTimer);const o={};let n=!0;for(let r=e;r;r=Y.getParentElement(r)){const a=null===(i=p(this._tabster,r))||void 0===i?void 0:i.groupper;if(a){if(o[a.id]=!0,n&&s&&r!==e&&(n=!1),t||!n){this._current[a.id]=a;const t=a.isActive()||e!==r&&(!a.getProps().delegated||a.getFirst(!1)!==e);a.makeTabbable(t)}n=!1}}for(const e of Object.keys(this._current)){const t=this._current[e];t.id in o||(t.makeTabbable(!1),t.setFirst(void 0),delete this._current[e])}}_enterGroupper(e,t){const s=this._tabster,i=Pe.getTabsterContext(s,e),o=(null==i?void 0:i.groupper)||(null==i?void 0:i.modalizerInGroupper),n=null==o?void 0:o.getElement();if(o&&n&&(e===n||o.getProps().delegated&&e===o.getFirst(!1))){const i=s.focusable.findNext({container:n,currentElement:e,useActiveModalizer:!0});if(i&&(!t||t&&n.dispatchEvent(new U({by:"groupper",owner:n,next:i,relatedEvent:t}))))return t&&(t.preventDefault(),t.stopImmediatePropagation()),i.focus(),i}return null}_escapeGroupper(e,t,s){var i;const o=this._tabster,n=Pe.getTabsterContext(o,e),r=null==n?void 0:n.modalizerInGroupper;let a=(null==n?void 0:n.groupper)||r;const l=null==a?void 0:a.getElement();if(a&&l&&Y.nodeContains(l,e)){let n;if(e!==l||s)n=a.getFirst(!0);else{const e=Y.getParentElement(l),t=e?Pe.getTabsterContext(o,e):void 0;a=null==t?void 0:t.groupper,n=null==a?void 0:a.getFirst(!0)}if(n&&(!t||t&&l.dispatchEvent(new U({by:"groupper",owner:l,next:n,relatedEvent:t}))))return a&&(a.makeTabbable(!1),r&&(null===(i=o.modalizer)||void 0===i||i.setActive(void 0))),n.focus(),n}return null}moveFocus(e,t){return t===v.Enter?this._enterGroupper(e):this._escapeGroupper(e)}handleKeyPress(e,t,s){const i=this._tabster,o=Pe.getTabsterContext(i,e);if(o&&((null==o?void 0:o.groupper)||(null==o?void 0:o.modalizerInGroupper))){if(i.focusedElement.cancelAsyncFocus(a.EscapeGroupper),o.ignoreKeydown(t))return;if(t.key===yt)this._enterGroupper(e,t);else if(t.key===wt){const o=i.focusedElement.getFocusedElement();i.focusedElement.requestAsyncFocus(a.EscapeGroupper,(()=>{(o===i.focusedElement.getFocusedElement()||(!s||o)&&s)&&this._escapeGroupper(e,t,s)}),0)}}}}class St extends je{constructor(e){super(),this._onChange=e=>{this.setVal(e,void 0)},this._keyborg=(0,i.Vm)(e()),this._keyborg.subscribe(this._onChange)}dispose(){super.dispose(),this._keyborg&&(this._keyborg.unsubscribe(this._onChange),(0,i.ub)(this._keyborg),delete this._keyborg)}setNavigatingWithKeyboard(e){var t;null===(t=this._keyborg)||void 0===t||t.setVal(e)}isNavigatingWithKeyboard(){var e;return!!(null===(e=this._keyborg)||void 0===e?void 0:e.isNavigatingWithKeyboard())}}let Lt=0;const Wt="aria-hidden";class Ut extends Ie{constructor(e,t,s){super(t,e,we,s),this._setHandlers(((s,o)=>{var n,r,a;const l=e.get(),c=l&&(null===(n=Pe.getRoot(t,l))||void 0===n?void 0:n.getElement()),u=s.input;let d;if(c&&u){const e=null===(r=u.__tabsterDummyContainer)||void 0===r?void 0:r.get(),s=Pe.getTabsterContext(t,e||u);s&&(d=null===(a=At.findNextTabbable(t,s,c,u,void 0,o,!0))||void 0===a?void 0:a.element),d&&(0,i.ev)(d)}}))}}class zt extends pe{constructor(e,t,s,i,o,n){super(e,t,i),this._wasFocused=0,this.userId=i.id,this._onDispose=s,this._activeElements=n,e.controlTab||(this.dummyManager=new Ut(this._element,e,o))}makeActive(e){if(this._isActive!==e){this._isActive=e;const t=this.getElement();if(t){const s=this._activeElements,i=s.map((e=>e.get())).indexOf(t);e?i<0&&s.push(new ie(this._tabster.getWindow,t)):i>=0&&s.splice(i,1)}0,this._dispatchEvent(e)}}focused(e){return e||(this._wasFocused=++Lt),this._wasFocused}setProps(e){e.id&&(this.userId=e.id),this._props={...e}}dispose(){var e;this.makeActive(!1),this._onDispose(this),null===(e=this.dummyManager)||void 0===e||e.dispose(),delete this.dummyManager,this._activeElements=[],this._remove()}isActive(){return!!this._isActive}contains(e){return Y.nodeContains(this.getElement(),e)}findNextTabbable(e,t,s,i){var o,n;if(!this.getElement())return null;const r=this._tabster;let a,l=null,c=!1;const u=e&&(null===(o=Pe.getRoot(r,e))||void 0===o?void 0:o.getElement());if(u){const o={container:u,currentElement:e,referenceElement:t,ignoreAccessibility:i,useActiveModalizer:!0},d={};l=r.focusable[s?"findPrev":"findNext"](o,d),!l&&this._props.isTrapped&&(null===(n=r.modalizer)||void 0===n?void 0:n.activeId)?(l=r.focusable[s?"findLast":"findFirst"]({container:u,ignoreAccessibility:i,useActiveModalizer:!0},d),c=!0):c=!!d.outOfDOMOrder,a=d.uncontrolled}return{element:l,uncontrolled:a,outOfDOMOrder:c}}_dispatchEvent(e,t){const s=this.getElement();let i=!1;if(s){const o=t?this._activeElements.map((e=>e.get())):[s];for(const t of o)if(t){const o={id:this.userId,element:s},n=e?new j(o):new q(o);t.dispatchEvent(n),n.defaultPrevented&&(i=!0)}}return i}_remove(){0}}class Bt{constructor(e,t,s){this._onModalizerDispose=e=>{const t=e.id,s=e.userId,i=this._parts[s];delete this._modalizers[t],i&&(delete i[t],0===Object.keys(i).length&&(delete this._parts[s],this.activeId===s&&this.setActive(void 0)))},this._onKeyDown=e=>{var t;if(e.key!==wt)return;const s=this._tabster,i=s.focusedElement.getFocusedElement();if(i){const o=Pe.getTabsterContext(s,i),n=null==o?void 0:o.modalizer;if(o&&!o.groupper&&(null==n?void 0:n.isActive())&&!o.ignoreKeydown(e)){const i=n.userId;if(i){const o=this._parts[i];if(o){const i=Object.keys(o).map((e=>{var t;const s=o[e],i=s.getElement();let n;return i&&(n=null===(t=p(this._tabster,i))||void 0===t?void 0:t.groupper),s&&i&&n?{el:i,focusedSince:s.focused(!0)}:{focusedSince:0}})).filter((e=>e.focusedSince>0)).sort(((e,t)=>e.focusedSince>t.focusedSince?-1:e.focusedSince<t.focusedSince?1:0));if(i.length){const o=i[0].el;o&&(null===(t=s.groupper)||void 0===t||t.handleKeyPress(o,e,!0))}}}}}},this._onFocus=(e,t)=>{var s,i;const o=e&&Pe.getTabsterContext(this._tabster,e);if(!o||!e)return;const n=this._augMap;for(let t=e;t;t=Y.getParentElement(t))n.has(t)&&(n.delete(t),ke(this._tabster,t,Wt));const r=o.modalizer;if(null===(i=r||(null===(s=p(this._tabster,e))||void 0===s?void 0:s.modalizer))||void 0===i||i.focused(),(null==r?void 0:r.userId)!==this.activeId)if(t.isFocusedProgrammatically||this.currentIsOthersAccessible||(null==r?void 0:r.getProps().isAlwaysAccessible))this.setActive(r);else{const t=this._win();t.clearTimeout(this._restoreModalizerFocusTimer),this._restoreModalizerFocusTimer=t.setTimeout((()=>this._restoreModalizerFocus(e)),100)}else this.currentIsOthersAccessible=null==r?void 0:r.getProps().isOthersAccessible},this._tabster=e,this._win=e.getWindow,this._modalizers={},this._parts={},this._augMap=new WeakMap,this._aug=[],this._alwaysAccessibleSelector=t,this._accessibleCheck=s,this.activeElements=[],e.controlTab||e.root.addDummyInputs();this._win().addEventListener("keydown",this._onKeyDown,!0),e.queueInit((()=>{this._tabster.focusedElement.subscribe(this._onFocus)}))}dispose(){const e=this._win();e.removeEventListener("keydown",this._onKeyDown,!0),Object.keys(this._modalizers).forEach((e=>{this._modalizers[e]&&(this._modalizers[e].dispose(),delete this._modalizers[e])})),e.clearTimeout(this._restoreModalizerFocusTimer),e.clearTimeout(this._hiddenUpdateTimer),this._parts={},delete this.activeId,this.activeElements=[],this._augMap=new WeakMap,this._aug=[],this._tabster.focusedElement.unsubscribe(this._onFocus)}createModalizer(e,t,s){var i;const o=new zt(this._tabster,e,this._onModalizerDispose,t,s,this.activeElements),n=o.id,r=t.id;this._modalizers[n]=o;let a=this._parts[r];return a||(a=this._parts[r]={}),a[n]=o,Y.nodeContains(e,null!==(i=this._tabster.focusedElement.getFocusedElement())&&void 0!==i?i:null)&&(r!==this.activeId?this.setActive(o):o.makeActive(!0)),o}isAugmented(e){return this._augMap.has(e)}hiddenUpdate(){this._hiddenUpdateTimer||(this._hiddenUpdateTimer=this._win().setTimeout((()=>{delete this._hiddenUpdateTimer,this._hiddenUpdate()}),250))}setActive(e){const t=null==e?void 0:e.userId,s=this.activeId;if(s!==t){if(this.activeId=t,s){const e=this._parts[s];if(e)for(const t of Object.keys(e))e[t].makeActive(!1)}if(t){const e=this._parts[t];if(e)for(const t of Object.keys(e))e[t].makeActive(!0)}this.currentIsOthersAccessible=null==e?void 0:e.getProps().isOthersAccessible,this.hiddenUpdate()}}focus(e,t,s){const i=Pe.getTabsterContext(this._tabster,e),o=null==i?void 0:i.modalizer;if(o){this.setActive(o);const e=o.getProps(),i=o.getElement();if(i){if(void 0===t&&(t=e.isNoFocusFirst),!t&&this._tabster.keyboardNavigation.isNavigatingWithKeyboard()&&this._tabster.focusedElement.focusFirst({container:i}))return!0;if(void 0===s&&(s=e.isNoFocusDefault),!s&&this._tabster.focusedElement.focusDefault(i))return!0;this._tabster.focusedElement.resetFocus(i)}}else 0;return!1}acceptElement(e,t){var s;const i=t.modalizerUserId,o=null===(s=t.currentCtx)||void 0===s?void 0:s.modalizer;if(i)for(const t of this.activeElements){const s=t.get();if(s&&(Y.nodeContains(e,s)||s===e))return NodeFilter.FILTER_SKIP}const n=i===(null==o?void 0:o.userId)||!i&&(null==o?void 0:o.getProps().isAlwaysAccessible)?void 0:NodeFilter.FILTER_SKIP;return void 0!==n&&(t.skippedFocusable=!0),n}_hiddenUpdate(){var e;const t=this._tabster,s=t.getWindow().document.body,i=this.activeId,o=this._parts,n=[],r=[],a=this._alwaysAccessibleSelector,l=a?Array.from(Y.querySelectorAll(s,a)):[],c=[];for(const e of Object.keys(o)){const t=o[e];for(const s of Object.keys(t)){const o=t[s],a=o.getElement(),u=o.getProps().isAlwaysAccessible;a&&(e===i?(c.push(a),this.currentIsOthersAccessible||n.push(a)):u?l.push(a):r.push(a))}}const u=this._augMap,d=n.length>0?[...n,...l]:void 0,h=[],_=new WeakMap,m=(e,s)=>{var i;const o=e.tagName;if("SCRIPT"===o||"STYLE"===o)return;let n=!1;u.has(e)?s?n=!0:(u.delete(e),ke(t,e,Wt)):s&&!(null===(i=this._accessibleCheck)||void 0===i?void 0:i.call(this,e,c))&&ke(t,e,Wt,"true")&&(u.set(e,!0),n=!0),n&&(h.push(new ie(t.getWindow,e)),_.set(e,!0))},f=e=>{for(let s=Y.getFirstElementChild(e);s;s=Y.getNextElementSibling(s)){let e=!1,i=!1,o=!1;if(d){const n=t.getParent(s);for(const t of d){if(s===t){e=!0;break}if(Y.nodeContains(s,t)){i=!0;break}Y.nodeContains(t,n)&&(o=!0)}i?f(s):e||o||m(s,!0)}else m(s,!1)}};d||l.forEach((e=>m(e,!1))),r.forEach((e=>m(e,!0))),s&&f(s),null===(e=this._aug)||void 0===e||e.map((e=>e.get())).forEach((e=>{e&&!_.get(e)&&m(e,!1)})),this._aug=h,this._augMap=_}_restoreModalizerFocus(e){const t=null==e?void 0:e.ownerDocument;if(!e||!t)return;const s=Pe.getTabsterContext(this._tabster,e),i=null==s?void 0:s.modalizer,o=this.activeId;if(!i&&!o||i&&o===i.userId)return;const n=null==s?void 0:s.root.getElement();if(n){let t=this._tabster.focusable.findFirst({container:n,useActiveModalizer:!0});if(t){if(e.compareDocumentPosition(t)&document.DOCUMENT_POSITION_PRECEDING&&(t=this._tabster.focusable.findLast({container:n,useActiveModalizer:!0}),!t))throw new Error("Something went wrong.");return void this._tabster.focusedElement.focus(t)}}e.blur()}}const Kt=["input","textarea","*[contenteditable]"].join(", ");class Vt extends Ie{constructor(e,t,s,o){super(t,e,Te,o),this._onFocusDummyInput=e=>{var t,s;const o=this._element.get(),n=e.input;if(o&&n){const r=Pe.getTabsterContext(this._tabster,o);let a;r&&(a=null===(t=At.findNextTabbable(this._tabster,r,void 0,n,void 0,!e.isFirst,!0))||void 0===t?void 0:t.element);const l=null===(s=this._getMemorized())||void 0===s?void 0:s.get();l&&(a=l),a&&(0,i.ev)(a)}},this._tabster=t,this._getMemorized=s,this._setHandlers(this._onFocusDummyInput)}}class jt extends pe{constructor(e,t,s,i,o){var n;super(e,t,i),this._visible={},this._onIntersection=e=>{for(const t of e){const e=t.target,s=he(this._win,e);let i,o=this._fullyVisible;if(t.intersectionRatio>=.25?(i=t.intersectionRatio>=.75?d.Visible:d.PartiallyVisible,i===d.Visible&&(o=s)):i=d.Invisible,this._visible[s]!==i){void 0===i?(delete this._visible[s],o===s&&delete this._fullyVisible):(this._visible[s]=i,this._fullyVisible=o);const t=this.getState(e);t&&e.dispatchEvent(new z(t))}}},this._win=e.getWindow,this.visibilityTolerance=null!==(n=i.visibilityTolerance)&&void 0!==n?n:.8,(this._props.trackState||this._props.visibilityAware)&&(this._intersectionObserver=new IntersectionObserver(this._onIntersection,{threshold:[0,.25,.5,.75,1]}),this._observeState()),this._onDispose=s;const r=()=>i.memorizeCurrent?this._current:void 0;e.controlTab||(this.dummyManager=new Vt(this._element,e,r,o))}dispose(){var e;this._onDispose(this),this._intersectionObserver&&(this._intersectionObserver.disconnect(),delete this._intersectionObserver),delete this._current,delete this._fullyVisible,delete this._allElements,delete this._updateQueue,this._unobserve&&(this._unobserve(),delete this._unobserve);const t=this._win();this._setCurrentTimer&&(t.clearTimeout(this._setCurrentTimer),delete this._setCurrentTimer),this._updateTimer&&(t.clearTimeout(this._updateTimer),delete this._updateTimer),null===(e=this.dummyManager)||void 0===e||e.dispose(),delete this.dummyManager}setCurrent(e){this._current=e?new ie(this._win,e):void 0,!this._props.trackState&&!this._props.visibilityAware||this._setCurrentTimer||(this._setCurrentTimer=this._win().setTimeout((()=>{var e;delete this._setCurrentTimer;const t=[];this._current!==this._prevCurrent&&(t.push(this._current),t.push(this._prevCurrent),this._prevCurrent=this._current);for(const s of t){const t=null==s?void 0:s.get();if(t&&(null===(e=this._allElements)||void 0===e?void 0:e.get(t))===this){const e=this._props;if(t&&(void 0!==e.visibilityAware||e.trackState)){const e=this.getState(t);e&&t.dispatchEvent(new z(e))}}}})))}getCurrent(){var e;return(null===(e=this._current)||void 0===e?void 0:e.get())||null}findNextTabbable(e,t,s,i){var o;const n=this.getElement(),r=n&&(null===(o=null==e?void 0:e.__tabsterDummyContainer)||void 0===o?void 0:o.get())===n;if(!n)return null;let a,l=null,c=!1;if(this._props.tabbable||r||e&&!Y.nodeContains(n,e)){const o={currentElement:e,referenceElement:t,container:n,ignoreAccessibility:i,useActiveModalizer:!0},r={};l=this._tabster.focusable[s?"findPrev":"findNext"](o,r),c=!!r.outOfDOMOrder,a=r.uncontrolled}return{element:l,uncontrolled:a,outOfDOMOrder:c}}acceptElement(e,t){var s,i,o;if(!At.isTabbing)return(null===(s=t.currentCtx)||void 0===s?void 0:s.excludedFromMover)?NodeFilter.FILTER_REJECT:void 0;const{memorizeCurrent:n,visibilityAware:r,hasDefault:a=!0}=this._props,l=this.getElement();if(l&&(n||r||a)&&(!Y.nodeContains(l,t.from)||(null===(i=t.from.__tabsterDummyContainer)||void 0===i?void 0:i.get())===l)){let e;if(n){const s=null===(o=this._current)||void 0===o?void 0:o.get();s&&t.acceptCondition(s)&&(e=s)}if(!e&&a&&(e=this._tabster.focusable.findDefault({container:l,useActiveModalizer:!0})),!e&&r&&(e=this._tabster.focusable.findElement({container:l,useActiveModalizer:!0,isBackward:t.isBackward,acceptCondition:e=>{var s;const i=he(this._win,e),o=this._visible[i];return l!==e&&!!(null===(s=this._allElements)||void 0===s?void 0:s.get(e))&&t.acceptCondition(e)&&(o===d.Visible||o===d.PartiallyVisible&&(r===d.PartiallyVisible||!this._fullyVisible))}})),e)return t.found=!0,t.foundElement=e,t.rejectElementsFrom=l,t.skippedFocusable=!0,NodeFilter.FILTER_ACCEPT}}_observeState(){const e=this.getElement();if(this._unobserve||!e||"undefined"==typeof MutationObserver)return;const t=this._win(),s=this._allElements=new WeakMap,i=this._tabster.focusable;let o=this._updateQueue=[];const n=Y.createMutationObserver((e=>{for(const t of e){const e=t.target,s=t.removedNodes,i=t.addedNodes;if("attributes"===t.type)"tabindex"===t.attributeName&&o.push({element:e,type:2});else{for(let e=0;e<s.length;e++)o.push({element:s[e],type:3});for(let e=0;e<i.length;e++)o.push({element:i[e],type:1})}}u()})),r=(e,t)=>{var i,o;const n=s.get(e);n&&t&&(null===(i=this._intersectionObserver)||void 0===i||i.unobserve(e),s.delete(e)),n||t||(s.set(e,this),null===(o=this._intersectionObserver)||void 0===o||o.observe(e))},a=e=>{const t=i.isFocusable(e);s.get(e)?t||r(e,!0):t&&r(e)},l=e=>{const{mover:s}=d(e);if(s&&s!==this){if(s.getElement()!==e||!i.isFocusable(e))return;r(e)}const o=re(t.document,e,(e=>{const{mover:t,groupper:s}=d(e);if(t&&t!==this)return NodeFilter.FILTER_REJECT;const o=null==s?void 0:s.getFirst(!0);return s&&s.getElement()!==e&&o&&o!==e?NodeFilter.FILTER_REJECT:(i.isFocusable(e)&&r(e),NodeFilter.FILTER_SKIP)}));if(o)for(o.currentNode=e;o.nextNode(););},c=e=>{s.get(e)&&r(e,!0);for(let t=Y.getFirstElementChild(e);t;t=Y.getNextElementSibling(t))c(t)},u=()=>{!this._updateTimer&&o.length&&(this._updateTimer=t.setTimeout((()=>{delete this._updateTimer;for(const{element:e,type:t}of o)switch(t){case 2:a(e);break;case 1:l(e);break;case 3:c(e)}o=this._updateQueue=[]}),0))},d=e=>{const t={};for(let s=e;s;s=Y.getParentElement(s)){const e=p(this._tabster,s);if(e&&(e.groupper&&!t.groupper&&(t.groupper=e.groupper),e.mover)){t.mover=e.mover;break}}return t};o.push({element:e,type:1}),u(),n.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["tabindex"]}),this._unobserve=()=>{n.disconnect()}}getState(e){const t=he(this._win,e);if(t in this._visible){const s=this._visible[t]||d.Invisible;return{isCurrent:this._current?this._current.get()===e:void 0,visibility:s}}}}class qt{constructor(e,t){this._init=()=>{const e=this._win();e.addEventListener("keydown",this._onKeyDown,!0),e.addEventListener(k,this._onMoveFocus),e.addEventListener(N,this._onMemorizedElement),this._tabster.focusedElement.subscribe(this._onFocus)},this._onMoverDispose=e=>{delete this._movers[e.id]},this._onFocus=e=>{var t;let s=e,i=e;for(let o=Y.getParentElement(e);o;o=Y.getParentElement(o)){const e=null===(t=p(this._tabster,o))||void 0===t?void 0:t.mover;e&&(e.setCurrent(i),s=void 0),!s&&this._tabster.focusable.isFocusable(o)&&(s=i=o)}},this._onKeyDown=async e=>{var t;if(this._ignoredInputTimer&&(this._win().clearTimeout(this._ignoredInputTimer),delete this._ignoredInputTimer),null===(t=this._ignoredInputResolve)||void 0===t||t.call(this,!1),e.ctrlKey||e.altKey||e.shiftKey||e.metaKey)return;const s=e.key;let i;if(s===Nt?i=m.ArrowDown:s===kt?i=m.ArrowRight:s===Ot?i=m.ArrowUp:s===Ct?i=m.ArrowLeft:s===Ft?i=m.PageDown:s===Tt?i=m.PageUp:s===Dt?i=m.Home:s===It&&(i=m.End),!i)return;const o=this._tabster.focusedElement.getFocusedElement();o&&!await this._isIgnoredInput(o,s)&&this._moveFocus(o,i,e)},this._onMoveFocus=e=>{var t;const s=e.composedPath()[0],i=null===(t=e.detail)||void 0===t?void 0:t.key;s&&void 0!==i&&!e.defaultPrevented&&(this._moveFocus(s,i),e.stopImmediatePropagation())},this._onMemorizedElement=e=>{var t;const s=e.composedPath()[0];let i=null===(t=e.detail)||void 0===t?void 0:t.memorizedElement;if(s){const t=Pe.getTabsterContext(this._tabster,s),o=null==t?void 0:t.mover;o&&(i&&!Y.nodeContains(o.getElement(),i)&&(i=void 0),o.setCurrent(i),e.stopImmediatePropagation())}},this._tabster=e,this._win=t,this._movers={},e.queueInit(this._init)}dispose(){var e;const t=this._win();this._tabster.focusedElement.unsubscribe(this._onFocus),null===(e=this._ignoredInputResolve)||void 0===e||e.call(this,!1),this._ignoredInputTimer&&(t.clearTimeout(this._ignoredInputTimer),delete this._ignoredInputTimer),t.removeEventListener("keydown",this._onKeyDown,!0),t.removeEventListener(k,this._onMoveFocus),t.removeEventListener(N,this._onMemorizedElement),Object.keys(this._movers).forEach((e=>{this._movers[e]&&(this._movers[e].dispose(),delete this._movers[e])}))}createMover(e,t,s){const i=new jt(this._tabster,e,this._onMoverDispose,t,s);return this._movers[i.id]=i,i}moveFocus(e,t){return this._moveFocus(e,t)}_moveFocus(e,t,s){var o,n;const r=this._tabster,a=Pe.getTabsterContext(r,e,{checkRtl:!0});if(!a||!a.mover||a.excludedFromMover||s&&a.ignoreKeydown(s))return null;const l=a.mover,c=l.getElement();if(a.groupperBeforeMover){const e=a.groupper;if(!e||e.isActive(!0))return null;for(let t=Y.getParentElement(e.getElement());t&&t!==c;t=Y.getParentElement(t))if(null===(n=null===(o=p(r,t))||void 0===o?void 0:o.groupper)||void 0===n?void 0:n.isActive(!0))return null}if(!c)return null;const u=r.focusable,d=l.getProps(),h=d.direction||_.Both,f=h===_.Both,v=f||h===_.Vertical,b=f||h===_.Horizontal,g=h===_.GridLinear,E=g||h===_.Grid,y=d.cyclic;let w,T,F,I=0,D=0;if(E&&(F=e.getBoundingClientRect(),I=Math.ceil(F.left),D=Math.floor(F.right)),a.rtl&&(t===m.ArrowRight?t=m.ArrowLeft:t===m.ArrowLeft&&(t=m.ArrowRight)),t===m.ArrowDown&&v||t===m.ArrowRight&&(b||E))if(w=u.findNext({currentElement:e,container:c,useActiveModalizer:!0}),w&&E){const e=Math.ceil(w.getBoundingClientRect().left);!g&&D>e&&(w=void 0)}else!w&&y&&(w=u.findFirst({container:c,useActiveModalizer:!0}));else if(t===m.ArrowUp&&v||t===m.ArrowLeft&&(b||E))if(w=u.findPrev({currentElement:e,container:c,useActiveModalizer:!0}),w&&E){const e=Math.floor(w.getBoundingClientRect().right);!g&&e>I&&(w=void 0)}else!w&&y&&(w=u.findLast({container:c,useActiveModalizer:!0}));else if(t===m.Home)E?u.findElement({container:c,currentElement:e,useActiveModalizer:!0,isBackward:!0,acceptCondition:t=>{var s;if(!u.isFocusable(t))return!1;const i=Math.ceil(null!==(s=t.getBoundingClientRect().left)&&void 0!==s?s:0);return t!==e&&I<=i||(w=t,!1)}}):w=u.findFirst({container:c,useActiveModalizer:!0});else if(t===m.End)E?u.findElement({container:c,currentElement:e,useActiveModalizer:!0,acceptCondition:t=>{var s;if(!u.isFocusable(t))return!1;const i=Math.ceil(null!==(s=t.getBoundingClientRect().left)&&void 0!==s?s:0);return t!==e&&I>=i||(w=t,!1)}}):w=u.findLast({container:c,useActiveModalizer:!0});else if(t===m.PageUp){if(u.findElement({currentElement:e,container:c,useActiveModalizer:!0,isBackward:!0,acceptCondition:e=>!!u.isFocusable(e)&&(!le(this._win,e,l.visibilityTolerance)||(w=e,!1))}),E&&w){const e=Math.ceil(w.getBoundingClientRect().left);u.findElement({currentElement:w,container:c,useActiveModalizer:!0,acceptCondition:t=>{if(!u.isFocusable(t))return!1;const s=Math.ceil(t.getBoundingClientRect().left);return I<s||e>=s||(w=t,!1)}})}T=!1}else if(t===m.PageDown){if(u.findElement({currentElement:e,container:c,useActiveModalizer:!0,acceptCondition:e=>!!u.isFocusable(e)&&(!le(this._win,e,l.visibilityTolerance)||(w=e,!1))}),E&&w){const e=Math.ceil(w.getBoundingClientRect().left);u.findElement({currentElement:w,container:c,useActiveModalizer:!0,isBackward:!0,acceptCondition:t=>{if(!u.isFocusable(t))return!1;const s=Math.ceil(t.getBoundingClientRect().left);return I>s||e<=s||(w=t,!1)}})}T=!0}else if(E){const s=t===m.ArrowUp,i=I,o=Math.ceil(F.top),n=D,r=Math.floor(F.bottom);let a,l,d=0;u.findAll({container:c,currentElement:e,isBackward:s,onElement:e=>{const t=e.getBoundingClientRect(),c=Math.ceil(t.left),u=Math.ceil(t.top),h=Math.floor(t.right),_=Math.floor(t.bottom);if(s&&o<_||!s&&r>u)return!0;const m=Math.ceil(Math.min(n,h))-Math.floor(Math.max(i,c)),f=Math.ceil(Math.min(n-i,h-c));if(m>0&&f>=m){const t=m/f;t>d&&(a=e,d=t)}else if(0===d){const t=function(e,t,s,i,o,n,r,a){const l=s<o?o-s:r<e?e-r:0,c=i<n?n-i:a<t?t-a:0;return 0===l?c:0===c?l:Math.sqrt(l*l+c*c)}(i,o,n,r,c,u,h,_);(void 0===l||t<l)&&(l=t,a=e)}else if(d>0)return!1;return!0}}),w=a}return w&&(!s||s&&c.dispatchEvent(new U({by:"mover",owner:c,next:w,relatedEvent:s})))?(void 0!==T&&function(e,t,s){const i=ce(t);if(i){const o=ae(e,i),n=t.getBoundingClientRect();i.scrollTop+=s?n.top-o.top:n.bottom-o.bottom}}(this._win,w,T),s&&(s.preventDefault(),s.stopImmediatePropagation()),(0,i.ev)(w),w):null}async _isIgnoredInput(e,t){if("true"===e.getAttribute("aria-expanded")&&e.hasAttribute("aria-activedescendant"))return!0;if(ve(e,Kt)){let s,i=0,o=0,n=0;if("INPUT"===e.tagName||"TEXTAREA"===e.tagName){const s=e.type,r=e.value;if(n=(r||"").length,"email"===s||"number"===s){if(n){const s=Y.getSelection(e);if(s){const e=s.toString().length,i=t===Ct||t===Ot;if(s.modify("extend",i?"backward":"forward","character"),e!==s.toString().length)return s.modify("extend",i?"forward":"backward","character"),!0;n=0}}}else{const t=e.selectionStart;if(null===t)return"hidden"===s;i=t||0,o=e.selectionEnd||0}}else"true"===e.contentEditable&&(s=new(be(this._win))((t=>{this._ignoredInputResolve=e=>{delete this._ignoredInputResolve,t(e)};const s=this._win();this._ignoredInputTimer&&s.clearTimeout(this._ignoredInputTimer);const{anchorNode:r,focusNode:a,anchorOffset:l,focusOffset:c}=Y.getSelection(e)||{};this._ignoredInputTimer=s.setTimeout((()=>{var t,s,u;delete this._ignoredInputTimer;const{anchorNode:d,focusNode:h,anchorOffset:_,focusOffset:m}=Y.getSelection(e)||{};if(d===r&&h===a&&_===l&&m===c){if(i=_||0,o=m||0,n=(null===(s=e.textContent)||void 0===s?void 0:s.length)||0,d&&h&&Y.nodeContains(e,d)&&Y.nodeContains(e,h)&&d!==e){let t=!1;const s=e=>{if(e===d)t=!0;else if(e===h)return!0;const n=e.textContent;if(n&&!Y.getFirstChild(e)){const e=n.length;t?h!==d&&(o+=e):(i+=e,o+=e)}let r=!1;for(let t=Y.getFirstChild(e);t&&!r;t=t.nextSibling)r=s(t);return r};s(e)}null===(u=this._ignoredInputResolve)||void 0===u||u.call(this,!0)}else null===(t=this._ignoredInputResolve)||void 0===t||t.call(this,!1)}),0)})));if(s&&!await s)return!0;if(i!==o)return!0;if(i>0&&(t===Ct||t===Ot||t===Dt))return!0;if(i<n&&(t===kt||t===Nt||t===It))return!0}return!1}}class Ht extends je{constructor(e){super(),this._waiting={},this._lastRequestFocusId=0,this._observedById={},this._observedByName={},this._currentRequestTimestamp=0,this._onFocus=e=>{if(e){const e=this._currentRequest;if(e){Date.now()-this._currentRequestTimestamp>=300&&(delete this._currentRequest,e.cancel())}}},this.onObservedElementUpdate=e=>{var t;const s=null===(t=p(this._tabster,e))||void 0===t?void 0:t.observed,i=he(this._win,e);let o=this._observedById[i];if(s&&fe(e.ownerDocument,e)){o||(o=this._observedById[i]={element:new ie(this._win,e)}),s.names.sort();const t=s.names,n=o.prevNames;this._isObservedNamesUpdated(t,n)&&(n&&n.forEach((e=>{const t=this._observedByName[e];t&&t[i]&&(Object.keys(t).length>1?delete t[i]:delete this._observedByName[e])})),o.prevNames=t),t.forEach((e=>{let t=this._observedByName[e];t||(t=this._observedByName[e]={}),t[i]=o,this._waitConditional(e)}))}else if(o){const e=o.prevNames;e&&e.forEach((e=>{const t=this._observedByName[e];t&&t[i]&&(Object.keys(t).length>1?delete t[i]:delete this._observedByName[e])})),delete this._observedById[i]}},this._tabster=e,this._win=e.getWindow,e.queueInit((()=>{this._tabster.focusedElement.subscribe(this._onFocus)}))}dispose(){this._tabster.focusedElement.unsubscribe(this._onFocus);for(const e of Object.keys(this._waiting))this._rejectWaiting(e);this._observedById={},this._observedByName={}}_rejectWaiting(e,t){const s=this._waiting[e];if(s){const i=this._win();s.timer&&i.clearTimeout(s.timer),s.conditionTimer&&i.clearTimeout(s.conditionTimer),!t&&s.reject?s.reject():t&&s.resolve&&s.resolve(null),delete this._waiting[e]}}_isObservedNamesUpdated(e,t){if(!t||e.length!==t.length)return!0;for(let s=0;s<e.length;++s)if(e[s]!==t[s])return!0;return!1}getElement(e,t){const s=this._observedByName[e];if(s)for(const e of Object.keys(s)){let i=s[e].element.get()||null;return i?(t===l.Accessible&&!this._tabster.focusable.isAccessible(i)||t===l.Focusable&&!this._tabster.focusable.isFocusable(i,!0))&&(i=null):(delete s[e],delete this._observedById[e]),i}return null}waitElement(e,t,s){const i=this.getElement(e,s);if(i)return{result:be(this._win).resolve(i),cancel:()=>{}};let o;o=s===l.Accessible?"a":s===l.Focusable?"f":"_";const n=o+e;let r=this._waiting[n];if(r&&r.request)return r.request;r=this._waiting[n]={timer:this._win().setTimeout((()=>{r.conditionTimer&&this._win().clearTimeout(r.conditionTimer),delete this._waiting[n],r.resolve&&r.resolve(null)}),t)};const a=new(be(this._win))(((e,t)=>{r.resolve=e,r.reject=t}));return r.request={result:a,cancel:()=>{this._rejectWaiting(n,!0)}},s&&this.getElement(e)&&this._waitConditional(e),r.request}requestFocus(e,t){const s=++this._lastRequestFocusId,i=this._currentRequest;i&&i.cancel();const o=this.waitElement(e,t,l.Focusable);return this._currentRequest=o,this._currentRequestTimestamp=Date.now(),o.result.finally((()=>{this._currentRequest===o&&delete this._currentRequest})),{result:o.result.then((e=>!(this._lastRequestFocusId!==s||!e)&&this._tabster.focusedElement.focus(e,!0))),cancel:()=>{o.cancel()}}}_waitConditional(e){const t="_"+e,s="a"+e,i="f"+e,o=this._waiting[t],n=this._waiting[s],r=this._waiting[i],a=this._win(),c=(t,s,i,o)=>{var n;const r=null===(n=p(this._tabster,t))||void 0===n?void 0:n.observed;r&&r.names.includes(e)&&(i.timer&&a.clearTimeout(i.timer),delete this._waiting[s],i.resolve&&i.resolve(t),this.trigger(t,{names:[e],details:r.details,accessibility:o}))};if(o){const s=this.getElement(e);s&&fe(s.ownerDocument,s)&&c(s,t,o,l.Any)}if(n&&!n.conditionTimer){const t=()=>{const i=this.getElement(e);i&&fe(i.ownerDocument,i)&&this._tabster.focusable.isAccessible(i)?c(i,s,n,l.Accessible):n.conditionTimer=a.setTimeout(t,100)};t()}if(r&&!r.conditionTimer){const t=()=>{const s=this.getElement(e);s&&fe(s.ownerDocument,s)&&this._tabster.focusable.isFocusable(s,!0)?c(s,i,r,l.Focusable):r.conditionTimer=a.setTimeout(t,100)};t()}}}const Gt={areaClass:"tabster-focus-outline-area",outlineClass:"tabster-focus-outline",outlineColor:"#ff4500",outlineWidth:2,zIndex:2147483647};let $t=Gt;class Jt{constructor(e,t,s,i){this.left=e,this.top=t,this.right=s,this.bottom=i}equalsTo(e){return this.left===e.left&&this.top===e.top&&this.right===e.right&&this.bottom===e.bottom}clone(){return new Jt(this.left,this.top,this.right,this.bottom)}}class Qt{constructor(e){this._isVisible=!1,this._allOutlineElements=[],this._init=()=>{this._tabster.keyboardNavigation.subscribe(this._onKeyboardNavigationStateChanged),this._tabster.focusedElement.subscribe(this._onFocus);const e=this._win();e.addEventListener("scroll",this._onScroll,!0),this._fullScreenEventName&&e.document.addEventListener(this._fullScreenEventName,this._onFullScreenChanged)},this._onFullScreenChanged=e=>{if(!this._fullScreenElementName||!e.target)return;const t=e.target.body||e.target,s=this._getDOM(t);if(t.ownerDocument&&s){const e=t.ownerDocument[this._fullScreenElementName];e?(e.appendChild(s.container),this._fullScreenElement=e):(t.ownerDocument.body.appendChild(s.container),this._fullScreenElement=void 0)}},this._onKeyboardNavigationStateChanged=()=>{this._onFocus(this._tabster.focusedElement.getFocusedElement())},this._onFocus=e=>{!this._updateElement(e)&&this._isVisible&&this._setVisibility(!1)},this._onScroll=e=>{this._outlinedElement&&Qt._isParentChild(e.target,this._outlinedElement)&&(this._curPos=void 0,this._setOutlinePosition())},this._tabster=e,this._win=e.getWindow,e.queueInit(this._init),"undefined"!=typeof document&&("onfullscreenchange"in document?(this._fullScreenEventName="fullscreenchange",this._fullScreenElementName="fullscreenElement"):"onwebkitfullscreenchange"in document?(this._fullScreenEventName="webkitfullscreenchange",this._fullScreenElementName="webkitFullscreenElement"):"onmozfullscreenchange"in document?(this._fullScreenEventName="mozfullscreenchange",this._fullScreenElementName="mozFullScreenElement"):"onmsfullscreenchange"in document&&(this._fullScreenEventName="msfullscreenchange",this._fullScreenElementName="msFullscreenElement"))}setup(e){$t={...$t,...e};const t=this._win();t.__tabsterOutline||(t.__tabsterOutline={}),t.__tabsterOutline.style||(t.__tabsterOutline.style=Yt(t.document,$t)),e&&e.areaClass?t.document.body.classList.remove(Gt.areaClass):t.document.body.classList.add(Gt.areaClass)}dispose(){const e=this._win();this._updateTimer&&(e.clearTimeout(this._updateTimer),this._updateTimer=void 0),this._tabster.keyboardNavigation.unsubscribe(this._onKeyboardNavigationStateChanged),this._tabster.focusedElement.unsubscribe(this._onFocus),e.removeEventListener("scroll",this._onScroll,!0),this._fullScreenEventName&&e.document.removeEventListener(this._fullScreenEventName,this._onFullScreenChanged),this._allOutlineElements.forEach((e=>this._removeDOM(e.container))),this._allOutlineElements=[],delete this._outlinedElement,delete this._curPos,delete this._curOutlineElements,delete this._fullScreenElement}_shouldShowCustomOutline(e){const t=p(this._tabster,e);if(t&&t.outline&&t.outline.isIgnored)return!1;for(let t=e;t;t=t.parentElement)if(t.classList&&t.classList.contains($t.areaClass))return!0;return!1}_updateElement(e){if(this._outlinedElement=void 0,this._updateTimer&&(this._win().clearTimeout(this._updateTimer),this._updateTimer=void 0),this._curPos=void 0,!this._tabster.keyboardNavigation.isNavigatingWithKeyboard())return!1;if(e){if("INPUT"===e.tagName){if(!(e.type in{button:!0,checkbox:!0,file:!0,image:!0,radio:!0,range:!0,reset:!0,submit:!0}))return!1}else if("TEXTAREA"===e.tagName||"true"===e.contentEditable||"IFRAME"===e.tagName)return!1;return!!this._shouldShowCustomOutline(e)&&(this._tabster.keyboardNavigation.isNavigatingWithKeyboard()&&(this._outlinedElement=e,this._updateOutline()),!0)}return!1}_updateOutline(){this._setOutlinePosition(),this._updateTimer&&(this._win().clearTimeout(this._updateTimer),this._updateTimer=void 0),this._outlinedElement&&(this._updateTimer=this._win().setTimeout((()=>{this._updateTimer=void 0,this._updateOutline()}),30))}_setVisibility(e){this._isVisible=e,this._curOutlineElements&&(e?this._curOutlineElements.container.classList.add(`${$t.outlineClass}_visible`):(this._curOutlineElements.container.classList.remove(`${$t.outlineClass}_visible`),this._curPos=void 0))}_setOutlinePosition(){if(!this._outlinedElement)return;let e=ae(this._win,this._outlinedElement);const t=new Jt(e.left,e.top,e.right,e.bottom);if(this._curPos&&t.equalsTo(this._curPos))return;const s=this._getDOM(this._outlinedElement),i=this._outlinedElement.ownerDocument&&this._outlinedElement.ownerDocument.defaultView;if(!s||!i)return;this._curOutlineElements!==s&&(this._setVisibility(!1),this._curOutlineElements=s),this._curPos=t;const o=t.clone();let n=!1,r=!1;const a=s.container,l=a&&a.ownerDocument&&a.ownerDocument.scrollingElement;if(!l)return;for(let t=this._outlinedElement.parentElement;t&&t.nodeType===Node.ELEMENT_NODE&&t!==this._fullScreenElement;t=t.parentElement){e=ae(this._win,t);const s=t.ownerDocument&&t.ownerDocument.defaultView;if(!s)return;const i=s.getComputedStyle(t),a=i.position;"absolute"===a?n=!0:"fixed"!==a&&"sticky"!==a||(r=!0),"visible"!==i.overflow&&((n||r)&&"hidden"!==i.overflow||(e.left>o.left&&(o.left=e.left),e.top>o.top&&(o.top=e.top),e.right<o.right&&(o.right=e.right),e.bottom<o.bottom&&(o.bottom=e.bottom)))}const c=ae(this._win,l),u=c.left+c.right,d=c.top+c.bottom,h=$t.outlineWidth;o.left=o.left>h?o.left-h:0,o.top=o.top>h?o.top-h:0,o.right=o.right<u-h?o.right+h:u,o.bottom=o.bottom<d-h?o.bottom+h:d;const _=o.right-o.left,m=o.bottom-o.top;if(_>2*h&&m>2*h){const e=s.left,t=s.top,n=s.right,l=s.bottom,c=this._fullScreenElement||r?0:i.pageXOffset,u=this._fullScreenElement||r?0:i.pageYOffset;a.style.position=r?"fixed":"absolute",a.style.background=$t.outlineColor,e.style.width=n.style.width=t.style.height=l.style.height=$t.outlineWidth+"px",e.style.left=t.style.left=l.style.left=o.left+c+"px",n.style.left=o.left+c+_-h+"px",e.style.top=n.style.top=t.style.top=o.top+u+"px",l.style.top=o.top+u+m-h+"px",e.style.height=n.style.height=m+"px",t.style.width=l.style.width=_+"px",this._setVisibility(!0)}else this._setVisibility(!1)}_getDOM(e){const t=e.ownerDocument,s=t&&t.defaultView;if(t&&s&&s.__tabsterOutline){if(s.__tabsterOutline.style||(s.__tabsterOutline.style=Yt(t,$t)),!s.__tabsterOutline.elements){const e={container:t.createElement("div"),left:t.createElement("div"),top:t.createElement("div"),right:t.createElement("div"),bottom:t.createElement("div")};e.container.className=$t.outlineClass,e.left.className=`${$t.outlineClass}__left`,e.top.className=`${$t.outlineClass}__top`,e.right.className=`${$t.outlineClass}__right`,e.bottom.className=`${$t.outlineClass}__bottom`,e.container.appendChild(e.left),e.container.appendChild(e.top),e.container.appendChild(e.right),e.container.appendChild(e.bottom),t.body.appendChild(e.container),s.__tabsterOutline.elements=e,this._allOutlineElements.push(e)}return s.__tabsterOutline.elements}}_removeDOM(e){const t=e.ownerDocument&&e.ownerDocument.defaultView,s=t&&t.__tabsterOutline;if(!s)return;s.style&&s.style.parentNode&&(s.style.parentNode.removeChild(s.style),delete s.style);const i=s&&s.elements;i&&(i.container.parentNode&&i.container.parentNode.removeChild(i.container),delete s.elements)}static _isParentChild(e,t){return t===e||!!(e.compareDocumentPosition(t)&document.DOCUMENT_POSITION_CONTAINED_BY)}}function Yt(e,t){const s=e.createElement("style");return s.type="text/css",s.appendChild(e.createTextNode(function(e){return`\n.${e.areaClass} *, .${e.areaClass} *:focus {\noutline: none !important;\n}\n\n.${e.outlineClass} {\ndisplay: none;\nposition: absolute;\nwidth: 0;\nheight: 0;\nleft: 0;\ntop: 0;\nz-index: ${e.zIndex};\n}\n\n.${e.outlineClass}.${e.outlineClass}_visible {\ndisplay: block;\n}\n\n.${e.outlineClass}__left,\n.${e.outlineClass}__top,\n.${e.outlineClass}__right,\n.${e.outlineClass}__bottom {\nposition: absolute;\nbackground: inherit;\n}`}(t))),e.head.appendChild(s),s}class Xt{constructor(e){this._isUncontrolledCompletely=e}isUncontrolledCompletely(e,t){var s;const i=null===(s=this._isUncontrolledCompletely)||void 0===s?void 0:s.call(this,e,t);return void 0===i?t:i}}class Zt extends pe{constructor(e,t,s){var i;if(super(e,t,s),this._hasFocus=!1,this._onFocusOut=e=>{var t;const s=null===(t=this._element)||void 0===t?void 0:t.get();s&&null===e.relatedTarget&&s.dispatchEvent(new G),s&&!Y.nodeContains(s,e.relatedTarget)&&(this._hasFocus=!1)},this._onFocusIn=()=>{this._hasFocus=!0},this._props.type===h.Source){const e=null===(i=this._element)||void 0===i?void 0:i.get();null==e||e.addEventListener("focusout",this._onFocusOut),null==e||e.addEventListener("focusin",this._onFocusIn),this._hasFocus=Y.nodeContains(e,e&&Y.getActiveElement(e.ownerDocument))}}dispose(){var e;if(this._props.type===h.Source){const t=null===(e=this._element)||void 0===e?void 0:e.get();if(null==t||t.removeEventListener("focusout",this._onFocusOut),null==t||t.removeEventListener("focusin",this._onFocusIn),this._hasFocus){this._tabster.getWindow().document.body.dispatchEvent(new G)}}}}class es{constructor(e){this._history=[],this._onRestoreFocus=e=>{this._focusedElementState.cancelAsyncFocus(a.Restorer);const t=e.composedPath()[0];t&&this._focusedElementState.requestAsyncFocus(a.Restorer,(()=>this._restoreFocus(t)),0)},this._onFocusIn=e=>{var t;if(!e)return;const s=p(this._tabster,e);(null===(t=null==s?void 0:s.restorer)||void 0===t?void 0:t.getProps().type)===h.Target&&this._addToHistory(e)},this._restoreFocus=e=>{var t;const s=this._getWindow().document;if(Y.getActiveElement(s)!==s.body)return;if(!this._keyboardNavState.isNavigatingWithKeyboard()&&Y.nodeContains(s.body,e))return;let i=this._history.pop();for(;i&&!Y.nodeContains(s.body,Y.getParentElement(i.get()));)i=this._history.pop();null===(t=null==i?void 0:i.get())||void 0===t||t.focus()},this._tabster=e,this._getWindow=e.getWindow,this._getWindow().addEventListener(A,this._onRestoreFocus),this._keyboardNavState=e.keyboardNavigation,this._focusedElementState=e.focusedElement,this._focusedElementState.subscribe(this._onFocusIn)}dispose(){const e=this._getWindow();this._focusedElementState.unsubscribe(this._onFocusIn),this._focusedElementState.cancelAsyncFocus(a.Restorer),e.removeEventListener(A,this._onRestoreFocus)}_addToHistory(e){var t;(null===(t=this._history[this._history.length-1])||void 0===t?void 0:t.get())!==e&&(this._history.length>10&&this._history.shift(),this._history.push(new ie(this._getWindow,e)))}createRestorer(e,t){const s=new Zt(this._tabster,e,t);return t.type===h.Target&&Y.getActiveElement(e.ownerDocument)===e&&this._addToHistory(e),s}}function ts(e,t){var s,i;if(!e||!t)return!1;let o=t;for(;o;){if(o===e)return!0;o="function"!=typeof o.assignedElements&&(null===(s=o.assignedSlot)||void 0===s?void 0:s.parentNode)?null===(i=o.assignedSlot)||void 0===i?void 0:i.parentNode:o.nodeType===document.DOCUMENT_FRAGMENT_NODE?o.host:o.parentNode}return!1}class ss{static _overrideAttachShadow(e){const t=e.Element.prototype.attachShadow;t.__origAttachShadow||(Element.prototype.attachShadow=function(e){const s=t.call(this,e);for(const e of ss._shadowObservers)e._addSubObserver(s);return s},Element.prototype.attachShadow.__origAttachShadow=t)}constructor(e){this._isObserving=!1,this._callbackWrapper=(e,t)=>{for(const t of e)if("childList"===t.type){const e=t.removedNodes,s=t.addedNodes;for(let t=0;t<e.length;t++)this._walkShadows(e[t],!0);for(let e=0;e<s.length;e++)this._walkShadows(s[e])}this._callback(e,t)},this._callback=e,this._observer=new MutationObserver(this._callbackWrapper),this._subObservers=new Map}_addSubObserver(e){if(this._options&&this._callback&&!this._subObservers.has(e)&&this._options.subtree&&ts(this._root,e)){const t=new MutationObserver(this._callbackWrapper);this._subObservers.set(e,t),this._isObserving&&t.observe(e,this._options),this._walkShadows(e)}}disconnect(){this._isObserving=!1,delete this._options,ss._shadowObservers.delete(this);for(const e of this._subObservers.values())e.disconnect();this._subObservers.clear(),this._observer.disconnect()}observe(e,t){const s=e.nodeType===Node.DOCUMENT_NODE?e:e.ownerDocument,i=null==s?void 0:s.defaultView;s&&i&&(ss._overrideAttachShadow(i),ss._shadowObservers.add(this),this._root=e,this._options=t,this._isObserving=!0,this._observer.observe(e,t),this._walkShadows(e))}_walkShadows(e,t){const s=e.nodeType===Node.DOCUMENT_NODE?e:e.ownerDocument;if(!s)return;if(e===s)e=s.body;else{const t=e.shadowRoot;if(t)return void this._addSubObserver(t)}s.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{if(e.nodeType===Node.ELEMENT_NODE)if(t){const t=this._subObservers.get(e);t&&(t.disconnect(),this._subObservers.delete(e))}else{const t=e.shadowRoot;t&&this._addSubObserver(t)}return NodeFilter.FILTER_SKIP}}).nextNode()}takeRecords(){const e=this._observer.takeRecords();for(const t of this._subObservers.values())e.push(...t.takeRecords());return e}}ss._shadowObservers=new Set;class is{constructor(e){this.keyboardNavigation=e.keyboardNavigation,this.focusedElement=e.focusedElement,this.focusable=e.focusable,this.root=e.root,this.uncontrolled=e.uncontrolled,this.core=e}}class os{constructor(e,t){var s,i;this._forgetMemorizedElements=[],this._wrappers=new Set,this._initQueue=[],this._version="7.0.1",this._noop=!1,this.getWindow=()=>{if(!this._win)throw new Error("Using disposed Tabster.");return this._win},this._storage=function(e){const t=e.__tabsterInstanceContext;return new((null==t?void 0:t.basics.WeakMap)||WeakMap)}(e),this._win=e;const n=this.getWindow;(null==t?void 0:t.DOMAPI)&&function(e){for(const t of Object.keys(e))Y[t]=e[t]}({...t.DOMAPI}),this.keyboardNavigation=new St(n),this.focusedElement=new At(this,n),this.focusable=new pt(this),this.root=new Pe(this,null==t?void 0:t.autoRoot),this.uncontrolled=new Xt((null==t?void 0:t.checkUncontrolledCompletely)||(null==t?void 0:t.checkUncontrolledTrappingFocus)),this.controlTab=null===(s=null==t?void 0:t.controlTab)||void 0===s||s,this.rootDummyInputs=!!(null==t?void 0:t.rootDummyInputs),this._dummyObserver=new De(n),this.getParent=null!==(i=null==t?void 0:t.getParent)&&void 0!==i?i:Y.getParentNode,this.internal={stopObserver:()=>{this._unobserve&&(this._unobserve(),delete this._unobserve)},resumeObserver:e=>{if(!this._unobserve){const t=n().document;this._unobserve=function(e,t,s,i){if("undefined"==typeof MutationObserver)return()=>{};const n=t.getWindow;let r;function a(t,s){r||(r=te(n).elementByUId),l(t,s);const i=re(e,t,(e=>l(e,s)));if(i)for(;i.nextNode(););}function l(e,i){var a;if(!e.getAttribute)return NodeFilter.FILTER_SKIP;const l=e.__tabsterElementUID;return l&&r&&(i?delete r[l]:null!==(a=r[l])&&void 0!==a||(r[l]=new ie(n,e))),(p(t,e)||e.hasAttribute(o))&&s(t,e,i),NodeFilter.FILTER_SKIP}const c=Y.createMutationObserver((e=>{var i,n,r,l,c;const u=new Set;for(const c of e){const e=c.target,d=c.removedNodes,h=c.addedNodes;if("attributes"===c.type)c.attributeName===o&&(u.has(e)||s(t,e));else{for(let s=0;s<d.length;s++){const o=d[s];u.add(o),a(o,!0),null===(n=(i=t._dummyObserver).domChanged)||void 0===n||n.call(i,e)}for(let s=0;s<h.length;s++)a(h[s]),null===(l=(r=t._dummyObserver).domChanged)||void 0===l||l.call(r,e)}}u.clear(),null===(c=t.modalizer)||void 0===c||c.hiddenUpdate()}));return i&&a(n().document.body),c.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:[o]}),()=>{c.disconnect()}}(t,this,E,e)}}},ne(n),this.queueInit((()=>{this.internal.resumeObserver(!0)}))}_mergeProps(e){var t;e&&(this.getParent=null!==(t=e.getParent)&&void 0!==t?t:this.getParent)}createTabster(e,t){const s=new is(this);return e||this._wrappers.add(s),this._mergeProps(t),s}disposeTabster(e,t){t?this._wrappers.clear():this._wrappers.delete(e),0===this._wrappers.size&&this.dispose()}dispose(){var e,t,s,i,o,n,r,a;this.internal.stopObserver();const l=this._win;null==l||l.clearTimeout(this._initTimer),delete this._initTimer,this._initQueue=[],this._forgetMemorizedElements=[],l&&this._forgetMemorizedTimer&&(l.clearTimeout(this._forgetMemorizedTimer),delete this._forgetMemorizedTimer),null===(e=this.outline)||void 0===e||e.dispose(),null===(t=this.crossOrigin)||void 0===t||t.dispose(),null===(s=this.deloser)||void 0===s||s.dispose(),null===(i=this.groupper)||void 0===i||i.dispose(),null===(o=this.mover)||void 0===o||o.dispose(),null===(n=this.modalizer)||void 0===n||n.dispose(),null===(r=this.observedElement)||void 0===r||r.dispose(),null===(a=this.restorer)||void 0===a||a.dispose(),this.keyboardNavigation.dispose(),this.focusable.dispose(),this.focusedElement.dispose(),this.root.dispose(),this._dummyObserver.dispose(),function(e){const t=te(e);t.fakeWeakRefsStarted=!1,t.fakeWeakRefsTimer&&(e().clearTimeout(t.fakeWeakRefsTimer),t.fakeWeakRefsTimer=void 0,t.fakeWeakRefs=[])}(this.getWindow),me(this.getWindow),this._storage=new WeakMap,this._wrappers.clear(),l&&(!function(e){const t=e.__tabsterInstanceContext;t&&(t.elementByUId={},delete t.WeakRef,t.containerBoundingRectCache={},t.containerBoundingRectCacheTimer&&e.clearTimeout(t.containerBoundingRectCacheTimer),t.fakeWeakRefsTimer&&e.clearTimeout(t.fakeWeakRefsTimer),t.fakeWeakRefs=[],delete e.__tabsterInstanceContext)}(l),delete l.__tabsterInstance,delete this._win)}storageEntry(e,t){const s=this._storage;let i=s.get(e);return i?!1===t&&0===Object.keys(i).length&&s.delete(e):!0===t&&(i={},s.set(e,i)),i}forceCleanup(){this._win&&(this._forgetMemorizedElements.push(this._win.document.body),this._forgetMemorizedTimer||(this._forgetMemorizedTimer=this._win.setTimeout((()=>{delete this._forgetMemorizedTimer;for(let e=this._forgetMemorizedElements.shift();e;e=this._forgetMemorizedElements.shift())me(this.getWindow,e),At.forgetMemorized(this.focusedElement,e)}),0),oe(this.getWindow,!0)))}queueInit(e){var t;this._win&&(this._initQueue.push(e),this._initTimer||(this._initTimer=null===(t=this._win)||void 0===t?void 0:t.setTimeout((()=>{delete this._initTimer,this.drainInitQueue()}),0)))}drainInitQueue(){if(!this._win)return;const e=this._initQueue;this._initQueue=[],e.forEach((e=>e()))}}function ns(e,t){let s=fs(e);return s?s.createTabster(!1,t):(s=new os(e,t),e.__tabsterInstance=s,s.createTabster())}function rs(e){const t=e.core;return t.groupper||(t.groupper=new Pt(t,t.getWindow)),t.groupper}function as(e){const t=e.core;return t.mover||(t.mover=new qt(t,t.getWindow)),t.mover}function ls(e){const t=e.core;return t.outline||(t.outline=new Qt(t)),t.outline}function cs(e,t){const s=e.core;return s.deloser||(s.deloser=new Ve(s,t)),s.deloser}function us(e,t,s){const i=e.core;return i.modalizer||(i.modalizer=new Bt(i,t,s)),i.modalizer}function ds(e){const t=e.core;return t.observedElement||(t.observedElement=new Ht(t)),t.observedElement}function hs(e){const t=e.core;return t.crossOrigin||(cs(e),us(e),as(e),rs(e),ls(e),ds(e),t.crossOrigin=new bt(t)),t.crossOrigin}function _s(e){const t=e.core;return t.restorer||(t.restorer=new es(t)),t.restorer}function ms(e,t){e.core.disposeTabster(e,t)}function fs(e){return e.__tabsterInstance}function vs(e,t){const s=e.core;if(s._noop!==t){s._noop=t;const e=e=>e.getAttribute?((p(s,e)||e.hasAttribute(o))&&E(s,e),NodeFilter.FILTER_SKIP):NodeFilter.FILTER_SKIP,i=s.getWindow().document,n=i.body;e(n);const r=re(i,n,e);if(r)for(;r.nextNode(););}}function bs(e,t){return e.dispatchEvent(new V({action:t}))}function gs(e,t){return e.dispatchEvent(new B({key:t}))}}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/14415-474489f6473d4711.js.map