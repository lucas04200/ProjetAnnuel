"use strict";(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[191366],{686219:(e,t,r)=>{r.d(t,{ab:()=>o,Xt:()=>n,vC:()=>i,fe:()=>s,su:()=>a,oz:()=>c,oq:()=>l,lO:()=>d,PH:()=>u,mR:()=>h});const o="com.microsoft.teams.corelayout",n="com.microsoft.teams.entitymoreinfo",i="com.microsoft.teams.notifications",s={show:"show",showWithoutFocusing:"showWithoutFocusing",hide:"hide",toggle:"toggle"},a={none:"none",flush:"flush",forceFlush:"forceFlush",flow:"flow",forceFlow:"forceFlow",new:"new",extend:"extend"};var c;!function(e){e.organization="organization",e.privacyManageVisibility="privacy_manage_visibility",e.linkedin="linkedin"}(c||(c={}));const l={Cancelled:"Cancelled",Closed:"Closed",Confirmed:"Confirmed",Error:"Error",Open:"Open"},d={minimal:"minimal",focus:"focus",standard:"standard",minimode:"minimode"};var u,h;!function(e){e.main="main"}(u||(u={})),function(e){e.header="header",e.midNav="midNav",e.subNav="subNav",e.contextualNotifications="contextualNotifications",e.end="end",e.nav="nav",e.main="main",e.start="start",e.titleBar="titleBar",e.toasts="toasts",e.notifications="notifications",e.monitor="monitor"}(h||(h={}))},742286:(e,t,r)=>{var o;r.d(t,{R:()=>o}),function(e){e.flyout="flyout",e.iFrame="iFrame",e.primary="primary",e.secondary="secondary",e.minimode="minimode"}(o||(o={}))},317876:(e,t,r)=>{var o;r.d(t,{W:()=>o}),function(e){e.WindowReady="windowReady",e.WindowUnloaded="windowUnloaded",e.WindowAppStart="windowAppStart",e.CoreInitialized="coreInitialized",e.CommandChangeType="commandEvent",e.ExperienceStarted="experienceStarted",e.CoreInitializationFailed="coreInitializationFailed",e.ExtendedEntityContainerState="extendedEntityContainerState",e.MainWindowBlockedState="mainWindowBlockedState"}(o||(o={}))},207689:(e,t,r)=>{var o,n,i,s;r.d(t,{QP:()=>o,d:()=>n,zF:()=>s}),function(e){e.standAlone="main",e.iframe="iFrame",e.secondary="MW",e.embedded="EDOM",e.worker="Worker"}(o||(o={})),function(e){e.flyout="flyout",e.main="main",e.minimode="mini",e.notifications="notifications"}(n||(n={})),function(e){e.owa="OWA",e.outlook="Outlook",e.officeOnline="OfficeOnline",e.wordWeb="WordWeb",e.word="Word",e.excelWeb="ExcelWeb",e.excel="Excel",e.powerPointWeb="PowerPointWeb",e.powerPoint="PowerPoint",e.lmsBlackBoard="BlackBoard",e.lmsCanvas="Canvas",e.lmsMoodle="Moodle",e.lmsBrightspace="Brightspace",e.lmsOther="OtherLMS",e.lmsOpenLMS="OpenLMS",e.lmsSchoology="Schoology",e.unknown="unknown",e.thirdParty="ThirdParty",e.dynamics="Dynamics",e.onePlayer="OnePlayer",e.devHost="DevHost",e.edge="Edge",e.purview="Purview"}(i||(i={})),function(e){e.userInitiated="userInitiated"}(s||(s={}))},898785:(e,t,r)=>{var o,n,i,s,a,c;r.d(t,{rY:()=>o,cr:()=>n,Gx:()=>i,H:()=>a,C3:()=>c}),function(e){e.ExpandTab="expandTab",e.UndoExpandTab="undoExpandTab",e.MaximizeTab="maximizeTab",e.UndoMaximizeTab="undoMaximizeTab",e.WindowInitialized="windowInitialized",e.WindowErrored="windowErrored",e.GetAadToken="aadGetToken",e.Login="login",e.GetDriveItemResponse="getDriveItemResponse",e.GetAadCurrentUser="aadCurrentUser",e.AadClearCacheForResource="aadClearCache",e.GetStateData="getStateData",e.GetLogs="getLogs",e.GetSettings="getSettings",e.TriggerAutoBrb="triggerAutoBrb",e.ShouldShowChatNotification="shouldShowChatNotification",e.GetLeaks="getLeaks",e.GetMemory="getMemory",e.UpdateWindowState="updateWindowState",e.AppStateSyncMessage="appStateSyncMessage",e.CentralDataLayerRequest="centralDataLayer:request",e.CentralDataLayerResponse="centralDataLayer:response",e.ScreenSharingControlMessage="screenSharing:controlMessage",e.HideFileViewerLoader="hideFileViewerLoader",e.StopDocStageScenario="stopDocStageScenario",e.AddScenarioMarker="addScenarioMarker",e.FilesExperienceSendData="filesExperience:sendData",e.FilesExperienceRequestData="filesExperience:requestData",e.ActivityEvent="activityEvent",e.GetAggregatedSettings="getAggregatedSettings",e.SetAggregatedSettings="setAggregatedSettings",e.GetWindowLaunchSubSteps="getWindowLaunchSubSteps",e.CreateWebview="createWebview",e.UnhandledMouseEvent="unhandledMouseEvent",e.GetHeartbeat="getHeartbeat",e.GetApolloCacheStats="getApolloCacheStats",e.GetCdlStats="getCdlStats",e.GetWindowEntityTypeStats="getWindowEntityTypeStats",e.SetTouchBar="set-touch-bar",e.ClearTouchBar="clear-touch-bar",e.LayoutChangeMessage="layoutChangeMessage",e.UnhandledShortcut="unhandledShortcut",e.NavigateToOpenerLandmark="NavigateToOpenerLandmark",e.NavigateToLandmark="NavigateToLandmark",e.HybridRouteNavigation="hybridRouteNavigation",e.FocusManagementEvent="focusManagementEvent",e.FocusResetEvent="focusResetEvent",e.CdlRegistration="cdlRegistration",e.NotificationBannerUpdate="NotificationBannerUpdate",e.EntityCommandTimedOutAtHost="entityCommandTimedOutAtHost",e.ActivateOutlook="activateOutlook",e.RequestTabMetrics="requestTabMetrics",e.SendWebviewIdentity="sendWebviewIdentity",e.HasDevicePermissions="hasDevicePermissions",e.HasDevicePermissionsCallback="hasDevicePermissionsCallback"}(o||(o={})),function(e){e.GlobalWindowError="error",e.UnhandledRejection="unhandledrejection"}(n||(n={})),function(e){e.Create="createIframe",e.Destroy="destroyIframe",e.ChildReady="iframeReady",e.Acquired="iframeAcquired",e.ToggleMinimized="toggleChatMinimize"}(i||(i={})),function(e){e.ConversationOpened="conversationOpened",e.CreateNewConversation="createNewConversation",e.EmbedClientInitializationSuccess="embedClientInitializationSuccess",e.EmbedClientInitializationFail="embedClientInitializationFail",e.NewConversationResolved="newConversationResolved",e.SetFocusOnChatList="setFocusOnChatList",e.UpdateSettings="UpdateSettings",e.ShowCoreIFrame="ShowCoreIFrame",e.HideCoreIFrame="HideCoreIFrame",e.TeamsPreAuthComplete="teamsPreAuthComplete",e.ContinueWithTeamsCoreTasks="continueWithTeamsCoreTasks"}(s||(s={})),function(e){e.LogoutSuccess="logoutSuccessful",e.LogoutFailed="logoutFailed",e.Logout="logout"}(a||(a={})),function(e){e.TrustedUIInit="trusted-ui:init",e.TrustedUIResize="trusted-ui:resize",e.TrustedUIRendered="trusted-ui:rendered",e.TrustedUIError="trusted-ui:error",e.TrustedUIShortcut="trusted-ui:shortcut"}(c||(c={}))},968687:(e,t,r)=>{r.d(t,{G:()=>n});var o=r(410969);class n extends Error{get extensions(){return this.getExtensions()}constructor({type:e,code:t,message:r,originSlotName:o,originAppId:n,prevError:i,userContextId:s}){super(r),this.type=e,this.code=t,this.originSlotName=o,this.originAppId=n,this.prevError=i,this.userContextId=s;const a=(c=i?.stack??this.stack,c?.split("\n").slice(1)??[]);var c;this.stack=[`${t} Error: ${r}`,...a].join("\n"),Object.setPrototypeOf(this,new.target.prototype)}static isFunction(e){return"function"==typeof e}getBoundaryProps(){return{title:`default_${this.type.toLowerCase()}_title`,description:`default_${this.type.toLowerCase()}_description`}}toTelemetryEntry(){let e=this.toTelemetryCode(),t=this.prevError;for(;t;)t instanceof n&&n.isFunction(t.toTelemetryEntry)?(e+=t.toTelemetryEntry(),t=void 0):(0,o.a)(t)?(e+=`[IError::${t.code}]`,t=t.innerError??t.reason?.innerError):(e+=`[Error::${t.message}]`,t=void 0);return e}toJSON(){return{type:this.type,code:this.code,stack:this.stack,userContextId:this.userContextId,prevError:this.prevError}}serialize(){const e=new WeakSet;return JSON.stringify(this,((t,r)=>{if("object"==typeof r&&null!==r){if(e.has(r))return;e.add(r)}return r}))}deserialize(e){this.stack=e.stack}toTelemetryCode(){return`[${this.type}::${this.code}]`}getExtensions(){return{type:this.type,code:this.code,prevError:this.prevError,boundaryProps:this.getBoundaryProps()}}}},692588:(e,t,r)=>{r.d(t,{$:()=>o,G:()=>l});var o,n=r(968687),i=r(466691),s=r(410969);!function(e){e.CDL_WORKER_FAILURE="CDL_WORKER_FAILURE",e.CLEANUP="CLEANUP",e.CORE_SERVICES_MISSING="CORE_SERVICES_MISSING",e.CREATE_USER_CONTEXT_FAILED_GENERIC="CREATE_USER_CONTEXT_FAILED_GENERIC",e.CREATE_WINDOW_WRAPPER="CREATE_WINDOW_WRAPPER",e.DISABLED_BY_ADMIN="DISABLED_BY_ADMIN",e.EXPERIENCE_DISABLED="EXPERIENCE_DISABLED",e.INVALID_INTENT_OVERRIDE="INVALID_INTENT_OVERRIDE",e.LAUNCH_CLOUD_DEEPLINK_ERROR="LAUNCH_CLOUD_DEEPLINK_ERROR",e.LAYOUT_ERROR="LAYOUT_ERROR",e.LAYOUT_ERROR_USER_BLOCKED="LAYOUT_ERROR_USER_BLOCKED",e.LAYOUT_PHASE_STATE_MACHINE_TIMEOUT="LAYOUT_PHASE_STATE_MACHINE_TIMEOUT",e.NETWORK_OFFLINE="NETWORK_OFFLINE",e.NETWORK_OFFLINE_USER_BLOCKED="NETWORK_OFFLINE_USER_BLOCKED",e.RENDERING_CONTEXT_DOES_NOT_EXIST="RENDERING_CONTEXT_DOES_NOT_EXIST",e.UNKNOWN="UNKNOWN",e.TELEMETRY_PRIMARY_USER_SET_FAILURE="TELEMETRY_PRIMARY_USER_SET_FAILURE",e.USER_DOES_NOT_EXIST="USER_DOES_NOT_EXIST",e.USER_NOT_AUTHENTICATED="USER_NOT_AUTHENTICATED",e.USERCONTEXTID_EMPTY="USERCONTEXTID_EMPTY",e.WINDOW_UNDEFINED="WINDOW_UNDEFINED"}(o||(o={}));const a={CDL_WORKER_FAILURE:"Cdl worker did not start up properly.",DISABLED_BY_ADMIN:"Please switch back to classic Teams.",EXPERIENCE_DISABLED:"We can't wait to show you the new Teams, but we're not quite ready for you. We'll let you know when it's time.",LAYOUT_PHASE_STATE_MACHINE_TIMEOUT:"Layout phase state machine has timed out triggering a view tear down.",TELEMETRY_PRIMARY_USER_SET_FAILURE:"This can result from a failure to load the PIE api, a failure to call maglev, or a failure to set primary user in the telemetry web worker"},c={CREATE_USER_CONTEXT_FAILED_GENERIC:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART","SIGN_OUT"]},DISABLED_BY_ADMIN:{title:"default_disabledbyadmin_title",description:"default_disabledbyadmin_description",actions:["SWITCH_TO_CLASSIC","SIGN_OUT"],icon:i.P.NoLongerAllowed},EXPERIENCE_DISABLED:{title:"default_experiencedisabled_title",description:"default_experiencedisabled_description",actions:["SIGN_OUT"],icon:i.P.NoLongerAllowed},LAYOUT_PHASE_STATE_MACHINE_TIMEOUT:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART"]},NETWORK_OFFLINE:{title:"default_nonetwork_title",description:"error_nonetwork_text"},NETWORK_OFFLINE_USER_BLOCKED:{title:"default_nonetwork_title",description:"error_nonetwork_text",actions:["RESTART"]},CDL_WORKER_FAILURE:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART"]},LAYOUT_ERROR:{title:"default_unknown_title",description:"",actions:[]},LAYOUT_ERROR_USER_BLOCKED:{title:"default_unknown_title",description:"",actions:["RESTART"]},RENDERING_CONTEXT_DOES_NOT_EXIST:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART","SIGN_OUT"]},USER_DOES_NOT_EXIST:{title:"default_unknown_title",description:"default_unknown_description",actions:["RESTART","SIGN_OUT"]}};class l extends n.G{constructor(e,t,r,o){super({type:"CoreError",code:e,message:a[e]??((0,s.a)(t)?t.innerError?.message??t.reason?.innerError?.message:t?.message),originSlotName:o,prevError:t,userContextId:r})}getBoundaryProps(){return c[this.code]??{title:"default_core_title",description:"default_core_description"}}static fromSerialized(e){if("CoreError"!==e?.type)return null;const t=new l(e.code,e.prevError,e.userContextId);return t.deserialize(e),t}}},787465:(e,t,r)=>{r.d(t,{Y:()=>n});var o=r(968687);class n extends o.G{constructor(e,t){super({type:"TrustedTypeError",code:e,prevError:t})}}},466691:(e,t,r)=>{var o;r.d(t,{P:()=>o,X:()=>n}),function(e){e.DefaultDark="defaultDark",e.Default="default",e.NoLongerAllowed="noLongerAllowed"}(o||(o={}));const n={[o.DefaultDark]:"/evergreen-assets/illustrations/error/something-went-wrong-v2-dark.svg",[o.Default]:"/evergreen-assets/illustrations/error/something-went-wrong-v2.svg",[o.NoLongerAllowed]:"/evergreen-assets/illustrations/error/license-error-no-longer-allowed-hero.svg"}},410969:(e,t,r)=>{function o(e){const t=e;return"string"==typeof t?.code}r.d(t,{a:()=>o})},735977:(e,t,r)=>{r.d(t,{n:()=>Y});var o=r(317876),n=r(207689),i=r(742286),s=r(316877),a=r(702135),c=r(689626);class l{constructor(e,t){this.shellComms=e,this.globalWindow=t,this.defaultRequestTimeoutMs=3e4,this.bufferInTimeout=5e3}postMessage(e,t){const r={eventId:e,payload:t,correlationId:(0,s.v4)()};this.shellComms.postMessage(r)}requestMessage(e,t,r=this.defaultRequestTimeoutMs){let o;const n=(0,s.v4)(),i=(t?.timeout||r)+this.bufferInTimeout;return new Promise(((r,s)=>{const l=t=>{this.globalWindow.clearTimeout(o),t&&!t.error?r(t.payload):s((0,a.Tr)(c.w5.ShellService,c.jK.RemoteOperationFailed,"requestMessage",{eventName:e,error:t&&t.error,correlationId:n},"Received an error from IPC"))};o=this.globalWindow.setTimeout((()=>{this.shellComms.remove(e,l),s((0,a.Tr)(c.w5.ShellService,c.jK.TimedOut,"requestMessage",{eventName:e,correlationId:n}))}),i),this.shellComms.once(e,l,n);const d={eventId:e,correlationId:n,payload:t};this.shellComms.postMessage(d)}))}addEventListener(e,t,r){r&&r.once?this.shellComms.once(e,t):this.shellComms.on(e,t)}removeEventListener(e,t){t?this.shellComms.remove(e,t):this.shellComms.removeAll(e)}open(e,t,r){const o={openType:e,openHandler:t,handlerParams:r};this.postMessage("requestShellToOpen",o)}}class d{constructor(e,t,r){this._globalWindow=e,this.shellComms=t,this.envPerformance={getBlinkMemoryInfo:()=>{},getJSHeapStatistics:()=>{},getMallocMemoryUsage:()=>{},getProcessMemoryInfo:()=>{},getWebCacheInfo:()=>{}};const{isInCypressFrame:o,isInIframe:s}=r;let a=n.QP.standAlone;if(this.viewportContext=i.R.primary,s&&!o)a=n.QP.iframe,this.viewportContext=i.R.iFrame;else if(null!==this._globalWindow.opener)try{this._globalWindow.opener.location?.host===this._globalWindow.location.host&&(a=n.QP.secondary,this.viewportContext=i.R.secondary)}catch(e){a=n.QP.standAlone,this.viewportContext=i.R.primary}this._hostedWindowContext={...r,panelContext:a,startReason:n.zF.userInitiated,__webpack_public_path__:this._globalWindow.__webpack_public_path__},this.opener=new l(this.shellComms,this._globalWindow)}getHostedWindowContext(){return this._hostedWindowContext}onAppStart(){}setTimeout(...e){return this._globalWindow.setTimeout(...e)}clearTimeout(...e){return this._globalWindow.clearTimeout(...e)}}var u=r(63682),h=r(59083);var g=r(89184);class m{constructor(e,t){this.getObservableOn=e=>{const t=this.observableCache,r=t.get(e);if(r)return r;const o=new g.xQ;return t.set(e,o),o},this.next=e=>{this.logger.debug("Incoming message received. Filtering through cached observables.");const t=e.metaData.destination.channel,r=this.observableCache.get(t);r&&r.next(e)},this.error=e=>{const t=e.message?e.message:e;this.logger.error(`Internal Message Source emitted an error - {${t}}. Completing then clearing all observables from cache...`),this.completeAndClearCache()},this.complete=()=>{this.logger.debug("Internal Message Source completed. Completing then clearing all observables from cache..."),this.completeAndClearCache()},this.completeAndClearCache=()=>{this.observableCache.forEach((e=>e.complete())),this.observableCache.clear(),this.logger.debug("Cache cleared")},this.logger=t,this.observableCache=new Map,e.subscribe(this)}}const p="multi-window-manager-channel";var w=r(67081),E=r(336378),v=r(803238);const f=/^https:\/\/local\.teams\.(office|live)\.com(:8080)?$/;function _(e,t){return t.some((t=>{if(t.startsWith("regex:")){const r=t.replace("regex:","");return new RegExp(r).test(e)}return t===e}))}function C(e){return f.test(new URL(e).origin)}const S=(e,t,r,o)=>{const n=w.y.create((n=>{e.addEventListener("message",(e=>{const{eventId:i,channel:s}=e.data;e&&i&&s===p&&function(e,t,r){const o=r.newLogger("PostMessage origin validation","services-io-browser-shell-message-passing-browser"),n=e.origin;return t?!("*"!==t&&!C(n)&&((0,v.isArray)(t)?0===t.length?(o.errorToTelemetry?.(`PostMessage is disabled for this experience. (case 5) ${n}`,"core_origin_validation_failed",void 0,!0),1):!_(n,t)&&(o.errorToTelemetry?.(`Event origin is not in allow-list. Event was dropped. (case 4) ${n}`,"core_origin_validation_failed",void 0,!0),1):(o.errorToTelemetry?.(`Could not match the event origin. Event was dropped. (case 6) ${n}`,"core_origin_validation_failed",void 0,!0),1))):(o.debug("PostMessage is enabled for backwards compatibility. No postMessageConfig is set on this experience. https://aka.ms/tmp-post-message-config (case1 )"),!0)}(e,r.postMessageConfig,o)&&(t.debug("Incoming message from post messages"),n.next(e.data))}))})).pipe((0,E.B)());return n};class b{constructor(e,t,r,o){this.opt=o,this.postMessage=e=>{if((0,v.isArray)(this.opt.postMessageConfig)&&0===this.opt.postMessageConfig.length)return void this.logger.errorToTelemetry?.("postMessageConfig is set to empty array. No outgoing post messages are allowed","core_origin_validation_failed",void 0,!0);this.logger.log("Sending targeted message to host browser only");const t=null!==e.payload&&"object"==typeof e.payload?{...e.payload}:{payload:e.payload};this.windowReference.parent.postMessage({channel:p,payload:{...t,channel:e.channel}},((e,t,r)=>{const o=new URL(e.location.href).origin;let n;if(!t||"*"===t)return"*";if(e.document.referrer)try{n=new URL(e.document.referrer).origin}catch(t){r.error(`Invalid referrer: ${e.document.referrer}`)}return n?n===o||C(n)||_(n,t)?n:(r.error(`Invalid target origin (${n}). Source origin (${o}) was returned as target origin.`),o):(r.log(`Could not determine target origin. Falling back to source origin: ${o}`),o)})(this.windowReference,this.opt.postMessageConfig,this.logger))},this.broadcast=()=>{},this.asObservable=e=>this.shellChannelCache.getObservableOn(e).pipe((0,h.U)((e=>(e=>({channel:e.metaData.destination.channel,payload:e.payload}))(e)))),this.createShellChannelCache=(e,t,r,o)=>{t.debug("Creating Shell Channel cache");const n=S(e,t,r,o);return new m(n,t)},this.logger=r.newLogger("RndrShComm","services-io-browser-shell-message-passing-browser"),this.processId=e,this.windowReference=t,this.shellChannelCache=this.createShellChannelCache(this.windowReference,this.logger,this.opt,r)}}const R="main_process";var I=r(782478);class T{constructor(e,t,r){if(3!==arguments.length||e.trim().length<=0)throw(0,a.Tr)("Invalid constructor arguments",c.jK.InvalidInput,typeof T);this.logger=r,this.messagePassingService=t,this.metaData={streamId:e}}next(e,...t){const r=this.metaData,o=this.messagePassingService,n=t&&t.length>0?t:this.messagePassingService.processId!==R?[R]:["main_renderer"],i={channel:r.streamId,payload:e};this.logger.debug(`Invoking stream on targets: ${JSON.stringify(n)}.`),o.postMessage(i,n)}asObservable(){const e=this.messagePassingService,t=this.metaData.streamId;return e.asObservable(t).pipe((0,h.U)((e=>e.payload)),(0,I.b)((()=>{this.logger.debug("Handling stream event.")})))}}class y{constructor(e,t){if(this.getStream=e=>new T(e,this.messagePassingService,this.loggerFactory.newLogger(`ShStrm${e}`,"services-io-browser-shell-communication-provider")),!e||!t)throw(0,a.Tr)(`sc: ${e}, lf: ${t}`,c.jK.Undefined,typeof y);this.messagePassingService=e,this.loggerFactory=t}}var L=r(872746),k=r(387383),A=r(841763);class O{constructor(e,t){if(this.windowReference=e,this.opt=t,!this.windowReference)throw(0,a.Tr)(c.w5.ShellService,c.jK.Undefined,"constructor");const r={error:()=>{},warn:()=>{},debug:()=>{},info:()=>{},log:()=>{}},o={newLogger:()=>r},n=new b("browserWindow",this.windowReference,o,this.opt);this.shellComms=new y(n,o),this.subscriptionManager=new g.xQ}postMessage(e){this.shellComms.getStream(e.eventId).next(e)}on(e,t,r=""){this.createSubscription(e,t,!1,r)}once(e,t,r=""){this.createSubscription(e,t,!0,r)}remove(e,t){this.subscriptionManager.next({channel:e,listener:t})}removeAll(e){this.subscriptionManager.next({channel:e})}createSubscription(e,t,r,o){const n=this.shellComms.getStream(e).asObservable().pipe(this.filterWrapper((e=>{const t=e?.correlationId||e?.payload?.correlationId;return!e||!t||t===o}))),i=this.registerForUnsubscription(e,t);(r?n.pipe((0,L.q)(1),(0,k.R)(i)):n.pipe((0,k.R)(i))).subscribe((e=>{t({payload:e})}),(e=>{throw(0,a.Tr)(c.w5.ShellService,c.jK.RemoteOperationFailed,"createSubscription",{errorMsg:(0,a.B9)(e)})}))}registerForUnsubscription(e,t){return this.subscriptionManager.pipe(this.filterWrapper((r=>r.channel===e&&(void 0===r.listener||r.listener===t))))}filterWrapper(e){return(0,A.h)(e)}}class W{constructor(e,t){this.globalWindow=e,this.opt=t}configureShell(e){const t=this.globalWindow,r=this.createShellCommService(this.globalWindow,this.opt),o=new d(this.globalWindow,r,e);return{hostedWindowContext:o.getHostedWindowContext(),window:(0,u.So)(t,o,!1)}}createShellCommService(e,t){return new O(e,t)}}class x{constructor(e,t,r,s){this.envPerformance=e,this._globalWindow=t,this.shellComms=r,this._hostedWindowContext={...s,panelContext:n.QP.secondary,startReason:n.zF.userInitiated,__webpack_public_path__:this._globalWindow.__webpack_public_path__},this.viewportContext=i.R.iFrame,this.opener=new l(r,this._globalWindow),this._globalWindow.addEventListener("unload",(()=>{this.shellComms.postMessage({eventId:o.W.WindowUnloaded})}))}getHostedWindowContext(){return this._hostedWindowContext}onAppStart(){const e={eventId:o.W.WindowAppStart};this.shellComms.postMessage(e)}setTimeout(...e){return this._globalWindow.setTimeout(...e)}clearTimeout(...e){return this._globalWindow.clearTimeout(...e)}}var D,M=r(898785);!function(e){e.WindowMinimize="child-window-minimize",e.WindowMaximize="child-window-maximize"}(D||(D={}));const N="experience-renderer-channel";class P{constructor(e){this.ipcRenderer=e,this.onceListenerLookup={},this.listenerLookup={},this.ipcRenderer.on(N,((e,t)=>{if(t&&t.eventId){const e=`${t.eventId}${t.correlationId||""}`;this.onceListenerLookup[e]?(this.onceListenerLookup[e].forEach((e=>e(t))),delete this.onceListenerLookup[e]):this.listenerLookup[e]&&this.listenerLookup[e].forEach((e=>{e(t)}))}}))}postMessage(e){switch(e.eventId){case M.rY.ActivityEvent:case M.rY.CreateWebview:case M.rY.GetWindowLaunchSubSteps:case M.rY.SetTouchBar:case M.rY.ClearTouchBar:case M.rY.ActivateOutlook:case M.rY.RequestTabMetrics:case M.rY.HasDevicePermissionsCallback:this.ipcRenderer.send(N,e);break;case o.W.CoreInitialized:case M.rY.WindowInitialized:this.ipcRenderer.send(N,e),this.ipcRenderer.sendToHost(N,e);break;default:this.ipcRenderer.sendToHost(N,e)}}on(e,t,r=""){const o=`${e}${r}`;this.listenerLookup[o]||(this.listenerLookup[o]=[]),this.listenerLookup[o].push(t)}once(e,t,r=""){const o=`${e}${r}`;this.onceListenerLookup[o]||(this.onceListenerLookup[o]=[]),this.onceListenerLookup[o].push(t)}remove(e,t){e&&t&&(this.onceListenerLookup[e]&&(this.onceListenerLookup[e]=this.onceListenerLookup[e].filter((e=>e!==t)),0===this.onceListenerLookup[e].length&&delete this.onceListenerLookup[e]),this.listenerLookup[e]&&(this.listenerLookup[e]=this.listenerLookup[e].filter((e=>e!==t)),0===this.listenerLookup[e].length&&delete this.listenerLookup[e]))}removeAll(e){delete this.onceListenerLookup[e],delete this.listenerLookup[e]}}class F{constructor(e){this.windowHandle=e,this.ipcRenderer=this.windowHandle.desktop.ipcRenderer,this.webViewCommService=new P(this.ipcRenderer),this.browserShellCommService=new O(e,{})}postMessage(e){switch(e.eventId){case M.rY.ActivityEvent:case M.rY.CreateWebview:case M.rY.GetWindowLaunchSubSteps:case M.rY.SetTouchBar:case M.rY.ClearTouchBar:this.ipcRenderer.send(N,e);break;case o.W.CoreInitialized:case M.rY.WindowInitialized:this.ipcRenderer.send(N,e),this.browserShellCommService.postMessage(e);break;default:this.browserShellCommService.postMessage(e)}}on(e,t,r=""){this.webViewCommService.on(e,t,r),this.browserShellCommService.on(e,t,r)}once(e,t,r=""){this.webViewCommService.once(e,t,r),this.browserShellCommService.once(e,t,r)}remove(e,t){this.webViewCommService.remove(e,t),this.browserShellCommService.remove(e,t)}removeAll(e){this.webViewCommService.removeAll(e),this.browserShellCommService.removeAll(e)}}class U{constructor(e){this.globalWindow=e}configureShell(e){const t=this.globalWindow,{isInIframe:r}=e,o=this.extractPerformanceTooling(t),n=r?new F(t):new P(t.desktop.ipcRenderer),i=new x(o,t,n,e);return Object.keys(t.desktop).forEach((e=>{"perf"!==e&&delete t.desktop[e]})),{hostedWindowContext:i.getHostedWindowContext(),window:(0,u.So)(t,i,!1)}}extractPerformanceTooling(e){return e.desktop.perf||{getBlinkMemoryInfo:()=>{},getJSHeapStatistics:()=>{},getMallocMemoryUsage:()=>{},getProcessMemoryInfo:()=>{},getWebCacheInfo:()=>{}}}}var z=r(65733);class B{constructor(e){this.windowEnvironment=e}configure(e){const t={isInCypressFrame:H(this.windowEnvironment),isInIframe:$(this.windowEnvironment)};t.isInIframe&&function(e){if(e.navigator){if("Electron"===z.getParser(e.navigator?.userAgent).getBrowserName())return!0}return!1}(this.windowEnvironment)&&function(e){try{const t=e.parent;if(!t||!function(e){return!(!e||!e.electronSafeIpc)}(t))return;e.desktop={perf:t.desktop?.perf,ipcRenderer:t.electronSafeIpc},e.createInterprocessStore=t.createInterprocessStore,e.vdiSettings=t.vdiSettings}catch(e){return}}(this.windowEnvironment);return(function(e){return!!(e&&e.desktop&&e.desktop.ipcRenderer)}(this.windowEnvironment)?new U(this.windowEnvironment):new W(this.windowEnvironment,e)).configureShell(t)}}function H(e){try{let t=!!e.Cypress;if(!t){const r=e.top||e.parent;t=!!r?.Cypress}return t}catch(e){return!1}}function $(e){try{return e.self!==e.top}catch(e){return!0}}class Y{constructor(){this._opt={};const e=new B(window);this.config=e.configure(this._opt),this.config.window.opener.postMessage(o.W.WindowReady)}set opt(e){Object.keys(e).forEach((t=>{this._opt[t]=e[t]}))}static getInstance(){return Y.instance||(Y.instance=new Y),Y.instance}get window(){return this.config.window}}},63682:(e,t,r)=>{r.d(t,{YR:()=>S,dP:()=>_,So:()=>f});var o=r(683184),n=r(66432),i=r(686219),s=r(742286),a=r(692588);function c(e){return e.ResizeObserver?e.ResizeObserver:function(t){const r=new Map;let o,n=!1;function i(){if(n||!r.size)return void(o=void 0);const s=[];r.forEach(((e,t)=>{const o=t.getBoundingClientRect();e.height!==o.height&&(r.set(t,o),s.push({target:t,contentRect:o,borderBoxSize:[{inlineSize:o.width,blockSize:o.height}],contentBoxSize:[{inlineSize:o.width,blockSize:o.height}],devicePixelContentBoxSize:[]}))})),s.length&&t(s),o=e.requestAnimationFrame(i)}return{observe(t){r.has(t)||(r.set(t,t.getBoundingClientRect()),o||(o=e.requestAnimationFrame(i)))},unobserve(e){r.has(e)&&r.delete(e)},disconnect(){r.clear(),o=void 0,n=!0}}}}var l=r(787465),d=r(677686);class u{constructor(e,t){this._document=e,this._chunkConfig=t,this._loadedItems=new Map,this._loadScript=(0,d.m)(((e,t)=>new Promise(((r,o)=>{if(!e)return r();const n=this._document.createElement("script");if(n.onload=()=>r(),n.onerror=o,n.async=!0,n.id=`${t}-script`,n.charset="utf-8",!this._coreSecurityService)throw new l.Y("DEVELOPER_ERROR",new Error("Chunkloader core security service is not defined. This should never happen"));try{const t=this._coreSecurityService.getTrustedTypePolicy("@msteams/services-utilities-common#ChunkLoader").createScriptURL(e,n.baseURI);n.src=t}catch(e){throw e}this._document.body.appendChild(n)}))),{backoffTime:1e4,retryWindow:3e4,maxRetries:3}),this._loadStyle=(0,d.m)(((e,t)=>new Promise(((r,o)=>{if(!e)return r();const n=this._document.createElement("link");n.onload=()=>r(),n.onerror=o,n.type="text/css",n.rel="stylesheet",n.id=`${t}-style`,n.charset="utf-8",n.href=e,this._document.head.appendChild(n)}))),{backoffTime:1e4,retryWindow:3e4,maxRetries:3}),this.loadChunk=async(e,t=!1)=>{if(!this._chunkConfig)throw new Error("Chunk loading is not supported in this window or host.");const r=e.reduce(((e,r)=>{const o=this._chunkConfig&&this._chunkConfig[r];if(!o)return e.push(Promise.reject(new Error(`No chunk information found for ${o}.`))),e;const n=o.endsWith(".css")?this._loadStyle:this._loadScript,i=this._loadedItems.get(o)||n(o,r).catch((e=>{throw t&&this._loadedItems.delete(o),e}));return this._loadedItems.has(o)||this._loadedItems.set(o,i),e.push(i),e}),[]);await Promise.all(r)}}configureCoreSecurityService(e){if(this._coreSecurityService)throw new l.Y("DUPLICATE_POLICY_FOUND",new Error("ChunkLoader::coreSecurityService is already defined. Developer should not be calling configureCoreSecurityService multiple times in it's context"));e&&(this._coreSecurityService=e)}}var h=r(839779),g=r(88202),m=r(242111),p=r(782478),w=r(926717);const E=(e,t,r,i)=>{const{coreSettings:s,interprocessStoreService:a,loggerFactory:c,platformService:l}=i||{},d=c?.newLogger("WindowUtilities","services-io-browser-shell"),u=l?.config.clientType===n.Bh.Desktop;if(s.get(o.J.Core,["enableHostFullscreenSubscription"]).enableHostFullscreenSubscription)return t.pipe((0,m.x)());if(u)return a&&r?a.onWindowFullscreen(r).pipe((0,p.b)((e=>d?.log(`WindowHook[onFullscreen] update to: ${e}`)))):(d?.error(`WindowHook[onFullscreen] on desktop failed due to interprocessStoreService missing for windowId: ${r}`),new h.X(!1));{const t=e,r=new h.X(v(t)),o=new t.ResizeObserver((()=>{t.requestAnimationFrame((()=>{r.next(v(t))}))}));return o.observe(t.document.documentElement),r.pipe((0,w.x)((()=>o.disconnect())),(0,m.x)())}},v=e=>!!(e.matchMedia("(display-mode: fullscreen)").matches||e.document.fullscreenElement||e.document.mozFullScreenElement||e.document.webkitFullscreenElement),f=(e,t,r)=>{let o;try{o={DOMRect:e.DOMRect,loader:e.loader,loaderConfig:e.loaderConfig,preCoreUiAdapter:e.preCoreUiAdapter,Cypress:e.Cypress,document:e.document,HTMLVideoElement:e.HTMLVideoElement,Element:e.Element,emitDebugEvent:e.emitDebugEvent,external:e.external,location:e.location,history:e.history,navigator:e.navigator,get caches(){return e.caches},crypto:e.crypto,parent:e.parent,self:e.self,top:e.top,performance:e.performance,msCrypto:e.msCrypto&&e.msCrypto,IntersectionObserver:e.IntersectionObserver,ResizeObserver:c(e),WeakRef:e.WeakRef,chunkLoader:new u(e.document,e.__experienceWindowChunks__),screen:e.screen?.orientation?e.screen:{...e.screen,orientation:{type:"landscape-primary"}},viewportContext:t.viewportContext,chrome:e.chrome,open:e.loader&&e.loader.openWindow?e.loader.openWindow.bind(e.loader):e.open.bind(e),getLoadingWindow:e.loader?.getLoadingWindow&&e.loader.getLoadingWindow.bind(e.loader),fetch:e.fetch&&e.fetch.bind(e),close:e.close.bind(e),alert:e.alert.bind(e),requestAnimationFrame:e.requestAnimationFrame.bind(e),cancelAnimationFrame:e.cancelAnimationFrame.bind(e),requestIdleCallback:e.requestIdleCallback?e.requestIdleCallback.bind(e):e.requestAnimationFrame.bind(e),cancelIdleCallback:e.cancelIdleCallback?e.cancelIdleCallback.bind(e):e.cancelAnimationFrame.bind(e),scheduler:e.scheduler,setInterval:e.setInterval.bind(e),clearInterval:e.clearInterval.bind(e),clearTimeout:e.clearTimeout.bind(e),setTimeout:e.setTimeout.bind(e),addEventListener:e.addEventListener.bind(e),removeEventListener:e.removeEventListener.bind(e),dispatchEvent:e.dispatchEvent.bind(e),focus:e.focus.bind(e),getScreenDetails:()=>e.getScreenDetails?e.getScreenDetails():Promise.resolve(void 0),getSelection:e.getSelection.bind(e),getComputedStyle:e.getComputedStyle.bind(e),onpagehide:e.onpagehide?.bind(e),setBounds:e.setBounds,setMinimumSize:e.setMinimumSize,createInterprocessStore:e.createInterprocessStore,Logging:e.Logging,matchMedia:e.matchMedia?e.matchMedia.bind(e):null,proxyPostMessage:(t,r,o,n)=>{e.proxyPostMessage&&e.proxyPostMessage(t,r,o,n)},getLocaleInfoAsync:()=>e.getLocaleInfoAsync?e.getLocaleInfoAsync():Promise.resolve(void 0),getUserMedia:t=>e.navigator?.mediaDevices?.getUserMedia?e.navigator.mediaDevices.getUserMedia(t):Promise.reject(new Error("Not available")),enumerateDevices:()=>t.navigator?.mediaDevices?.enumerateDevices?t.navigator.mediaDevices.enumerateDevices():Promise.reject(new Error("Not available")),AudioContext:e.AudioContext,handleGlobalWindowError:e.handleGlobalWindowError?.bind(e),decodeURIComponent,encodeURIComponent,getDesktopCapturerSources:t=>e.getDesktopCapturerSources?e.getDesktopCapturerSources(t):Promise.reject(new Error("Not available")),get __experienceWindowChunks__(){return e.__experienceWindowChunks__},get __webpack_nonce__(){return e.__webpack_nonce__},get __VERSION__(){return e.__VERSION__},get __webpack_public_path__(){return e.__webpack_public_path__},get devicePixelRatio(){return e.devicePixelRatio},get localStorage(){return e.localStorage},get sessionStorage(){return e.sessionStorage},get indexedDB(){return e.indexedDB},get CKEDITOR(){return e.CKEDITOR},get ITEMS_VIEW_STRINGS(){return e.ITEMS_VIEW_STRINGS},get CodeMirror(){return e.CodeMirror},get MutationObserver(){return e.MutationObserver},get LivePersonaCardStrings(){return e.LivePersonaCardStrings},get LivePersonaCardHoverTargetV2(){return e.LivePersonaCardHoverTargetV2},get LPC(){return e.LPC},get SlimCore(){return e.SlimCore},get authLogger(){return e.Logging},get Microsoft(){return e.Microsoft},get Office(){return e.Office},get Image(){return e.Image},get DOMParser(){return e.DOMParser},videoRenderer:e.videoRenderer,get FrameSinkReader(){return e.FrameSinkReader},get continueExternalAuth(){return e.continueExternalAuth},set continueExternalAuth(t){e.continueExternalAuth=t},get continueMsaAuth(){return e.continueMsaAuth},set continueMsaAuth(t){e.continueMsaAuth=t},get FabricConfig(){return e.FabricConfig},set FabricConfig(t){e.FabricConfig=t},get CKEDITOR_BASEPATH(){return e.CKEDITOR_BASEPATH},get ClipboardItem(){return e.ClipboardItem},get PerformanceObserver(){return e.PerformanceObserver},get opener(){return t.opener},get envPerformance(){return t.envPerformance},getHostedWindowContext:t.getHostedWindowContext.bind(t),onAppStart:t.onAppStart.bind(t),get isHighResolution(){if(e){const t=1.3,r=e.navigator&&e.navigator.userAgent&&e.navigator.userAgent.toLowerCase().indexOf("firefox")>-1;if(void 0!==e.devicePixelRatio&&!r)return e.devicePixelRatio>t;if(e.matchMedia){const t="(-webkit-min-device-pixel-ratio: 1.3),            (min--moz-device-pixel-ratio: 1.3),            (-o-min-device-pixel-ratio: 1.3),            (min-resolution: 120dpi)";return e.matchMedia(t).matches}}return!1},get screenX(){return e.screenX},get screenY(){return e.screenY},get innerWidth(){return e.innerWidth},get innerHeight(){return e.innerHeight},isFocused:()=>e.isFocused?e.isFocused():e.document.hasFocus(),onFullscreen:()=>new h.X(!1),unsubscribeFullscreenEvents:()=>{},exitFullscreen:()=>{},maximize:()=>{},minimize:()=>{},requestFullscreen:()=>{},show:()=>{},windowTitleDblClick:()=>{},clearCache:()=>e.clearCache?.(),getZoomFactor:()=>e.getZoomFactor?e.getZoomFactor():0,zoomFactors:e.zoomFactors??g.E,zoomIn:()=>e.zoomIn?e.zoomIn():void 0,zoomOut:()=>e.zoomOut?e.zoomOut():void 0,zoomReset:()=>e.zoomReset?e.zoomReset():void 0,vdiSettings:e.vdiSettings,setSelectedAudioOutputDevice:t=>e.setSelectedAudioOutputDevice?e.setSelectedAudioOutputDevice(t):Promise.resolve(),destroy:async n=>(o.unsubscribeFullscreenEvents?.(),r?new Promise(((r,i)=>{const s=t.setTimeout((()=>{try{t.clearTimeout(s);for(const e of Reflect.ownKeys(o)){if("windowLeakInfo"===e)continue;delete o[e];const t=()=>{const t=new Error(`wrapWindow: Accessing window.${e} after destroy`);throw t.message=`${t.message} at\n${t.stack}`,t};Reflect.defineProperty(o,e,{get:t,set:t})}e.document.documentElement.innerText="",r()}catch(e){i(e)}finally{e=void 0,t=void 0}}),n+1)})):void 0)}}catch(e){throw new a.G(a.$.CREATE_WINDOW_WRAPPER,e)}e.CKEDITOR_BASEPATH=e.CKEDITOR_BASEPATH||`${e.__webpack_public_path__||t?.getHostedWindowContext()?.__webpack_public_path__||""}ckeditor/4.15.1-msft-11/`||"";const n=new Proxy(o,{deleteProperty:(t,r)=>delete e[r]});return o.__lpcWindowProxy=n,o};function _(e,t,r,n,i){const{coreSecurityService:s,hostCommunicationService:a,windowProvider:c,coreSettings:l,loggerFactory:d}=t,g=e,{enableDisconnectWindowWrapper:m,enableHostFullscreenSubscription:p}=l.get(o.J.Core),w=d.newLogger("WindowUtilities","services-io-browser-shell"),v=f(g,c,m??!1),_=S(n,i),b=new u(g.document,c.__experienceWindowChunks__);let R,I;b.configureCoreSecurityService(s);const T={chunkLoader:b,parent:c,viewportContext:_,FabricConfig:{mergeStyles:{namespace:"cw"}},exitFullscreen:()=>C("exitFullscreen",e,t,r,w),focus:()=>C("focus",e,t,r,w),maximize:()=>C("maximize",e,t,r,w),minimize:()=>C("minimize",e,t,r,w),requestFullscreen:()=>C("requestFullscreen",e,t,r,w),windowTitleDblClick:()=>C("windowTitleDblClick",e,t,r,w),onFullscreen:()=>(R||(R=new h.X(!1),p&&a.loadModule("windowcontrols").then((e=>{w.log(`Subscribing to hostComms fullscreen events for window: ${r}`),I=e?.registerForWindowFullScreenChanged?.((e=>{e.windowId===r&&R?.next(e.fullscreen)}))}))),E(e,R,r,t)),unsubscribeFullscreenEvents:()=>I?.()};return Object.assign(v,T)}function C(e,t,r,o,i){const{interprocessStoreService:s,platformService:a}=r;if(i.log(`Performing action ${e}`),a.config.clientType===n.Bh.Desktop){if("focus"===e&&t?.document.hidden&&(e="show"),!s)return void i.error(`WindowAction[${e}] on Desktop failed due to interprocessStoreService missing`);s[e](o).then((()=>{i.log(`WindowAction[${e}] on Desktop succeeded.`)})).catch((t=>{i.error(`WindowAction[${e}] on Desktop failed with: ${t&&t.message} (${t&&t.code})`)}))}else{const r=t;switch(e){case"exitFullscreen":r.document.exitFullscreen().catch((t=>{i.error(`WindowAction[${e}] on Web failed due to: ${t}.`)}));break;case"requestFullscreen":r.document.documentElement.requestFullscreen().catch((t=>{i.error(`WindowAction[${e}] on Web failed due to: ${t}.`)}));break;default:try{r[e]()}catch(t){i.error(`WindowAction[${e}] on Web failed due to: ${t}.`)}}}}function S(e,t){let r;if(e)switch(t){case i.lO.minimal:r=s.R.flyout;break;case i.lO.minimode:r=s.R.minimode;break;default:r=s.R.primary}else r=s.R.secondary;return r}},191366:(e,t,r)=>{r.d(t,{J:()=>n,l:()=>i});var o=r(735977);function n(){return o.n.getInstance().window}function i(e,...t){const r=window.electronSafeIpc;r&&r.send(e,...t)}},677686:(e,t,r)=>{r.d(t,{X:()=>c,m:()=>l});var o=r(787465),n=r(897826),i=r(702135),s=r(689626),a=r(6842);const c=(e,t)=>async(...r)=>{for(;;)try{return await e(...r)}catch(e){await t(e,...r)}},l=(e,t)=>{const{maxRetries:r,retryWindow:c,backoffTime:l,shouldRetry:d}=t,u=e=>c-(Date.now()-e);return async(...t)=>{const c=Date.now();let h=0,g=u(c);for(;h++<=r&&g>0;)try{return await Promise.resolve(e.apply(e,t))}catch(e){if(e instanceof o.Y)throw e;const t=await(0,n.tE)(e);if(d&&!d(t))throw t?(0,i.Tr)(t.context,t.code,t.subContext?t.subContext:"",t.reason,t.message,t.serverResponse):(0,i.Tr)("RetryWithBackoff",s.jK.MaxLimitReached,"elapsed",void 0,`All retries elapsed or retryWindow expired, RetryCount: ${h}, RemainingTime: ${g}`);if(h>=r||u(c)<=0)break;await(0,a._)(l),g=u(c)}throw(0,i.Tr)("RetryWithBackoff",s.jK.MaxLimitReached,"elapsed",void 0,`All retries elapsed or retryWindow expired, RetryCount: ${h}, RemainingTime: ${g}`)}}},897826:(e,t,r)=>{r.d(t,{E6:()=>i,xn:()=>s,Q6:()=>a,v7:()=>c,tE:()=>l});var o=r(689626),n=r(702135);const i=e=>{if(!e)return null;const{graphQLErrors:t}=e;return t&&t.length>0&&t[0]&&t[0].originalError?(0,n.Jn)(t[0].originalError,o.w5.Apollo,o.jK.ApolloError,"getOriginalError",{status:t[0].originalError.code}):null},s=e=>{const t=e.graphQLErrors?.[0]?.extensions;return t?t.prevError&&"UNKNOWN"===t.code?(0,n.Jn)(new Error(e.graphQLErrors[0].message),t.prevError.context,t.prevError.code,t.prevError.subContext,t.prevError.reason):(0,n.Jn)(new Error(e.graphQLErrors[0].message),t.context,t.code,t.subContext,t.reason):null},a=e=>{const t=c(e);return!(!(0,n.Wc)(t)&&!(0,n.K3)(t.reason,t.context))},c=e=>e?.graphQLErrors[0]?.extensions?.prevError,l=async e=>{if(!e)return null;let t=null;const{graphQLErrors:r,networkError:i}=e;return i&&(t=d(i)),!t&&r&&r.length>0&&r[0].originalError&&(t=await(async e=>{let t=null;try{if(t=e.originalError,!t?.serverResponse?.body)return t;const r=t?.serverResponse?.status,o=await(t?.serverResponse?.body.json());if(!m(o))return t;t.reason={status:r,errorCode:o.errorCode,errorSubCode:o.errorSubCode}}catch(e){}return t})(r[0])),t||(t=r&&r.length>0&&r[0]&&r[0].originalError?(0,n.Jn)(r[0].originalError,o.w5.Apollo,o.jK.ApolloError,"getOriginalError",{status:r[0].originalError.code}):null),t},d=e=>{let t=null;try{const r=JSON.parse(e.message);if(r){const o=JSON.parse(r.message);if(o){const r=JSON.parse(o.reason);r&&(t={...e,reason:{status:g(r)?r.status:void 0,errorCode:m(r)?r.errorCode:void 0}})}}}catch(r){t=u(e)}return t},u=e=>{if(!e.serverResponse)return null;const t={...e?.reason};return(0,n.Tr)(e.context,e.code,e.subContext?e.subContext:"",{status:e.serverResponse.status,errorCode:t.errorCode??void 0,reason:e.reason,...t},e.message,e.serverResponse)},h=e=>"number"==typeof e,g=e=>!!e&&void 0!==e.status&&h(e.status),m=e=>!!e&&void 0!==e.errorCode&&h(e.errorCode)}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/191366-9006ab1e8410be83.js.map