"use strict";(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[106979],{329310:(e,a,t)=>{t.d(a,{H:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsFileActionsChannelQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"channelByID"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"channelType"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"description"}},{kind:"Field",name:{kind:"Name",value:"defaultFileSettings"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"filesRelativePath"}}]}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"owningTeam"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"teamSiteInformation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"groupId"}}]}},{kind:"Field",name:{kind:"Name",value:"isArchived"}},{kind:"Field",name:{kind:"Name",value:"teamType"}},{kind:"Field",name:{kind:"Name",value:"tenantId"}}]}},{kind:"Field",name:{kind:"Name",value:"memberRole"}}]}}]}}]}},9095:(e,a,t)=>{t.d(a,{uH:()=>o,lS:()=>s,qi:()=>l,jP:()=>d,IT:()=>c});var n=t(288718),i=t(894917),r=t(233304);const o=e=>"com.microsoft.teams.callable-channel"===e||"com.microsoft.teamspace.tab.file.staticviewer.pdf"===e||"44263ed4-f1ac-4e96-93aa-d24dd50459ea"===e||"com.microsoft.teamspace.tab.web"===e,s=(e,a,t)=>{if(t){const{correlationId:n,installationScope:i,tabConfigurationData:r,threadId:o,teamId:s,isEduContext:l,isTmpLaunch:d}=t;switch(i){case"Team":return a.platform.inContextStorePostInstall({appId:e,teamId:s,correlationId:n,isEduContext:l,isTmpLaunch:d,tabConfigurationData:r,channelId:o,name:"openTabInstanceConfigDialogForChannel",inContextStoreLaunchOptions:t});case"GroupChat":return a.platform.inContextStorePostInstall({appId:e,correlationId:n,tabConfigurationData:r,isTmpLaunch:d,chatId:o,name:"openTabInstanceConfigDialogForChat",inContextStoreLaunchOptions:t})}}return Promise.resolve()},l=e=>"Student"===e||"Teacher"===e,d=async(e,a)=>{const{data:t}=await e.query({query:i.v,variables:{convId:a}});return t},c=e=>{let a=n.sG.na;switch(e){case r.mQ.card:a=n.sG.card;break;case r.mQ.deepLink:case r.mQ.deepLinkStageView:a=n.sG.deepLink;break;case r.mQ.stageViewOpenSDKApi:a=n.sG.stageViewOpenSDKApi;break;case r.mQ.messageExtension:a=n.sG.messageExtension;break;case r.mQ.chatTab:case r.mQ.channelTab:case r.mQ.sidePanel:case r.mQ.privateMeetingSchedulingForm:case r.mQ.channelMeetingSchedulingForm:case r.mQ.tab:a=n.sG.platformExtensionTab;break;case r.mQ.storeApp:a=n.sG.storeapp;break;case r.mQ.personalApp:a=n.sG.personalApp;break;case r.mQ.virtualEvent:a=n.sG.virtualEvent;break;case r.mQ.shareToOutlook:a=n.sG.shareToOutlook;break;case r.mQ.contentBubble:a=n.sG.contentBubble;break;case r.mQ.adaptiveCardTab:case r.mQ.adaptiveCardCollabStage:case r.mQ.adaptiveCardStageModal:a=n.sG.adaptiveCardTab;break;case r.mQ.botConfig:a=n.sG.botConfig;break;case r.mQ.workflows:a=n.sG.workflows}return a}},460026:(e,a,t)=>{t.d(a,{Us:()=>n,Wt:()=>l,UN:()=>d,wI:()=>c,eV:()=>p,v:()=>m,DA:()=>u,b4:()=>h});var n,i=t(447567),r=t(485510),o=t(543491),s=t(854887);!function(e){e.Start="Start",e.Stop="Stop",e.Cancel="Cancel",e.Fail="Fail"}(n||(n={}));const l=(e,a)=>{const{appId:t,appConfigEntryPoint:n,appEntryPoint:r,threadId:s,messageId:l,tabType:d,actionType:c,tabId:p}=a;switch(r){case i.m.Meeting:case i.m.ChannelMeeting:case i.m.PrivateMeetingSchedulingForm:case i.m.ChannelMeetingSchedulingForm:e.newScenario(o.RG.PlatformTabsHeaderUpdate).appendEventData({"App.Id":t,"App.EntryPoint":r,"Thread.Id":s,"Message.Id":l,"PlatformApp.TabType":d,"PlatformApp.ActionType":c,"PlatformApp.TabId":p,"PlatformApp.ConfigEntryPoint":n})}},d=(e,a)=>{const t=e.findScenario(o.RG.PlatformTabsHeaderUpdate);if(t){const e=t.eventData?.["PlatformApp.TabId"];a(e||"")&&t.stop()}},c=e=>{const a=e.findScenario(o.RG.PlatformTabsHeaderUpdate);a?.cancel()},p=e=>a=>e.some((e=>e.tabInfo.tabId===a)),m=(e,a,t)=>{const i=o.RG.ExtMeetingAppVisualIndicator,r=e.findScenario(o.RG.ExtMeetingAppVisualIndicator);switch(a){case n.Start:const a=r||e.newScenario(i);r||a.appendEventData({"Bot.Id":t});break;case n.Stop:r?.stop();break;case n.Cancel:r?.cancel();break;case n.Fail:r?.fail()}};function u(e,a,t){const n=new s.S,i=e.showNotificationBadge;n.tabId=e.tabInfo.tabId,n.appId=e.appInfo.appId,n.appName=e.appInfo.appName;const o={panelType:r.wh.MeetingAppVisualIndicator,moduleName:r.rA.meetingAppVisualIndicator,moduleType:r.PO.meetingAppVisualIndicator,actionOutcome:i?r.$K.meetingAppVisualIndicatorCreated:r.$K.dismissActionMeetingAppVisualIndicator,actionScenario:i?r.Tk.meetingAppVisualIndicatorCreated:r.Tk.dismissActionMeetingAppVisualIndicator,actionScenarioType:i?r.Yu.meetingAppVisualIndicatorCreated:r.Tk.dismissActionMeetingAppVisualIndicator,dataBag:n};return a.recordPanelAction(o,t,[r.sz.callType,r.sz.callMeetingContent]),n.dispose(),null}function h(e,a){e.findScenario(o.RG.PlatformTabLaunch)?.cancel({errors:a}),e.findScenario(o.RG.PlatformTabFrameLoading)?.cancel({errors:a})}},779843:(e,a,t)=>{t.d(a,{M:()=>o});var n=t(462512),i=t(543491),r=t(435205);const o=async(e,a,t,o,s)=>{try{const{appId:l}=e,d=JSON.parse(e.tabInfo);o?.mark(i.ck.StageViewAppTabInfoParsed);const c=await(0,n.yx)(a,l);e.isFullScreenApp=c?.isFullScreenApp||!1,o?.appendEventData({"App.isFullScreenApp":e.isFullScreenApp,"StageView.OpenMode":"popout"}),o?.mark(i.ck.StageViewAppDefFetched);const p=(0,r.SO)(e,d.tabInfo.contentUrl);return t.platform.launchStageMWWithoutChat({id:p,stageOptions:e,commandSource:s})}catch(e){throw o?.mark(i.ck.StageViewFailedBeforeCommandTrigger),e}}},272833:(e,a,t)=>{t.d(a,{M:()=>i});var n=t(435205);const i=async(e,a,t,i,r)=>{const{stageViewId:o,linkedEntity:s}=await(0,n.kf)(e,a,i);return o&&s?t.platform.launchStageMW({id:o,linkedEntity:s,stageOptions:e,commandSource:r}):Promise.reject("Entity commanding not available")}},722874:(e,a,t)=>{t.d(a,{A:()=>b});var n=t(9095),i=t(288718),r=t(485510),o=t(683184),s=t(323356),l=t(12978),d=t(686219),c=t(543491),p=t(233304),m=t(435205),u=t(462512),h=t(894917);const g=async(e,a,t)=>{if(t)return"Team";if(a){const t=await(async(e,a,t)=>{const{data:n}=await a.query({query:h.v,variables:{convId:e},context:{callerInfo:t}});return n.chat?.isOneOnOneBotChat??!1})(a,e,"handleJITInstallForStageView");return t?"Personal":"GroupChat"}return"Personal"},I=async(e,a,t,n,i,r,o,s)=>{const l=await(0,u.yx)(n,e);o?.mark(c.ck.StageViewAppDefFetched),s?.mark(c.ck.StageViewAppDefFetched);const d=(0,u.WW)("Personal",l);let p=!1,m=t;if(d){m="Personal",o?.mark(c.ck.StageViewInstallingInPersonalScope,{reason:`installing in personal scope: isPersonalScopeSupported: ${d}`}),s?.mark(c.ck.StageViewInstallingInPersonalScope,{reason:`installing in personal scope: isPersonalScopeSupported: ${d}`});p=!!await(0,u.eI)(n,i,c.RG.AppInstallationDialogInstallApp,e,"Personal",r,!0,void 0,{reason:`installing in personal scope: isPersonalScopeSupported: ${d}`,"App.Scope":"Personal",correlationId:s?.id})}else{if("Personal"===t||!(0,u.WW)(t,l))throw o?.mark(c.ck.StageViewJITInstallScopeNotSupported,{reason:`installScope: ${t} is not supported by app: ${e}`}),s?.mark(c.ck.StageViewJITInstallScopeNotSupported,{reason:`installScope: ${t} is not supported by app: ${e}`}),Error(`installScope: ${t} is not supported by app: ${e}`);o?.mark(c.ck.StageViewInstallingInChatChannelScope,{reason:`installing in scope: ${t}, conversationId: ${a}`}),s?.mark(c.ck.StageViewInstallingInChatChannelScope,{reason:`installing in scope: ${t}, conversationId: ${a}`});p=!!await(0,u.eI)(n,i,c.RG.AppInstallationDialogInstallApp,e,t,r,!0,a,{reason:`installing in scope: ${t}, conversationId: ${a}`,correlationId:s?.id,"App.Scope":t},void 0,"jit-install-for-stage-view"),m=t}return p&&(o?.mark(c.ck.StageViewAppInstallationDone,{reason:`installed in ${m} scope, conversationId: ${a}`}),s?.mark(c.ck.StageViewAppInstallationDone,{reason:`installed in ${m} scope, conversationId: ${a}`})),{appInstalled:p,appInstallScope:m}};var S=t(272833);const y=(e,a,t,n,i)=>{const{enableReactStageModal:r}=a.get(o.J.Extensibility);return r?(i?.appendEventData({"StageView.OpenMode":"modal"}),t.platform.launchReactStageModal(e.appId,e,{visibilityState:d.fe.show,stateTransition:d.su.extend,correlation:{source:n}}).toPromise()):t.platform.launchStage({stageOptions:e,entityCommand:{stateTransition:d.su.extend,visibilityState:d.fe.show,correlation:{source:n}}}).toPromise()};var f=t(779843),T=t(981917);const b=async(e,a,t,n,s,l,d,h)=>{const{enableCommandingTelemetryForCollabStageMW:S,enableReactStageModal:y,enableProgrammaticPopoutStageViewOpenAPI:f,enableProgrammaticPopoutStageDeeplink:T}=a.get(o.J.Extensibility);let b,C,k=e;if(!S){const{phase1CollabStageScenario:e,endToEndScenario:a}=(0,m.R3)(n,k.entryPoint);b=e,C=a,k.launchScenarioId=a.id,k.phase1OnlyScenarioDetails={scenarioMarkerName:e.name,scenarioMarkerId:e.id}}if(l)try{k=await v(s,l,k,t,b,C)}catch(e){return Promise.reject(`Could not determine if threadId passed is chat/channel: ${e}`)}if(k.openMode=(0,m.qV)(a,k),b?.appendEventData({"App.Id":k.appId,"Thread.Id":k.convId,"PlatformApp.ScenarioCapability":i.Ky.tabs,"App.EntryPoint":k.entryPoint,"StageView.OpenMode":k.openMode,"StageView.inputThreadIdDefined":!!l}),C?.appendEventData({"App.Id":k.appId,"Thread.Id":k.convId,"App.EntryPoint":k.entryPoint,"StageView.OpenMode":k.openMode,"StageView.inputThreadIdDefined":!!l}),!y&&k.openMode===m.Sm.modal&&d)return b?.cancel({errors:"Opening angular modal hence cancelling react scenarios"}),C?.cancel({errors:"Opening angular modal hence cancelling react scenarios"}),E(k,a,t,d,void 0);const{appInstalled:w,appInstallScope:P}=await(async(e,a,t,n,i,r)=>{if(e.entryPoint===p.mQ.adaptiveCardCollabStage||e.entryPoint===p.mQ.adaptiveCardStageModal)return{appInstalled:!0,appInstallScope:"Personal"};const{appId:o,convId:s,replyChainId:l,channelId:d}=e,m=d||l?void 0:s,h=l?d||s:d,S=h||m||"";let y="Personal";try{y=await g(a,m,h),i?.mark(c.ck.StageViewTargetInstallationScopeConfirmed,{reason:`confirmed installed scope for chatThreadId: ${m}, channelThreadId: ${h} is ${y}`}),r?.mark(c.ck.StageViewTargetInstallationScopeConfirmed,{reason:`confirmed installed scope for chatThreadId: ${m}, channelThreadId: ${h} is ${y}`}),n.log(`confirmed installed scope for chatThreadId: ${m}, channelThreadId: ${h} is ${y}`);const s={conversation:{id:S,scope:y},shouldFetchPersonalApps:!0},l=await(0,u.xJ)(a,n,t,o,!0,`jit-install-for-stage-view-${e.entryPoint}`,s);n.log(`Fetched Installed apps length: ${l.length} `);const d=l.find((e=>["Installed","InstalledAndFavorited","InstalledAndPermanent","AdminPreInstalled"].includes(e.installationState)));if(d)return i?.mark(c.ck.StageViewAppIsPreInstalled),r?.mark(c.ck.StageViewAppIsPreInstalled),{appInstalled:!0,appInstallScope:d.installedScope};{i?.mark(c.ck.StageViewAppIsNotPreInstalled),r?.mark(c.ck.StageViewAppIsNotPreInstalled);const{appInstalled:e,appInstallScope:s}=await I(o,S,y,a,t,n,i,r);return{appInstalled:e,appInstallScope:s}}}catch(e){return n.log(e?.message),i?.fail({errors:`JIT Install failed - ${e?.message}`}),r?.fail({errors:`JIT Install failed - ${e?.message}`}),{appInstalled:!1,appInstallScope:y}}})(k,t,n,s,b,C);return h&&h.recordPanelAction(((e,a,t)=>{const n=t.createDatabag(),o={actionGesture:r.uS.auto,actionOutcome:r.$K.submit,actionScenario:r.Tk.openCollabStageWindow,actionScenarioType:r.Yu.collabStage_Window,moduleName:r.rA.collabStage,moduleType:r.PO.collabStage,panelRegion:r.Ai.main,panelType:r.wh.AdaptiveCardTab,extensibilityData:{id:e,scope:a,scenarioCapability:i.Ky.tabs}};return o.dataBag=n,o})(k.appId,(e=>{let a=i.Mv.personal;switch(e){case"Team":a=i.Mv.team;case"GroupChat":a=i.Mv.group}return a})(P),h)),w?(b?.appendEventData({"App.Scope":P}),C?.appendEventData({"App.Scope":P}),E(k,a,t,d,b,!!f,!!T).catch((e=>(C?.fail({errors:"Failed to launch"}),b?.fail({errors:"Failed to launch"}),Promise.reject(e))))):(b?.fail({errors:`App could not be installed- ${P}`}),C?.fail({errors:`App could not be installed- ${P}`}),A())},v=async(e,a,t,i,r,o)=>{let s={chat:null};try{s=await(0,n.jP)(i,a)}catch(t){r?.mark(c.ck.ChatQueryFailed,{reason:`ChatQuery failed for inputThreadId: ${a}`}),o?.mark(c.ck.ChatQueryFailed,{reason:`ChatQuery failed for inputThreadId: ${a}`}),e.error(`Could not determine if inputThreadId is chat/channel, ChatQuery failed for inputThreadId: ${a}`)}if(s?.chat){const{chatSubType:n,memberIds:i}=s.chat;switch(r?.mark(c.ck.ChatQuerySuccessful,{reason:`chatSubType: ${n}, memberIds.length: ${i?.length}`}),o?.mark(c.ck.ChatQuerySuccessful,{reason:`chatSubType: ${n}, memberIds.length: ${i?.length}`}),n){case T.k2.Channel:return e.log(`inputThreadId is a channel ${a}`),{...t,convId:a,channelId:a,replyChainId:void 0,messageId:void 0};case T.k2.Meeting:case T.k2.None:e.log(`inputThreadId is a chat ${a}`);const n={...t,convId:a,channelId:void 0,replyChainId:void 0,messageId:void 0};return i&&0!==i.length||t.openMode===m.Sm.modal?n:{...n,openMode:m.Sm.popout};default:return e.error("chatSubType is not present in chatQuery return, launching stage view in personal scope context"),{...t,convId:"",channelId:void 0,replyChainId:void 0,messageId:void 0}}}return r?.mark(c.ck.ChatQueryReturnedEmptyData,{reason:`ChatQuery result is empty for inputThreadId: ${a}`}),o?.mark(c.ck.ChatQueryReturnedEmptyData,{reason:`ChatQuery result is empty for inputThreadId: ${a}`}),e.error(`Could not determine if inputThreadId is chat/channel, ChatQuery result is empty for inputThreadId: ${a}`),{...t,convId:"",channelId:void 0,replyChainId:void 0,messageId:void 0}},E=async(e,a,t,n,i,r,o)=>{const s=C(e.entryPoint);switch(e.entryPoint){case p.mQ.adaptiveCardCollabStage:return n?(0,S.M)(e,t,n,i,s):Promise.reject("Entity commanding not available");case p.mQ.deepLinkStageView:if(!o)return P(e);switch(e.openMode){case m.Sm.modal:return P(e);case m.Sm.popoutWithChat:return e={...e,showChatTitleForHeader:!0},k(e,t,i);case m.Sm.popout:return w(e);default:return P(e)}case p.mQ.stageViewOpenSDKApi:if(!r)return n?y({...e,openMode:"modal"},a,n,s,i):Promise.reject("Entity commanding not available");switch(e.openMode){case m.Sm.popout:return n?(0,f.M)(e,t,n,i,s):Promise.reject("Entity commanding not available");case m.Sm.popoutWithChat:return n?(0,S.M)(e,t,n,i,s):Promise.reject("Entity commanding not available");case m.Sm.modal:default:return n?y(e,a,n,s,i):Promise.reject("Entity commanding not available")}case p.mQ.adaptiveCardStageModal:return n?y(e,a,n,s,i):Promise.reject("Entity commanding not available");default:return Promise.reject(`Stage view entry point not supported. Entrypoint: ${e.entryPoint}`)}},C=e=>{switch(e){case p.mQ.stageViewOpenSDKApi:return s.D.StageViewOpenSDKApi;case p.mQ.deepLinkStageView:return s.D.StageViewDeeplink;default:return s.D.AdaptiveCardInvokeButton}},k=async(e,a,t)=>{const{stageViewId:n,linkedEntity:i}=await(0,m.kf)(e,a,t);return n&&i?Promise.resolve({entityCommand:{entity:{id:n,type:l.py.platformStage,action:l.uk.create,linkedEntity:i},command:{stateTransition:d.su.new,visibilityState:d.fe.show,correlation:{source:s.D.StageViewDeeplink,startTimestamp:e.scenarioStartTime}},entityOptions:e},metadata:{allowAnonymous:!1}}):Promise.reject("Entity commanding not available")},A=async()=>Promise.resolve({entityCommand:{entity:{type:l.py.unsupportedcollabstageerrordialog,action:l.uk.view},command:{stateTransition:d.su.extend,visibilityState:d.fe.show},entityOptions:{}},metadata:{allowAnonymous:!1}}),w=async e=>{const a=JSON.parse(e.tabInfo),t=(0,m.SO)(e,a.tabInfo.contentUrl);return t?Promise.resolve({entityCommand:{entity:{id:t,type:l.py.platformstagewithoutchat,action:l.uk.view},command:{stateTransition:d.su.new,visibilityState:d.fe.show,correlation:{source:s.D.StageViewDeeplink,startTimestamp:e.scenarioStartTime}},entityOptions:e},metadata:{allowAnonymous:!1}}):Promise.reject("Entity commanding not available")},P=async e=>Promise.resolve({entityCommand:{entity:{id:e.appId,type:l.py.platformstagemodal,action:l.uk.view},command:{visibilityState:d.fe.show,stateTransition:d.su.extend,correlation:{source:s.D.StageViewDeeplink}},entityOptions:e},metadata:{allowAnonymous:!1}})},529280:(e,a,t)=>{t.d(a,{Bz:()=>c,kO:()=>p});var n=t(250033),i=t(818319),r=t(445217);const{createContext:o,memo:s,useContext:l}=i,d=o({UNSAFE_dialogPaddingLeftOffset:0}),c=s((e=>{const{children:a,...t}=e;return(0,n.t)(d.Provider,{value:(0,r.Q)(t),children:a})}));c.displayName="UNSAFE_DialogOffsetContextProvider";const p=()=>l(d)},573436:(e,a,t)=>{t.d(a,{DV:()=>n,Du:()=>R,I4:()=>F});var n,i=t(818319),r=t(681971),o=t(379263),s=t(683184),l=t(994575),d=t(12978),c=t(629494),p=t(237867),m=t(462512),u=t(684211),h=t(349422),g=t(621819),I=t(343498),S=t(100471),y=t(509899),f=t(4652),T=t(741108),b=t(179496),v=t(886071),E=t(665911),C=t(918258),k=t(574962),A=t(543491),w=t(329310),P=t(677362),N=t(610597);!function(e){e.PlatformApp="PlatformApp",e.OneUp="OneUp",e.OneUpPageEmbed="OneUpPageEmbed"}(n||(n={}));const R=()=>{const{entityCommanding:e,scenarioFactory:a,windowHistoryNavigationService:t}=(0,r.SE)(),{entity:n,getEntityOptions:d}=(0,o.sV)(),m=(0,p.x)(),{enableAppBasedFileHandlingForWXPTMP:u,enableFilesAppBasedFileHandlingForPDFTMP:h,enableFilesPDFAppIdForViewTMP:g,enableFilesAdminPreinstallCheckForPDFAppTMP:I,enableFilesAAACheckForPDFAppTMP:S,allowedInstallerAzureADAppIdsForPDFApp:y,enableAppBasedFileHandlingForOneNoteTMP:f,enableAppBasedFileHandlingForVisioTMP:T}=(0,c.NC)(s.J.Files,["enableAppBasedFileHandlingForWXPTMP","enableFilesAppBasedFileHandlingForPDFTMP","enableFilesPDFAppIdForViewTMP","enableFilesAdminPreinstallCheckForPDFAppTMP","enableFilesAAACheckForPDFAppTMP","allowedInstallerAzureADAppIdsForPDFApp","enableAppBasedFileHandlingForOneNoteTMP","enableAppBasedFileHandlingForVisioTMP"]),{enableAppsQueryOptimization:b,enablePopOutFileChicletInMultiWindow:v,enableInstalledAppQueryOptimization:E}=(0,c.NC)(s.J.Extensibility,["enableAppsQueryOptimization","enablePopOutFileChicletInMultiWindow","enableInstalledAppQueryOptimization"]),{isPrimaryWindow:C}=(0,c.NC)(s.J.Core,["isPrimaryWindow"]),k=(0,l.w)("InTeamsFileViewerResolver");return i.useCallback((async(i,r,o,s)=>{O(U(i,!!v,!!C),r,o,s,e,n,t,d,m,!!u,!!h,!!S,g,y,!!I,!!f,!!T,!!b,!!E,k,a)}),[e,n,t,d,m,u,h,S,g,y,I,f,T,b,E,v,k,a,C])},O=async(e,a,t,n,i,r,o,s,l,c,p,m,h,g,I,S,y,f,T,b,v)=>{const E=v.newScenario(A.RG.FileViewerResolver);try{const C=(0,u.m)(e.fileType),k=await M(e,l,b);e={...e,tenantId:k?.channelByID.owningTeam?.tenantId||void 0};const w=await F(l,e.fileType,c,p,m,h,g,I,S,y,f,T,b,v);if(e.subEntityId){const a=s(d.py.extensions,d.uk.view);o.pushToWindowHistory(r,{...a,subEntityId:e.subEntityId})}if(w)return E.mark(A.ck.FileViewerResolverRoutingToInstalledApp),n(a,{...t,dataBagProperties:{...t.dataBagProperties,fileViewerType:"PlatformApp",fileViewerAppId:w,fileAction:P.Y_.editInTeams},actionKey:"edit_in_teams"}),(0,N.ui)(v,w,"personalApp",b,e.shouldOpenInMultiWindow,!0),i.file.launchFileViewApp(w,{...e,baseUrl:e.siteUrl}),void E.stop();C===u.xw.OneUpViewer?(E.mark(A.ck.FileViewerResolverRoutingToOneupViewer),n(a,{...t,dataBagProperties:{...t.dataBagProperties,fileViewerType:"OneUp",fileAction:P.Y_.openInTeams},actionKey:"edit_in_teams"}),i.file.openInOneup(e)):(b.errorToTelemetry?.("This means no platform app installed for a office file type. Not good","files_viewer_resolver"),E.mark(A.ck.FileViewerResolverFallback),n(a,{...t,actionKey:"edit_in_teams"}),i.file.fileById(e)),E.stop()}catch(e){b.errorToTelemetry?.(`Unexpected error while file viewer resolution ${e?.message}`,"files_viewer_resolver"),E.fail({errorCode:e?.errorCode,message:e?.message,reason:"Unexpected error while file viewer resolution"})}},F=async(e,a,t,n,i,r,o,s,l,d,c,p,u,h)=>{const g=await D(e,a,t,n,i,r,o,s,l,d,c,p,u,h);if(g){const a=await(0,m.xJ)(e,u,h,g,c,"file-viewer-route-to-platform-app",{shouldFetchPersonalApps:!0,enableInstalledAppQueryOptimization:p});if(a&&a.length>0&&(u.logNoPii?.(`getDocumentViewAppId: Pre-install check enabled: app pre-install state ${a[0].installationState}`),L(a[0])))return g}},D=async(e,a,t,n,i,r,o,s,l,d,c,p,m,A)=>{const{icon:w}=(0,u.hU)(a);switch(w){case h.N:case g.P:if(t)return"3e0a4fec-499b-4138-8e7c-71a9d88a62ed";break;case I.J:case S.f:if(t)return"d7958adf-f419-46fa-941b-1b946497ef84";break;case y.u:case f.y:if(t)return"1c256a65-83a6-4b5c-9ccf-78f8afb6f1e8";break;case T.n:if(n)return _(r,s,i,o,e,c,p,m,A);break;case b.m:case v.U:case E.S:if(l)return"0d820ecd-def2-4297-adad-78056cde7c78";break;case C.q:case k.B:if(d)return"d7958adf-f419-46fa-941b-1b946497ef95"}},_=async(e,a,t,n,i,r,o,s,l)=>{const d=e;if(d){const e=await(0,m.xJ)(i,s,l,d,r,"check-status-and-give-pdf-app-for-user",{shouldFetchPersonalApps:!0,enableInstalledAppQueryOptimization:o});if(t){if(!(e&&e.length>0))return;{const a=e[0].installerIdentity?.azureAdAppId,t=a&&n?.includes(a);if(s.logNoPii?.(`getDocumentViewAppId: AAA Pre-install check enabled: Is App Installed by AAA:  ${t} and installedByAppId: ${a}}`),t)return d}}return a?e&&e.length>0?(s.logNoPii?.(`getDocumentViewAppId: Pre-install check enabled: app pre-install state ${e[0].installationState}`),"AdminPreInstalled"===e[0].installationState?d:void 0):void 0:d}},L=e=>!!e.installationState&&["Installed","InstalledAndFavorited","InstalledAndPermanent","AdminPreInstalled"].includes(e.installationState),M=async(e,a,t)=>{try{if(e.threadId){const{data:n,error:i}=await a.query({query:w.H,fetchPolicy:"cache-first",variables:{conversationId:e.threadId}});return i?void t.errorToTelemetry?.(`getChannelFields threw error ${i.message}`,"files_viewer_resolver"):n}return}catch(e){return void(e?.message?.includes("Id is not of a channel")?t.logNoPii?.(`Not called from channel ${e.message}`):t.errorToTelemetry?.(`Exception while fetching channel info ${e?.message}`,"files_viewer_resolver"))}},U=(e,a,t)=>a&&!t?{...e,shouldOpenInMultiWindow:!0}:e},435205:(e,a,t)=>{t.d(a,{Sm:()=>p,kf:()=>y,fd:()=>m,g:()=>S,SO:()=>I,qV:()=>f,R3:()=>h,zt:()=>u});var n=t(683184),i=t(12978),r=t(9095),o=t(610597),s=t(681375),l=t(543491),d=t(233304);const c={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"ComponentsStageViewUtilsQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"conversationId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callByThreadId"},arguments:[{kind:"Argument",name:{kind:"Name",value:"conversationId"},value:{kind:"Variable",name:{kind:"Name",value:"conversationId"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]};var p;!function(e){e.modal="modal",e.popout="popout",e.popoutWithChat="popoutWithChat"}(p||(p={}));const m=(e,a)=>a?`${e};replyChainId=${a}`:e,u=(e,a,t,i)=>{const{licenseType:o}=e.get(n.J.UserResources),{enableStageviewMW:s,enableStageviewMWInChannels:l,enableCollabStageForEDU:c}=e.get(n.J.Extensibility),p=a===d.E4.desktop;return!(!c&&(0,r.qi)(o)||!p)&&(s&&!l?"chats"===t.type&&!i:!!l&&("chats"===t.type||"channels"===t.type))},h=(e,a)=>{const t=g(a),n=e.newScenario(t),i=e.newScenario(l.RG.PlatformTabLaunch);return n.clientId=n.id,i.clientId=i.id,e.hoistScenarioToCore?.(n),e.hoistScenarioToCore?.(i),{phase1CollabStageScenario:n,endToEndScenario:i}},g=e=>{switch(e){case d.mQ.adaptiveCardStageModal:return l.RG.PlatformTabStageModalLaunch;case d.mQ.adaptiveCardCollabStage:return l.RG.PlatformTabCollabStageLaunch;case d.mQ.deepLinkStageView:case d.mQ.stageViewOpenSDKApi:default:return l.RG.PlatformTabStageViewFrameLoading}},I=(e,a)=>`${e.appId}-${e.convId}-${a}-${e.reloadToggle}`;function S(e,a,t){const n={};try{if(e.linkedEntity?.type===i.py.calls){const{convId:t,messageId:r}=(0,s.U3)(e,i.py.extensions,i.uk.view,a);r&&"0"!==r?(n.channelId=t,n.parentMessageId=r,n.channelMeetingMessageId=r,n.chatId=t):n.chatId=t}else if(e.linkedEntity?.type===i.py.channels){const{channelId:t}=e.linkedEntity?.id&&JSON.parse(e.linkedEntity?.id);n.channelId=t;const{messageId:r,replyChainId:o}=(0,s.U3)(e,i.py.extensions,i.uk.view,a);n.replyChainId=o,n.parentMessageId=r,n.channelMeetingMessageId=r}else switch(e.type){case i.py.channels:const{channelId:r}=e.id&&JSON.parse(e.id);n.channelId=r;break;case i.py.chats:const s=(e.id??"").split(";replyChainId=");s.length>1&&(n.replyChainId=s[1],n.channelId=s[0]),n.chatId=s[0];break;case i.py.extensions:const l=(0,o.cq)(e,t,a);n.parentMessageId=l?.messageId,n.channelMeetingMessageId=l?.messageId,n.chatId=l?.messageId?void 0:l?.threadId,n.channelId=l?.messageId?l?.threadId:void 0}}catch(e){a.log("Error while parsing source view entity.",e?.message)}return n}const y=async(e,a,t)=>{try{const{convId:n}=e;t?.appendEventData({"StageView.OpenMode":"popoutWithChat"});const r=JSON.parse(e.tabInfo);t?.mark(l.ck.StageViewAppTabInfoParsed);const{data:o}=await a.query({query:c,fetchPolicy:"no-cache",variables:{conversationId:n}}),s=I(e,r.tabInfo.contentUrl);t?.mark(l.ck.StageViewGetCallByThreadIdSuccessful);return{stageViewId:s,linkedEntity:o?.callByThreadId?{id:`${n}-stageview`,type:i.py.platformstageinactivemeeting}:{id:m(n,e.replyChainId),type:i.py.chats}}}catch(e){return t?.mark(l.ck.StageViewFailedBeforeCommandTrigger),{}}},f=(e,a)=>{const{sdkHostType:t}=e.get(n.J.Sdk),i="Desktop"===t,{enableProgrammaticPopoutStageViewOpenAPI:r,enableProgrammaticPopoutStageDeeplink:o}=e.get(n.J.Extensibility);return a.entryPoint===d.mQ.adaptiveCardCollabStage?p.popoutWithChat:a.entryPoint===d.mQ.deepLinkStageView?T(a,i,!!o):T(a,i,!!r)},T=(e,a,t)=>{if(!a||!t)return p.modal;const n=e.openMode||p.popoutWithChat;return n===p.popoutWithChat?e.convId||e.channelId?e.channelId&&!e.replyChainId?p.popout:p.popoutWithChat:p.popout:n}},970368:(e,a,t)=>{var n,i,r;t.d(a,{PG:()=>n,x9:()=>i,xL:()=>r}),function(e){e.ComposeMessage="composeMessage",e.PostCompose="postCompose",e.MessageList="messageList",e.Powerbar="powerbar",e.VirtualTreeList="virtualTreeList",e.FeedsFilter="feedsFilter",e.PeoplePicker="peoplePicker",e.SearchBox="searchBox",e.Floodgate="floodgate",e.ChatListSearchFilter="chatListSearchFilter",e.ChannelListSearchFilter="channelListSearchFilter",e.CallingPerf="callingPerf",e.TeamsAndChannelsTable="teamsAndChannelsTable",e.DiscoverSurfaceFeedList="discoverSurfaceFeedList",e.AllChannelSystemMessages="channelInfoPaneAllSystemMessages",e.AllPinnedPosts="channelInfoPaneAllPinnedPosts",e.UnifiedFunPicker="unifiedFunPicker",e.CreateTeamGallery="createTeamGallery",e.AddMember="addMember",e.MeetForWorkList="meetForWorkList",e.MeetForWorkSearchFilter="meetForWorkSearchFilter",e.PeopleAppContactList="peopleAppContactList",e.SimpleCollabLeftRail="simpleCollabLeftRail",e.UserOnboardingToTeam="UserOnboardingToTeam",e.TrinityChannelsTab="TrinityChannelsTab"}(n||(n={})),function(e){e.CallingScreen="callingScreen",e.Chat="chat",e.ChannelL1="channelL1",e.ChannelL2="channelL2",e.ChannelSettings="channelSettings",e.ChatList="chatList",e.Communities="communitites",e.DialPad="dialpad",e.FeedList="feedlist",e.FlyoutChatList="flyoutChatList",e.FlyoutPeopleL2="flyoutPeopleL2",e.GroupChat="groupChat",e.MeetingChat="meetingChat",e.MessageEscalation="messageEscalation",e.NewChat="newChat",e.PeopleSearch="peopleSearch",e.Floodgate="floodgate",e.ChannelList="ChannelList",e.ManageThreadMembers="manageThreadMembers",e.ManageChannelThreadMembers="manageChannelThreadMembers",e.ManagePrivateChannelThreadMembers="managePrivateChannelThreadMembers",e.ManageSharedChannelThreadMembers="manageSharedChannelThreadMembers",e.ManageTeams="manageTeams",e.ChannelInvitationsTab="channelInvitationsTab",e.DiscoverSurface="discoverSurface",e.ThreadMembersSearch="threadMembersSearch",e.SharedChannelPendingInvites="sharedChannelPendingInvites",e.PendingJoinRequests="pendingJoinRequests",e.SelectPeoplePickerExtensibility="selectPeoplePickerExtensibility",e.ChannelsTable="channelsTable",e.SpeedDial="SpeedDial",e.CommunitiesJoinRequests="communitiesJoinRequests",e.PeopleApp="peopleApp",e.CommentStreamChatPane="commentStreamChatPane"}(i||(i={})),function(e){e.HeartbeatMonitor="HeartbeatMonitor",e.CallingPerfMonitor="CallingPerfMonitor"}(r||(r={}))},681375:(e,a,t)=>{t.d(a,{Mf:()=>i,f$:()=>r,U3:()=>o,cW:()=>s});var n=t(12978);function i(e,a){return{entity:{type:n.py.chats,action:n.uk.create,id:r(e)},command:a}}function r(e){return JSON.stringify(e&&e.length>0?e.sort():[])}function o(e,a,t,n){let i={};if(!e)return i;if(e.type===a&&e.action===t){const a=e.options;if(a&&"string"==typeof a)try{i=JSON.parse(a)}catch{n.warn(`Entity options are in unexpected format. Expected a valid stringified JSON object but instead received: ${a}.`)}}else n.warn(`Entity options are (incorrectly) being asked for type and action that do not pertain to the entity. ${e.type} != ${a} or ${e.action} != ${t}`);return i}const s=e=>`${e.substring(0,32)}00000000${e.substring(40)}`},203868:(e,a,t)=>{t.d(a,{y:()=>n});const n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"messageToParentResult"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"appId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"messageToParentResult"},arguments:[{kind:"Argument",name:{kind:"Name",value:"appId"},value:{kind:"Variable",name:{kind:"Name",value:"appId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"appId"}},{kind:"Field",name:{kind:"Name",value:"message"}}]}}]}}]}},218420:(e,a,t)=>{t.d(a,{Kz:()=>s,Kp:()=>l,D5:()=>c,eT:()=>p,uO:()=>m,aE:()=>u,eA:()=>h,C$:()=>g,h5:()=>I,vf:()=>S,Mw:()=>y,IM:()=>f});var n=t(689626),i=t(702135),r=t(803238);const o="ParsingMeetingUrl",s=e=>{const a=decodeURIComponent(e),t=new RegExp("context=(.*)$","g").exec(a);if(!t||t.length<2)throw d(`Meeting context is not in valid format ${a}`);const n=JSON.parse(t[1]);if(!n||!n.Tid||!n.Oid)throw d("Meeting url is malformed Tid or Oid is missing");return{tenantId:n.Tid,organizerId:n.Oid}},l=e=>e.context===o&&e.code===n.jK.ErrorParsingQueryParams,d=e=>(0,i.Tr)(o,n.jK.ErrorParsingQueryParams,"",void 0,e),c=e=>{const a="meet",t="meetup-join",n=new URL(e);let i;if(n.pathname.includes(a)||n.pathname.includes(t))i=n;else{if(!n.hash||!n.hash.includes(a)&&!n.hash.includes(t))throw d("Invalid URL - unsupported URL format");i=new URL(n.hash.substring(1),n.origin)}const r=i.searchParams,o=i.pathname.split("/"),s={isLegacyUrl:!1,meetingCloud:i.hostname,meetingUrl:e};if(o[2]===t){const e=r.get("context");if(5!==o.length||!e)throw d("Invalid URL - context param is missing");s.threadId=decodeURIComponent(o[3]),s.messageId=decodeURIComponent(o[4]);try{const a=JSON.parse(decodeURIComponent(e));if(!a.Tid||!a.Oid)throw d("Invalid URL - context param is invalid. Tid or Oid missing.");s.tenantId=a.Tid,s.organizerId=a.Oid,s.isBroadcastMeeting=a.IsBroadcastMeeting||void 0,s.attendeeRole=a.role||void 0,s.replyChainMessageId=a.MessageId||void 0,s.isLegacyUrl=!0}catch(a){const t=/\{\"Tid\":\"([\w\-]{36})\",\"Oid\":\"([\w\-]{36})\",\"IsBr/,n=3,i=decodeURIComponent(e).match(t);if(i?.length!==n)throw a;{const e=1,a=2;s.tenantId=i[e],s.organizerId=i[a],s.isBroadcastMeeting=!0,s.attendeeRole=void 0,s.replyChainMessageId=void 0,s.isLegacyUrl=!0}}}else{if(o[1]!==a)throw d("Invalid URL - unsupported URL format");s.meetingId=o[2],s.passCode=r.get("p")||void 0}return s},p=(e,a,t,n,i)=>{const o=c(e),s=(0,r.isEmpty)(n)?"calendar_join_meeting_utils":n;let l;return o.isLegacyUrl?(a.mark("cal_join_executing_legacy_url_flow"),l={type:"Meeting",joinOptions:{meeting:{showPrejoin:!0,isPSTN:!1,title:t},context:s},coordinates:{legacyMeeting:{meetingCloud:o.meetingCloud,conversationId:o.threadId||"",rootMessageId:o.messageId||"",messageId:o.replyChainMessageId||o.messageId||"",isChannel:"0"!==o.messageId,isAdhoc:!1,tenantId:o.tenantId||"",organizerId:o.organizerId||"",broadcast:o.isBroadcastMeeting?{role:i??"None"}:null}}}):(a.mark("cal_join_executing_non_legacy_url_flow"),l={type:"Meeting",joinOptions:{meeting:{showPrejoin:!0,isPSTN:!1,title:t},context:s},coordinates:{meetingData:{meetingUrl:e}}}),l},m=e=>{try{return new URL(e).hostname}catch(a){return e.split("/")?.[2]?.split("@")?.pop()?.split(":").shift()||""}},u=e=>{let a=!1;if(e&&e.skypeTeamsDataObj){a=1===e.skypeTeamsDataObj.type}return a};function h(e){return!(!e||!e.skypeTeamsDataObj||(0,r.isEmpty)(e.skypeTeamsDataObj))&&!1===e.skypeTeamsDataObj.private}function g(e){return"Group"===e?.mailboxType}const I=e=>!!e.webinarRegistration?.webinarId,S=e=>!!e.virtualEventsData?.eventId,y=e=>{try{return"meet"===new URL(e).pathname.split("/")[1]}catch(e){return!1}},f=(e,a,t,n)=>e&&a&&(t||!1!==n)},842070:(e,a,t)=>{t.d(a,{zm:()=>n,py:()=>i,WK:()=>r,bW:()=>d,x$:()=>c,Zk:()=>p,OO:()=>m});var n,i,r,o,s,l=t(689626);!function(e){e.logErrorMessage="errorMessage",e.internalErrorCode="errorCode",e.correlationId="correlationId",e.httpStatusCode="httpStatusCode",e.isRecoverable="isRecoverable",e.reportingService="reportingService",e.subError="subError",e.serviceErrorMessage="serviceErrorMessage",e.cmdRequestId="requestId"}(n||(n={})),function(e){e.UNKNOWN_ERROR="UnknownError",e.FORBIDDEN="Forbidden",e.NOT_FOUND="NotFound",e.CONFLICT="Conflict",e.UNAUTHORIZED="Unauthorized",e.BAD_REQUEST="BadRequest",e.INTERNAL_SERVER_ERROR="InternalServerError",e.SERVICE_UNAVAILABLE="ServiceUnavailable",e.REQUEST_THROTTLED="RequestThrottled",e.FAILED_TO_CALL_SCHEDULING_SERVICE="FailedToCallSchedulingService",e.GATEWAY_TIMEOUT="GatewayTimeout",e[e.DEFAULT_ERROR=1e3]="DEFAULT_ERROR",e[e.BEGIN_CLIENT_ERROR_CODES=1001]="BEGIN_CLIENT_ERROR_CODES",e[e.INVALID_RESPONSE=1002]="INVALID_RESPONSE",e[e.CHANGE_KEY_NOT_FOUND=1003]="CHANGE_KEY_NOT_FOUND",e[e.EMPTY_INPUT=1004]="EMPTY_INPUT",e[e.INVALID_SECRET=1005]="INVALID_SECRET",e[e.RENEW_TOKEN_FAILED=1006]="RENEW_TOKEN_FAILED",e[e.INTERNAL_CLIENT_ERROR=1007]="INTERNAL_CLIENT_ERROR"}(i||(i={})),function(e){e.DEFAULT_BAD_REQUEST="Request is not correct, please ensure you are passing the values for each parameter.",e.DEFAULT_ERROR="Unknown error occurred",e.COLLAB_OBJECT_NOT_FOUND="Collab object could not be found for the provided external entity key",e.RESOURCE_CONFLICT="Resource conflicts with another; location URLs must be unique",e.EMPTY_INPUT="Input is empty",e.INVALID_SECRET="Invalid Secret while trying to commit resource",e.FORBIDDEN="User does not have permissions to access the requested resource",e.INVALID_RESPONSE="Response from CMD Artifact service is not valid.",e.INTERNAL_CLIENT_ERROR="An internal error was registered on the client.",e.CHANGE_KEY_NOT_FOUND="No change key in collab object returned.",e.UNAUTHORIZED="User does not have permissions to perform the requested action",e.INTERNAL_SERVER_ERROR="An error occurred with Artifacts service",e.SERVICE_UNAVAILABLE="Service is not currently available.",e.REQUEST_THROTTLED="Requests to the artifacts service are being throttled.",e.FAILED_TO_CALL_SCHEDULING_SERVICE="Artifact service was not able to call scheduling service",e.GATEWAY_TIMEOUT="A downstream service is timing out."}(r||(r={})),function(e){e.RESOURCE_CONFLICT="Conflict - Reason: Conflict",e.BAD_REQUEST="Bad Request",e.NOT_FOUND="NotFound - Reason: Not Found",e.FORBIDDEN="Permission Issue"}(o||(o={})),function(e){e.POPUP_BLOCKED="Error opening popup",e.RENEW_TOKEN_FAILED="Token Renewal Failed"}(s||(s={}));const d="Unknown",c="None",p="None",m=(new Map([[s.POPUP_BLOCKED,l.jK.AuthPopupWindowBlocked],[s.RENEW_TOKEN_FAILED,i.RENEW_TOKEN_FAILED]]),new Map([[i.UNKNOWN_ERROR,r.DEFAULT_ERROR],[i.CONFLICT,r.RESOURCE_CONFLICT],[i.NOT_FOUND,r.COLLAB_OBJECT_NOT_FOUND],[i.BAD_REQUEST,r.DEFAULT_BAD_REQUEST],[i.FORBIDDEN,r.FORBIDDEN],[i.UNAUTHORIZED,r.UNAUTHORIZED],[i.INTERNAL_SERVER_ERROR,r.INTERNAL_SERVER_ERROR],[i.SERVICE_UNAVAILABLE,r.SERVICE_UNAVAILABLE],[i.REQUEST_THROTTLED,r.REQUEST_THROTTLED],[i.INVALID_RESPONSE,r.INVALID_RESPONSE],[i.CHANGE_KEY_NOT_FOUND,r.CHANGE_KEY_NOT_FOUND],[i.FAILED_TO_CALL_SCHEDULING_SERVICE,r.FAILED_TO_CALL_SCHEDULING_SERVICE],[i.GATEWAY_TIMEOUT,r.GATEWAY_TIMEOUT]]))},925703:(e,a,t)=>{t.d(a,{Q:()=>o});var n=t(677362);const i=new RegExp(n.yH.oneDriveFile),r=new RegExp(n.yH.sharePointFile),o=(e,a)=>{if(a){const t=a.replace(n.yH.leadingAndTrailingSlashesRegex,"").split("/");t.pop();const i=t.join("/");return`${new URL(e).origin}/${i}/`}if(r.test(e)){const a=e.match(r);return a?a[0]:null}if(i.test(e)){const a=e.match(i);return a?a[0]:null}if(e){const a=e.split("/"),t=2;if(a.length>=t)return`${a[0]}//${a[t]}/`}return e}},249998:(e,a,t)=>{t.d(a,{X:()=>i});var n=t(677362);const i=e=>{switch(e){case n.Bx.unauthorizedAccess:return!1;case n.Bx.clientError:case n.Bx.badRequest:case n.Bx.internalServerError:case n.Bx.serviceUnavailable:case n.Bx.tooManyRequests:return!0;default:return!1}}},931495:(e,a,t)=>{var n;t.d(a,{a:()=>n}),function(e){e[e.E164=0]="E164",e[e.INTERNATIONAL=1]="INTERNATIONAL",e[e.NATIONAL=2]="NATIONAL"}(n||(n={}))},802076:(e,a,t)=>{let n;t.d(a,{B:()=>r});const i=async()=>{if(!n){const e=await Promise.all([t.e(377348),t.e(187946),t.e(112403),t.e(463781),t.e(681896),t.e(457628),t.e(182149),t.e(909020),t.e(346992),t.e(586535),t.e(591878),t.e(607784),t.e(986797),t.e(65537),t.e(505990),t.e(865804),t.e(88373),t.e(612377),t.e(766254),t.e(933161),t.e(128770),t.e(649800),t.e(729251),t.e(663276),t.e(553940),t.e(857282),t.e(310307),t.e(44499),t.e(242213),t.e(424772),t.e(814315),t.e(593837),t.e(157477),t.e(233171),t.e(852144),t.e(289814),t.e(672822),t.e(83395),t.e(727035),t.e(851290),t.e(904986),t.e(364592),t.e(316808),t.e(532863),t.e(833851),t.e(618412),t.e(115829),t.e(577037),t.e(227290),t.e(24994),t.e(928362),t.e(879608),t.e(43077),t.e(522359),t.e(845730),t.e(362148),t.e(642917),t.e(213629),t.e(27729),t.e(371104),t.e(379371),t.e(796594),t.e(841342),t.e(14415),t.e(625402),t.e(484885),t.e(797394),t.e(723572),t.e(274),t.e(758354),t.e(308918),t.e(864654),t.e(891248),t.e(29311),t.e(909663),t.e(34607),t.e(289458),t.e(718542),t.e(685827),t.e(474133),t.e(609660),t.e(371898),t.e(210338),t.e(442948),t.e(406628),t.e(566118),t.e(357903),t.e(123513),t.e(998264),t.e(735313),t.e(258544),t.e(963461),t.e(968147),t.e(34671),t.e(450367),t.e(230050),t.e(700818),t.e(986305),t.e(458629),t.e(414720),t.e(837458),t.e(403062),t.e(284523),t.e(861153),t.e(617758),t.e(299585),t.e(792751),t.e(737885),t.e(469858),t.e(557964),t.e(973647),t.e(568740)]).then(t.bind(t,138608));n=new e.PhoneNumberService}return n};class r{constructor(e,a,t){this.phoneNumberService=e,this.value=a,this.isNormalized=t}static async tryParse(e,a){const t=await i(),{regionCode:n,normalizer:o,convertAlphaCharactersToNumber:s,isMri:l}=a||{},d=r.getUserLocale(n,o?.getITUCountryPrefix(),t),{phoneNumber:c,extension:p}=r.separateExtension(t,e);let m=c;!0===s&&(m=t.convertAlphaCharactersInNumber(m));const u=o?.normalize(m),h=u?.isNormalized,g=u?.phoneNumber||m;try{let e;return e=l?t.parse(`${g}${p}`,d):t.parseAndKeepRawInput(`${g}${p}`,d),new r(t,e,h)}catch(e){return}}static async isPossibleNumber(e,a){try{const t=await i(),n=t.parse(e,r.getUserLocale(void 0,a.getITUCountryPrefix(),t));return t.isPossibleNumber(n)}catch(e){return!1}}static async isStandardFormatNormalized(e,a,t,n){if(!e)return!1;try{const o=await i(),s=a.normalize(e),l=o.parse(s.phoneNumber,r.getUserLocale(t,a.getITUCountryPrefix(),o));return o.isPossibleNumber(l)&&(n||o.isValidNumber(l))}catch(e){return!1}}static async getValidNumber(e,a,t){return r.isStandardFormatNormalized(e,a,t).then((t=>t?e:e.startsWith("+")?"":r.isStandardFormatNormalized("+".concat(e),a).then((a=>a?`+${e}`:""))))}static isValidNumberForAnyRegion(e,a){if(!e)return!1;try{const t=r.getPhoneNumberService(e).getRegionCode(r.getPhoneNumberValue(e));return!!t&&-1!==a.indexOf(t)}catch(e){return!1}}static getPhoneNumberService(e){return e.phoneNumberService}static getPhoneNumberValue(e){return e.value}static getIsNormalized(e){return e.isNormalized}static getUserLocale(e,a,t){if(e)return e;if(!a)return;let n;return a&&(n=t.getRegionCodeForCountryCode(Number(a))),n||(n="us"),n.toLowerCase()}static separateExtension(e,a){const t=a.search(e.getExtensionRegx()),n=t>-1;return{phoneNumber:n?a.substring(0,t):a,extension:n?a.substring(t):""}}}}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/106979-f20c7a9d98d9c74d.js.map