"use strict";(this.webpackChunk_msteams_react_web_client=this.webpackChunk_msteams_react_web_client||[]).push([[505724],{910215:(e,n,t)=>{t.d(n,{K:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userPreferences"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"controllerConnectedServicesEnabled"}},{kind:"Field",name:{kind:"Name",value:"readReceiptsEnabled"}}]}}]}}]}},698004:(e,n,t)=>{t.d(n,{r:()=>a});const a={kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"ComponentsConnectedCalendarConnectedCalendarSettingFragment"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ConnectedCalendarSetting"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"source"}},{kind:"Field",name:{kind:"Name",value:"accountAddress"}},{kind:"Field",name:{kind:"Name",value:"accountId"}},{kind:"Field",name:{kind:"Name",value:"isSyncAllowed"}},{kind:"Field",name:{kind:"Name",value:"eTag"}}]}}]}},676210:(e,n,t)=>{t.d(n,{M:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"syncConnectedCalendarSettings"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"syncConnectedCalendarSettings"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callerInfo"},value:{kind:"Variable",name:{kind:"Name",value:"callerInfo"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"ComponentsConnectedCalendarConnectedCalendarSettingFragment"}}]}}]}},...t(698004).r.definitions]}},372795:(e,n,t)=>{t.d(n,{F:()=>i});var a=t(14415);function i(e,n){return(0,a.yS)({observed:{names:Array.isArray(e)?e:[e]},uncontrolled:n?{}:void 0})}},886400:(e,n,t)=>{t.d(n,{f:()=>d});var a=t(250033),i=(t(818319),t(722256)),o=t(173292);const d=e=>(0,a.t)(o.f,{loaderRenderer:()=>(0,a.t)(i.T,{}),...e})},722256:(e,n,t)=>{t.d(n,{T:()=>r});var a=t(250033),i=t(818319),o=t(444156),d=t(681971);const s=(0,t(696618).s)({root:{Bqenvij:"f1l02sjl"}},{d:[".f1l02sjl{height:100%;}"]}),r=({label:e,delay:n})=>{const t=i.useRef(),r=(0,d.SE)(),l=r?.host||window,[c,E]=i.useState(!n),m=s();return i.useEffect((()=>(void 0!==n&&n>0&&!t.current&&(t.current=l.setTimeout((()=>{E(!0)}),n)),()=>l.clearTimeout(t.current))),[n,l]),c?(0,a.t)(o.$,{size:"large",label:{children:e||"Loading..."},labelPosition:"below",className:m.root}):null}},206661:(e,n,t)=>{t.d(n,{su:()=>d,Ef:()=>s,V7:()=>r});var a=t(683184),i=t(629494);const o=({ageGroup:e,enableUnderAgeOfConsentPolicy:n})=>!!n&&("MinorWithMsaParentalConsent"===e||"MinorWithoutMsaParentalConsent"===e||"MinorNoMsaParentalConsentRequired"===e||"MinorWithoutParentalConsent"===e||"MinorWithParentalConsent"===e||"MinorNoParentalConsentRequired"===e),d=e=>{const{ageGroup:n,enableUnderAgeOfConsentPolicy:t}=e.get(a.J.AgeConsent);return o({ageGroup:n,enableUnderAgeOfConsentPolicy:t})},s=()=>{const{ageGroup:e,enableUnderAgeOfConsentPolicy:n}=(0,i.NC)(a.J.AgeConsent,["ageGroup","enableUnderAgeOfConsentPolicy"]);return o({ageGroup:e,enableUnderAgeOfConsentPolicy:n})},r=e=>{const{disableGiphyForUnderAgeUser:n}=e.get(a.J.AgeConsent);return d(e)&&!!n}},730479:(e,n,t)=>{t.d(n,{wz:()=>E,C9:()=>m,tW:()=>u,bC:()=>p,km:()=>_,yw:()=>I,vV:()=>v,nh:()=>T,M3:()=>g,I6:()=>N,eM:()=>D,u0:()=>S,Z6:()=>C,RD:()=>f,Fr:()=>h,QV:()=>k,FJ:()=>y,Nz:()=>R,qz:()=>U,jF:()=>L,gL:()=>M,Li:()=>b,_w:()=>V,bW:()=>O,s6:()=>F,gv:()=>w,Oh:()=>G,mB:()=>B,g:()=>K,Jw:()=>W,kc:()=>j,bF:()=>Y,Kr:()=>x});var a=t(683184),i=t(461618),o=t(861341),d=t(829082),s=t(609446),r=t(169781),l=t(424729),c=t(990982);const E="acceptStreamPermissionsDebug",m={__typename:"PrejoinState",incomingAudio:!0,isPSTN:!1,withAudio:!0,withVideo:!1,withByod:!1,volume:10,wasMuteToggledByUser:!1,roomDetails:{__typename:"RoomDetails",room:null,roomParticipantInMeeting:null,wasRoomBluetoothProximityTriggered:!1,wasRoomLoudSpeakerInTheMeetingTriggered:!1,wasByodConnectedDeviceRoomSelected:!1,byodRoomSpeakerId:null,byodRoomMicrophoneId:null,roomType:null},wasAutomuteTriggered:!1,isAuditoriumModeEnabled:!1,shouldShowCameraCoachMark:!1,shouldAutoExpandRoomsDropdown:!1,timestamp:null};function u(e){e.writeQuery({query:r.vB,data:{prejoinState:m}})}function p(e){e.writeQuery({query:l._,data:{shouldShowVideoApp:!1}})}const _={__typename:"ByodState",isToggleEnabled:!1,isPoppedOut:!1,byodScreenBounds:null,targetMonitorId:null,sourceMonitorId:null,displayModeBeforeByod:null},I=e=>({__typename:"CallingScreenStatus",id:e,isDtmfKeypadVisible:!1,isPstnDialogVisible:!1,isBroadcastRestartWaitingOverlayVisible:!1,isChatBubblesSuppressed:!1,hasTogetherModeBeenPinned:!1,isShareTrayVisible:!1,isRosterVisible:!1,hasOnMeetingLandingElementBeenShown:!1,isAudienceBackgroundDialogVisible:!1,isTogetherModeSeatSelectionDialogVisible:!1,isTogetherModeAssignSeatsDialogVisible:!1,isAnnouncementDialogVisible:!1,isUnlockMeetingDialogVisible:!1,isInterpretationDialogVisible:!1,isMeetingLevelSpokenLanguageDialogVisible:!1,isUserLevelSpokenLanguageDialogVisible:!1,isPinConfirmDialogVisible:!1}),v=e=>({__typename:"CallingScreenLayout",currentLayout:e.get(a.J.Calling).defaultLayoutSelection||"Grid",meetingRoomLayoutSelection:"ContentAndPeople",lastSelectedLayout:"Grid",initialLayoutBeforeContentPopout:"Grid",meetingRoomLayoutPreferences:[],isFocusModeEnabled:!1,isNarrowModeActiveByUser:!1,isNarrowModeActiveByResize:!1,isNarrowModeActiveInSpatialAudio:!1,isHostViewModeWithContentActive:!1,isLayoutFlipped:!1,isContentPoppedOut:!1,isPresenterHostModeWithContent:!1,isGalleryInCentralSegment:!0,isMyselfInBarSegment:!1,isFrontRowUnifiedBackgroundActivated:!0,isPanoramicAudienceViewActivated:!1,productionStudioViewType:"None"}),T=e=>({__typename:"PinnedParticipantIds",participantIds:[],id:e}),g=e=>({__typename:"VideoScanTypeResponse",videoScanType:"none",id:e}),A="microsoft_none",N={__typename:"BackgroundsInfo",imageId:A,imagePath:"",imageStatus:"",imageProvider:"default",imageName:"",imageSrc:""},D={__typename:"SelectedAvatarInfo",id:"SelectedAvatarInfoWithAppId:null",appId:null,filterId:null,isFilterApplyUnderLoadingProcess:null,imageId:A},S=e=>({__typename:"MyselfSettings",isMyselfHidden:!1,id:e}),C={__typename:"AvatarAppAvailabilityInfo",available:!1,dataFetched:!1},f={__typename:"ImmersiveViewModeAppAvailabilityInfo",isAppAvailable:null,timestamp:null},h={__typename:"AudioVideoFrameworkInfo",id:"",isInFlyoutAvatarTab:!1,dismissedComponentIds:[]},k={__typename:"VideoEffectInfo",appId:"",appName:"",filterId:""},y={__typename:"ActiveVideoEffects",first:k,second:k,third:k},R={__typename:"InstallingVideoEffectInfo",appId:"",appName:"",developerName:"",effectCount:0,filterId:""},U={__typename:"VideoEffectsCurrentInfo",isInstallingVideoEffectInfo:R,isShowingAppPageVideoEffect:k,isAppliedVideoEffect:k,isUnderApplyingProcessVideoEffect:k,allVideoApps:[]},L={__typename:"VideoAppInfo",appId:"",appName:"",developerName:"",effectCount:1,isInstalled:!0},M={__typename:"AvatarPayload",avatarItems:[]},b=(e,n)=>n.readQuery({query:o.Q,variables:{id:e}})?.callParticipants||[],V=(e,n)=>n.readFragment({id:P(e),fragment:c.u_,fragmentName:"participantFields"})||null,O=(e,n,t)=>{const a=V(e,t);a&&t.writeFragment({id:P(e),fragment:c.u_,data:{...a,...n},fragmentName:"participantFields"})},P=e=>`Participant:{"participantId":"${e}"}`,F=(e,n)=>{e.writeQuery({query:d.j,data:{callingAlerts:n}})},w=e=>`No call found with id ${e}`,G=(e,n)=>{const t=e.coordinates;return{conversationId:(0,i.N6)(t)&&t.conversationId||null,isOneOnOne:"OneToOneCall"===e.type,isMeetup:"Meeting"===e.type,isBroadcast:(0,i.N6)(t)&&"LegacyMeetingCoordinates"===t.__typename&&!!t.broadcast,broadcastRole:(0,i.N6)(t)&&"LegacyMeetingCoordinates"===t.__typename?(0,i.N6)(t)&&t.broadcast?.role:null,withVideo:n&&n.outgoingVideo,withAudio:n&&n.outgoingAudio}},B=e=>({tenantId:"tenantId",organizerId:e??"31eedce6-db0e-44e3-9a76-56d1fa5f010a",threadId:"threadId",messageId:"messageId",additionalMessageId:"additionalMessage"}),K=()=>{const e=B();return{__typename:"BreakoutRoom",coordinates:{__typename:"RoomCoordinates",...e,additionalMessageId:"additionalMessage"},roomName:"Room 1",sourceMeetingCoordinates:{__typename:"RoomCoordinates",...e,additionalMessageId:"additionalMessage"},participants:[(n="9342492d-d51e-4317-bbf6-8341bf69f07a",{__typename:"BreakoutRoomParticipant",mri:n,role:null,objectId:null,upn:null})],restrictChatAccess:!0,isOpened:!1,meetingJoinUrl:"https://teams.microsoft.com",clientActionState:null};var n},H=(e,n)=>e?{...e,__typename:"VideoEffectInfo"}:n,W=e=>({__typename:"ActiveVideoEffects",first:H(e.activeVideoEffects.first,k),second:H(e.activeVideoEffects.second,k),third:H(e.activeVideoEffects.third,k)}),j=(e,n)=>({__typename:"VideoEffectsCurrentInfo",allVideoApps:n&&n.allVideoApps&&n.allVideoApps.length>0&&n.allVideoApps.map((e=>({...e,__typename:"VideoAppInfo"})))||e.allVideoApps,isInstallingVideoEffectInfo:n.isInstallingVideoEffectInfo?{...n.isInstallingVideoEffectInfo,__typename:"InstallingVideoEffectInfo"}:e.isInstallingVideoEffectInfo,isShowingAppPageVideoEffect:H(n.isShowingAppPageVideoEffect,e.isShowingAppPageVideoEffect),isAppliedVideoEffect:H(n.isAppliedVideoEffect,e.isAppliedVideoEffect),isUnderApplyingProcessVideoEffect:H(n.isUnderApplyingProcessVideoEffect,e.isUnderApplyingProcessVideoEffect)}),Y=()=>"None",x=(e,n)=>{const t=n.filter((e=>"TM bot"!==e.displayName)).length+1,a=n.filter((e=>e.state===s.b1.InLobby)).length;return{__typename:"CallParticipantsCounts",teamsCallId:e,participantCounts:{__typename:"ParticipantCounts",id:"id",totalParticipants:t,totalConnectedTflParticipants:0,lobbyParticipants:a,totalPresenters:t-a,totalAttendees:0,requestingAttentionPresenters:0,requestingAttentionAttendees:0,overflowAttendees:0,streamingAttendees:0}}}},861341:(e,n,t)=>{t.d(n,{Q:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"callParticipants"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callParticipants"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"participantFields"}}]}}]}},...t(990982).u_.definitions]}},829082:(e,n,t)=>{t.d(n,{j:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"callingAlerts"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"callingAlerts"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"callingAlert"}}]}}]}},...t(165180).h.definitions]}},536890:(e,n,t)=>{t.d(n,{z:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"DataResolversBrowserCallingShouldKeepPreviewWindowInSidePanelOpenQuery"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shouldKeepPreviewWindowInSidePanelOpen"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},169781:(e,n,t)=>{t.d(n,{vB:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"prejoinState"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"callingIntentId"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"prejoinState"},arguments:[{kind:"Argument",name:{kind:"Name",value:"callingIntentId"},value:{kind:"Variable",name:{kind:"Name",value:"callingIntentId"}}}],directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"incomingAudio"}},{kind:"Field",name:{kind:"Name",value:"isPSTN"}},{kind:"Field",name:{kind:"Name",value:"withAudio"}},{kind:"Field",name:{kind:"Name",value:"withVideo"}},{kind:"Field",name:{kind:"Name",value:"withByod"}},{kind:"Field",name:{kind:"Name",value:"volume"}},{kind:"Field",name:{kind:"Name",value:"wasAutomuteTriggered"}},{kind:"Field",name:{kind:"Name",value:"wasMuteToggledByUser"}},{kind:"Field",name:{kind:"Name",value:"roomDetails"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"roomDetails"}}]}},{kind:"Field",name:{kind:"Name",value:"isAuditoriumModeEnabled"}},{kind:"Field",name:{kind:"Name",value:"shouldShowCameraCoachMark"}},{kind:"Field",name:{kind:"Name",value:"shouldAutoExpandRoomsDropdown"}},{kind:"Field",name:{kind:"Name",value:"timestamp"}}]}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"roomDetails"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"RoomDetails"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"room"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"roomData"}}]}},{kind:"Field",name:{kind:"Name",value:"roomParticipantInMeeting"},selectionSet:{kind:"SelectionSet",selections:[{kind:"FragmentSpread",name:{kind:"Name",value:"roomData"}}]}},{kind:"Field",name:{kind:"Name",value:"wasRoomBluetoothProximityTriggered"}},{kind:"Field",name:{kind:"Name",value:"wasRoomLoudSpeakerInTheMeetingTriggered"}},{kind:"Field",name:{kind:"Name",value:"wasByodConnectedDeviceRoomSelected"}},{kind:"Field",name:{kind:"Name",value:"roomType"}},{kind:"Field",name:{kind:"Name",value:"byodRoomSpeakerId"}},{kind:"Field",name:{kind:"Name",value:"byodRoomMicrophoneId"}}]}},...{kind:"Document",definitions:[{kind:"FragmentDefinition",name:{kind:"Name",value:"roomData"},typeCondition:{kind:"NamedType",name:{kind:"Name",value:"ClientRoom"}},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"userId"}},{kind:"Field",name:{kind:"Name",value:"displayName"}},{kind:"Field",name:{kind:"Name",value:"proximityValidationCode"}}]}}]}.definitions]}.definitions]}},424729:(e,n,t)=>{t.d(n,{_:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"shouldShowVideoApp"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shouldShowVideoApp"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},414908:(e,n,t)=>{t.d(n,{a:()=>a});const a={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"shouldShowVideoEffectsPreview"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"shouldShowVideoEffectsPreview"},directives:[{kind:"Directive",name:{kind:"Name",value:"client"}}]}]}}]}},265593:(e,n,t)=>{var a;t.d(n,{Bx:()=>a,nJ:()=>i,p9:()=>o}),function(e){e.ChannelCard="ChannelCard"}(a||(a={}));const i={getLinkToChannel:"getLinkToChannel",viewChannelEmail:"viewChannelEmail",manageChannelMembers:"manageChannelMembers",manageTeam:"manageTeam",manageTeamChannels:"manageTeamChannels",leaveChannel:"leaveChannel",manageChannel:"manageChannel",channelAddMembers:"channelAddMembers",shareChannelWithUser:"shareChannelWithUser",shareChannelWithTeam:"shareChannelWithTeam",channelNotificationSettings:"channelNotificationSettings"},o={getLinkToChannel:(e,n)=>({data:n,originator:e,type:i.getLinkToChannel}),viewChannelEmail:(e,n)=>({data:n,originator:e,type:i.viewChannelEmail}),manageChannelMembers:(e,n)=>({data:n,originator:e,type:i.manageChannelMembers}),manageTeam:(e,n)=>({data:n,originator:e,type:i.manageTeam}),manageTeamChannels:(e,n)=>({data:n,originator:e,type:i.manageTeamChannels}),leaveChannel:(e,n)=>({data:n,originator:e,type:i.leaveChannel}),manageChannel:(e,n)=>({data:n,originator:e,type:i.manageChannel}),channelAddMembers:(e,n)=>({data:n,originator:e,type:i.channelAddMembers}),shareChannelWithUser:(e,n)=>({data:n,originator:e,type:i.shareChannelWithUser}),shareChannelWithTeam:(e,n)=>({data:n,originator:e,type:i.shareChannelWithTeam}),channelNotificationSettings:(e,n)=>({data:n,originator:e,type:i.channelNotificationSettings})}},361899:(e,n,t)=>{t.d(n,{xx:()=>a,Hl:()=>i,iG:()=>o,hL:()=>d,x3:()=>s,EO:()=>r,mO:()=>l,rP:()=>c,t_:()=>E,Dg:()=>m,i7:()=>u,kr:()=>p,ry:()=>_,bT:()=>I,rZ:()=>v,YC:()=>T,wW:()=>g,SS:()=>A,Zr:()=>N,n6:()=>D,ZX:()=>S,PN:()=>C,d6:()=>f,Qw:()=>h,eY:()=>k,V1:()=>y,av:()=>R,HI:()=>U,RF:()=>L});const a="v1/objects/",i="imgpsh_mobile_save_anim",o="v1/objects/{objectId}/forward",d="v1/objects/{objectId}/views/imgo",s="v1/objects/{objectId}/views/imgpsh_mobile_save_anim",r="?v=1",l="&v=1",c="retry-after",E="/views/video",m="/views/thumbnail",u="/status",p=4194304,_=524288,I=2,v=144e3,T="/views/original",g="RejectedByPolicy",A=10004,N=403,D="retry-after",S=2,C=4,f=.5,h="transcript_info",k={IMAGE:"pish/image",DOCUMENT:"sharing/file",VIDEO:"sharing/videototranscode"},y={IMAGE:"imgpsh",DOCUMENT:"original",VIDEO:"video",THUMBNAIL:"thumbnail",TRANSCRIPT_INFO:"transcript_info"},R={IMAGE:"imgpsh",ORIGINAL:"original",VIDEO:"video"},U={downloadMedia:"downloadMedia",getViewStatus:"getViewStatus",postMedia:"postMedia",putMedia:"putMedia",forwardMediaContent:"forwardMediaContent"},L={"x-ms-client-version":"1415/1.0.0.2018090100"}},823805:(e,n,t)=>{t.d(n,{i:()=>p,O:()=>_});var a=t(593697),i=t(803238),o=t(683184),d=t(543491),s=t(238572),r=t(904986),l=t(98666),c=t(72742),E=t(205454),m=t(789168),u=t(666921);const p="~~~~###@@TACOCAT@@###~~~~";let _=class{async transform(e,n){if(!e||!n.messageProperties)return;this._logger=n.loggerFactory.newLogger("CodeSnippetsSerializer","services-io-browser-compose-serializer-extensions"),this._scenarioFactory=n.scenarioFactory,this._settings=n.coreSettings;const t=(0,i.unescape)(E.N.DomUtils.getAttributeValue(e,s.Qq)),a=E.N.DomUtils.getAttributeValue(e,s.fK),[o]=E.N.DomUtils.getElementsByTagName("code",e);if(!t)return this._logger.error("The props was missing"),null;if(!o)return this._logger.error("The code snippet was missing"),null;if(!a)return this._logger.error("The id of the card was missing"),null;try{await this._uploadAndUpdateCard(a,JSON.parse(t),o,n);const e=(0,m.ln)("span",{content:a,itemprop:"cardId"}),i=(0,m.ln)("span",{class:"inline-compose-card",itemid:a,itemscope:"",itemtype:c.T.inputExtension});return E.N.DomUtils.appendChild(i,e),this._logger.debug("Uploaded code snippet",a),i}catch(e){return this._logger.error("Failed to upload the code snippet!"),null}}async _uploadCodeSnippet(e,n,t){const{source:a}=e,i=E.N.DomUtils.getInnerHTML(n),s=`${a}${p}${i}`,r=this._scenarioFactory?.newScenario(d.RG.CodeSnippetUpload);try{const{objectId:e}=await this._uploadToAMS(s,t,this._logger);return r?.stop(),{objectId:e,uploadType:"AMS"}}catch(e){this._logger.error("_uploadCodeSnippet: code snippet upload to ams failed!"),r?.fail();const{enableCacheStorageInSendMessageMW:n}=this._settings.get(o.J.Messaging);if(n){this._logger.debug("Trying to upload code snippet to cache storage");const{objectId:e}=await this._uploadToCache(s,t,this._logger);return{objectId:e,uploadType:"OfflineCache"}}throw this._logger.debug("_uploadCodeSnippet: enableCacheStorageInSendMessageMW is not enabled!"),e}finally{r?.stop()}}async _uploadToAMS(e,n,t){t.log("Uploading to code snippet to ams");const{objectId:a}=await n.asyncMediaService.uploadItem(e,n.conversationId,"DOCUMENT",l.r1.Attached);return{objectId:a}}async _uploadToCache(e,n,t){try{t.log("uploading inline image to offline cache storage");const[a,i]=await n.offlineCacheManager.saveDynamic(new Response(e,{headers:new Headers({"Content-Type":"text/html","Cache-Control":"max-age=259200, s-maxage=0, private","Content-Length":`${e.length}`,Date:(new Date).toUTCString()})}));return t.log(`Uploaded image to offline cache, image: ${i} objectId: ${a}`),{objectId:a}}catch(e){throw t.error("_uploadToCache: uploading inline image to offline cache store failed!"),e}}async _uploadAndUpdateCard(e,n,t,a){const{amsReferenceId:i}=n,{name:o,language:d,wrap:s}=n,r=a.messageProperties.cards||[];let l={objectId:i,uploadType:"AMS"};if(i||(l=await this._uploadCodeSnippet(n,t,a)),"AMS"===l.uploadType){const e=a.messageProperties.amsReferences||[];a.messageProperties.amsReferences=[...e,l.objectId]}else if("OfflineCache"===l.uploadType){const e=a.messageProperties.offlineAssets||[];a.messageProperties.offlineAssets=[...e,l.objectId]}a.messageProperties.cards=[...r.filter((n=>n.cardClientId!==e)),{appId:e,cardClientId:e,contentType:u.p.CodeSnippet,content:JSON.stringify({type:u.p.CodeSnippet,editable:!0,id:e,name:o,language:d,wrap:s,lines:t.children?t.children.length:0,cardClientId:e,amsReferenceId:l.objectId})}],a.telemetryDatabag["DataBag.codeSnippets"]=(a.telemetryDatabag["DataBag.codeSnippets"]||0)+1}};_=(0,a.__decorate)([(0,r.HR)({name:"CodeSnippets",filter:{[s.$S]:"CodeSnippetCard"}})],_)},538523:(e,n,t)=>{t.d(n,{D:()=>u});var a=t(593697),i=t(803238),o=t(904986),d=t(72742),s=t(205454);const r=new RegExp(/animated-emoticon.*?/),l=/img|table/,c=e=>!!e&&s.N.DomUtils.getAttributeValue(e,"itemtype")===d.T.customEmoji,E=e=>!!e&&(s.N.DomUtils.getAttributeValue(e,"itemtype")===d.T.emoji||r.test(s.N.DomUtils.getAttributeValue(e,"class")||"")),m=3;let u=class{preTransform(e,n){const t=(0,i.isUndefined)(n.superSizeEmoticons)?0:n.superSizeEmoticons;var a;"br"===e.name?n.containsPotentiallyIncludedWhitespace=!0:(0,i.isNumber)(t)&&(n.superSizeEmoticons=E(e)||c(e)?(a=t,!n.containsPotentiallyIncludedWhitespace&&a<m&&a+1):!(e=>e&&!E(e.parent)&&!c(e.parent)&&!(e.parent&&E(e.parent.parent))&&(l.test(e.name||"")||!(!e.data||!e.data.replace("Â ","").replace(/[\u200B-\u200D\uFEFF]/g,"").trim())))(e)&&t)}};u=(0,a.__decorate)([(0,o.wx)({name:"BigEmoticonPreprocessor",filter:"*"})],u)},938772:(e,n,t)=>{t.d(n,{pF:()=>a,I0:()=>i,jI:()=>o,xb:()=>d,yv:()=>E,Pn:()=>u,Vx:()=>p,Gl:()=>_,XD:()=>I,JV:()=>v,KI:()=>D});var a,i,o,d,s=t(702135),r=t(689626);!function(e){e[e.Unknown=1]="Unknown",e[e.InvalidContinueResponse=2]="InvalidContinueResponse",e[e.InvalidMessageResponse=3]="InvalidMessageResponse",e[e.BothCardAndUrl=4]="BothCardAndUrl",e[e.MissingCardAndUrl=5]="MissingCardAndUrl",e[e.InvalidAdaptiveCard=6]="InvalidAdaptiveCard",e[e.InvalidUrl=7]="InvalidUrl"}(a||(a={})),function(e){e[e.InvalidInvokeResponseType=1]="InvalidInvokeResponseType"}(i||(i={})),function(e){e[e.InvalidInvokeResponseType=1]="InvalidInvokeResponseType"}(o||(o={})),function(e){e[e.Unknown=1]="Unknown",e[e.InvalidContinueResponse=2]="InvalidContinueResponse",e[e.InvalidAdaptiveCards=3]="InvalidAdaptiveCards",e[e.InvalidSubmitTaskResponse=4]="InvalidSubmitTaskResponse"}(d||(d={}));const l="BotsPlatformResolvers",c="retry-after",E=async e=>{const n=await T(e),t=g(n.errorCode),a=A(n);return t?(0,s.Tr)(l,r.jK.BotError,"executeBotInvoke",void 0,a,void 0):m(e,a)},m=(e,n)=>412===e.status?(0,s.Tr)(l,r.jK.UserConsentRequired,"executeBotInvoke",void 0,n,void 0):429===e.status?(0,s.Tr)(l,r.jK.Throttled,"executeBotInvoke",void 0,n,{status:e.status,headers:{[c]:e.headers[c]},body:{},url:""}):403===e.status&&n.toLowerCase().includes("BotDisabledByAdmin".toLowerCase())?(0,s.Tr)(l,r.jK.Forbidden,"executeBotInvoke",void 0,n,void 0):(0,s.Tr)(l,r.jK.RemoteOperationFailed,"executeBotInvoke",void 0,n,void 0),u=e=>{const n=e&&a[e]||void 0;return(0,s.Tr)(l,r.jK.InvalidResponse,"executeTaskModuleInvoke",void 0,n,void 0)},p=e=>{const n=e&&d[e]||void 0;return(0,s.Tr)(l,r.jK.InvalidResponse,"executeAdaptiveCardTabInvoke",void 0,n,void 0)},_=()=>(0,s.Tr)(l,r.jK.Unauthorized,"getCurrentUserName",void 0,void 0,void 0),I=e=>{const n=e&&o[e]||void 0;return(0,s.Tr)(l,r.jK.InvalidResponse,"executeMessageExtensionInvoke",void 0,n,void 0)},v=e=>{const n=e&&i[e]||void 0;return(0,s.Tr)(l,r.jK.InvalidResponse,"executeBotConfigInvoke",void 0,n,void 0)},T=async e=>{const n=await e.body.text();return n&&n.length>0?JSON.parse(n):{}},g=e=>null!=e&&(1008===e||209===e),A=e=>`Error code: ${e.errorCode} message: ${N(e.message)}`,N=e=>{const n=e&&e.match(/<[^>]*>/g);return n&&n.length>0?n[0]:""},D=(e,n)=>{const t="^((https|api):/(/.+)?/botid-{botId})".replace("{botId}",n);return new RegExp(t,"i").test(e)}},219983:(e,n,t)=>{t.d(n,{Bc:()=>a,l4:()=>i,FW:()=>o,kH:()=>d});const a={INVALID_START_DATE:"Invalid start date. Start date cannot be null or undefined",INVALID_END_DATE:"Invalid end date. End date cannot be null or undefined",INVALID_GROUP_IDENTIFIER:"Invalid group identifier. Group identifier cannot be null or undefined",INVALID_START_AND_END_DATE:"Start date cannot greater than end date",INVALID_EVENT_ID:"Invalid event id",INVALID_UID:"Invalid uid",ATLEAST_ONE_ATTENDEE_REQUIRED:"atleast one attendee is required",INVALID_MRI:"invalid mri",INVALID_MEETING_RESPONSE:"Invalid Meeting Response",INVALID_START_TIME_FOR_ICALUID_OP:"Invalid start time. Start time cannot be null or undefined for operation on instance of a series event using iCalUId",INVALID_CONNECTED_ACCOUNT_ID:"Invalid connected account id",FAILED_TO_GENERATE_URL:"Failed to generate URL to call",REQUEST_TIMEOUT_MESSAGE:"Request timeout"},i={MiddleTier:{V1:{Private:{CREATE_EMPTY_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/privateMeeting/schedulingService/create",UPDATE_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/schedulingService/update",DELETE_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/schedulingService/delete",GET_MEETING_FROM_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/schedulingService/{tenantId}/{organizerId}/{threadId}/{messageId}",CREATE_EVENT_USING_EXISTING_SCHEDULING_SERVICE_EVENT:"beta/me/calendarEvents/privateMeeting/exchangeandlink?useGraphApi=false",UPDATE_CALENDAR_EVENT:"beta/me/calendarEvents/privateMeeting/{eventId}?useSchedulingService=true&useGraphApi=false",GET_CALENDAR_EVENT:"beta/me/calendarEvents/{eventId}?useICalUId={useICalUId}&eventType={eventType}&eventStartDateTime={eventStartDateTime}",GET_CALENDAR_EVENTS:"beta/me/calendarEvents?StartDate={startDate}&EndDate={endDate}",DELETE_CALENDAR_EVENT:"beta/me/calendarEvents/{eventId}?useICalUId={useICalUId}",UPDATE_MEETING_RESPONSE:"beta/me/calendarEvents/{eventId}/respond?useICalUId={useICalUId}&eventType={eventType}&eventStartDateTime={eventStartDateTime}",UPDATE_ATTENDEE_EVENT:"beta/me/calendarEvents/{eventId}/attendeeEvent?useICalUId={useICalUId}",CANCEL_CALENDAR_EVENT:"beta/me/calendarEvents/{eventId}/cancel?useICalUId={useICalUId}",CANCEL_PRIVATE_EVENT:"beta/me/calendarEvents/privateMeeting/{eventId}/cancel?useSchedulingService=true&useICalUId={useICalUId}",GET_USER_MAILBOX_SETTINGS:"beta/users/mailboxSettings",GET_USER_TIMEZONE:"beta/me/calendarEvents/timeZoneSettingsWithOffset?timezone={timezone}",GET_BUILDINGS:"beta/me/calendarEvents/roomlist",GET_ROOMS_IN_BUILDING:"beta/me/calendarEvents/roomlist?topLevel={buildingAddress}",GET_SUGGESTED_TIME:"beta/me/calendarEvents/availability"},Channel:{GET_CHANNEL_EVENTS:"beta/teams/{smtpAddress}/calendarEvents?StartDate={startDate}&EndDate={endDate}",GET_CHANNEL_EVENT:"beta/teams/{smtpAddress}/calendarEvents/{eventId}?useICalUId={useICalUId}&eventType={eventType}&eventStartDateTime={eventStartDateTime}",ADD_TO_MY_CALENDAR:"beta/teams/{smtpAddress}/addtomycalendar/{eventId}?useICalUId={useICalUId}",CANCEL_TEAM_EVENT:"beta/teams/{smtpAddress}/calendarEvents/{iCalUId}/cancel?useICalUId={useICalUId}&useSchedulingService=true",CREATE_TEAM_EVENT:"beta/teams/{smtpAddress}/calendarEvents?useSchedulingService=true&useGraphApi=false&enablePstn={enablePstn}",UPDATE_TEAM_EVENT:"beta/teams/{smtpAddress}/calendarEvents/{iCalUId}/update?useICalUId=true&useSchedulingService=true&useGraphApi=false"}},V2:{Unified:{GET_CALENDAR_EVENTS:"v2.0/unified/calendarEvents?startDate={startDate}&endDate={endDate}",GET_CALENDAR_VIEWS:"v2.0/unified/calendars/calendarViews?startDate={startDate}&endDate={endDate}",GET_CALENDAR_LEFT_RAIL_SETTINGS:"v2.0/unified/calendars/settings/leftrail",UPDATE_CALENDAR_LEFT_RAIL_SETTINGS:"v2.0/unified/calendars/settings/leftrail"},Private:{GET_OUTLOOK_CALENDAR_SETTINGS:"v1/calendarSettings?settingName={outlookCalendarSettings}",GET_CALENDAR_EVENTS:"v2.0/me/calendars/default/calendarView?StartDate={startDate}&EndDate={endDate}&shouldDecryptData={shouldDecryptData}",FORWARD_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}/forward?useICalUId={useICalUId}",IMPORT_CALENDAR_EVENT:"v2.0/me/calendars/events/import",GET_SCHEDULES:"v2.0/me/calendars/schedules",GET_ATTENDEE_WORK_HOURS:"v2.0/me/calendars/attendeeWorkHours",FIND_MEETING_TIMES:"v2.0/me/calendars/findMeetingTimes",CREATE_CALENDAR_EVENT:"v2.0/me/calendars/default/events?isOnlineMeeting={isOnlineMeeting}&shouldDecryptData={shouldDecryptData}",UPDATE_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}?isOnlineMeeting={isOnlineMeeting}",GET_CALENDAR_EVENT_WITH_ICALUID:"v2.0/me/calendars/events/iCalUId/{eventId}?eventStartDateTime={eventStartDateTime}&shouldDecryptData={shouldDecryptData}",GET_CALENDAR_EVENT_WITH_UID:"v2.0/me/calendars/events/uid/{uid}?startDate={startDate}&endDate={endDate}",GET_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}?shouldDecryptData={shouldDecryptData}",DELETE_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}",PATCH_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}",UPDATE_MEETING_RESPONSE:"v2.0/me/calendars/events/{eventId}/respond",UPDATE_MEETING_RESPONSE_WITH_ICALUID:"v2.0/me/calendars/events/{eventId}/respond?eventType={eventType}&eventStartDateTime={eventStartDateTime}",UPDATE_ATTENDEE_EVENT:"v2.0/me/calendars/events/{eventId}/attendeeEvent",CANCEL_CALENDAR_EVENT:"v2.0/me/calendars/events/{eventId}/cancel",GET_MASTER_CATEGORIES:"v2.0/me/calendars/masterCategories",GET_CALENDAR_VIEW_V2_1:"v2.1/me/calendars/calendarView?startDate={startDate}&endDate={endDate}&$top={top}&$count=true&$skip={skip}&$orderby={orderby}",GET_ROOM_LISTS:"v2.0/places/roomLists?$count={count}&$top={top}&$skip={skip}",GET_ALL_ROOMS:"v2.0/places/rooms?$count={count}&$top={top}&$skip={skip}",GET_ROOMS_IN_ROOM_LIST:"v2.0/places/{roomListAddress}/roomList/rooms?$count={count}&$top={top}&$skip={skip}",GET_MEETING_ARTIFACTS:"v2.0/me/calendars/events/collabs",GET_ATTACHMENTS:"v2.0/me/events/{eventId}/attachments/{attachmentId}"},Channel:{FORWARD_TEAM_EVENT:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}/forward?useICalUId={useICalUId}&isBackedBySubstrateGroup={isBackedBySubstrateGroup}",GET_CHANNEL_EVENT:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}?isBackedBySubstrateGroup={isBackedBySubstrateGroup}&shouldDecryptData={shouldDecryptData}",GET_CHANNEL_EVENT_WITH_ICALUID:"v2.0/groups/{groupIdentifier}/calendars/events/iCalUId/{iCalUId}?eventStartDateTime={eventStartDateTime}&shouldDecryptData={shouldDecryptData}",GET_CHANNEL_EVENT_WITH_UID:"v2.0/groups/{groupIdentifier}/calendars/events/uid/{uid}?startDate={startDate}&endDate={endDate}&shouldDecryptData={shouldDecryptData}",GET_CALENDAR_VIEW:"v2.0/groups/{groupIdentifier}/calendars/default/calendarView?startDate={startDate}&endDate={endDate}&shouldDecryptData={shouldDecryptData}",GET_CALENDAR_VIEW_V2_1:"v2.1/groups/{groupIdentifier}/calendars/default/calendarView?startDate={startDate}&endDate={endDate}&shouldDecryptData={shouldDecryptData}",CREATE_TEAM_EVENT:"v2.0/groups/{groupIdentifier}/calendars/default/events?isOnlineMeeting={isOnlineMeeting}&shouldDecryptData={shouldDecryptData}",CREATE_TEAM_EVENT_V2_1:"v2.1/groups/{groupIdentifier}/calendars/{calendarId}/events?isOnlineMeeting={isOnlineMeeting}",UPDATE_TEAM_EVENT:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}?isOnlineMeeting={isOnlineMeeting}",CANCEL_TEAM_EVENT:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}/cancel",ADD_TO_MY_CALENDAR:"v2.0/groups/{groupIdentifier}/calendars/events/{eventId}/addtomycalendar?isBackedBySubstrateGroup={isBackedBySubstrateGroup}"}},CONNECTED:{Private:{GET_CALENDAR_VIEW_V2_1:"v1.1/connected/{connectedAccountId}/calendars/default/calendarView?startDate={startDate}&endDate={endDate}&$top={top}&$count=true&$skip={skip}&$orderby={orderby}",GET_CALENDAR_EVENTS_CALENDAR_VIEW:"v1.0/connected/{connectedAccountId}/calendars/default/calendarView?StartDate={startDate}&EndDate={endDate}",GET_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}",GET_CALENDAR_EVENT_WITH_ICALUID:"v1.0/connected/{connectedAccountId}/calendars/events/iCalUid/{eventId}?eventStartDateTime={eventStartDateTime}",GET_CALENDAR_EVENT_BY_UID:"v1.0/connected/{connectedAccountId}/calendars/events/uid/{uid}?startDate={startDate}&endDate={endDate}",CREATE_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/default/events?isOnlineMeeting={isOnlineMeeting}",FORWARD_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}/forward?useICalUId={useICalUId}",UPDATE_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}",CANCEL_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}/cancel",UPDATE_MEETING_RESPONSE:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}/respond",DELETE_CALENDAR_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}",UPDATE_ATTENDEE_EVENT:"v1.0/connected/{connectedAccountId}/calendars/events/{eventId}/attendeeEvent"}}},Outlook:{V2:{Private:{GET_ATTACHMENT_BY_ID:"/v2.0/me/events/{eventId}/attachments/{attachmentId}"}}}},o="Personal",d={DEEP_LINK:"deep-link",NOTIFICATION_POPOVER:"notification-popover",NOTIFICATIONS_FLYOUT:"notifications-flyout",DRAG_DROP_EDIT_DIALOG:"drag-and-drop-edit-dialog"}},98666:(e,n,t)=>{var a,i,o,d;t.d(n,{f5:()=>a,Ko:()=>i,r1:()=>o,sF:()=>d}),function(e){e.ActiveUserOperation="AUO",e.PassiveOperation="PO",e.BackgroundOperation="BO"}(a||(a={})),function(e){e.UploadFile="ShareUploadFile",e.RemoveFile="ShareAbort"}(i||(i={})),function(e){e.Unknown="Unknown",e.Inline="Inline",e.Attached="Attached"}(o||(o={})),function(e){e.manualRedirect="manualRedirect"}(d||(d={}))},839860:(e,n,t)=>{t.d(n,{l0:()=>i,gP:()=>o,lw:()=>d,iV:()=>s,G5:()=>r,o3:()=>l,gI:()=>c,Dk:()=>E,gZ:()=>m});const a="__",i=(e,n,t,a,i)=>{if(!(e&&n&&t&&a))return"";return(i?[e,n,t,a,i]:[e,n,t,a]).join("__")},o=e=>{const[n,t,a,i]=e.split("__");return{tenantId:n,organizerId:t,conversationId:a,messageId:i}},d=e=>e.split(a)[0],s=e=>e.split(a)[1],r=e=>e.split(a)[2],l=e=>e.split(a)[3],c=e=>e.split(a)[4],E=(e,n,t)=>{let a=n.replace("{broadcastId}",e);return t&&(a+=`?isanonymous=true&tenantId=${d(e)}`),a},m=e=>{if(e){const n=e.stream,t=n?.wamsStreamingUrl,a=!!n?.decryptionToken,i=e.altStream,o=i?.wamsStreamingUrl;return!!(t&&a||o&&!!i?.decryptionToken)}return!1}},130480:(e,n,t)=>{function a(){return new Date}t.d(n,{Ux:()=>a,cO:()=>i,f1:()=>l,R4:()=>c});const i=9999,o=59,d=59,s=23,r=999,l=new Date(i,11,31,0,0,0);function c(){const e=a();return e.setHours(s,d,o,r),e}},627718:(e,n,t)=>{var a;t.d(n,{YJ:()=>a,sK:()=>o,ZU:()=>d,Y1:()=>s}),function(e){e.SPPage="sppage",e.SPList="splist",e.SPListItem="splistitem",e.SPListForm="splistform",e.SPListPlaylist="splistplaylist"}(a||(a={}));const i=[a.SPList,a.SPListForm,a.SPListPlaylist,a.SPListItem],o=e=>!!e&&-1!==i.indexOf(e),d=e=>!!e&&(e===a.SPList||e===a.SPListPlaylist),s=e=>!!e&&e===a.SPListItem},826457:(e,n,t)=>{var a,i,o;t.d(n,{gT:()=>a,lP:()=>i,ej:()=>o}),function(e){e[e.Two=2]="Two",e[e.FOUR=4]="FOUR",e[e.FIVE=5]="FIVE",e[e.FIFTEEN=15]="FIFTEEN",e[e.TWENTY_FOUR=24]="TWENTY_FOUR",e[e.THIRTY=30]="THIRTY",e[e.ONE_HUNDRED=100]="ONE_HUNDRED",e[e.SECONDS_PER_MINUTE=60]="SECONDS_PER_MINUTE",e[e.MINUTES_PER_HOUR=60]="MINUTES_PER_HOUR",e[e.MILLI_PER_SECOND=1e3]="MILLI_PER_SECOND",e[e.MILLI_PER_MINUTE=6e4]="MILLI_PER_MINUTE",e[e.MILLISECONDS_PER_HOUR=36e5]="MILLISECONDS_PER_HOUR",e[e.MILLISECONDS_PER_DAY=864e5]="MILLISECONDS_PER_DAY"}(a||(a={})),function(e){e[e.LOAD_FRAME_TIMEOUT=15e3]="LOAD_FRAME_TIMEOUT",e[e.EXPIRE_OFFSET_SECONDS=600]="EXPIRE_OFFSET_SECONDS",e[e.MT_TOKEN_INTERVAL=12e4]="MT_TOKEN_INTERVAL",e[e.ACQUIRE_TOKEN_TIMEOUT=6e4]="ACQUIRE_TOKEN_TIMEOUT",e[e.DEFAULT_ACQUIRE_TOKEN_MAX_RETRIES=3]="DEFAULT_ACQUIRE_TOKEN_MAX_RETRIES",e[e.DEFAULT_ACQUIRE_TOKEN_RETRY_WINDOW=3e4]="DEFAULT_ACQUIRE_TOKEN_RETRY_WINDOW",e[e.DEFAULT_ACQUIRE_TOKEN_BACKOFF_TIME=2e3]="DEFAULT_ACQUIRE_TOKEN_BACKOFF_TIME",e[e.ELECTRON_ACQUIRE_TOKEN_TIMEOUT=22e4]="ELECTRON_ACQUIRE_TOKEN_TIMEOUT",e[e.ACQUIRE_TOKEN_SCENARIO_TIMEOUT=24e4]="ACQUIRE_TOKEN_SCENARIO_TIMEOUT",e[e.DEFAULT_SKYPE_MAX_DELAY_TIME_MS=3e4]="DEFAULT_SKYPE_MAX_DELAY_TIME_MS",e[e.DEFAULT_SKYPE_MAX_RETRY_DURATION_MS=15e3]="DEFAULT_SKYPE_MAX_RETRY_DURATION_MS",e[e.DEFAULT_SKYPE_MAX_RETRY_COUNT=3]="DEFAULT_SKYPE_MAX_RETRY_COUNT",e[e.DEFAULT_SKYPE_MIN_RETRY_INTERVAL_MS=1e3]="DEFAULT_SKYPE_MIN_RETRY_INTERVAL_MS",e[e.DEFAULT_SKYPE_EXP_DELAY_FACTOR=2]="DEFAULT_SKYPE_EXP_DELAY_FACTOR",e[e.DEFAULT_REGION_GTM_MIN_LENGTH=10]="DEFAULT_REGION_GTM_MIN_LENGTH"}(i||(i={})),function(e){e.LOKI_TFL_AUTH_TOKEN_AUDIENCE="liveprofilecard.access",e.MT_AAD_KEY="https://api.spaces.skype.com",e.MT_KEY="middleTier",e.SKYPE_KEY="skype",e.AUTHZ_DEFAULT_BASE_URL="https://teams.microsoft.com/api/authsvc/v1.0/authz",e.AUTHZ_DEPRECATED_DEFAULT_BASE_URL="https://authsvc.teams.microsoft.com/v1.0/authz",e.GROUPS_SERVICE="https://groupssvc.fl.teams.microsoft.com/teams.readwrite",e.UNIFIED_CONSENT_WEB_AUTH_URL="https://consentservice.microsoft.com/web/UnifiedUserConsent.ReadWrite",e.UNIFIED_CONSENT_CHECKIN_AUTH_URL="https://consentservice.microsoft.com/checkin/UnifiedUserConsent.Read",e.CSA_PHONELINK_AUTH_URL="https://chatsvcagg-tfl.teams.microsoft.com/user_impersonation"}(o||(o={}))},355617:(e,n,t)=>{var a;t.d(n,{Y:()=>a}),function(e){e.About="about",e.Accounts="accounts",e.Accessibility="accessibility",e.Calendar="calendar",e.Calls="calls",e.ChatsAndChannels="chats_and_channels",e.General="general",e.Notifications="notifications",e.People="people_setting",e.Privacy="privacy",e.Benefits="benefits",e.Transcription="captions_and_transcription",e.Devices="devices",e.Recognition="recognition",e.FilesAndLinks="files_and_links",e.PhoneLink="phonelink",e.AppDevicePermission="app_permissions",e.Insiders="teams_insider"}(a||(a={}))},720477:(e,n,t)=>{t.d(n,{Ss:()=>d,BY:()=>s,qv:()=>r,Gg:()=>l,L2:()=>c,HA:()=>E,fY:()=>m,zt:()=>u,xy:()=>p,GI:()=>_,vU:()=>I,r:()=>T});var a=t(191366),i=t(923671);const o=/[a-z]+-[a-z]+/gi,d=e=>{const n=e.match(/\/objects\/(.*)\/views\/video/);return n?.[1]},s=e=>`${e}.mpd`,r=(e,n,t)=>e.replace(new RegExp("/video$"),`/${t}/videoSegment/${n}`),l=e=>e.includes("canary")?"canary":"prod",c=e=>e?"2":"1",E=e=>e.replace("views/video","views/transcript"),m=(e,n,t)=>{if(!t||!e||!n||e.startsWith(n))return e;return[n,new URL(e).pathname.substring(1)].join("")},u=e=>s(e),p=(e,n)=>({...e&&{authorization:`skype_token ${e}`},...n&&{"ms-cv":n}}),_=()=>{const{document:e}=(0,a.J)(),n=e?.defaultView?.navigator.userAgent;return void 0!==n&&-1!==n.indexOf("Electron")},I=()=>{const{document:e}=(0,a.J)(),n=e?.defaultView?.navigator.userAgent;return void 0!==n&&-1!==n.indexOf("Firefox")},v=e=>(0,i.LJ)(e).locale??e,T=(e,n,t)=>{const a=new Set;e&&a.add(v(e.toLowerCase())),n&&!a.has(n)&&a.add(v(n.toLowerCase()));const i=t.map((e=>v(e))).filter((e=>e.match(o)));if(i)for(const e of i){if(a.size>=4)break;a.has(e.toLowerCase())||a.add(e.toLowerCase())}return[...a].slice(0,4).join(";")}},766527:(e,n,t)=>{t.d(n,{Sq:()=>a,wX:()=>i,hq:()=>o,OE:()=>d,ZU:()=>s,If:()=>r,cQ:()=>l,an:()=>c,JH:()=>E});const a="video-message",i="video-message-gc",o="Creation-Epoch",d=(e,n)=>{const t=parseInt(n||"",10);return isNaN(t)||e-t>144e5},s=(e,n)=>e-n>2592e5,r=e=>c(e,"videoBlob"),l=e=>c(e,"thumbnailBlob"),c=(e,n)=>`${a}?cacheId=${e}&type=${n}`,E=e=>{try{const n=new URL(e);if(n.pathname.slice(Math.max(0,n.pathname.length-a.length))!==a)return;const t=n.searchParams.get("cacheId"),i=n.searchParams.get("type"),o="videoBlob"===i||"thumbnailBlob"===i?i:void 0;return t&&o?{cacheId:t,type:o}:void 0}catch{return}}}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/hashed-assets/505724-bb210a4c1c4084fc.js.map